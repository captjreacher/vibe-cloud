{"version":3,"file":"index-C2o18Evc.js","names":["globalAuthModalTrigger: ((context?: string) => void) | null","status: number","statusText: string","endpoint: string","headers: Record<string, string>","data: ApiResponse<CsrfTokenResponseData>","config: RequestInit","value: AuthContextType","errors: Record<string, string>","value: AuthModalContextType","boards: Board[]","defaultStatus: PlatformStatusData","cachedStatus: PlatformStatusData | null","inFlightRequest: Promise<void> | null","pagination: PaginationInfo","DEPLOYMENT_STATUS_CONFIG: Record<DeploymentStatus, DeploymentStatusInfo>","CurvedArrow: React.FC<ArrowProps>","endPoint: Point","c1: Point","c2: Point","decorations: monaco.editor.IModelDeltaDecoration[]","match: RegExpExecArray | null","name: string","version: string | undefined","root: { [key: string]: FileTreeItem }","currentLevel: { [key: string]: FileTreeItem }","elementsToHide: Array<{ element: HTMLElement; originalStyle: string }>","onScreenshot?: (screenshot: ScreenshotResult) => void","domChangeTimeout: NodeJS.Timeout","newMsg: ChatMessage","initialStages: ProjectStage[]","history: ReadonlyArray<ConversationMessage>","restoredMessages: ChatMessage[]","message: WebSocketMessage","result: {\r\n\t\t\t\t\t\twebsocketUrl: string;\r\n\t\t\t\t\t\tagentId: string;\r\n\t\t\t\t\t\ttemplate: {\r\n\t\t\t\t\t\t\tfiles: FileType[];\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}","error: any","specificMappings: Record<string, string>","debugMessage: DebugMessage","PROVIDER_LOGOS: Record<string, React.ComponentType<{ className?: string }>>","managedSecrets: ManagedSecret[]","recommendations: Record<string, string>","models: { value: string; label: string; provider: string; hasUserKey: boolean; byokAvailable: boolean }[]","specificMappings: Record<string, string>","descriptions: Record<string, string>","PROVIDER_LOGOS: Record<\r\n\t\tstring,\r\n\t\tReact.ComponentType<{ className?: string }>\r\n\t>","emojiMap: Record<string, string>","AppListContainer: React.FC<AppListContainerProps>","AppFiltersForm: React.FC<AppFiltersFormProps>","SORT_CONFIGURATIONS: Record<AppSortOption, SortOption>","AppSortTabs: React.FC<AppSortTabsProps>","VisibilityFilter: React.FC<VisibilityFilterProps>","allowedSorts: AppSortOption[]","initialSort: AppSortOption","SUPPORTED_ACTIONS: PendingAction[]","ACTION_MAP: Record<PendingAction, string>","actionConfigs: Record<string, ActionConfig>","allowedSorts: AppSortOption[]","initialSort: AppSortOption"],"sources":["../../../src/utils/sentry.ts","../../../src/lib/api-client.ts","../../../src/hooks/useSentryUser.ts","../../../src/contexts/auth-context.tsx","../../../src/components/auth/login-modal.tsx","../../../src/components/auth/AuthModalProvider.tsx","../../../src/contexts/theme-context.tsx","../../../src/components/ui/sonner.tsx","../../../src/hooks/use-mobile.ts","../../../src/lib/utils.ts","../../../src/components/ui/button.tsx","../../../src/components/ui/input.tsx","../../../src/components/ui/separator.tsx","../../../src/components/ui/sheet.tsx","../../../src/components/ui/skeleton.tsx","../../../src/components/ui/tooltip.tsx","../../../src/components/ui/sidebar.tsx","../../../src/hooks/useAuthGuard.ts","../../../src/lib/app-events.ts","../../../src/contexts/apps-data-context.tsx","../../../src/hooks/use-apps.ts","../../../src/components/ui/scroll-area.tsx","../../../src/components/ui/dropdown-menu.tsx","../../../src/components/ui/alert-dialog.tsx","../../../src/components/shared/ConfirmDeleteDialog.tsx","../../../src/components/shared/AppActionsDropdown.tsx","../../../src/components/layout/app-sidebar.tsx","../../../src/components/ui/avatar.tsx","../../../src/components/auth/auth-button.tsx","../../../src/components/theme-toggle.tsx","../../../src/components/icons/logos.tsx","../../../src/hooks/use-platform-status.ts","../../../src/components/ui/dialog.tsx","../../../src/components/layout/global-header.tsx","../../../src/components/layout/app-layout.tsx","../../../src/components/ErrorBoundary.tsx","../../../src/App.tsx","../../../src/hooks/use-paginated-apps.ts","../../../src/components/ui/card.tsx","../../../src/components/shared/AppCard.tsx","../../../src/api-types.ts","../../../src/hooks/use-image-upload.ts","../../../src/hooks/use-drag-drop.ts","../../../src/components/image-upload-button.tsx","../../../src/components/image-attachment-preview.tsx","../../../src/routes/home.tsx","../../../src/routes.ts?raw","../../../src/components/monaco-editor/monaco-editor.tsx","../../../src/routes/chat/components/messages.tsx","../../../src/routes/chat/components/blueprint.tsx","../../../src/routes/chat/components/file-explorer.tsx","../../../src/routes/chat/components/thinking-indicator.tsx","../../../src/routes/chat/components/phase-timeline.tsx","../../../src/routes/chat/components/preview-iframe.tsx","../../../src/routes/chat/components/view-mode-switch.tsx","../../../src/components/primitives/button.tsx","../../../src/utils/screenshot.ts","../../../src/routes/chat/components/debug-panel.tsx","../../../src/routes/chat/components/deployment-controls.tsx","../../../src/utils/ndjson-parser/ndjson-parser.ts","../../../src/utils/string.ts","../../../src/utils/logger.ts","../../../src/routes/chat/utils/file-state-helpers.ts","../../../src/utils/id-generator.ts","../../../src/routes/chat/utils/message-helpers.ts","../../../src/routes/chat/utils/project-stage-helpers.ts","../../../src/routes/chat/utils/websocket-helpers.ts","../../../src/routes/chat/utils/handle-websocket-message.ts","../../../src/routes/chat/hooks/use-chat.ts","../../../src/routes/chat/components/copy.tsx","../../../src/routes/chat/hooks/use-file-content-stream.ts","../../../src/hooks/use-app.ts","../../../src/hooks/use-github-export.ts","../../../src/components/github-export-modal.tsx","../../../src/components/ui/badge.tsx","../../../src/components/ui/tabs.tsx","../../../src/routes/chat/components/model-config-info.tsx","../../../src/hooks/use-auto-scroll.ts","../../../src/routes/chat/chat.tsx","../../../src/components/ui/label.tsx","../../../src/components/ui/textarea.tsx","../../../src/hooks/use-stats.ts","../../../src/routes/profile.tsx","../../../src/components/config-card.tsx","../../../src/components/ui/select.tsx","../../../src/components/ui/popover.tsx","../../../src/components/ui/model-selector.tsx","../../../src/components/ui/alert.tsx","../../../src/components/ui/switch.tsx","../../../src/assets/provider-logos/openai.svg?react","../../../src/assets/provider-logos/anthropic.svg?react","../../../src/assets/provider-logos/google.svg?react","../../../src/assets/provider-logos/cerebras.svg?react","../../../src/assets/provider-logos/cloudflare.svg?react","../../../src/components/byok-api-keys-modal.tsx","../../../src/components/config-modal.tsx","../../../src/components/model-config-tabs.tsx","../../../src/routes/settings/index.tsx","../../../src/hooks/use-infinite-scroll.ts","../../../src/components/shared/AppListContainer.tsx","../../../src/components/shared/AppFiltersForm.tsx","../../../src/components/shared/AppSortTabs.tsx","../../../src/components/shared/VisibilityFilter.tsx","../../../src/routes/apps/index.tsx","../../../src/routes/app/index.tsx","../../../src/routes/discover/index.tsx","../../../src/routes/protected-route.tsx","../../../src/routes.ts","../../../src/main.tsx"],"sourcesContent":["import * as Sentry from '@sentry/react';\r\nimport { useEffect } from 'react';\r\nimport {\r\n  createRoutesFromChildren,\r\n  matchRoutes,\r\n  useLocation,\r\n  useNavigationType,\r\n} from 'react-router';\r\n\r\n/**\r\n * Initialize Sentry for frontend error tracking and session replay\r\n */\r\nexport function initSentry() {\r\n  const dsn = import.meta.env.VITE_SENTRY_DSN;\r\n  const environment = import.meta.env.VITE_ENVIRONMENT || 'development';\r\n  const release = import.meta.env.VITE_RELEASE || 'unknown';\r\n  \r\n  if (!dsn) {\r\n    console.warn('Sentry DSN not configured, skipping initialization');\r\n    return;\r\n  }\r\n\r\n  Sentry.init({\r\n    dsn,\r\n    environment,\r\n    release,\r\n    \r\n    // Use tunnel to bypass ad blockers\r\n    tunnel: '/api/sentry/tunnel',\r\n    \r\n    // Integrations\r\n    integrations: [\r\n      // React Router integration\r\n      Sentry.reactRouterV6BrowserTracingIntegration({\r\n        useEffect,\r\n        useLocation,\r\n        useNavigationType,\r\n        createRoutesFromChildren,\r\n        matchRoutes,\r\n      }),\r\n      \r\n      // Session Replay\r\n      Sentry.replayIntegration({\r\n        maskAllText: false,\r\n        maskAllInputs: true,\r\n      }),\r\n    ],\r\n    \r\n    // Performance Monitoring\r\n    tracesSampleRate: environment === 'production' ? 0.1 : 1.0,\r\n    \r\n    // Replay sampling rates\r\n    replaysSessionSampleRate: environment === 'production' ? 0.1 : 1.0,\r\n    replaysOnErrorSampleRate: 1.0,\r\n    \r\n    // Only enable in production/staging\r\n    enabled: environment !== 'development',\r\n  });\r\n}\r\n\r\n// Helper to set user context\r\nexport function setSentryUser(user: { id: string; email?: string; username?: string }) {\r\n  Sentry.setUser({\r\n    id: user.id,\r\n    email: user.email,\r\n    username: user.username,\r\n  });\r\n}\r\n\r\n// Helper to clear user context on logout\r\nexport function clearSentryUser() {\r\n  Sentry.setUser(null);\r\n}\r\n\r\n// Helper to capture custom events\r\nexport function captureEvent(message: string, level: Sentry.SeverityLevel = 'info', extra?: Record<string, any>) {\r\n  Sentry.captureMessage(message, {\r\n    level,\r\n    extra,\r\n  });\r\n}\r\n\r\n// Helper to add breadcrumbs\r\nexport function addBreadcrumb(\r\n  message: string,\r\n  category: string,\r\n  level: Sentry.SeverityLevel = 'info',\r\n  data?: Record<string, any>\r\n) {\r\n  Sentry.addBreadcrumb({\r\n    message,\r\n    category,\r\n    level,\r\n    data,\r\n    timestamp: Date.now() / 1000,\r\n  });\r\n}\r\n\r\n// Helper to start a transaction for performance monitoring\r\nexport function startTransaction(name: string, op: string) {\r\n  return Sentry.startSpan({ name, op }, () => {\r\n    // Transaction logic here\r\n  });\r\n}\r\n\r\n// Export Sentry instance for advanced usage\r\nexport { Sentry };\r\n","/**\r\n * Unified API Client - Premium quality abstraction for all worker API calls\r\n * Provides type-safe methods for all endpoints with proper error handling\r\n * Features 401 response interception to trigger authentication modals\r\n */\r\n\r\nimport type{\r\n\tApiResponse,\r\n\tAppsListData,\r\n\tPublicAppsData,\r\n\tFavoriteToggleData,\r\n\tCreateAppData,\r\n\tUpdateAppVisibilityData,\r\n\tAppDeleteData,\r\n\tAppDetailsData,\r\n\tAppStarToggleData,\r\n\tUserAppsData,\r\n\tProfileUpdateData,\r\n\tUserStatsData,\r\n\tUserActivityData,\r\n\tUserAnalyticsResponseData,\r\n\tAgentAnalyticsResponseData,\r\n\tModelConfigsData,\r\n\tModelConfigData,\r\n\tModelConfigUpdateData,\r\n\tModelConfigTestData,\r\n\tModelConfigResetData,\r\n\tModelConfigDefaultsData,\r\n\tModelConfigDeleteData,\r\n\tByokProvidersData,\r\n\tModelConfigUpdate,\r\n\tModelProvidersListData,\r\n\tModelProviderCreateData,\r\n\tModelProviderUpdateData,\r\n\tModelProviderDeleteData,\r\n\tModelProviderTestData,\r\n\tCreateProviderRequest,\r\n\tUpdateProviderRequest,\r\n\tTestProviderRequest,\r\n\tSecretsData,\r\n\tSecretStoreData,\r\n\tSecretDeleteData,\r\n\tSecretTemplatesData,\r\n\tAgentConnectionData,\r\n\tAgentStreamingResponse,\r\n\tApp,\r\n\tActiveSessionsData,\r\n\tApiKeysData,\r\n\tLoginResponseData,\r\n\tRegisterResponseData,\r\n\tProfileResponseData,\r\n\tAuthProvidersResponseData,\r\n\tCsrfTokenResponseData,\r\n\tOAuthProvider,\r\n    CodeGenArgs,\r\n    AgentPreviewResponse,\r\n    PlatformStatusData,\r\n    RateLimitError\r\n} from '@/api-types';\r\nimport type{\r\n    \r\n    RateLimitExceededError,\r\n    SecurityError,\r\n    SecurityErrorType,\r\n} from '@/api-types';\r\nimport { toast } from 'sonner';\r\n\r\n/**\r\n * Global auth modal trigger for 401 interception\r\n */\r\nlet globalAuthModalTrigger: ((context?: string) => void) | null = null;\r\n\r\nexport function setGlobalAuthModalTrigger(trigger: (context?: string) => void) {\r\n\tglobalAuthModalTrigger = trigger;\r\n}\r\n\r\n/**\r\n * API Client Error class with proper error context\r\n */\r\nexport class ApiError extends Error {\r\n\tconstructor(\r\n\t\tpublic status: number,\r\n\t\tpublic statusText: string,\r\n\t\tmessage: string,\r\n\t\tpublic endpoint: string,\r\n\t) {\r\n\t\tsuper(message);\r\n\t\tthis.name = 'ApiError';\r\n\t}\r\n}\r\n\r\n/**\r\n * Base API client configuration\r\n */\r\ninterface ApiClientConfig {\r\n\tbaseUrl?: string;\r\n\tdefaultHeaders?: Record<string, string>;\r\n}\r\n\r\n/**\r\n * Request options for API calls\r\n */\r\ninterface RequestOptions {\r\n\tmethod?: 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';\r\n\theaders?: Record<string, string>;\r\n\tbody?: unknown;\r\n\tcredentials?: RequestCredentials;\r\n\tskipJsonParsing?: boolean; // Skip JSON parsing for streaming responses\r\n}\r\n\r\n/**\r\n * Pagination parameters for paginated endpoints\r\n */\r\ninterface PaginationParams {\r\n\tpage?: number;\r\n\tlimit?: number;\r\n\tsort?: string;\r\n\torder?: 'asc' | 'desc';\r\n}\r\n\r\n/**\r\n * User apps parameters with filtering and sorting\r\n */\r\ninterface UserAppsParams extends PaginationParams {\r\n\tperiod?: 'today' | 'week' | 'month' | 'all';\r\n\tframework?: string;\r\n\tsearch?: string;\r\n\tvisibility?: 'private' | 'public' | 'team' | 'board';\r\n\tstatus?: 'generating' | 'completed';\r\n\tteamId?: string;\r\n}\r\n\r\n/**\r\n * Public apps parameters with filtering and sorting\r\n */\r\ninterface PublicAppsParams extends PaginationParams {\r\n\tperiod?: 'today' | 'week' | 'month' | 'all';\r\n\tframework?: string;\r\n\tsearch?: string;\r\n\tboardId?: string;\r\n}\r\n\r\n/**\r\n * Unified API Client class\r\n */\r\ninterface CSRFTokenInfo {\r\n\ttoken: string;\r\n\texpiresAt: number;\r\n}\r\n\r\nclass ApiClient {\r\n\tprivate baseUrl: string;\r\n\tprivate defaultHeaders: Record<string, string>;\r\n\tprivate csrfTokenInfo: CSRFTokenInfo | null = null;\r\n\r\n\tconstructor(config: ApiClientConfig = {}) {\r\n\t\tthis.baseUrl = config.baseUrl || '';\r\n\t\tthis.defaultHeaders = {\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t\t...config.defaultHeaders,\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Get authentication headers for API requests\r\n\t */\r\n\tprivate getAuthHeaders(): Record<string, string> {\r\n\t\tconst headers: Record<string, string> = {};\r\n\r\n\t\t// Add session token for anonymous users if not authenticated\r\n\t\t// This will be handled automatically by cookies/credentials for authenticated users\r\n\t\tconst sessionToken = localStorage.getItem('anonymous_session_token');\r\n\t\tif (sessionToken && !document.cookie.includes('session=')) {\r\n\t\t\theaders['X-Session-Token'] = sessionToken;\r\n\t\t}\r\n\r\n\t\t// Add CSRF token for state-changing requests\r\n\t\tif (this.csrfTokenInfo && !this.isCSRFTokenExpired()) {\r\n\t\t\theaders['X-CSRF-Token'] = this.csrfTokenInfo.token;\r\n\t\t}\r\n\r\n\t\treturn headers;\r\n\t}\r\n\r\n\t/**\r\n\t * Fetch CSRF token from server with expiration handling\r\n\t */\r\n\tprivate async fetchCsrfToken(): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tconst response = await fetch(`${this.baseUrl}/api/auth/csrf-token`, {\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\tcredentials: 'include',\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tif (response.ok) {\r\n\t\t\t\tconst data: ApiResponse<CsrfTokenResponseData> = await response.json();\r\n\t\t\t\tif (data.data?.token) {\r\n\t\t\t\t\tconst expiresIn = data.data.expiresIn || 7200; // Default 2 hours\r\n\t\t\t\t\tthis.csrfTokenInfo = {\r\n\t\t\t\t\t\ttoken: data.data.token,\r\n\t\t\t\t\t\texpiresAt: Date.now() + (expiresIn * 1000)\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.warn('Failed to fetch CSRF token:', error);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Public method to refresh CSRF token\r\n\t * Should be called after authentication operations that rotate the token\r\n\t */\r\n\tasync refreshCsrfToken(): Promise<void> {\r\n\t\tawait this.fetchCsrfToken();\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Check if CSRF token is expired\r\n\t */\r\n\tprivate isCSRFTokenExpired(): boolean {\r\n\t\tif (!this.csrfTokenInfo) return true;\r\n\t\treturn Date.now() >= this.csrfTokenInfo.expiresAt;\r\n\t}\r\n\r\n\t/**\r\n\t * Ensure CSRF token exists and is valid for state-changing requests\r\n\t */\r\n\tprivate async ensureCsrfToken(method: string): Promise<boolean> {\r\n\t\tif (!['POST', 'PUT', 'DELETE', 'PATCH'].includes(method.toUpperCase())) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\t// Fetch new token if none exists or current one is expired\r\n\t\tif (!this.csrfTokenInfo || this.isCSRFTokenExpired()) {\r\n\t\t\treturn await this.fetchCsrfToken();\r\n\t\t}\r\n\t\t\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * Ensure session token exists for anonymous users\r\n\t */\r\n\tprivate ensureSessionToken(): void {\r\n\t\tif (\r\n\t\t\t!localStorage.getItem('anonymous_session_token') &&\r\n\t\t\t!document.cookie.includes('session=')\r\n\t\t) {\r\n\t\t\tlocalStorage.setItem(\r\n\t\t\t\t'anonymous_session_token',\r\n\t\t\t\tcrypto.randomUUID(),\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Get authentication context message based on endpoint\r\n\t */\r\n\tprivate getAuthContextForEndpoint(endpoint: string): string {\r\n\t\tif (endpoint.includes('/api/agent')) return 'to create applications';\r\n\t\tif (endpoint.includes('/favorite')) return 'to favorite this app';\r\n\t\tif (endpoint.includes('/star')) return 'to star this app';\r\n\t\t// if (endpoint.includes('/fork')) return 'to fork this app';\r\n\t\t// if (endpoint.includes('/apps')) return 'to access your apps';\r\n\t\tif (endpoint.includes('/profile')) return 'to access your profile';\r\n\t\tif (endpoint.includes('/settings')) return 'to access settings';\r\n\t\treturn 'to continue';\r\n\t}\r\n\r\n\t/**\r\n\t * Check if endpoint should trigger auth modal on 401\r\n\t * Auth checking endpoints should not auto-trigger modals\r\n\t */\r\n\tprivate shouldTriggerAuthModal(endpoint: string): boolean {\r\n\t\t// Don't trigger modal for auth state checking endpoints\r\n\t\tif (endpoint === '/api/auth/profile') return false;\r\n\t\tif (endpoint === '/api/auth/providers') return false;\r\n\t\tif (endpoint === '/api/auth/sessions') return false;\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprivate async request<T>(\r\n\t\tendpoint: string,\r\n\t\toptions: RequestOptions = {},\r\n        noToast: boolean = false,\r\n\t): Promise<ApiResponse<T>> {\r\n\t\tconst { data } = await this.requestRaw<T>(endpoint, options, false, noToast);\r\n\t\tif (!data) {\r\n\t\t\tthrow new ApiError(\r\n\t\t\t\t500,\r\n\t\t\t\t'Internal Error',\r\n\t\t\t\t'Unexpected null response data',\r\n\t\t\t\tendpoint,\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn data;\r\n\t}\r\n\r\n\tprivate async requestRaw<T>(\r\n\t\tendpoint: string,\r\n\t\toptions: RequestOptions = {},\r\n\t\tisRetry: boolean = false,\r\n        noToast: boolean = false,\r\n\t): Promise<{ response: Response; data: ApiResponse<T> | null }> {\r\n\t\tthis.ensureSessionToken();\r\n\t\t\r\n\t\tif (!await this.ensureCsrfToken(options.method || 'GET')) {\r\n\t\t\tthrow new ApiError(\r\n\t\t\t\t500,\r\n\t\t\t\t'Internal Error',\r\n\t\t\t\t'Failed to obtain CSRF token',\r\n\t\t\t\tendpoint,\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tconst url = `${this.baseUrl}${endpoint}`;\r\n\t\tconst config: RequestInit = {\r\n\t\t\tmethod: options.method || 'GET',\r\n\t\t\theaders: {\r\n\t\t\t\t...this.defaultHeaders,\r\n\t\t\t\t...this.getAuthHeaders(),\r\n\t\t\t\t...options.headers,\r\n\t\t\t},\r\n\t\t\tcredentials: options.credentials || 'include',\r\n\t\t};\r\n\r\n\t\tif (options.body) {\r\n\t\t\tconfig.body =\r\n\t\t\t\ttypeof options.body === 'string'\r\n\t\t\t\t\t? options.body\r\n\t\t\t\t\t: JSON.stringify(options.body);\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await fetch(url, config);\r\n\t\t\t\r\n\t\t\t// For streaming responses, skip JSON parsing if response is ok\r\n\t\t\tif (options.skipJsonParsing && response.ok) {\r\n\t\t\t\treturn { response, data: null };\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst data = await response.json() as ApiResponse<T>;\r\n\r\n\t\t\tif (!response.ok) {\r\n                if (\r\n                    response.status === 401 &&\r\n                    globalAuthModalTrigger &&\r\n                    this.shouldTriggerAuthModal(endpoint)\r\n                ) {\r\n                    const authContext = this.getAuthContextForEndpoint(endpoint);\r\n                    globalAuthModalTrigger(authContext);\r\n                }\r\n\r\n                const errorData = data.error;\r\n                if (errorData && errorData.type) {\r\n                       // Send a toast notification for typed errors\r\n                    if (!noToast) {\r\n                        toast.error(errorData.message);\r\n                    }\r\n                    switch (errorData.type) {\r\n                        case SecurityErrorType.CSRF_VIOLATION:\r\n                            // Handle CSRF failures with retry\r\n                            if (response.status === 403 && !isRetry) {\r\n                                // Clear expired token and retry with fresh one\r\n                                this.csrfTokenInfo = null;\r\n                                return this.requestRaw(endpoint, options, true);\r\n                            }\r\n                            break;\r\n                        case SecurityErrorType.RATE_LIMITED:\r\n                            // Handle rate limiting\r\n                            console.log('Rate limited', errorData);\r\n                            throw RateLimitExceededError.fromRateLimitError(errorData as unknown as RateLimitError);\r\n                        default:\r\n                            // Security error\r\n                            throw new SecurityError(errorData.type, errorData.message);\r\n                        }\r\n                    }\r\n                    console.log(\"Came here\");\r\n\r\n                    throw new ApiError(\r\n                        response.status,\r\n                        response.statusText,\r\n                        data.error?.message || data.message || 'Request failed',\r\n                        endpoint,\r\n                    );\r\n\t\t\t}\r\n\r\n\t\t    return { response, data };\r\n\t\t} catch (error) {\r\n            console.error(error);\r\n\t\t\tif (error instanceof ApiError || error instanceof RateLimitExceededError || error instanceof SecurityError) {\r\n\t\t\t\tthrow error;\r\n\t\t\t}\r\n\t\t\tthrow new ApiError(\r\n\t\t\t\t0,\r\n\t\t\t\t'Network Error',\r\n\t\t\t\terror instanceof Error ? error.message : 'Unknown error',\r\n\t\t\t\tendpoint,\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\t// ===============================\r\n\t// Platform Status API Methods\r\n\t// ===============================\r\n\r\n\tasync getPlatformStatus(noToast: boolean = true): Promise<ApiResponse<PlatformStatusData>> {\r\n\t\treturn this.request<PlatformStatusData>('/api/status', undefined, noToast);\r\n\t}\r\n\r\n\t// ===============================\r\n\t// Apps API Methods\r\n\t// ===============================\r\n\r\n\t/**\r\n\t * Get all apps for the current user\r\n\t */\r\n\tasync getUserApps(): Promise<ApiResponse<AppsListData>> {\r\n\t\treturn this.request<AppsListData>('/api/apps');\r\n\t}\r\n\r\n\t/**\r\n\t * Get recent apps (last 10)\r\n\t */\r\n\tasync getRecentApps(): Promise<ApiResponse<AppsListData>> {\r\n\t\treturn this.request<AppsListData>('/api/apps/recent');\r\n\t}\r\n\r\n\t/**\r\n\t * Get favorite apps\r\n\t */\r\n\tasync getFavoriteApps(): Promise<ApiResponse<AppsListData>> {\r\n\t\treturn this.request<AppsListData>('/api/apps/favorites');\r\n\t}\r\n\r\n\t/**\r\n\t * Get public apps feed with pagination\r\n\t */\r\n\tasync getPublicApps(\r\n\t\tparams?: PublicAppsParams,\r\n\t): Promise<ApiResponse<PublicAppsData>> {\r\n\t\tconst queryParams = new URLSearchParams();\r\n\t\tif (params?.page) queryParams.set('page', params.page.toString());\r\n\t\tif (params?.limit) queryParams.set('limit', params.limit.toString());\r\n\t\tif (params?.sort) queryParams.set('sort', params.sort);\r\n\t\tif (params?.order) queryParams.set('order', params.order);\r\n\t\tif (params?.period) queryParams.set('period', params.period);\r\n\t\tif (params?.framework) queryParams.set('framework', params.framework);\r\n\t\tif (params?.search) queryParams.set('search', params.search);\r\n\t\tif (params?.boardId) queryParams.set('boardId', params.boardId);\r\n\r\n\t\tconst endpoint = `/api/apps/public${queryParams.toString() ? `?${queryParams.toString()}` : ''}`;\r\n\t\treturn this.request<PublicAppsData>(endpoint);\r\n\t}\r\n\r\n\t/**\r\n\t * Create a new app\r\n\t */\r\n\tasync createApp(data: {\r\n\t\ttitle: string;\r\n\t\tdescription?: string;\r\n\t}): Promise<ApiResponse<CreateAppData>> {\r\n\t\treturn this.request<CreateAppData>('/api/apps', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody: data,\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Toggle favorite status of an app\r\n\t */\r\n\tasync toggleFavorite(\r\n\t\tappId: string,\r\n\t): Promise<ApiResponse<FavoriteToggleData>> {\r\n\t\treturn this.request<FavoriteToggleData>(`/api/apps/${appId}/favorite`, {\r\n\t\t\tmethod: 'POST',\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Update app visibility\r\n\t */\r\n\tasync updateAppVisibility(\r\n\t\tappId: string,\r\n\t\tvisibility: App['visibility'],\r\n\t): Promise<ApiResponse<UpdateAppVisibilityData>> {\r\n\t\treturn this.request<UpdateAppVisibilityData>(\r\n\t\t\t`/api/apps/${appId}/visibility`,\r\n\t\t\t{\r\n\t\t\t\tmethod: 'PUT',\r\n\t\t\t\tbody: { visibility },\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Delete an app\r\n\t */\r\n\tasync deleteApp(appId: string): Promise<ApiResponse<AppDeleteData>> {\r\n\t\treturn this.request<AppDeleteData>(`/api/apps/${appId}`, {\r\n\t\t\tmethod: 'DELETE',\r\n\t\t});\r\n\t}\r\n\r\n\t// ===============================\r\n\t// App View API Methods\r\n\t// ===============================\r\n\r\n\t/**\r\n\t * Get detailed app information for viewing\r\n\t */\r\n\tasync getAppDetails(appId: string): Promise<ApiResponse<AppDetailsData>> {\r\n\t\treturn this.request<AppDetailsData>(`/api/apps/${appId}`);\r\n\t}\r\n\r\n\t/**\r\n\t * Toggle star status of an app (different from favorite)\r\n\t */\r\n\tasync toggleAppStar(\r\n\t\tappId: string,\r\n\t): Promise<ApiResponse<AppStarToggleData>> {\r\n\t\treturn this.request<AppStarToggleData>(`/api/apps/${appId}/star`, {\r\n\t\t\tmethod: 'POST',\r\n\t\t});\r\n\t}\r\n\r\n\t// /**\r\n\t//  * Fork an app\r\n\t//  */\r\n    // DISABLED: Has been disabled for initial alpha release, for security reasons\r\n\t// async forkApp(appId: string): Promise<ApiResponse<ForkAppData>> {\r\n\t// \treturn this.request<ForkAppData>(`/api/apps/${appId}/fork`, {\r\n\t// \t\tmethod: 'POST',\r\n\t// \t});\r\n\t// }\r\n\r\n\t// ===============================\r\n\t// User API Methods\r\n\t// ===============================\r\n\r\n\t/**\r\n\t * Get user apps with pagination\r\n\t */\r\n\tasync getUserAppsWithPagination(\r\n\t\tparams?: UserAppsParams,\r\n\t): Promise<ApiResponse<UserAppsData>> {\r\n\t\tconst queryParams = new URLSearchParams();\r\n\t\tif (params?.page) queryParams.set('page', params.page.toString());\r\n\t\tif (params?.limit) queryParams.set('limit', params.limit.toString());\r\n\t\tif (params?.sort) queryParams.set('sort', params.sort);\r\n\t\tif (params?.order) queryParams.set('order', params.order);\r\n\t\tif (params?.period) queryParams.set('period', params.period);\r\n\t\tif (params?.framework) queryParams.set('framework', params.framework);\r\n\t\tif (params?.search) queryParams.set('search', params.search);\r\n\t\tif (params?.visibility)\r\n\t\t\tqueryParams.set('visibility', params.visibility);\r\n\t\tif (params?.status) queryParams.set('status', params.status);\r\n\t\tif (params?.teamId) queryParams.set('teamId', params.teamId);\r\n\r\n\t\tconst endpoint = `/api/user/apps${queryParams.toString() ? `?${queryParams.toString()}` : ''}`;\r\n\t\treturn this.request<UserAppsData>(endpoint);\r\n\t}\r\n\r\n\tasync createAgentSession(args: CodeGenArgs): Promise<AgentStreamingResponse> {\r\n\t\ttry {\r\n\t\t\tconst { response, data } = await this.requestRaw('/api/agent', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tbody: args,\r\n\t\t\t\tskipJsonParsing: true, // Don't parse JSON for streaming response\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// Check if response is ok\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\t// Parse error response if available\r\n\t\t\t\tconst errorMessage = data?.error?.message || `Agent creation failed with status: ${response.status}`;\r\n\t\t\t\tthrow new Error(errorMessage);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn {\r\n\t\t\t\tsuccess: true,\r\n\t\t\t\tstream: response\r\n\t\t\t};\r\n\t\t} catch (error) {\r\n\t\t\t// Handle any network or parsing errors\r\n\t\t\tconst errorMessage = error instanceof Error ? error.message : 'Failed to create agent session';\r\n\t\t\ttoast.error(errorMessage);\r\n\t\t\t\r\n            throw new Error(errorMessage);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Update user profile\r\n\t */\r\n\tasync updateProfile(data: {\r\n\t\tdisplayName?: string;\r\n\t\tusername?: string;\r\n\t\tbio?: string;\r\n\t\ttimezone?: string;\r\n\t\ttheme?: 'light' | 'dark' | 'system';\r\n\t}): Promise<ApiResponse<ProfileUpdateData>> {\r\n\t\treturn this.request<ProfileUpdateData>('/api/user/profile', {\r\n\t\t\tmethod: 'PUT',\r\n\t\t\tbody: data,\r\n\t\t});\r\n\t}\r\n\r\n\t// ===============================\r\n\t// Stats API Methods\r\n\t// ===============================\r\n\r\n\t/**\r\n\t * Get user statistics\r\n\t */\r\n\tasync getUserStats(): Promise<ApiResponse<UserStatsData>> {\r\n\t\treturn this.request<UserStatsData>('/api/stats/user');\r\n\t}\r\n\r\n\t/**\r\n\t * Get user activity timeline\r\n\t */\r\n\tasync getUserActivity(): Promise<ApiResponse<UserActivityData>> {\r\n\t\treturn this.request<UserActivityData>('/api/stats/activity');\r\n\t}\r\n\r\n\t// ===============================\r\n\t// Analytics API Methods\r\n\t// ===============================\r\n\r\n\t/**\r\n\t * Get user analytics (AI Gateway costs and usage)\r\n\t */\r\n\tasync getUserAnalytics(\r\n\t\tuserId: string,\r\n\t\tdays?: number,\r\n\t): Promise<ApiResponse<UserAnalyticsResponseData>> {\r\n\t\tconst queryParams = days ? `?days=${days}` : '';\r\n\t\treturn this.request<UserAnalyticsResponseData>(\r\n\t\t\t`/api/user/${userId}/analytics${queryParams}`,\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Get agent analytics (AI Gateway costs and usage for specific app/chat)\r\n\t */\r\n\tasync getAgentAnalytics(\r\n\t\tagentId: string,\r\n\t\tdays?: number,\r\n\t): Promise<ApiResponse<AgentAnalyticsResponseData>> {\r\n\t\tconst queryParams = days ? `?days=${days}` : '';\r\n\t\treturn this.request<AgentAnalyticsResponseData>(\r\n\t\t\t`/api/agent/${agentId}/analytics${queryParams}`,\r\n\t\t);\r\n\t}\r\n\r\n\t// ===============================\r\n\t// Model Config API Methods\r\n\t// ===============================\r\n\r\n\t/**\r\n\t * Get all model configurations\r\n\t */\r\n\tasync getModelConfigs(): Promise<ApiResponse<ModelConfigsData>> {\r\n\t\treturn this.request<ModelConfigsData>('/api/model-configs');\r\n\t}\r\n\r\n\t/**\r\n\t * Get BYOK providers and available models\r\n\t */\r\n\tasync getByokProviders(): Promise<ApiResponse<ByokProvidersData>> {\r\n\t\treturn this.request<ByokProvidersData>(\r\n\t\t\t'/api/model-configs/byok-providers',\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Get BYOK templates for dynamic provider configuration\r\n\t */\r\n\tasync getBYOKTemplates(): Promise<ApiResponse<SecretTemplatesData>> {\r\n\t\treturn this.request<SecretTemplatesData>(\r\n\t\t\t'/api/secrets/templates?category=byok',\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Reset model configuration to default\r\n\t */\r\n\tasync resetModelConfig(\r\n\t\tagentAction: string,\r\n\t): Promise<ApiResponse<ModelConfigResetData>> {\r\n\t\treturn this.request<ModelConfigResetData>(\r\n\t\t\t`/api/model-configs/${agentAction}`,\r\n\t\t\t{\r\n\t\t\t\tmethod: 'DELETE',\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Reset all model configurations to defaults\r\n\t */\r\n\tasync resetAllModelConfigs(): Promise<ApiResponse<ModelConfigResetData>> {\r\n\t\treturn this.request<ModelConfigResetData>(\r\n\t\t\t'/api/model-configs/reset-all',\r\n\t\t\t{\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Get specific model configuration\r\n\t */\r\n\tasync getModelConfig(\r\n\t\tactionKey: string,\r\n\t): Promise<ApiResponse<ModelConfigData>> {\r\n\t\treturn this.request<ModelConfigData>(`/api/model-configs/${actionKey}`);\r\n\t}\r\n\r\n\t/**\r\n\t * Update model configuration\r\n\t */\r\n\tasync updateModelConfig(\r\n\t\tactionKey: string,\r\n\t\tconfig: ModelConfigUpdate,\r\n\t): Promise<ApiResponse<ModelConfigUpdateData>> {\r\n\t\treturn this.request<ModelConfigUpdateData>(\r\n\t\t\t`/api/model-configs/${actionKey}`,\r\n\t\t\t{\r\n\t\t\t\tmethod: 'PUT',\r\n\t\t\t\tbody: config,\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Test model configuration\r\n\t */\r\n\tasync testModelConfig(\r\n\t\tactionKey: string,\r\n\t\ttempConfig?: ModelConfigUpdate,\r\n\t): Promise<ApiResponse<ModelConfigTestData>> {\r\n\t\treturn this.request<ModelConfigTestData>('/api/model-configs/test', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody: {\r\n\t\t\t\tagentActionName: actionKey,\r\n\t\t\t\tuseUserKeys: true,\r\n\t\t\t\t...(tempConfig && { tempConfig }),\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Reset all model configurations\r\n\t */\r\n\tasync resetAllConfigs(): Promise<ApiResponse<ModelConfigResetData>> {\r\n\t\treturn this.request<ModelConfigResetData>(\r\n\t\t\t'/api/model-configs/reset-all',\r\n\t\t\t{\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Get default model configurations\r\n\t */\r\n\tasync getModelDefaults(): Promise<ApiResponse<ModelConfigDefaultsData>> {\r\n\t\treturn this.request<ModelConfigDefaultsData>(\r\n\t\t\t'/api/model-configs/defaults',\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Delete model configuration\r\n\t */\r\n\tasync deleteModelConfig(\r\n\t\tactionKey: string,\r\n\t): Promise<ApiResponse<ModelConfigDeleteData>> {\r\n\t\treturn this.request<ModelConfigDeleteData>(\r\n\t\t\t`/api/model-configs/${actionKey}`,\r\n\t\t\t{\r\n\t\t\t\tmethod: 'DELETE',\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t// ===============================\r\n\t// Model Providers API Methods\r\n\t// ===============================\r\n\r\n\t/**\r\n\t * Get all custom model providers\r\n\t */\r\n\tasync getModelProviders(): Promise<ApiResponse<ModelProvidersListData>> {\r\n\t\treturn this.request<ModelProvidersListData>('/api/user/providers');\r\n\t}\r\n\r\n\t/**\r\n\t * Create a new custom model provider\r\n\t */\r\n\tasync createModelProvider(\r\n\t\tdata: CreateProviderRequest,\r\n\t): Promise<ApiResponse<ModelProviderCreateData>> {\r\n\t\treturn this.request<ModelProviderCreateData>('/api/user/providers', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody: data,\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Update an existing model provider\r\n\t */\r\n\tasync updateModelProvider(\r\n\t\tproviderId: string,\r\n\t\tdata: UpdateProviderRequest,\r\n\t): Promise<ApiResponse<ModelProviderUpdateData>> {\r\n\t\treturn this.request<ModelProviderUpdateData>(\r\n\t\t\t`/api/user/providers/${providerId}`,\r\n\t\t\t{\r\n\t\t\t\tmethod: 'PUT',\r\n\t\t\t\tbody: data,\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Delete a model provider\r\n\t */\r\n\tasync deleteModelProvider(\r\n\t\tproviderId: string,\r\n\t): Promise<ApiResponse<ModelProviderDeleteData>> {\r\n\t\treturn this.request<ModelProviderDeleteData>(\r\n\t\t\t`/api/user/providers/${providerId}`,\r\n\t\t\t{\r\n\t\t\t\tmethod: 'DELETE',\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Test a model provider connection\r\n\t */\r\n\tasync testModelProvider(\r\n\t\tdata: TestProviderRequest,\r\n\t): Promise<ApiResponse<ModelProviderTestData>> {\r\n\t\treturn this.request<ModelProviderTestData>('/api/user/providers/test', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody: data,\r\n\t\t});\r\n\t}\r\n\r\n\t// ===============================\r\n\t// Secrets API Methods\r\n\t// ===============================\r\n\r\n\t/**\r\n\t * Get all user secrets including inactive ones\r\n\t */\r\n\tasync getAllSecrets(): Promise<ApiResponse<SecretsData>> {\r\n\t\treturn this.request<SecretsData>('/api/secrets');\r\n\t}\r\n\r\n\t/**\r\n\t * Store a new secret\r\n\t */\r\n\tasync storeSecret(data: {\r\n\t\ttemplateId?: string;\r\n\t\tname?: string;\r\n\t\tenvVarName?: string;\r\n\t\tvalue: string;\r\n\t\tenvironment?: string;\r\n\t\tdescription?: string;\r\n\t}): Promise<ApiResponse<SecretStoreData>> {\r\n\t\treturn this.request<SecretStoreData>('/api/secrets', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody: data,\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Delete a secret\r\n\t */\r\n\tasync deleteSecret(\r\n\t\tsecretId: string,\r\n\t): Promise<ApiResponse<SecretDeleteData>> {\r\n\t\treturn this.request<SecretDeleteData>(`/api/secrets/${secretId}`, {\r\n\t\t\tmethod: 'DELETE',\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Toggle secret active status\r\n\t */\r\n\tasync toggleSecret(\r\n\t\tsecretId: string,\r\n\t): Promise<ApiResponse<SecretStoreData>> {\r\n\t\treturn this.request<SecretStoreData>(\r\n\t\t\t`/api/secrets/${secretId}/toggle`,\r\n\t\t\t{\r\n\t\t\t\tmethod: 'PATCH',\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Get secret templates\r\n\t */\r\n\tasync getSecretTemplates(): Promise<ApiResponse<SecretTemplatesData>> {\r\n\t\treturn this.request<SecretTemplatesData>('/api/secrets/templates');\r\n\t}\r\n\r\n\t/**\r\n\t * Initiate GitHub OAuth authorization for user repository access\r\n\t * This redirects to GitHub OAuth\r\n\t */\r\n\tinitiateGitHubOAuth(): void {\r\n\t\tconst oauthUrl = new URL('/api/github-app/authorize', window.location.origin);\r\n\t\twindow.location.href = oauthUrl.toString();\r\n\t}\r\n\r\n\t/**\r\n\t * Initiate GitHub export with OAuth flow\r\n\t * Returns authorization URL for redirect\r\n\t */\r\n\tasync initiateGitHubExport(data: {\r\n\t\trepositoryName: string;\r\n\t\tdescription?: string;\r\n\t\tisPrivate?: boolean;\r\n\t\tagentId: string;\r\n\t}): Promise<ApiResponse<{ authUrl: string }>> {\r\n\t\treturn this.request<{ authUrl: string }>('/api/github-app/export', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody: data,\r\n\t\t});\r\n\t}\r\n\r\n\t// ===============================\r\n\t// Agent/CodeGen API Methods\r\n\t// ===============================\r\n\t/**\r\n\t * Connect to existing agent\r\n\t */\r\n\tasync connectToAgent(\r\n\t\tagentId: string,\r\n\t): Promise<ApiResponse<AgentConnectionData>> {\r\n\t\treturn this.request<AgentConnectionData>(\r\n\t\t\t`/api/agent/${agentId}/connect`,\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Deploy preview\r\n\t */\r\n\tasync deployPreview(\r\n\t\tagentId: string,\r\n\t): Promise<ApiResponse<AgentPreviewResponse>> {\r\n\t\treturn this.request<AgentPreviewResponse>(\r\n\t\t\t`/api/agent/${agentId}/preview`,\r\n\t\t);\r\n\t}\r\n\r\n\t// ===============================\r\n\t// Session Management API Methods\r\n\t// ===============================\r\n\r\n\t/**\r\n\t * Get active user sessions\r\n\t */\r\n\tasync getActiveSessions(): Promise<ApiResponse<ActiveSessionsData>> {\r\n\t\treturn this.request<ActiveSessionsData>('/api/auth/sessions');\r\n\t}\r\n\r\n\t/**\r\n\t * Revoke a specific session\r\n\t */\r\n\tasync revokeSession(\r\n\t\tsessionId: string,\r\n\t): Promise<ApiResponse<{ message: string }>> {\r\n\t\treturn this.request<{ message: string }>(\r\n\t\t\t`/api/auth/sessions/${sessionId}`,\r\n\t\t\t{\r\n\t\t\t\tmethod: 'DELETE',\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t// ===============================\r\n\t// API Keys Management Methods\r\n\t// ===============================\r\n\r\n\t/**\r\n\t * Get user API keys\r\n\t */\r\n\tasync getApiKeys(): Promise<ApiResponse<ApiKeysData>> {\r\n\t\treturn this.request<ApiKeysData>('/api/auth/api-keys');\r\n\t}\r\n\r\n\t/**\r\n\t * Create a new API key\r\n\t */\r\n\tasync createApiKey(data: {\r\n\t\tname: string;\r\n\t}): Promise<\r\n\t\tApiResponse<{\r\n\t\t\tkey: string;\r\n\t\t\tkeyPreview: string;\r\n\t\t\tname: string;\r\n\t\t\tmessage: string;\r\n\t\t}>\r\n\t> {\r\n\t\treturn this.request<{\r\n\t\t\tkey: string;\r\n\t\t\tkeyPreview: string;\r\n\t\t\tname: string;\r\n\t\t\tmessage: string;\r\n\t\t}>('/api/auth/api-keys', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody: data,\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Revoke an API key\r\n\t */\r\n\tasync revokeApiKey(\r\n\t\tkeyId: string,\r\n\t): Promise<ApiResponse<{ message: string }>> {\r\n\t\treturn this.request<{ message: string }>(\r\n\t\t\t`/api/auth/api-keys/${keyId}`,\r\n\t\t\t{\r\n\t\t\t\tmethod: 'DELETE',\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t// ===============================\r\n\t// Authentication API Methods\r\n\t// ===============================\r\n\r\n\t/**\r\n\t * Login with email and password\r\n\t */\r\n\tasync loginWithEmail(credentials: {\r\n\t\temail: string;\r\n\t\tpassword: string;\r\n\t}): Promise<ApiResponse<LoginResponseData>> {\r\n\t\treturn this.request<LoginResponseData>('/api/auth/login', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody: credentials,\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Register a new user\r\n\t */\r\n\tasync register(data: {\r\n\t\temail: string;\r\n\t\tpassword: string;\r\n\t\tname?: string;\r\n\t}): Promise<ApiResponse<RegisterResponseData>> {\r\n\t\treturn this.request<RegisterResponseData>('/api/auth/register', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody: data,\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Verify email with OTP\r\n\t */\r\n\tasync verifyEmail(data: {\r\n\t\temail: string;\r\n\t\totp: string;\r\n\t}): Promise<ApiResponse<LoginResponseData>> {\r\n\t\treturn this.request<LoginResponseData>('/api/auth/verify-email', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody: data,\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Resend verification OTP\r\n\t */\r\n\tasync resendVerificationOtp(\r\n\t\temail: string,\r\n\t): Promise<ApiResponse<{ message: string }>> {\r\n\t\treturn this.request<{ message: string }>(\r\n\t\t\t'/api/auth/resend-verification',\r\n\t\t\t{\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tbody: { email },\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Get CSRF token\r\n\t */\r\n\tasync getCsrfToken(): Promise<ApiResponse<CsrfTokenResponseData>> {\r\n\t\treturn this.request<CsrfTokenResponseData>('/api/auth/csrf-token');\r\n\t}\r\n\r\n\t/**\r\n\t * Get current user profile\r\n\t */\r\n\tasync getProfile(noToast: boolean = false): Promise<ApiResponse<ProfileResponseData>> {\r\n\t\treturn this.request<ProfileResponseData>('/api/auth/profile', undefined, noToast);\r\n\t}\r\n\r\n\t/**\r\n\t * Logout current user\r\n\t */\r\n\tasync logout(): Promise<ApiResponse<{ message: string }>> {\r\n\t\treturn this.request<{ message: string }>('/api/auth/logout', {\r\n\t\t\tmethod: 'POST',\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Get available authentication providers\r\n\t */\r\n\tasync getAuthProviders(): Promise<ApiResponse<AuthProvidersResponseData>> {\r\n\t\treturn this.request<AuthProvidersResponseData>('/api/auth/providers');\r\n\t}\r\n\r\n\t/**\r\n\t * Initiate OAuth flow (redirects to provider)\r\n\t */\r\n\tinitiateOAuth(provider: OAuthProvider, redirectUrl?: string): void {\r\n\t\tconst oauthUrl = new URL(\r\n\t\t\t`/api/auth/oauth/${provider}`,\r\n\t\t\twindow.location.origin,\r\n\t\t);\r\n\t\tif (redirectUrl) {\r\n\t\t\toauthUrl.searchParams.set('redirect_url', redirectUrl);\r\n\t\t}\r\n\r\n\t\t// Redirect to OAuth provider\r\n\t\twindow.location.href = oauthUrl.toString();\r\n\t}\r\n}\r\n\r\n// Export singleton instance\r\nexport const apiClient = new ApiClient();\r\n\r\n// Export class for testing/custom instances\r\nexport { ApiClient };\r\n","import { useEffect } from 'react';\r\nimport { setSentryUser, clearSentryUser } from '@/utils/sentry';\r\nimport { AuthUser } from '@/api-types';\r\n\r\n/**\r\n * Hook to automatically sync user context with Sentry\r\n * Use this in your app's root or authentication provider\r\n */\r\nexport function useSentryUser(user: AuthUser | null) {\r\n  useEffect(() => {\r\n    if (user) {\r\n      setSentryUser({\r\n        id: user.id,\r\n        email: user.email,\r\n        username: user.displayName,\r\n      });\r\n    } else {\r\n      clearSentryUser();\r\n    }\r\n  }, [user]);\r\n}\r\n\r\n/**\r\n * Hook to track user actions as breadcrumbs\r\n */\r\nexport function useSentryBreadcrumb() {\r\n  return (message: string, data?: Record<string, any>) => {\r\n    import('@/utils/sentry').then(({ addBreadcrumb }) => {\r\n      addBreadcrumb(message, 'user-action', 'info', data);\r\n    });\r\n  };\r\n}\r\n","/**\r\n * Enhanced Auth Context\r\n * Provides OAuth + Email/Password authentication with backward compatibility\r\n */\r\n\r\nimport React, { createContext, useContext, useState, useEffect, useCallback, useRef } from 'react';\r\nimport { useNavigate } from 'react-router';\r\nimport { apiClient, ApiError } from '@/lib/api-client';\r\nimport { useSentryUser } from '@/hooks/useSentryUser';\r\nimport type { AuthSession, AuthUser } from '../api-types';\r\n\r\ninterface AuthContextType {\r\n  user: AuthUser | null;\r\n  token: string | null;\r\n  session: AuthSession | null;\r\n  isAuthenticated: boolean;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  \r\n  // Auth provider configuration\r\n  authProviders: {\r\n    google: boolean;\r\n    github: boolean;\r\n    email: boolean;\r\n  } | null;\r\n  hasOAuth: boolean;\r\n  requiresEmailAuth: boolean;\r\n  \r\n  // OAuth login method with redirect support\r\n  login: (provider: 'google' | 'github', redirectUrl?: string) => void;\r\n  \r\n  // Email/password login method\r\n  loginWithEmail: (credentials: { email: string; password: string }) => Promise<void>;\r\n  register: (data: { email: string; password: string; name?: string }) => Promise<void>;\r\n  \r\n  logout: () => Promise<void>;\r\n  refreshUser: () => Promise<void>;\r\n  clearError: () => void;\r\n  \r\n  // Redirect URL management\r\n  setIntendedUrl: (url: string) => void;\r\n  getIntendedUrl: () => string | null;\r\n  clearIntendedUrl: () => void;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\n// Token refresh interval - refresh every 10 minutes\r\nconst TOKEN_REFRESH_INTERVAL = 60 * 60 * 1000; // 1 hour (check less frequently since tokens last 24h)\r\n\r\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\r\n  const [user, setUser] = useState<AuthUser | null>(null);\r\n  const [token, setToken] = useState<string | null>(null);\r\n  const [session, setSession] = useState<AuthSession | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [authProviders, setAuthProviders] = useState<{ google: boolean; github: boolean; email: boolean; } | null>(null);\r\n  const [hasOAuth, setHasOAuth] = useState<boolean>(false);\r\n  const [requiresEmailAuth, setRequiresEmailAuth] = useState<boolean>(true);\r\n  const navigate = useNavigate();\r\n  \r\n  // Sync user context with Sentry for error tracking\r\n  useSentryUser(user);\r\n  \r\n  // Ref to store the refresh timer\r\n  const refreshTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // Redirect URL management\r\n  const INTENDED_URL_KEY = 'auth_intended_url';\r\n\r\n  const setIntendedUrl = useCallback((url: string) => {\r\n    try {\r\n      sessionStorage.setItem(INTENDED_URL_KEY, url);\r\n    } catch (error) {\r\n      console.warn('Failed to store intended URL:', error);\r\n    }\r\n  }, []);\r\n\r\n  const getIntendedUrl = useCallback((): string | null => {\r\n    try {\r\n      return sessionStorage.getItem(INTENDED_URL_KEY);\r\n    } catch (error) {\r\n      console.warn('Failed to retrieve intended URL:', error);\r\n      return null;\r\n    }\r\n  }, []);\r\n\r\n  const clearIntendedUrl = useCallback(() => {\r\n    try {\r\n      sessionStorage.removeItem(INTENDED_URL_KEY);\r\n    } catch (error) {\r\n      console.warn('Failed to clear intended URL:', error);\r\n    }\r\n  }, []);\r\n\r\n\r\n  // Fetch auth providers configuration\r\n  const fetchAuthProviders = useCallback(async () => {\r\n    try {\r\n      const response = await apiClient.getAuthProviders();\r\n      if (response.success && response.data) {\r\n        setAuthProviders(response.data.providers);\r\n        setHasOAuth(response.data.hasOAuth);\r\n        setRequiresEmailAuth(response.data.requiresEmailAuth);\r\n      }\r\n    } catch (error) {\r\n      console.warn('Failed to fetch auth providers:', error);\r\n      // Fallback to defaults\r\n      setAuthProviders({ google: false, github: false, email: true });\r\n      setHasOAuth(false);\r\n      setRequiresEmailAuth(true);\r\n    }\r\n  }, []);\r\n\r\n  // Check authentication status\r\n  const checkAuth = useCallback(async () => {\r\n    try {\r\n      const response = await apiClient.getProfile(true);\r\n      \r\n      if (response.success && response.data?.user) {\r\n        setUser({ ...response.data.user, isAnonymous: false } as AuthUser);\r\n        setToken(null); // Profile endpoint doesn't return token, cookies are used\r\n        setSession({\r\n          userId: response.data.user.id,\r\n          email: response.data.user.email,\r\n          sessionId: response.data.sessionId || response.data.user.id,\r\n          expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000), // 24 hours expiry\r\n        });\r\n        \r\n        // Setup token refresh\r\n        setupTokenRefresh();\r\n      } else {\r\n        setUser(null);\r\n        setToken(null);\r\n        setSession(null);\r\n      }\r\n    } catch (error) {\r\n      console.error('Auth check failed:', error);\r\n      setUser(null);\r\n      setToken(null);\r\n      setSession(null);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Setup automatic session validation (cookie-based)\r\n  const setupTokenRefresh = useCallback(() => {\r\n    // Clear any existing timer\r\n    if (refreshTimerRef.current) {\r\n      clearInterval(refreshTimerRef.current);\r\n    }\r\n\r\n    // Set up session validation timer - less frequent since cookies handle refresh\r\n    refreshTimerRef.current = setInterval(async () => {\r\n      try {\r\n        const response = await apiClient.getProfile(true);\r\n\r\n        if (!response.success) {\r\n          // Session invalid, user needs to login again\r\n          setUser(null);\r\n          setToken(null);\r\n          setSession(null);\r\n          clearInterval(refreshTimerRef.current!);\r\n        }\r\n      } catch (error) {\r\n        console.error('Session validation failed:', error);\r\n      }\r\n    }, TOKEN_REFRESH_INTERVAL);\r\n  }, []);\r\n\r\n  // Cleanup refresh timer on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (refreshTimerRef.current) {\r\n        clearInterval(refreshTimerRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Initialize auth state on mount\r\n  useEffect(() => {\r\n    const initAuth = async () => {\r\n      await fetchAuthProviders();\r\n      await checkAuth();\r\n    };\r\n    initAuth();\r\n  }, [fetchAuthProviders, checkAuth]);\r\n\r\n  // OAuth login method with redirect support\r\n  const login = useCallback((provider: 'google' | 'github', redirectUrl?: string) => {\r\n    // Store intended redirect URL if provided, otherwise use current location\r\n    const intendedUrl = redirectUrl || window.location.pathname + window.location.search;\r\n    setIntendedUrl(intendedUrl);\r\n    \r\n    // Build OAuth URL with redirect parameter\r\n    const oauthUrl = new URL(`/api/auth/oauth/${provider}`, window.location.origin);\r\n    oauthUrl.searchParams.set('redirect_url', intendedUrl);\r\n    \r\n    // Redirect to OAuth provider\r\n    window.location.href = oauthUrl.toString();\r\n  }, [setIntendedUrl]);\r\n\r\n  // Email/password login\r\n  const loginWithEmail = useCallback(async (credentials: { email: string; password: string }) => {\r\n    setError(null);\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const response = await apiClient.loginWithEmail(credentials);\r\n\r\n      if (response.success && response.data) {\r\n        setUser({ ...response.data.user, isAnonymous: false } as AuthUser);\r\n        setToken(null); // Using cookies for authentication\r\n        setSession({\r\n          userId: response.data.user.id,\r\n          email: response.data.user.email,\r\n          sessionId: response.data.sessionId,\r\n          expiresAt: response.data.expiresAt,\r\n        });\r\n        setupTokenRefresh();\r\n        \r\n        // Navigate to intended URL or default to home\r\n        const intendedUrl = getIntendedUrl();\r\n        clearIntendedUrl();\r\n        navigate(intendedUrl || '/');\r\n      }\r\n    } catch (error) {\r\n      console.error('Login error:', error);\r\n      if (error instanceof ApiError) {\r\n        setError(error.message);\r\n      } else {\r\n        setError('Connection error. Please try again.');\r\n      }\r\n      // Don't navigate on error - let modal stay open\r\n      throw error; // Re-throw to inform caller\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [navigate, setupTokenRefresh, getIntendedUrl, clearIntendedUrl]);\r\n\r\n  // Register new user\r\n  const register = useCallback(async (data: { email: string; password: string; name?: string }) => {\r\n    setError(null);\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const response = await apiClient.register(data);\r\n\r\n      if (response.success && response.data) {\r\n        setUser({ ...response.data.user, isAnonymous: false } as AuthUser);\r\n        setToken(null); // Using cookies for authentication\r\n        setSession({\r\n          userId: response.data.user.id,\r\n          email: response.data.user.email,\r\n          sessionId: response.data.sessionId,\r\n          expiresAt: response.data.expiresAt,\r\n        });\r\n        setupTokenRefresh();\r\n        \r\n        // Navigate to intended URL or default to home\r\n        const intendedUrl = getIntendedUrl();\r\n        clearIntendedUrl();\r\n        navigate(intendedUrl || '/');\r\n      }\r\n    } catch (error) {\r\n      console.error('Registration error:', error);\r\n      if (error instanceof ApiError) {\r\n        setError(error.message);\r\n      } else {\r\n        setError('Connection error. Please try again.');\r\n      }\r\n      throw error; // Re-throw to inform caller\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [navigate, setupTokenRefresh, getIntendedUrl, clearIntendedUrl]);\r\n\r\n  // Logout\r\n  const logout = useCallback(async () => {\r\n    try {\r\n      await apiClient.logout();\r\n    } catch (error) {\r\n      console.error('Logout error:', error);\r\n    } finally {\r\n      // Clear state regardless of API response\r\n      setUser(null);\r\n      setToken(null);\r\n      setSession(null);\r\n      if (refreshTimerRef.current) {\r\n        clearInterval(refreshTimerRef.current);\r\n      }\r\n      navigate('/');\r\n    }\r\n  }, [navigate]);\r\n\r\n  // Refresh user profile\r\n  const refreshUser = useCallback(async () => {\r\n    await checkAuth();\r\n  }, [checkAuth]);\r\n\r\n\r\n  // Clear error\r\n  const clearError = useCallback(() => {\r\n    setError(null);\r\n  }, []);\r\n\r\n  const value: AuthContextType = {\r\n    user,\r\n    token,\r\n    session,\r\n    isAuthenticated: !!user,\r\n    isLoading,\r\n    error,\r\n    authProviders,\r\n    hasOAuth,\r\n    requiresEmailAuth,\r\n    login, // OAuth method with redirect support\r\n    loginWithEmail, // Email/password method\r\n    register,\r\n    logout,\r\n    refreshUser,\r\n    clearError,\r\n    setIntendedUrl,\r\n    getIntendedUrl,\r\n    clearIntendedUrl,\r\n  };\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}\r\n\r\n// Helper hook for protected routes\r\nexport function useRequireAuth(redirectTo = '/') {\r\n  const { isAuthenticated, isLoading } = useAuth();\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    if (!isLoading && !isAuthenticated) {\r\n      navigate(redirectTo);\r\n    }\r\n  }, [isAuthenticated, isLoading, navigate, redirectTo]);\r\n\r\n  return { isAuthenticated, isLoading };\r\n}","/**\r\n * Enhanced Login Modal\r\n * Supports both OAuth and email/password authentication with backward compatibility\r\n */\r\n\r\nimport { useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { X, AlertCircle, Eye, EyeOff } from 'lucide-react';\r\nimport { createPortal } from 'react-dom';\r\nimport clsx from 'clsx';\r\nimport { useAuth } from '@/contexts/auth-context';\r\n// import {\r\n// \tvalidateEmail,\r\n// \tvalidatePassword,\r\n// \tvalidateDisplayName,\r\n// } from '../../utils/validationUtils';\r\n\r\ninterface LoginModalProps {\r\n\tisOpen: boolean;\r\n\tonClose: () => void;\r\n\r\n\t// Original OAuth-only interface (for backward compatibility)\r\n\tonLogin: (provider: 'google' | 'github') => void;\r\n\r\n\t// New enhanced interfaces (optional)\r\n\tonEmailLogin?: (credentials: {\r\n\t\temail: string;\r\n\t\tpassword: string;\r\n\t}) => Promise<void>;\r\n\tonOAuthLogin?: (provider: 'google' | 'github', redirectUrl?: string) => void;\r\n\tonRegister?: (data: {\r\n\t\temail: string;\r\n\t\tpassword: string;\r\n\t\tname?: string;\r\n\t}) => Promise<void>;\r\n\terror?: string | null;\r\n\tonClearError?: () => void;\r\n\t\r\n\t// Contextual messaging\r\n\tactionContext?: string; // e.g., \"to star this app\", \"to fork this project\"\r\n\tshowCloseButton?: boolean;\r\n}\r\n\r\ntype AuthMode = 'login' | 'register';\r\n\r\nexport function LoginModal({\r\n\tisOpen,\r\n\tonClose,\r\n\tonLogin, // Original OAuth interface\r\n\tonEmailLogin,\r\n\tonOAuthLogin,\r\n\tonRegister,\r\n\terror,\r\n\tonClearError,\r\n\tactionContext,\r\n\tshowCloseButton = true,\r\n}: LoginModalProps) {\r\n\tconst { authProviders, hasOAuth, requiresEmailAuth } = useAuth();\r\n\tconst [mode, setMode] = useState<AuthMode>('login');\r\n\tconst [showPassword, setShowPassword] = useState(false);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\r\n\t// Form state\r\n\tconst [email, setEmail] = useState('');\r\n\tconst [password, setPassword] = useState('');\r\n\tconst [name, setName] = useState('');\r\n\tconst [confirmPassword, setConfirmPassword] = useState('');\r\n\r\n\t// Validation errors\r\n\tconst [validationErrors, setValidationErrors] = useState<\r\n\t\tRecord<string, string>\r\n\t>({});\r\n\r\n\t// Determine if enhanced features are available\r\n\tconst hasEmailAuth = requiresEmailAuth && !!onEmailLogin;\r\n\tconst hasRegistration = requiresEmailAuth && !!onRegister;\r\n\tconst showGitHub = authProviders?.github && hasOAuth;\r\n\tconst showGoogle = authProviders?.google && hasOAuth;\r\n\r\n\tconst resetForm = () => {\r\n\t\tsetEmail('');\r\n\t\tsetPassword('');\r\n\t\tsetName('');\r\n\t\tsetConfirmPassword('');\r\n\t\tsetValidationErrors({});\r\n\t\tsetShowPassword(false);\r\n\t\tif (onClearError) onClearError();\r\n\t};\r\n\r\n\tconst handleClose = () => {\r\n\t\tresetForm();\r\n\t\tonClose();\r\n\t};\r\n\r\n\tconst switchMode = (newMode: AuthMode) => {\r\n\t\tsetMode(newMode);\r\n\t\tresetForm();\r\n\t\tsetValidationErrors({});\r\n\t\tif (onClearError) onClearError();\r\n\t};\r\n\r\n\tconst validateForm = (): boolean => {\r\n\t\tconst errors: Record<string, string> = {};\r\n\r\n\t\t// Basic email validation\r\n\t\tconst emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n\t\tif (!email.trim()) {\r\n\t\t\terrors.email = 'Email is required';\r\n\t\t} else if (!emailRegex.test(email)) {\r\n\t\t\terrors.email = 'Invalid email format';\r\n\t\t}\r\n\r\n\t\t// Basic password validation\r\n\t\tif (!password) {\r\n\t\t\terrors.password = 'Password is required';\r\n\t\t} else if (password.length < 8) {\r\n\t\t\terrors.password = 'Password must be at least 8 characters';\r\n\t\t}\r\n\r\n\t\t// Additional validation for registration\r\n\t\tif (mode === 'register') {\r\n\t\t\t// Name validation\r\n\t\t\tif (!name.trim()) {\r\n\t\t\t\terrors.name = 'Name is required';\r\n\t\t\t} else if (name.trim().length < 2) {\r\n\t\t\t\terrors.name = 'Name must be at least 2 characters';\r\n\t\t\t}\r\n\r\n\t\t\t// Confirm password validation\r\n\t\t\tif (password !== confirmPassword) {\r\n\t\t\t\terrors.confirmPassword = 'Passwords do not match';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tsetValidationErrors(errors);\r\n\t\treturn Object.keys(errors).length === 0;\r\n\t};\r\n\r\n\tconst handleSubmit = async (e: React.FormEvent) => {\r\n\t\te.preventDefault();\r\n\r\n\t\tif (!validateForm()) return;\r\n\r\n\t\tsetIsLoading(true);\r\n\t\ttry {\r\n\t\t\tif (mode === 'login' && onEmailLogin) {\r\n\t\t\t\tawait onEmailLogin({ email, password });\r\n\t\t\t} else if (mode === 'register' && onRegister) {\r\n\t\t\t\tawait onRegister({ email, password, name: name.trim() });\r\n\t\t\t}\r\n\t\t\t// Don't auto-close here - let the parent handle success/error\r\n\t\t} catch (err) {\r\n\t\t\t// Error handling is done in the auth context\r\n\t\t} finally {\r\n\t\t\tsetIsLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleOAuthClick = (provider: 'google' | 'github') => {\r\n\t\t// Use the new interface if available, otherwise fall back to original\r\n\t\tif (onOAuthLogin) {\r\n\t\t\t// Pass the current URL as redirect URL for context preservation\r\n\t\t\tonOAuthLogin(provider, window.location.pathname + window.location.search);\r\n\t\t} else {\r\n\t\t\tonLogin(provider);\r\n\t\t}\r\n\t};\r\n\r\n\tif (!isOpen) return null;\r\n\r\n\treturn createPortal(\r\n\t\t<AnimatePresence>\r\n\t\t\t{isOpen && (\r\n\t\t\t\t<div className=\"fixed inset-0 z-[9999] flex items-center justify-center p-4 overflow-y-auto\">\r\n\t\t\t\t\t{/* Backdrop */}\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tinitial={{ opacity: 0 }}\r\n\t\t\t\t\t\tanimate={{ opacity: 1 }}\r\n\t\t\t\t\t\texit={{ opacity: 0 }}\r\n\t\t\t\t\t\tclassName=\"fixed inset-0 bg-black/50 backdrop-blur-md\"\r\n\t\t\t\t\t\tonClick={handleClose}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t{/* Modal */}\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tinitial={{ opacity: 0, scale: 0.95, y: 20 }}\r\n\t\t\t\t\t\tanimate={{ opacity: 1, scale: 1, y: 0 }}\r\n\t\t\t\t\t\texit={{ opacity: 0, scale: 0.95, y: 20 }}\r\n\t\t\t\t\t\ttransition={{ type: 'spring', duration: 0.5 }}\r\n\t\t\t\t\t\tclassName=\"relative z-10 w-full max-w-md mx-auto my-8\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"bg-bg-3/95 backdrop-blur-xl text-text-primary border border-border-primary/50 rounded-2xl shadow-2xl overflow-hidden\">\r\n\t\t\t\t\t\t\t{/* Header */}\r\n\t\t\t\t\t\t\t<div className=\"relative p-6 pb-0\">\r\n\t\t\t\t\t\t\t\t{showCloseButton && (\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tonClick={handleClose}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"absolute right-4 top-4 p-2 rounded-lg hover:bg-accent transition-colors\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<X className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t<div className=\"text-center space-y-2\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"mx-auto w-12 h-12 rounded-full bg-text-secondary/10 flex items-center justify-center mb-4\">\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-6 h-6 text-text-primary\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstrokeWidth={2}\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<h2 className=\"text-2xl font-semibold mb-2\">\r\n\t\t\t\t\t\t\t\t\t\t{actionContext\r\n\t\t\t\t\t\t\t\t\t\t\t? `Sign in ${actionContext}`\r\n\t\t\t\t\t\t\t\t\t\t\t: hasEmailAuth && mode === 'register'\r\n\t\t\t\t\t\t\t\t\t\t\t? 'Create an account'\r\n\t\t\t\t\t\t\t\t\t\t\t: 'Welcome back'}\r\n\t\t\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t\t\t<p className=\"text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t{actionContext\r\n\t\t\t\t\t\t\t\t\t\t\t? 'Authentication required for this action'\r\n\t\t\t\t\t\t\t\t\t\t\t: hasEmailAuth && mode === 'register'\r\n\t\t\t\t\t\t\t\t\t\t\t? 'Join to start building amazing applications'\r\n\t\t\t\t\t\t\t\t\t\t\t: 'Sign in to save your apps and access your workspace'}\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Error display */}\r\n\t\t\t\t\t\t\t{error && (\r\n\t\t\t\t\t\t\t\t<div className=\"mx-6 mt-4 p-3 rounded-lg bg-destructive/10 border border-destructive/20 flex items-start gap-2\">\r\n\t\t\t\t\t\t\t\t\t<AlertCircle className=\"h-4 w-4 text-destructive mt-0.5\" />\r\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-destructive\">\r\n\t\t\t\t\t\t\t\t\t\t{error}\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{/* Authentication Options */}\r\n\t\t\t\t\t\t\t<div className={clsx('p-6 space-y-5 pt-12')}>\r\n\t\t\t\t\t\t\t\t{/* GitHub */}\r\n\t\t\t\t\t\t\t\t{showGitHub && (\r\n\t\t\t\t\t\t\t\t\t<motion.button\r\n\t\t\t\t\t\t\t\t\t\twhileTap={{ scale: 0.98 }}\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => handleOAuthClick('github')}\r\n\t\t\t\t\t\t\t\t\t\t// disabled={isLoading}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"w-full group relative overflow-hidden rounded-xl bg-gray-900 dark:bg-bg-1 p-4 text-white transition-all hover:bg-gray-800 dark:hover:bg-[#1a1e22] border border-gray-800 dark:border-bg-4 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div className=\"relative z-10 flex items-center justify-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-5 w-5\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tfillRule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclipRule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\tContinue with GitHub\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/10 to-transparent group-hover:translate-x-full transition-transform duration-700\" />\r\n\t\t\t\t\t\t\t\t</motion.button>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{/* Google */}\r\n\t\t\t\t\t\t\t\t{showGoogle && (\r\n\t\t\t\t\t\t\t\t\t<motion.button\r\n\t\t\t\t\t\t\t\t\twhileTap={{ scale: 0.98 }}\r\n\t\t\t\t\t\t\t\t\tonClick={() => handleOAuthClick('google')}\r\n\t\t\t\t\t\t\t\t\t// disabled={isLoading}\r\n\t\t\t\t\t\t\t\t\tclassName=\"w-full group relative overflow-hidden rounded-xl bg-white dark:bg-bg-4 p-4 text-gray-800 dark:text-text-primary transition-all hover:bg-gray-50 dark:hover:bg-bg-4/80 border border-gray-200 dark:border-border-primary disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div className=\"relative z-10 flex items-center justify-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-5 w-5\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"#4285F4\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"#34A853\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"#FBBC05\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"#EA4335\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\tContinue with Google\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-gray-100 dark:via-gray-800 to-transparent group-hover:translate-x-full transition-transform duration-700\" />\r\n\t\t\t\t\t\t\t\t</motion.button>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{/* Divider (only if both OAuth and email are available) */}\r\n\t\t\t\t\t\t\t\t{hasEmailAuth && hasOAuth && (\r\n\t\t\t\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"absolute inset-0 flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-full border-t border-border\" />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"relative flex justify-center text-xs uppercase\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"bg-background px-2 text-muted-foreground\">Or continue with</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{/* Email/Password Form */}\r\n\t\t\t\t\t\t\t\t{hasEmailAuth && (\r\n\t\t\t\t\t\t\t\t\t<form onSubmit={handleSubmit} className=\"space-y-4\">\r\n\t\t\t\t\t\t\t\t\t\t{mode === 'register' && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Full name\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setName(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'w-full p-3 rounded-lg border bg-background transition-colors',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalidationErrors.name ? 'border-destructive' : 'border-border focus:border-primary'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{validationErrors.name && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"mt-1 text-sm text-destructive\">{validationErrors.name}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"email\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Email address\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={email}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setEmail(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'w-full p-3 rounded-lg border bg-background transition-colors',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalidationErrors.email ? 'border-destructive' : 'border-border focus:border-primary'\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t{validationErrors.email && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"mt-1 text-sm text-destructive\">{validationErrors.email}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype={showPassword ? 'text' : 'password'}\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Password\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={password}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setPassword(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'w-full p-3 pr-10 rounded-lg border bg-background transition-colors',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalidationErrors.password ? 'border-destructive' : 'border-border focus:border-primary'\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setShowPassword(!showPassword)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t{validationErrors.password && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"mt-1 text-sm text-destructive\">{validationErrors.password}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t{mode === 'register' && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Confirm password\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={confirmPassword}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setConfirmPassword(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'w-full p-3 rounded-lg border bg-background transition-colors',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalidationErrors.confirmPassword ? 'border-destructive' : 'border-border focus:border-primary'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{validationErrors.confirmPassword && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"mt-1 text-sm text-destructive\">{validationErrors.confirmPassword}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t<motion.button\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\t\t\t\twhileTap={{ scale: 0.98 }}\r\n\t\t\t\t\t\t\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full bg-primary hover:bg-primary/90 text-primary-foreground p-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{isLoading \r\n\t\t\t\t\t\t\t\t\t\t\t\t? (mode === 'register' ? 'Creating account...' : 'Signing in...')\r\n\t\t\t\t\t\t\t\t\t\t\t\t: (mode === 'register' ? 'Create account' : 'Sign in')\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t</motion.button>\r\n\t\t\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Footer */}\r\n\t\t\t\t\t\t\t<div className=\"px-6 pb-6 space-y-4\">\r\n\t\t\t\t\t\t\t\t{/* Mode switching (only if registration is available) */}\r\n\t\t\t\t\t\t\t\t{hasRegistration && hasEmailAuth && (\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\tswitchMode(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmode === 'login'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'register'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'login',\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-sm text-text-tertiary hover:text-text-primary transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{mode === 'login' \r\n\t\t\t\t\t\t\t\t\t\t\t\t? \"Don't have an account? Sign up\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t: \"Already have an account? Sign in\"\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t<p className=\"text-center text-xs text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\tBy continuing, you agree to our{' '}\r\n\t\t\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"underline hover:text-text-primary\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tTerms of Service\r\n\t\t\t\t\t\t\t\t\t</a>{' '}\r\n\t\t\t\t\t\t\t\t\tand{' '}\r\n\t\t\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"underline hover:text-text-primary\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tPrivacy Policy\r\n\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</motion.div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</AnimatePresence>,\r\n\t\tdocument.body,\r\n\t);\r\n}\r\n","/**\r\n * Authentication Modal Provider\r\n * Provides global authentication modal management\r\n */\r\n\r\nimport React, { createContext, useContext, useState, useCallback, useEffect } from 'react';\r\nimport { LoginModal } from './login-modal';\r\nimport { useAuth } from '../../contexts/auth-context';\r\nimport { setGlobalAuthModalTrigger } from '../../lib/api-client';\r\n\r\ninterface AuthModalContextType {\r\n  showAuthModal: (context?: string, onSuccess?: () => void, intendedUrl?: string) => void;\r\n  hideAuthModal: () => void;\r\n  isAuthModalOpen: boolean;\r\n}\r\n\r\nconst AuthModalContext = createContext<AuthModalContextType | undefined>(undefined);\r\n\r\nexport function useAuthModal() {\r\n  const context = useContext(AuthModalContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuthModal must be used within an AuthModalProvider');\r\n  }\r\n  return context;\r\n}\r\n\r\ninterface AuthModalProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport function AuthModalProvider({ children }: AuthModalProviderProps) {\r\n  const [isAuthModalOpen, setIsAuthModalOpen] = useState(false);\r\n  const [modalContext, setModalContext] = useState<string | undefined>();\r\n  const [pendingAction, setPendingAction] = useState<(() => void) | undefined>();\r\n  const [intendedUrl, setIntendedUrlState] = useState<string | undefined>();\r\n  const { login, loginWithEmail, register, error, clearError, isAuthenticated } = useAuth();\r\n\r\n  const showAuthModal = useCallback((context?: string, onSuccess?: () => void, intendedUrl?: string) => {\r\n    setModalContext(context);\r\n    setPendingAction(onSuccess ? () => onSuccess : undefined);\r\n    setIntendedUrlState(intendedUrl);\r\n    setIsAuthModalOpen(true);\r\n  }, []);\r\n\r\n  const hideAuthModal = useCallback(() => {\r\n    setIsAuthModalOpen(false);\r\n    setModalContext(undefined);\r\n    setPendingAction(undefined);\r\n    setIntendedUrlState(undefined);\r\n    clearError();\r\n  }, [clearError]);\r\n\r\n  // Close modal and execute pending action when user becomes authenticated\r\n  useEffect(() => {\r\n    if (isAuthenticated && isAuthModalOpen) {\r\n      hideAuthModal();\r\n      // Execute the pending action after a brief delay to ensure modal is closed\r\n      if (pendingAction) {\r\n        setTimeout(() => {\r\n          pendingAction();\r\n        }, 100);\r\n      }\r\n    }\r\n  }, [isAuthenticated, pendingAction, isAuthModalOpen, hideAuthModal]);\r\n\r\n  const handleLogin = useCallback((provider: 'google' | 'github', redirectUrl?: string) => {\r\n    // Use the intended URL if available, otherwise use the provided redirect URL\r\n    const finalRedirectUrl = intendedUrl || redirectUrl;\r\n    login(provider, finalRedirectUrl);\r\n  }, [login, intendedUrl]);\r\n\r\n  // Set up global auth modal trigger for API client\r\n  useEffect(() => {\r\n    setGlobalAuthModalTrigger(showAuthModal);\r\n  }, [showAuthModal]);\r\n\r\n  const value: AuthModalContextType = {\r\n    showAuthModal,\r\n    hideAuthModal,\r\n    isAuthModalOpen,\r\n  };\r\n\r\n  return (\r\n    <AuthModalContext.Provider value={value}>\r\n      {children}\r\n      <LoginModal\r\n        isOpen={isAuthModalOpen}\r\n        onClose={hideAuthModal}\r\n        onLogin={login} // Fallback for backward compatibility\r\n        onOAuthLogin={handleLogin}\r\n        onEmailLogin={loginWithEmail}\r\n        onRegister={register}\r\n        error={error}\r\n        onClearError={clearError}\r\n        actionContext={modalContext}\r\n      />\r\n    </AuthModalContext.Provider>\r\n  );\r\n}","import React, { createContext, useContext, useEffect, useState } from 'react';\r\n\r\ntype Theme = 'light' | 'dark' | 'system';\r\n\r\ninterface ThemeContextType {\r\n  theme: Theme;\r\n  setTheme: (theme: Theme) => void;\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextType>({\r\n  theme: 'system',\r\n  setTheme: () => {},\r\n});\r\n\r\nexport const useTheme = () => {\r\n  const context = useContext(ThemeContext);\r\n  if (!context) {\r\n    throw new Error('useTheme must be used within a ThemeProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\ninterface ThemeProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport function ThemeProvider({ children }: ThemeProviderProps) {\r\n  const [theme, setTheme] = useState<Theme>(() => {\r\n    const savedTheme = localStorage.getItem('theme') as Theme;\r\n    return savedTheme || 'system';\r\n  });\r\n\r\n  const applyTheme = (newTheme: Theme) => {\r\n    const root = window.document.documentElement;\r\n    root.classList.remove('light', 'dark');\r\n\r\n    if (newTheme === 'system') {\r\n      const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\r\n      root.classList.add(systemTheme);\r\n    } else {\r\n      root.classList.add(newTheme);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    applyTheme(theme);\r\n\r\n    // Listen for system theme changes\r\n    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n    const handleChange = () => {\r\n      if (theme === 'system') {\r\n        applyTheme('system');\r\n      }\r\n    };\r\n\r\n    mediaQuery.addEventListener('change', handleChange);\r\n    return () => mediaQuery.removeEventListener('change', handleChange);\r\n  }, [theme]);\r\n\r\n  const handleSetTheme = (newTheme: Theme) => {\r\n    setTheme(newTheme);\r\n    localStorage.setItem('theme', newTheme);\r\n    // Apply theme immediately for instant feedback\r\n    applyTheme(newTheme);\r\n  };\r\n\r\n  return (\r\n    <ThemeContext.Provider value={{ theme, setTheme: handleSetTheme }}>\r\n      {children}\r\n    </ThemeContext.Provider>\r\n  );\r\n}","import { useTheme } from \"next-themes\"\r\nimport { Toaster as Sonner, type ToasterProps } from \"sonner\"\r\n\r\nconst Toaster = ({ ...props }: ToasterProps) => {\r\n  const { theme = \"system\" } = useTheme()\r\n\r\n  return (\r\n    <Sonner\r\n      theme={theme as ToasterProps[\"theme\"]}\r\n      className=\"toaster group\"\r\n      style={\r\n        {\r\n          \"--normal-bg\": \"var(--popover)\",\r\n          \"--normal-text\": \"var(--popover-foreground)\",\r\n          \"--normal-border\": \"var(--border)\",\r\n        } as React.CSSProperties\r\n      }\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Toaster }\r\n","import * as React from \"react\"\r\n\r\nconst MOBILE_BREAKPOINT = 768\r\n\r\nexport function useIsMobile() {\r\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\r\n\r\n  React.useEffect(() => {\r\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\r\n    const onChange = () => {\r\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\r\n    }\r\n    mql.addEventListener(\"change\", onChange)\r\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\r\n    return () => mql.removeEventListener(\"change\", onChange)\r\n  }, [])\r\n\r\n  return !!isMobile\r\n}\r\n","import { clsx, type ClassValue } from \"clsx\"\r\nimport { twMerge } from \"tailwind-merge\"\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n\r\nexport function getPreviewUrl(previewURL?: string, tunnelURL?: string): string {\r\n    // return import.meta.env.VITE_PREVIEW_MODE === 'tunnel' ? tunnelURL || previewURL || '' : previewURL || tunnelURL || '';\r\n    return previewURL || tunnelURL || '';\r\n}\r\n\r\nexport function capitalizeFirstLetter(str: string) {\r\n  if (typeof str !== 'string' || str.length === 0) {\r\n    return str; // Handle non-string input or empty string\r\n  }\r\n  return str.charAt(0).toUpperCase() + str.slice(1);\r\n}","import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive cursor-pointer\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"bg-text-secondary text-bg-3 shadow-xs hover:bg-text-secondary/90\",\r\n        destructive:\r\n          \"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\r\n        outline:\r\n          \"border bg-bg-3 dark:bg-bg-2 shadow-xs hover:bg-bg-4 hover:text-text-secondary dark:border-bg-4\",\r\n        secondary:\r\n          \"bg-bg-2 text-text-secondary shadow-xs hover:bg-bg-2/80\",\r\n        ghost:\r\n          \"hover:bg-accent hover:text-text-secondary dark:hover:bg-accent/50 text-text-primary\",\r\n        link: \"text-text-primary underline-offset-4 hover:underline\",\r\n      },\r\n      size: {\r\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\r\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\r\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\r\n        icon: \"size-8\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nfunction Button({\r\n  className,\r\n  variant,\r\n  size,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"button\"> &\r\n  VariantProps<typeof buttonVariants> & {\r\n    asChild?: boolean\r\n  }) {\r\n  const Comp = asChild ? Slot : \"button\"\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"button\"\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Button, buttonVariants }\r\n","import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Input({ className, type, ...props }: React.ComponentProps<\"input\">) {\r\n  return (\r\n    <input\r\n      type={type}\r\n      data-slot=\"input\"\r\n      className={cn(\r\n        \"file:text-text-primary placeholder:!text-gray-400 selection:bg-text-secondary selection:text-bg-3 flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\r\n        \"focus-visible:border-secondary focus-visible:ring-ring/50 focus-visible:ring-[1px]\",\r\n        \"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Input }\r\n","import * as React from \"react\"\r\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Separator({\r\n  className,\r\n  orientation = \"horizontal\",\r\n  decorative = true,\r\n  ...props\r\n}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {\r\n  return (\r\n    <SeparatorPrimitive.Root\r\n      data-slot=\"separator\"\r\n      decorative={decorative}\r\n      orientation={orientation}\r\n      className={cn(\r\n        \"bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Separator }\r\n","\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\r\nimport { XIcon } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Sheet({ ...props }: React.ComponentProps<typeof SheetPrimitive.Root>) {\r\n  return <SheetPrimitive.Root data-slot=\"sheet\" {...props} />\r\n}\r\n\r\nfunction SheetTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof SheetPrimitive.Trigger>) {\r\n  return <SheetPrimitive.Trigger data-slot=\"sheet-trigger\" {...props} />\r\n}\r\n\r\nfunction SheetClose({\r\n  ...props\r\n}: React.ComponentProps<typeof SheetPrimitive.Close>) {\r\n  return <SheetPrimitive.Close data-slot=\"sheet-close\" {...props} />\r\n}\r\n\r\nfunction SheetPortal({\r\n  ...props\r\n}: React.ComponentProps<typeof SheetPrimitive.Portal>) {\r\n  return <SheetPrimitive.Portal data-slot=\"sheet-portal\" {...props} />\r\n}\r\n\r\nfunction SheetOverlay({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SheetPrimitive.Overlay>) {\r\n  return (\r\n    <SheetPrimitive.Overlay\r\n      data-slot=\"sheet-overlay\"\r\n      className={cn(\r\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SheetContent({\r\n  className,\r\n  children,\r\n  side = \"right\",\r\n  ...props\r\n}: React.ComponentProps<typeof SheetPrimitive.Content> & {\r\n  side?: \"top\" | \"right\" | \"bottom\" | \"left\"\r\n}) {\r\n  return (\r\n    <SheetPortal>\r\n      <SheetOverlay />\r\n      <SheetPrimitive.Content\r\n        data-slot=\"sheet-content\"\r\n        className={cn(\r\n          \"bg-bg-3 data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\r\n          side === \"right\" &&\r\n            \"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm\",\r\n          side === \"left\" &&\r\n            \"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm\",\r\n          side === \"top\" &&\r\n            \"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b\",\r\n          side === \"bottom\" &&\r\n            \"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t\",\r\n          className\r\n        )}\r\n        {...props}\r\n      >\r\n        {children}\r\n        <SheetPrimitive.Close className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-bg-2 absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none\">\r\n          <XIcon className=\"size-4\" />\r\n          <span className=\"sr-only\">Close</span>\r\n        </SheetPrimitive.Close>\r\n      </SheetPrimitive.Content>\r\n    </SheetPortal>\r\n  )\r\n}\r\n\r\nfunction SheetHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sheet-header\"\r\n      className={cn(\"flex flex-col gap-1.5 p-4\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SheetFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sheet-footer\"\r\n      className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SheetTitle({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SheetPrimitive.Title>) {\r\n  return (\r\n    <SheetPrimitive.Title\r\n      data-slot=\"sheet-title\"\r\n      className={cn(\"text-text-primary font-semibold\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SheetDescription({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SheetPrimitive.Description>) {\r\n  return (\r\n    <SheetPrimitive.Description\r\n      data-slot=\"sheet-description\"\r\n      className={cn(\"text-text-tertiary text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Sheet,\r\n  SheetTrigger,\r\n  SheetClose,\r\n  SheetContent,\r\n  SheetHeader,\r\n  SheetFooter,\r\n  SheetTitle,\r\n  SheetDescription,\r\n}\r\n","import { cn } from \"@/lib/utils\"\r\n\r\nfunction Skeleton({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"skeleton\"\r\n      className={cn(\"bg-accent animate-pulse rounded-md\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Skeleton }\r\n","import * as React from \"react\"\r\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction TooltipProvider({\r\n  delayDuration = 0,\r\n  ...props\r\n}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {\r\n  return (\r\n    <TooltipPrimitive.Provider\r\n      data-slot=\"tooltip-provider\"\r\n      delayDuration={delayDuration}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction Tooltip({\r\n  ...props\r\n}: React.ComponentProps<typeof TooltipPrimitive.Root>) {\r\n  return (\r\n    <TooltipProvider>\r\n      <TooltipPrimitive.Root data-slot=\"tooltip\" {...props} />\r\n    </TooltipProvider>\r\n  )\r\n}\r\n\r\nfunction TooltipTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {\r\n  return <TooltipPrimitive.Trigger data-slot=\"tooltip-trigger\" {...props} />\r\n}\r\n\r\nfunction TooltipContent({\r\n  className,\r\n  sideOffset = 0,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof TooltipPrimitive.Content>) {\r\n  return (\r\n    <TooltipPrimitive.Portal>\r\n      <TooltipPrimitive.Content\r\n        data-slot=\"tooltip-content\"\r\n        sideOffset={sideOffset}\r\n        className={cn(\r\n          \"bg-text-secondary text-bg-3 animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md -ml-2 px-3 py-1.5 text-xs text-balance\",\r\n          className\r\n        )}\r\n        {...props}\r\n      >\r\n        {children}\r\n      </TooltipPrimitive.Content>\r\n    </TooltipPrimitive.Portal>\r\n  )\r\n}\r\n\r\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\r\n","\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\nimport { PanelLeftIcon } from \"lucide-react\"\r\n\r\nimport { useIsMobile } from \"@/hooks/use-mobile\"\r\nimport { cn } from \"@/lib/utils\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Separator } from \"@/components/ui/separator\"\r\nimport {\r\n  Sheet,\r\n  SheetContent,\r\n  SheetDescription,\r\n  SheetHeader,\r\n  SheetTitle,\r\n} from \"@/components/ui/sheet\"\r\nimport { Skeleton } from \"@/components/ui/skeleton\"\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\"\r\n\r\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\r\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\r\nconst SIDEBAR_WIDTH = \"16rem\"\r\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\r\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\r\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\r\n\r\ntype SidebarContextProps = {\r\n  state: \"expanded\" | \"collapsed\"\r\n  open: boolean\r\n  setOpen: (open: boolean) => void\r\n  openMobile: boolean\r\n  setOpenMobile: (open: boolean) => void\r\n  isMobile: boolean\r\n  toggleSidebar: () => void\r\n}\r\n\r\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\r\n\r\nfunction useSidebar() {\r\n  const context = React.useContext(SidebarContext)\r\n  if (!context) {\r\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\r\n  }\r\n\r\n  return context\r\n}\r\n\r\nfunction SidebarProvider({\r\n  defaultOpen = true,\r\n  open: openProp,\r\n  onOpenChange: setOpenProp,\r\n  className,\r\n  style,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<\"div\"> & {\r\n  defaultOpen?: boolean\r\n  open?: boolean\r\n  onOpenChange?: (open: boolean) => void\r\n}) {\r\n  const isMobile = useIsMobile()\r\n  const [openMobile, setOpenMobile] = React.useState(false)\r\n\r\n  // This is the internal state of the sidebar.\r\n  // We use openProp and setOpenProp for control from outside the component.\r\n  const [_open, _setOpen] = React.useState(defaultOpen)\r\n  const open = openProp ?? _open\r\n  const setOpen = React.useCallback(\r\n    (value: boolean | ((value: boolean) => boolean)) => {\r\n      const openState = typeof value === \"function\" ? value(open) : value\r\n      if (setOpenProp) {\r\n        setOpenProp(openState)\r\n      } else {\r\n        _setOpen(openState)\r\n      }\r\n\r\n      // This sets the cookie to keep the sidebar state.\r\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\r\n    },\r\n    [setOpenProp, open]\r\n  )\r\n\r\n  // Helper to toggle the sidebar.\r\n  const toggleSidebar = React.useCallback(() => {\r\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\r\n  }, [isMobile, setOpen, setOpenMobile])\r\n\r\n  // Adds a keyboard shortcut to toggle the sidebar.\r\n  React.useEffect(() => {\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      if (\r\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\r\n        (event.metaKey || event.ctrlKey)\r\n      ) {\r\n        event.preventDefault()\r\n        toggleSidebar()\r\n      }\r\n    }\r\n\r\n    window.addEventListener(\"keydown\", handleKeyDown)\r\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\r\n  }, [toggleSidebar])\r\n\r\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\r\n  // This makes it easier to style the sidebar with Tailwind classes.\r\n  const state = open ? \"expanded\" : \"collapsed\"\r\n\r\n  const contextValue = React.useMemo<SidebarContextProps>(\r\n    () => ({\r\n      state,\r\n      open,\r\n      setOpen,\r\n      isMobile,\r\n      openMobile,\r\n      setOpenMobile,\r\n      toggleSidebar,\r\n    }),\r\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\r\n  )\r\n\r\n  return (\r\n    <SidebarContext.Provider value={contextValue}>\r\n      <TooltipProvider delayDuration={0}>\r\n        <div\r\n          data-slot=\"sidebar-wrapper\"\r\n          style={\r\n            {\r\n              \"--sidebar-width\": SIDEBAR_WIDTH,\r\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\r\n              ...style,\r\n            } as React.CSSProperties\r\n          }\r\n          className={cn(\r\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-bg-2 flex min-h-svh w-full\",\r\n            className\r\n          )}\r\n          {...props}\r\n        >\r\n          {children}\r\n        </div>\r\n      </TooltipProvider>\r\n    </SidebarContext.Provider>\r\n  )\r\n}\r\n\r\nfunction Sidebar({\r\n  side = \"left\",\r\n  variant = \"sidebar\",\r\n  collapsible = \"offcanvas\",\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<\"div\"> & {\r\n  side?: \"left\" | \"right\"\r\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\r\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\r\n}) {\r\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\r\n\r\n  if (collapsible === \"none\") {\r\n    return (\r\n      <div\r\n        data-slot=\"sidebar\"\r\n        className={cn(\r\n          \"text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col\",\r\n          className\r\n        )}\r\n        {...props}\r\n      >\r\n        {children}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (isMobile) {\r\n    return (\r\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\r\n        <SheetContent\r\n          data-sidebar=\"sidebar\"\r\n          data-slot=\"sidebar\"\r\n          data-mobile=\"true\"\r\n          className=\"bg-bg-2 text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden\"\r\n          style={\r\n            {\r\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\r\n            } as React.CSSProperties\r\n          }\r\n          side={side}\r\n        >\r\n          <SheetHeader className=\"sr-only\">\r\n            <SheetTitle>Sidebar</SheetTitle>\r\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\r\n          </SheetHeader>\r\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\r\n        </SheetContent>\r\n      </Sheet>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"group peer text-sidebar-foreground hidden md:block bg-bg-2\"\r\n      data-state={state}\r\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\r\n      data-variant={variant}\r\n      data-side={side}\r\n      data-slot=\"sidebar\"\r\n    >\r\n      {/* This is what handles the sidebar gap on desktop */}\r\n      <div\r\n        data-slot=\"sidebar-gap\"\r\n        className={cn(\r\n          \"relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear\",\r\n          \"group-data-[collapsible=offcanvas]:w-0\",\r\n          \"group-data-[side=right]:rotate-180\",\r\n          variant === \"floating\" || variant === \"inset\"\r\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]\"\r\n            : \"group-data-[collapsible=icon]:w-(--sidebar-width-icon)\"\r\n        )}\r\n      />\r\n      <div\r\n        data-slot=\"sidebar-container\"\r\n        className={cn(\r\n          \"fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex\",\r\n          side === \"left\"\r\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\r\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\r\n          // Adjust the padding for floating and inset variants.\r\n          variant === \"floating\" || variant === \"inset\"\r\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]\"\r\n            : \"group-data-[collapsible=icon]:w-(--sidebar-width-icon)\",\r\n          className\r\n        )}\r\n        {...props}\r\n      >\r\n        <div\r\n          data-sidebar=\"sidebar\"\r\n          data-slot=\"sidebar-inner\"\r\n          className=\"bg-bg-2 border-r-[0.5px] border-border-primary flex h-full w-full flex-col\"\r\n        >\r\n          {children}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction SidebarTrigger({\r\n  className,\r\n  onClick,\r\n  ...props\r\n}: React.ComponentProps<typeof Button>) {\r\n  const { toggleSidebar } = useSidebar()\r\n\r\n  return (\r\n    <Button\r\n      data-sidebar=\"trigger\"\r\n      data-slot=\"sidebar-trigger\"\r\n      variant=\"ghost\"\r\n      size=\"icon\"\r\n      className={cn(\"size-7\", className)}\r\n      onClick={(event) => {\r\n        onClick?.(event)\r\n        toggleSidebar()\r\n      }}\r\n      {...props}\r\n    >\r\n      <PanelLeftIcon />\r\n      <span className=\"sr-only\">Toggle Sidebar</span>\r\n    </Button>\r\n  )\r\n}\r\n\r\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\r\n  const { toggleSidebar } = useSidebar()\r\n\r\n  return (\r\n    <button\r\n      data-sidebar=\"rail\"\r\n      data-slot=\"sidebar-rail\"\r\n      aria-label=\"Toggle Sidebar\"\r\n      tabIndex={-1}\r\n      onClick={toggleSidebar}\r\n      title=\"Toggle Sidebar\"\r\n      className={cn(\r\n        \"hover:after:bg-bg-2-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\r\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\r\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\r\n        \"hover:group-data-[collapsible=offcanvas]:bg-bg-2 group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\r\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\r\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\r\n  return (\r\n    <main\r\n      data-slot=\"sidebar-inset\"\r\n      className={cn(\r\n        \"bg-bg-3 relative flex w-full flex-1 flex-col\",\r\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarInput({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof Input>) {\r\n  return (\r\n    <Input\r\n      data-slot=\"sidebar-input\"\r\n      data-sidebar=\"input\"\r\n      className={cn(\"bg-bg-3 h-8 w-full shadow-none\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-footer\"\r\n      data-sidebar=\"footer\"\r\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarSeparator({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof Separator>) {\r\n  return (\r\n    <Separator\r\n      data-slot=\"sidebar-separator\"\r\n      data-sidebar=\"separator\"\r\n      className={cn(\"bg-bg-2-border mx-2 w-auto\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-content\"\r\n      data-sidebar=\"content\"\r\n      className={cn(\r\n        \"flex min-h-0 flex-1 flex-col gap-0 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-group\"\r\n      data-sidebar=\"group\"\r\n      className={cn(\"relative flex w-full min-w-0 flex-col pl-2 py-0\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarGroupLabel({\r\n  className,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\r\n  const Comp = asChild ? Slot : \"div\"\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"sidebar-group-label\"\r\n      data-sidebar=\"group-label\"\r\n      className={cn(\r\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\r\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarGroupAction({\r\n  className,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\r\n  const Comp = asChild ? Slot : \"button\"\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"sidebar-group-action\"\r\n      data-sidebar=\"group-action\"\r\n      className={cn(\r\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-bg-2-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\r\n        // Increases the hit area of the button on mobile.\r\n        \"after:absolute after:-inset-2 md:after:hidden\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarGroupContent({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-group-content\"\r\n      data-sidebar=\"group-content\"\r\n      className={cn(\"w-full text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\r\n  return (\r\n    <ul\r\n      data-slot=\"sidebar-menu\"\r\n      data-sidebar=\"menu\"\r\n      className={cn(\"flex w-full min-w-0 flex-col gap-0\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\r\n  return (\r\n    <li\r\n      data-slot=\"sidebar-menu-item\"\r\n      data-sidebar=\"menu-item\"\r\n      className={cn(\"group/menu-item relative\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nconst sidebarMenuButtonVariants = cva(\r\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-bg-2-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-bg-2-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-bg-2-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-bg-2-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"hover:bg-bg-2-accent hover:text-sidebar-accent-foreground\",\r\n        outline:\r\n          \"bg-bg-3 shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-bg-2-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\r\n      },\r\n      size: {\r\n        default: \"text-sm\",\r\n        sm: \"h-7 text-xs\",\r\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nfunction SidebarMenuButton({\r\n  asChild = false,\r\n  isActive = false,\r\n  variant = \"default\",\r\n  size = \"default\",\r\n  tooltip,\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"button\"> & {\r\n  asChild?: boolean\r\n  isActive?: boolean\r\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\r\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\r\n  const Comp = asChild ? Slot : \"button\"\r\n  const { isMobile, state } = useSidebar()\r\n\r\n  const button = (\r\n    <Comp\r\n      data-slot=\"sidebar-menu-button\"\r\n      data-sidebar=\"menu-button\"\r\n      data-size={size}\r\n      data-active={isActive}\r\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\r\n      {...props}\r\n    />\r\n  )\r\n\r\n  if (!tooltip) {\r\n    return button\r\n  }\r\n\r\n  if (typeof tooltip === \"string\") {\r\n    tooltip = {\r\n      children: tooltip,\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Tooltip>\r\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\r\n      <TooltipContent\r\n        side=\"right\"\r\n        align=\"center\"\r\n        hidden={state !== \"collapsed\" || isMobile}\r\n        {...tooltip}\r\n      />\r\n    </Tooltip>\r\n  )\r\n}\r\n\r\nfunction SidebarMenuAction({\r\n  className,\r\n  asChild = false,\r\n  showOnHover = false,\r\n  ...props\r\n}: React.ComponentProps<\"button\"> & {\r\n  asChild?: boolean\r\n  showOnHover?: boolean\r\n}) {\r\n  const Comp = asChild ? Slot : \"button\"\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"sidebar-menu-action\"\r\n      data-sidebar=\"menu-action\"\r\n      className={cn(\r\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-bg-2-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\r\n        // Increases the hit area of the button on mobile.\r\n        \"after:absolute after:-inset-2 md:after:hidden\",\r\n        \"peer-data-[size=sm]/menu-button:top-1\",\r\n        \"peer-data-[size=default]/menu-button:top-1.5\",\r\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        showOnHover &&\r\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarMenuBadge({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-menu-badge\"\r\n      data-sidebar=\"menu-badge\"\r\n      className={cn(\r\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\r\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\r\n        \"peer-data-[size=sm]/menu-button:top-1\",\r\n        \"peer-data-[size=default]/menu-button:top-1.5\",\r\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarMenuSkeleton({\r\n  className,\r\n  showIcon = false,\r\n  ...props\r\n}: React.ComponentProps<\"div\"> & {\r\n  showIcon?: boolean\r\n}) {\r\n  // Random width between 50 to 90%.\r\n  const width = React.useMemo(() => {\r\n    return `${Math.floor(Math.random() * 40) + 50}%`\r\n  }, [])\r\n\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-menu-skeleton\"\r\n      data-sidebar=\"menu-skeleton\"\r\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\r\n      {...props}\r\n    >\r\n      {showIcon && (\r\n        <Skeleton\r\n          className=\"size-4 rounded-md\"\r\n          data-sidebar=\"menu-skeleton-icon\"\r\n        />\r\n      )}\r\n      <Skeleton\r\n        className=\"h-4 max-w-(--skeleton-width) flex-1\"\r\n        data-sidebar=\"menu-skeleton-text\"\r\n        style={\r\n          {\r\n            \"--skeleton-width\": width,\r\n          } as React.CSSProperties\r\n        }\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\r\n  return (\r\n    <ul\r\n      data-slot=\"sidebar-menu-sub\"\r\n      data-sidebar=\"menu-sub\"\r\n      className={cn(\r\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarMenuSubItem({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"li\">) {\r\n  return (\r\n    <li\r\n      data-slot=\"sidebar-menu-sub-item\"\r\n      data-sidebar=\"menu-sub-item\"\r\n      className={cn(\"group/menu-sub-item relative\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SidebarMenuSubButton({\r\n  asChild = false,\r\n  size = \"md\",\r\n  isActive = false,\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"a\"> & {\r\n  asChild?: boolean\r\n  size?: \"sm\" | \"md\"\r\n  isActive?: boolean\r\n}) {\r\n  const Comp = asChild ? Slot : \"a\"\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"sidebar-menu-sub-button\"\r\n      data-sidebar=\"menu-sub-button\"\r\n      data-size={size}\r\n      data-active={isActive}\r\n      className={cn(\r\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-bg-2-accent hover:text-sidebar-accent-foreground active:bg-bg-2-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\r\n        \"data-[active=true]:bg-bg-2-accent data-[active=true]:text-sidebar-accent-foreground\",\r\n        size === \"sm\" && \"text-xs\",\r\n        size === \"md\" && \"text-sm\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Sidebar,\r\n  SidebarContent,\r\n  SidebarFooter,\r\n  SidebarGroup,\r\n  SidebarGroupAction,\r\n  SidebarGroupContent,\r\n  SidebarGroupLabel,\r\n  SidebarInput,\r\n  SidebarInset,\r\n  SidebarMenu,\r\n  SidebarMenuAction,\r\n  SidebarMenuBadge,\r\n  SidebarMenuButton,\r\n  SidebarMenuItem,\r\n  SidebarMenuSkeleton,\r\n  SidebarMenuSub,\r\n  SidebarMenuSubButton,\r\n  SidebarMenuSubItem,\r\n  SidebarProvider,\r\n  SidebarRail,\r\n  SidebarSeparator,\r\n  SidebarTrigger,\r\n  useSidebar,\r\n}\r\n","/**\r\n * Authentication Guard Hooks\r\n * Provides easy authentication checks and login prompts for protected actions\r\n */\r\n\r\nimport React, { useCallback } from 'react';\r\nimport { useAuth } from '../contexts/auth-context';\r\nimport { useAuthModal } from '../components/auth/AuthModalProvider';\r\nimport { AuthUser } from '@/api-types';\r\n\r\nexport interface AuthGuardOptions {\r\n  requireFullAuth?: boolean; // If true, anonymous users are not allowed\r\n  actionContext?: string; // Context message for the login modal\r\n  onSuccess?: () => void; // Callback to execute after successful authentication\r\n  intendedUrl?: string; // URL to redirect to after authentication\r\n}\r\n\r\nexport interface AuthGuardReturn {\r\n  isAuthenticated: boolean;\r\n  user: AuthUser | null;\r\n  requireAuth: (options?: AuthGuardOptions) => boolean;\r\n}\r\n\r\n/**\r\n * Hook that provides authentication guard functionality\r\n */\r\nexport function useAuthGuard(): AuthGuardReturn {\r\n  const { isAuthenticated, user } = useAuth();\r\n  const { showAuthModal } = useAuthModal();\r\n\r\n  const requireAuth = useCallback((options: AuthGuardOptions = {}) => {\r\n    // If already authenticated, check if anonymous users are allowed\r\n    if (isAuthenticated) {\r\n      if (options.requireFullAuth && user?.isAnonymous) {\r\n        showAuthModal(options.actionContext, options.onSuccess, options.intendedUrl);\r\n        return false;\r\n      }\r\n      // User is authenticated and meets requirements, execute success callback immediately\r\n      if (options.onSuccess) {\r\n        options.onSuccess();\r\n      }\r\n      return true;\r\n    }\r\n\r\n    // Show login modal with context, pending action, and intended URL\r\n    showAuthModal(options.actionContext, options.onSuccess, options.intendedUrl);\r\n    return false;\r\n  }, [isAuthenticated, user?.isAnonymous, showAuthModal]);\r\n\r\n  return {\r\n    isAuthenticated,\r\n    user,\r\n    requireAuth,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook for action-based authentication guards with configurable context\r\n */\r\nexport function useActionGuard() {\r\n  const authGuard = useAuthGuard();\r\n\r\n  /**\r\n   * Create a guarded action with custom context message\r\n   */\r\n  const createGuardedAction = useCallback(\r\n    (actionContext: string, requireFullAuth: boolean = true) => {\r\n      return (callback: () => void | Promise<void>) => {\r\n        return async () => {\r\n          if (authGuard.requireAuth({ \r\n            requireFullAuth, \r\n            actionContext \r\n          })) {\r\n            await callback();\r\n          }\r\n        };\r\n      };\r\n    },\r\n    [authGuard]\r\n  );\r\n\r\n  /**\r\n   * Execute an action with authentication guard\r\n   */\r\n  const executeWithAuth = useCallback(\r\n    async (\r\n      callback: () => void | Promise<void>,\r\n      options: { \r\n        actionContext?: string, \r\n        requireFullAuth?: boolean \r\n      } = {}\r\n    ) => {\r\n      const { actionContext = '', requireFullAuth = true } = options;\r\n      \r\n      if (authGuard.requireAuth({ requireFullAuth, actionContext })) {\r\n        await callback();\r\n      }\r\n    },\r\n    [authGuard]\r\n  );\r\n\r\n  return {\r\n    ...authGuard,\r\n    createGuardedAction,\r\n    executeWithAuth,\r\n  };\r\n}\r\n\r\n/**\r\n * Higher-order component wrapper for authentication guards\r\n */\r\nexport function withAuthGuard<P extends object>(\r\n  Component: React.ComponentType<P>,\r\n  options: AuthGuardOptions = {}\r\n) {\r\n  return function AuthGuardWrapper(props: P) {\r\n    const { requireAuth } = useAuthGuard();\r\n    \r\n    // Check auth on mount\r\n    const canRender = requireAuth(options);\r\n    \r\n    if (!canRender) {\r\n      return null; // Modal will be shown by useAuthGuard\r\n    }\r\n    \r\n    return React.createElement(Component, props);\r\n  };\r\n}","/**\r\n * Simple event system for app-related events\r\n * Allows different parts of the app to communicate about app state changes\r\n */\r\n\r\nimport { AppWithFavoriteStatus } from \"@/api-types\";\r\n\r\n// Define specific event data types\r\nexport interface AppDeletedEvent {\r\n  type: 'app-deleted';\r\n  appId: string;\r\n}\r\n\r\nexport interface AppCreatedEvent {\r\n  type: 'app-created';\r\n  appId: string;\r\n  data?: {\r\n    title?: string;\r\n    description?: string;\r\n    visibility?: string;\r\n    isForked?: boolean;\r\n  };\r\n}\r\n\r\nexport interface AppUpdatedEvent {\r\n  type: 'app-updated';\r\n  appId: string;\r\n  data?: AppWithFavoriteStatus\r\n}\r\n\r\nexport type AppEvent = AppDeletedEvent | AppCreatedEvent | AppUpdatedEvent;\r\nexport type AppEventType = AppEvent['type'];\r\nexport type AppEventListener = (event: AppEvent) => void;\r\n\r\nclass AppEventEmitter {\r\n  private listeners: Map<AppEventType, Set<AppEventListener>> = new Map();\r\n\r\n  on(eventType: AppEventType, listener: AppEventListener) {\r\n    if (!this.listeners.has(eventType)) {\r\n      this.listeners.set(eventType, new Set());\r\n    }\r\n    this.listeners.get(eventType)!.add(listener);\r\n\r\n    // Return cleanup function\r\n    return () => {\r\n      this.listeners.get(eventType)?.delete(listener);\r\n    };\r\n  }\r\n\r\n  emit(event: AppEvent) {\r\n    const listeners = this.listeners.get(event.type);\r\n    if (listeners) {\r\n      listeners.forEach(listener => {\r\n        try {\r\n          listener(event);\r\n        } catch (error) {\r\n          console.error('Error in app event listener:', error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  // Convenience methods\r\n  emitAppDeleted(appId: string) {\r\n    this.emit({ type: 'app-deleted', appId });\r\n  }\r\n\r\n  emitAppCreated(appId: string, data?: AppCreatedEvent['data']) {\r\n    this.emit({ type: 'app-created', appId, data });\r\n  }\r\n\r\n  emitAppUpdated(appId: string, data?: AppUpdatedEvent['data']) {\r\n    this.emit({ type: 'app-updated', appId, data });\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const appEvents = new AppEventEmitter();","import React, { createContext, useContext, useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { apiClient, ApiError } from '@/lib/api-client';\r\nimport type { AppWithFavoriteStatus } from '@/api-types';\r\nimport { appEvents } from '@/lib/app-events';\r\nimport type { AppEvent, AppDeletedEvent, AppUpdatedEvent } from '@/lib/app-events';\r\nimport { useAuth } from '@/contexts/auth-context';\r\n\r\ninterface AppsDataState {\r\n  allApps: AppWithFavoriteStatus[];\r\n  favoriteApps: AppWithFavoriteStatus[];\r\n  recentApps: AppWithFavoriteStatus[];\r\n  loading: {\r\n    allApps: boolean;\r\n    favoriteApps: boolean;\r\n  };\r\n  error: {\r\n    allApps: string | null;\r\n    favoriteApps: string | null;\r\n  };\r\n  moreRecentAvailable: boolean;\r\n}\r\n\r\ninterface AppsDataContextValue extends AppsDataState {\r\n  refetchAllApps: () => void;\r\n  refetchFavoriteApps: () => void;\r\n  refetchAll: () => void;\r\n}\r\n\r\nconst AppsDataContext = createContext<AppsDataContextValue | null>(null);\r\n\r\nconst RECENT_APPS_LIMIT = 10;\r\n\r\ninterface AppsDataProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport function AppsDataProvider({ children }: AppsDataProviderProps) {\r\n  const { user } = useAuth();\r\n  \r\n  const [state, setState] = useState<AppsDataState>({\r\n    allApps: [],\r\n    favoriteApps: [],\r\n    recentApps: [],\r\n    loading: {\r\n      allApps: true,\r\n      favoriteApps: true,\r\n    },\r\n    error: {\r\n      allApps: null,\r\n      favoriteApps: null,\r\n    },\r\n    moreRecentAvailable: false,\r\n  });\r\n\r\n  // Compute recent apps from all apps to avoid duplicate API calls\r\n  const computeRecentApps = useCallback((apps: AppWithFavoriteStatus[]) => {\r\n    const sortedApps = [...apps].sort((a, b) => {\r\n      const aTime = a.updatedAt ? new Date(a.updatedAt).getTime() : 0;\r\n      const bTime = b.updatedAt ? new Date(b.updatedAt).getTime() : 0;\r\n      return bTime - aTime;\r\n    });\r\n    \r\n    return {\r\n      recentApps: sortedApps.slice(0, RECENT_APPS_LIMIT),\r\n      moreRecentAvailable: sortedApps.length > RECENT_APPS_LIMIT,\r\n    };\r\n  }, []);\r\n\r\n  // Fetch all apps\r\n  const fetchAllApps = useCallback(async () => {\r\n    if (!user) {\r\n      setState(prev => ({\r\n        ...prev,\r\n        allApps: [],\r\n        ...computeRecentApps([]),\r\n        loading: { ...prev.loading, allApps: false },\r\n        error: { ...prev.error, allApps: null },\r\n      }));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setState(prev => ({\r\n        ...prev,\r\n        loading: { ...prev.loading, allApps: true },\r\n        error: { ...prev.error, allApps: null },\r\n      }));\r\n\r\n      const response = await apiClient.getUserApps();\r\n      \r\n      if (response.success) {\r\n        const apps = response.data?.apps || [];\r\n        const { recentApps, moreRecentAvailable } = computeRecentApps(apps);\r\n        \r\n        setState(prev => ({\r\n          ...prev,\r\n          allApps: apps,\r\n          recentApps,\r\n          moreRecentAvailable,\r\n          loading: { ...prev.loading, allApps: false },\r\n        }));\r\n      } else {\r\n        setState(prev => ({\r\n          ...prev,\r\n          loading: { ...prev.loading, allApps: false },\r\n          error: { ...prev.error, allApps: response.error?.message || 'Failed to fetch apps' },\r\n        }));\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching all apps:', err);\r\n      const errorMessage = err instanceof ApiError \r\n        ? `${err.message} (${err.status})`\r\n        : err instanceof Error ? err.message : 'Failed to fetch apps';\r\n      \r\n      setState(prev => ({\r\n        ...prev,\r\n        loading: { ...prev.loading, allApps: false },\r\n        error: { ...prev.error, allApps: errorMessage },\r\n      }));\r\n    }\r\n  }, [user, computeRecentApps]);\r\n\r\n  // Fetch favorite apps\r\n  const fetchFavoriteApps = useCallback(async () => {\r\n    if (!user) {\r\n      setState(prev => ({\r\n        ...prev,\r\n        favoriteApps: [],\r\n        loading: { ...prev.loading, favoriteApps: false },\r\n        error: { ...prev.error, favoriteApps: null },\r\n      }));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setState(prev => ({\r\n        ...prev,\r\n        loading: { ...prev.loading, favoriteApps: true },\r\n        error: { ...prev.error, favoriteApps: null },\r\n      }));\r\n\r\n      const response = await apiClient.getFavoriteApps();\r\n      \r\n      if (response.success) {\r\n        setState(prev => ({\r\n          ...prev,\r\n          favoriteApps: response.data?.apps || [],\r\n          loading: { ...prev.loading, favoriteApps: false },\r\n        }));\r\n      } else {\r\n        setState(prev => ({\r\n          ...prev,\r\n          loading: { ...prev.loading, favoriteApps: false },\r\n          error: { ...prev.error, favoriteApps: response.error?.message || 'Failed to fetch favorite apps' },\r\n        }));\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching favorite apps:', err);\r\n      const errorMessage = err instanceof ApiError\r\n        ? `${err.message} (${err.status})`\r\n        : err instanceof Error ? err.message : 'Failed to fetch favorite apps';\r\n      \r\n      setState(prev => ({\r\n        ...prev,\r\n        loading: { ...prev.loading, favoriteApps: false },\r\n        error: { ...prev.error, favoriteApps: errorMessage },\r\n      }));\r\n    }\r\n  }, [user]);\r\n\r\n  // Parallel fetch both data sets\r\n  const fetchAll = useCallback(async () => {\r\n    if (!user) return;\r\n    \r\n    // Execute both API calls in parallel\r\n    await Promise.all([\r\n      fetchAllApps(),\r\n      fetchFavoriteApps(),\r\n    ]);\r\n  }, [user, fetchAllApps, fetchFavoriteApps]);\r\n\r\n  // Initial data load with parallel fetching\r\n  useEffect(() => {\r\n    fetchAll();\r\n  }, [fetchAll]);\r\n\r\n  // Event handlers for real-time updates\r\n  useEffect(() => {\r\n    const onDeleted = (event: AppEvent) => {\r\n      if (event.type === 'app-deleted') {\r\n        const deletedEvent = event as AppDeletedEvent;\r\n        setState(prev => {\r\n          const filteredAllApps = prev.allApps.filter(app => app.id !== deletedEvent.appId);\r\n          const filteredFavoriteApps = prev.favoriteApps.filter(app => app.id !== deletedEvent.appId);\r\n          const { recentApps, moreRecentAvailable } = computeRecentApps(filteredAllApps);\r\n          \r\n          return {\r\n            ...prev,\r\n            allApps: filteredAllApps,\r\n            favoriteApps: filteredFavoriteApps,\r\n            recentApps,\r\n            moreRecentAvailable,\r\n          };\r\n        });\r\n      }\r\n    };\r\n    \r\n    const onCreated = () => {\r\n      // Refetch all data when new app is created\r\n      fetchAll();\r\n    };\r\n    \r\n    const onUpdated = (event: AppEvent) => {\r\n      if (event.type === 'app-updated') {\r\n        const updatedEvent = event as AppUpdatedEvent;\r\n        if (updatedEvent.data) {\r\n          setState(prev => {\r\n            // Update all apps\r\n            const updatedAllApps = prev.allApps.map(app => \r\n              app.id === updatedEvent.appId \r\n                ? { ...app, ...updatedEvent.data, updatedAt: new Date() }\r\n                : app\r\n            );\r\n            \r\n            // Update favorite apps if present\r\n            const updatedFavoriteApps = prev.favoriteApps.map(app =>\r\n              app.id === updatedEvent.appId\r\n                ? { ...app, ...updatedEvent.data, updatedAt: new Date() }\r\n                : app\r\n            );\r\n            \r\n            // Recompute recent apps with updated data\r\n            const { recentApps, moreRecentAvailable } = computeRecentApps(updatedAllApps);\r\n            \r\n            return {\r\n              ...prev,\r\n              allApps: updatedAllApps,\r\n              favoriteApps: updatedFavoriteApps,\r\n              recentApps,\r\n              moreRecentAvailable,\r\n            };\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    const unsubscribeDeleted = appEvents.on('app-deleted', onDeleted);\r\n    const unsubscribeCreated = appEvents.on('app-created', onCreated);\r\n    const unsubscribeUpdated = appEvents.on('app-updated', onUpdated);\r\n\r\n    return () => {\r\n      unsubscribeDeleted();\r\n      unsubscribeCreated();\r\n      unsubscribeUpdated();\r\n    };\r\n  }, [fetchAll, computeRecentApps]);\r\n\r\n  const contextValue = useMemo<AppsDataContextValue>(() => ({\r\n    ...state,\r\n    refetchAllApps: fetchAllApps,\r\n    refetchFavoriteApps: fetchFavoriteApps,\r\n    refetchAll: fetchAll,\r\n  }), [state, fetchAllApps, fetchFavoriteApps, fetchAll]);\r\n\r\n  return (\r\n    <AppsDataContext.Provider value={contextValue}>\r\n      {children}\r\n    </AppsDataContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAppsData() {\r\n  const context = useContext(AppsDataContext);\r\n  if (!context) {\r\n    throw new Error('useAppsData must be used within an AppsDataProvider');\r\n  }\r\n  return context;\r\n}\r\n","import { apiClient, ApiError } from '@/lib/api-client';\r\nimport type { AppWithFavoriteStatus } from '@/api-types';\r\nimport { useAuthGuard } from './useAuthGuard';\r\nimport { useAppsData } from '@/contexts/apps-data-context';\r\n\r\ninterface AppHookState<T> {\r\n  apps: T[];\r\n  loading: boolean;\r\n  error: string | null;\r\n  refetch: () => void;\r\n}\r\n\r\n\r\nexport function useApps(): AppHookState<AppWithFavoriteStatus> {\r\n  const { allApps, loading, error, refetchAllApps } = useAppsData();\r\n  \r\n  return {\r\n    apps: allApps,\r\n    loading: loading.allApps,\r\n    error: error.allApps,\r\n    refetch: refetchAllApps,\r\n  };\r\n}\r\n\r\nexport function useRecentApps() {\r\n  const { recentApps, moreRecentAvailable, loading, error, refetchAllApps } = useAppsData();\r\n  \r\n  return { \r\n    apps: recentApps, \r\n    moreAvailable: moreRecentAvailable,\r\n    loading: loading.allApps, \r\n    error: error.allApps, \r\n    refetch: refetchAllApps\r\n  };\r\n}\r\n\r\nexport function useFavoriteApps(): AppHookState<AppWithFavoriteStatus> {\r\n  const { favoriteApps, loading, error, refetchFavoriteApps } = useAppsData();\r\n  \r\n  return {\r\n    apps: favoriteApps,\r\n    loading: loading.favoriteApps,\r\n    error: error.favoriteApps,\r\n    refetch: refetchFavoriteApps,\r\n  };\r\n}\r\n\r\n\r\nexport async function toggleFavorite(appId: string): Promise<boolean> {\r\n  try {\r\n    const response = await apiClient.toggleFavorite(appId);\r\n    if (response.success && response.data) {\r\n      return response.data.isFavorite;\r\n    }\r\n    throw new Error(response.error?.message || 'Failed to toggle favorite');\r\n  } catch (err) {\r\n    if (err instanceof ApiError) {\r\n      throw new Error(`Failed to toggle favorite: ${err.message}`);\r\n    }\r\n    throw err;\r\n  }\r\n}\r\n\r\n/**\r\n * Hook for protected toggle favorite functionality\r\n */\r\nexport function useToggleFavorite() {\r\n  const { requireAuth } = useAuthGuard();\r\n\r\n  const protectedToggleFavorite = async (appId: string, actionContext = 'to favorite this app'): Promise<boolean | null> => {\r\n    if (!requireAuth({ \r\n      requireFullAuth: true, \r\n      actionContext \r\n    })) {\r\n      return null;\r\n    }\r\n\r\n    return await toggleFavorite(appId);\r\n  };\r\n\r\n  return { toggleFavorite: protectedToggleFavorite };\r\n}","\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction ScrollArea({\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\r\n  return (\r\n    <ScrollAreaPrimitive.Root\r\n      data-slot=\"scroll-area\"\r\n      className={cn(\"relative\", className)}\r\n      {...props}\r\n    >\r\n      <ScrollAreaPrimitive.Viewport\r\n        data-slot=\"scroll-area-viewport\"\r\n        className=\"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1 [&>div]:!block [&>div]:!w-full\"\r\n      >\r\n        {children}\r\n      </ScrollAreaPrimitive.Viewport>\r\n      <ScrollBar />\r\n      <ScrollAreaPrimitive.Corner />\r\n    </ScrollAreaPrimitive.Root>\r\n  )\r\n}\r\n\r\nfunction ScrollBar({\r\n  className,\r\n  orientation = \"vertical\",\r\n  ...props\r\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\r\n  return (\r\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\r\n      data-slot=\"scroll-area-scrollbar\"\r\n      orientation={orientation}\r\n      className={cn(\r\n        \"flex touch-none p-px transition-colors select-none\",\r\n        orientation === \"vertical\" &&\r\n          \"h-full w-2.5 border-l border-l-transparent\",\r\n        orientation === \"horizontal\" &&\r\n          \"h-2.5 flex-col border-t border-t-transparent\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <ScrollAreaPrimitive.ScrollAreaThumb\r\n        data-slot=\"scroll-area-thumb\"\r\n        className=\"bg-border relative flex-1 rounded-full\"\r\n      />\r\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\r\n  )\r\n}\r\n\r\nexport { ScrollArea, ScrollBar }\r\n","\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\r\nimport { CheckIcon, ChevronRightIcon, CircleIcon } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction DropdownMenu({\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {\r\n  return <DropdownMenuPrimitive.Root data-slot=\"dropdown-menu\" {...props} />\r\n}\r\n\r\nfunction DropdownMenuPortal({\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {\r\n  return (\r\n    <DropdownMenuPrimitive.Portal data-slot=\"dropdown-menu-portal\" {...props} />\r\n  )\r\n}\r\n\r\nfunction DropdownMenuTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {\r\n  return (\r\n    <DropdownMenuPrimitive.Trigger\r\n      data-slot=\"dropdown-menu-trigger\"\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DropdownMenuContent({\r\n  className,\r\n  sideOffset = 4,\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {\r\n  return (\r\n    <DropdownMenuPrimitive.Portal>\r\n      <DropdownMenuPrimitive.Content\r\n        data-slot=\"dropdown-menu-content\"\r\n        sideOffset={sideOffset}\r\n        className={cn(\r\n          \"bg-bg-4 text-text-primary data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md\",\r\n          className\r\n        )}\r\n        {...props}\r\n      />\r\n    </DropdownMenuPrimitive.Portal>\r\n  )\r\n}\r\n\r\nfunction DropdownMenuGroup({\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {\r\n  return (\r\n    <DropdownMenuPrimitive.Group data-slot=\"dropdown-menu-group\" {...props} />\r\n  )\r\n}\r\n\r\nfunction DropdownMenuItem({\r\n  className,\r\n  inset,\r\n  variant = \"default\",\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {\r\n  inset?: boolean\r\n  variant?: \"default\" | \"destructive\"\r\n}) {\r\n  return (\r\n    <DropdownMenuPrimitive.Item\r\n      data-slot=\"dropdown-menu-item\"\r\n      data-inset={inset}\r\n      data-variant={variant}\r\n      className={cn(\r\n        \"focus:bg-accent focus:text-text-secondary data-[variant=destructive]:text-destructive  data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-text-tertiary relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DropdownMenuCheckboxItem({\r\n  className,\r\n  children,\r\n  checked,\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {\r\n  return (\r\n    <DropdownMenuPrimitive.CheckboxItem\r\n      data-slot=\"dropdown-menu-checkbox-item\"\r\n      className={cn(\r\n        \"focus:bg-accent focus:text-text-secondary relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className\r\n      )}\r\n      checked={checked}\r\n      {...props}\r\n    >\r\n      <span className=\"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center\">\r\n        <DropdownMenuPrimitive.ItemIndicator>\r\n          <CheckIcon className=\"size-4\" />\r\n        </DropdownMenuPrimitive.ItemIndicator>\r\n      </span>\r\n      {children}\r\n    </DropdownMenuPrimitive.CheckboxItem>\r\n  )\r\n}\r\n\r\nfunction DropdownMenuRadioGroup({\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {\r\n  return (\r\n    <DropdownMenuPrimitive.RadioGroup\r\n      data-slot=\"dropdown-menu-radio-group\"\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DropdownMenuRadioItem({\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {\r\n  return (\r\n    <DropdownMenuPrimitive.RadioItem\r\n      data-slot=\"dropdown-menu-radio-item\"\r\n      className={cn(\r\n        \"focus:bg-accent focus:text-text-secondary relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <span className=\"pointer-events-none absolute left-2 flex size-3.5 items-center justify-center\">\r\n        <DropdownMenuPrimitive.ItemIndicator>\r\n          <CircleIcon className=\"size-2 fill-current\" />\r\n        </DropdownMenuPrimitive.ItemIndicator>\r\n      </span>\r\n      {children}\r\n    </DropdownMenuPrimitive.RadioItem>\r\n  )\r\n}\r\n\r\nfunction DropdownMenuLabel({\r\n  className,\r\n  inset,\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {\r\n  inset?: boolean\r\n}) {\r\n  return (\r\n    <DropdownMenuPrimitive.Label\r\n      data-slot=\"dropdown-menu-label\"\r\n      data-inset={inset}\r\n      className={cn(\r\n        \"px-2 py-1.5 text-sm font-medium data-[inset]:pl-8\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DropdownMenuSeparator({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {\r\n  return (\r\n    <DropdownMenuPrimitive.Separator\r\n      data-slot=\"dropdown-menu-separator\"\r\n      className={cn(\"bg-border -mx-1 my-1 h-px\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DropdownMenuSub({\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {\r\n  return <DropdownMenuPrimitive.Sub data-slot=\"dropdown-menu-sub\" {...props} />\r\n}\r\n\r\nfunction DropdownMenuSubTrigger({\r\n  className,\r\n  inset,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {\r\n  inset?: boolean\r\n}) {\r\n  return (\r\n    <DropdownMenuPrimitive.SubTrigger\r\n      data-slot=\"dropdown-menu-sub-trigger\"\r\n      data-inset={inset}\r\n      className={cn(\r\n        \"focus:bg-accent focus:text-text-secondary data-[state=open]:bg-accent data-[state=open]:text-text-secondary flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      {children}\r\n      <ChevronRightIcon className=\"ml-auto size-4\" />\r\n    </DropdownMenuPrimitive.SubTrigger>\r\n  )\r\n}\r\n\r\nfunction DropdownMenuSubContent({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {\r\n  return (\r\n    <DropdownMenuPrimitive.SubContent\r\n      data-slot=\"dropdown-menu-sub-content\"\r\n      className={cn(\r\n        \"bg-bg-4 text-text-primary data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  DropdownMenu,\r\n  DropdownMenuPortal,\r\n  DropdownMenuTrigger,\r\n  DropdownMenuContent,\r\n  DropdownMenuGroup,\r\n  DropdownMenuLabel,\r\n  DropdownMenuItem,\r\n  DropdownMenuCheckboxItem,\r\n  DropdownMenuRadioGroup,\r\n  DropdownMenuRadioItem,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuSub,\r\n  DropdownMenuSubTrigger,\r\n  DropdownMenuSubContent,\r\n}\r\n","\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { buttonVariants } from \"@/components/ui/button\"\r\n\r\nfunction AlertDialog({\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Root>) {\r\n  return <AlertDialogPrimitive.Root data-slot=\"alert-dialog\" {...props} />\r\n}\r\n\r\nfunction AlertDialogTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Trigger>) {\r\n  return (\r\n    <AlertDialogPrimitive.Trigger data-slot=\"alert-dialog-trigger\" {...props} />\r\n  )\r\n}\r\n\r\nfunction AlertDialogPortal({\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Portal>) {\r\n  return (\r\n    <AlertDialogPrimitive.Portal data-slot=\"alert-dialog-portal\" {...props} />\r\n  )\r\n}\r\n\r\nfunction AlertDialogOverlay({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Overlay>) {\r\n  return (\r\n    <AlertDialogPrimitive.Overlay\r\n      data-slot=\"alert-dialog-overlay\"\r\n      className={cn(\r\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogContent({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Content>) {\r\n  return (\r\n    <AlertDialogPortal>\r\n      <AlertDialogOverlay />\r\n      <AlertDialogPrimitive.Content\r\n        data-slot=\"alert-dialog-content\"\r\n        className={cn(\r\n          \"bg-bg-3 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg\",\r\n          className\r\n        )}\r\n        {...props}\r\n      />\r\n    </AlertDialogPortal>\r\n  )\r\n}\r\n\r\nfunction AlertDialogHeader({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert-dialog-header\"\r\n      className={cn(\"flex flex-col gap-2 text-center sm:text-left\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogFooter({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert-dialog-footer\"\r\n      className={cn(\r\n        \"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogTitle({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Title>) {\r\n  return (\r\n    <AlertDialogPrimitive.Title\r\n      data-slot=\"alert-dialog-title\"\r\n      className={cn(\"text-lg font-semibold\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogDescription({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Description>) {\r\n  return (\r\n    <AlertDialogPrimitive.Description\r\n      data-slot=\"alert-dialog-description\"\r\n      className={cn(\"text-text-tertiary text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogAction({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Action>) {\r\n  return (\r\n    <AlertDialogPrimitive.Action\r\n      className={cn(buttonVariants(), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDialogCancel({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AlertDialogPrimitive.Cancel>) {\r\n  return (\r\n    <AlertDialogPrimitive.Cancel\r\n      className={cn(buttonVariants({ variant: \"outline\" }), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  AlertDialog,\r\n  AlertDialogPortal,\r\n  AlertDialogOverlay,\r\n  AlertDialogTrigger,\r\n  AlertDialogContent,\r\n  AlertDialogHeader,\r\n  AlertDialogFooter,\r\n  AlertDialogTitle,\r\n  AlertDialogDescription,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n}\r\n","import {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from '@/components/ui/alert-dialog';\r\nimport { Trash2, AlertTriangle, Loader2 } from 'lucide-react';\r\n\r\ninterface ConfirmDeleteDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  onConfirm: () => Promise<void> | void;\r\n  title?: string;\r\n  description?: string;\r\n  isLoading?: boolean;\r\n  appTitle?: string;\r\n}\r\n\r\nexport function ConfirmDeleteDialog({\r\n  open,\r\n  onOpenChange,\r\n  onConfirm,\r\n  title = \"Delete App\",\r\n  description,\r\n  isLoading = false,\r\n  appTitle\r\n}: ConfirmDeleteDialogProps) {\r\n  const defaultDescription = appTitle \r\n    ? `Are you sure you want to delete \"${appTitle}\"? This action cannot be undone and all associated data will be permanently removed.`\r\n    : 'Are you sure you want to delete this app? This action cannot be undone and all associated data will be permanently removed.';\r\n\r\n  const handleConfirm = async (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n    await onConfirm();\r\n    // Don't auto-close here, let the parent handle the success/error states\r\n  };\r\n\r\n  return (\r\n    <AlertDialog open={open} onOpenChange={onOpenChange}>\r\n      <AlertDialogContent className=\"sm:max-w-[425px]\">\r\n        <AlertDialogHeader>\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-destructive/10\">\r\n              <AlertTriangle className=\"h-5 w-5 text-destructive\" />\r\n            </div>\r\n            <div className=\"flex-1\">\r\n              <AlertDialogTitle className=\"text-left\">{title}</AlertDialogTitle>\r\n            </div>\r\n          </div>\r\n          <AlertDialogDescription className=\"text-left pt-2\">\r\n            {description || defaultDescription}\r\n          </AlertDialogDescription>\r\n        </AlertDialogHeader>\r\n        <AlertDialogFooter>\r\n          <AlertDialogCancel disabled={isLoading}>\r\n            Cancel\r\n          </AlertDialogCancel>\r\n          <AlertDialogAction\r\n            onClick={handleConfirm}\r\n            disabled={isLoading}\r\n            className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90 focus:ring-destructive\"\r\n          >\r\n            {isLoading ? (\r\n              <>\r\n                <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\r\n                Deleting...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Trash2 className=\"h-4 w-4 mr-2\" />\r\n                Delete App\r\n              </>\r\n            )}\r\n          </AlertDialogAction>\r\n        </AlertDialogFooter>\r\n      </AlertDialogContent>\r\n    </AlertDialog>\r\n  );\r\n}","import { useState } from 'react';\r\nimport { MoreVertical, Trash2 } from 'lucide-react';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu';\r\nimport { Button } from '@/components/ui/button';\r\nimport { ConfirmDeleteDialog } from './ConfirmDeleteDialog';\r\nimport { apiClient } from '@/lib/api-client';\r\nimport { toast } from 'sonner';\r\nimport { appEvents } from '@/lib/app-events';\r\n\r\ninterface AppActionsDropdownProps {\r\n  appId: string;\r\n  appTitle: string;\r\n  onAppDeleted?: () => void;\r\n  className?: string;\r\n  variant?: 'default' | 'ghost';\r\n  size?: 'default' | 'sm' | 'icon';\r\n  showOnHover?: boolean;\r\n}\r\n\r\nexport function AppActionsDropdown({\r\n  appId,\r\n  appTitle,\r\n  onAppDeleted,\r\n  className = '',\r\n  variant = 'ghost',\r\n  size = 'icon',\r\n  showOnHover = false\r\n}: AppActionsDropdownProps) {\r\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n\r\n  const handleDeleteApp = async () => {\r\n    try {\r\n      setIsDeleting(true);\r\n      const response = await apiClient.deleteApp(appId);\r\n      \r\n      if (response.success) {\r\n        toast.success('App deleted successfully');\r\n        setIsDeleteDialogOpen(false);\r\n        \r\n        appEvents.emitAppDeleted(appId);\r\n        onAppDeleted?.();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting app:', error);\r\n      toast.error('An unexpected error occurred while deleting the app');\r\n    } finally {\r\n      setIsDeleting(false);\r\n    }\r\n  };\r\n\r\n  const buttonClasses = showOnHover \r\n    ? `opacity-0 group-hover:opacity-100 transition-all duration-200 hover:bg-bg-3/80 cursor-pointer ${className}`\r\n    : `hover:bg-bg-3/80 cursor-pointer ${className}`;\r\n\r\n  return (\r\n    <>\r\n      <DropdownMenu>\r\n        <DropdownMenuTrigger asChild>\r\n          <Button\r\n            variant={variant}\r\n            size={size}\r\n            className={buttonClasses}\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              e.preventDefault();\r\n            }}\r\n          >\r\n            <MoreVertical className=\"h-4 w-4\" />\r\n            <span className=\"sr-only\">App actions</span>\r\n          </Button>\r\n        </DropdownMenuTrigger>\r\n        <DropdownMenuContent align=\"end\" className=\"w-48\">\r\n          <DropdownMenuItem\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              e.preventDefault();\r\n              setIsDeleteDialogOpen(true);\r\n            }}\r\n            className=\"text-destructive focus:text-destructive focus:bg-destructive/10\"\r\n          >\r\n            <Trash2 className=\"h-4 w-4 mr-2\" />\r\n            Delete app\r\n          </DropdownMenuItem>\r\n          {/* Future: Add Share option here */}\r\n        </DropdownMenuContent>\r\n      </DropdownMenu>\r\n\r\n      <ConfirmDeleteDialog\r\n        open={isDeleteDialogOpen}\r\n        onOpenChange={setIsDeleteDialogOpen}\r\n        onConfirm={handleDeleteApp}\r\n        isLoading={isDeleting}\r\n        appTitle={appTitle}\r\n      />\r\n    </>\r\n  );\r\n}","import React from 'react';\r\nimport {\r\n\tUsers,\r\n\tSettings,\r\n\tPlus,\r\n\tChevronRight,\r\n\tSearch,\r\n\tGlobe,\r\n\tLock,\r\n\tUsers2,\r\n\tBookmark,\r\n\t// LayoutGrid,\r\n\tCompass,\r\n} from 'lucide-react';\r\nimport './sidebar-overrides.css';\r\nimport { useRecentApps, useFavoriteApps, useApps } from '@/hooks/use-apps';\r\nimport {\r\n\tSidebar,\r\n\tSidebarContent,\r\n\tSidebarGroup,\r\n\tSidebarGroupContent,\r\n\tSidebarGroupLabel,\r\n\tSidebarMenu,\r\n\tSidebarMenuItem,\r\n\tSidebarMenuButton,\r\n\tSidebarMenuAction,\r\n\tSidebarSeparator,\r\n\tSidebarFooter,\r\n\tuseSidebar,\r\n} from '@/components/ui/sidebar';\r\nimport { Input } from '@/components/ui/input';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { useAuth } from '@/contexts/auth-context';\r\nimport { useNavigate } from 'react-router';\r\nimport { cn } from '@/lib/utils';\r\nimport {\r\n\tTooltip,\r\n\tTooltipContent,\r\n\tTooltipProvider,\r\n\tTooltipTrigger,\r\n} from '@/components/ui/tooltip';\r\nimport { formatDistanceToNow, isValid } from 'date-fns';\r\nimport { AppActionsDropdown } from '@/components/shared/AppActionsDropdown';\r\n\r\ninterface App {\r\n\tid: string;\r\n\ttitle: string;\r\n\tframework?: string | null;\r\n\tupdatedAt: Date | null;\r\n\tupdatedAtFormatted?: string;\r\n\tvisibility: 'private' | 'team' | 'board' | 'public';\r\n\tisFavorite?: boolean;\r\n}\r\n\r\ninterface Board {\r\n\tid: string;\r\n\tname: string;\r\n\tslug: string;\r\n\tmemberCount: number;\r\n\tappCount: number;\r\n\ticonUrl?: string | null;\r\n}\r\n\r\n// Reusable AppMenuItem component for consistent app display\r\ninterface AppMenuItemProps {\r\n\tapp: App;\r\n\tonClick: (id: string) => void;\r\n\tvariant?: 'recent' | 'bookmarked';\r\n\tshowActions?: boolean;\r\n\tisCollapsed: boolean;\r\n\tgetVisibilityIcon: (visibility: App['visibility']) => React.ReactNode;\r\n}\r\n\r\nfunction AppMenuItem({\r\n\tapp,\r\n\tonClick,\r\n\tvariant = 'recent',\r\n\tshowActions = true,\r\n\tisCollapsed,\r\n\tgetVisibilityIcon,\r\n}: AppMenuItemProps) {\r\n\tconst formatTimestamp = () => {\r\n\t\tif (app.updatedAtFormatted) return app.updatedAtFormatted;\r\n\t\tif (app.updatedAt && isValid(app.updatedAt)) {\r\n\t\t\treturn formatDistanceToNow(app.updatedAt, { addSuffix: true });\r\n\t\t}\r\n\t\treturn 'Recently';\r\n\t};\r\n\r\n\treturn (\r\n\t\t<SidebarMenuItem className=\"group/app-item\">\r\n\t\t\t<SidebarMenuButton\r\n\t\t\t\tasChild\r\n\t\t\t\ttooltip={app.title}\r\n\t\t\t\tclassName=\"cursor-pointer transition-opacity hover:opacity-75 pr-0\"\r\n\t\t\t>\r\n\t\t\t\t<a\r\n\t\t\t\t\thref={`/app/${app.id}`}\r\n\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tonClick(app.id);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tclassName=\"w-full no-underline\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div className=\"flex-1 min-w-0 pr-2\">\r\n\t\t\t\t\t\t<div className=\"flex items-center gap-2 min-w-0\">\r\n\t\t\t\t\t\t\t{variant === 'bookmarked' && (\r\n\t\t\t\t\t\t\t\t<Bookmark className=\"h-3 w-3 fill-yellow-500 text-yellow-500 flex-shrink-0\" />\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t<div className=\"relative flex-1 min-w-0 overflow-hidden\">\r\n\t\t\t\t\t\t\t\t<span className=\"font-medium flex justify-start  items-center  gap-2 text-text-primary/80 whitespace-nowrap\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-ellipsis w-fit overflow-hidden\">\r\n\t\t\t\t\t\t\t\t\t\t{app.title}{' '}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0 min-w-6\">\r\n\t\t\t\t\t\t\t\t\t\t{getVisibilityIcon(app.visibility)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t<div className=\"absolute inset-y-0 right-0 w-4 bg-gradient-to-l from-bg-2 to-transparent pointer-events-none\" />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<p className=\"text-xs text-text-tertiary truncate\">\r\n\t\t\t\t\t\t\t{formatTimestamp()}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</a>\r\n\t\t\t</SidebarMenuButton>\r\n\r\n\t\t\t{!isCollapsed && showActions && (\r\n\t\t\t\t<SidebarMenuAction\r\n\t\t\t\t\tasChild\r\n\t\t\t\t\tclassName=\"opacity-0 -mr-2 group-hover/app-item:opacity-100 transition-opacity\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<AppActionsDropdown\r\n\t\t\t\t\t\tappId={app.id}\r\n\t\t\t\t\t\tappTitle={app.title}\r\n\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\tclassName=\"h-6 w-6\"\r\n\t\t\t\t\t\tshowOnHover={false}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</SidebarMenuAction>\r\n\t\t\t)}\r\n\t\t</SidebarMenuItem>\r\n\t);\r\n}\r\n\r\nexport function AppSidebar() {\r\n\tconst { user } = useAuth();\r\n\tconst navigate = useNavigate();\r\n\tconst [searchQuery, setSearchQuery] = React.useState('');\r\n\tconst [expandedGroups, setExpandedGroups] = React.useState<string[]>([\r\n\t\t'apps',\r\n\t\t'boards',\r\n\t]);\r\n\tconst { state, setOpen } = useSidebar();\r\n\tconst isCollapsed = state === 'collapsed';\r\n\r\n\t// Fetch real data from API\r\n\tconst { apps: recentApps, moreAvailable } = useRecentApps();\r\n\tconst { apps: favoriteApps } = useFavoriteApps();\r\n\tconst { apps: allApps, loading: allAppsLoading } = useApps();\r\n\r\n\tconst boards: Board[] = []; // Remove mock boards\r\n\r\n\t// Search functionality - filter all apps based on search query\r\n\tconst searchResults = React.useMemo(() => {\r\n\t\tif (!searchQuery.trim()) return [];\r\n\r\n\t\treturn allApps.filter((app) =>\r\n\t\t\tapp.title.toLowerCase().includes(searchQuery.toLowerCase().trim()),\r\n\t\t);\r\n\t}, [allApps, searchQuery]);\r\n\r\n\tconst isSearching = searchQuery.trim().length > 0;\r\n\r\n\tconst getVisibilityIcon = (visibility: App['visibility']) => {\r\n\t\tswitch (visibility) {\r\n\t\t\tcase 'private':\r\n\t\t\t\treturn <Lock className=\"h-3 w-3\" />;\r\n\t\t\tcase 'team':\r\n\t\t\t\treturn <Users2 className=\"h-3 w-3\" />;\r\n\t\t\tcase 'board':\r\n\t\t\t\treturn <Globe className=\"h-3 w-3\" />;\r\n\t\t\tcase 'public':\r\n\t\t\t\treturn <Globe className=\"h-3 w-3\" />;\r\n\t\t}\r\n\t};\r\n\r\n\tconst toggleGroup = (group: string) => {\r\n\t\tsetExpandedGroups((prev) =>\r\n\t\t\tprev.includes(group)\r\n\t\t\t\t? prev.filter((g) => g !== group)\r\n\t\t\t\t: [...prev, group],\r\n\t\t);\r\n\t};\r\n\r\n\tif (!user) return;\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Sidebar\r\n\t\t\t\tcollapsible=\"icon\"\r\n\t\t\t\tclassName={cn(\r\n\t\t\t\t\t'bg-bg-2 transition-all duration-300 ease-in-out',\r\n\t\t\t\t)}\r\n\t\t\t>\r\n\t\t\t\t<SidebarContent className=\"mt-2\">\r\n\t\t\t\t\t{/* Build Button */}\r\n\t\t\t\t\t<SidebarGroup>\r\n\t\t\t\t\t\t<SidebarGroupContent>\r\n\t\r\n\t\t\t\t\t\t\t{location.pathname !== '/' && (\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\tisCollapsed ? ' pr-2' : 'px-1',\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<TooltipProvider delayDuration={0}>\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t\t<TooltipTrigger asChild>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'group flex w-full border-[0.5px] border-bg-2 items-center gap-2 font-medium hover:opacity-80 hover:cursor-pointer p-2 rounded-md cursor-hand text-text-secondary hover:text-text-primary',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisCollapsed\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'justify-center bg-accent'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'justify-start bg-accent',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Collapse sidebar when starting a new build\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (!isCollapsed) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetOpen(false);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigate('/');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Plus className=\"h-4 w-4 text-neutral-50\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{!isCollapsed && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-neutral-50\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tNew build\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t</TooltipTrigger>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t</TooltipProvider>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</SidebarGroupContent>\r\n\t\t\t\t\t</SidebarGroup>\r\n\r\n\t\t\t\t\t{!isCollapsed && (\r\n\t\t\t\t\t\t<ScrollArea className=\"flex-1 px-1 relative\">\r\n\t\t\t\t\t\t\t{/* Gradient fade overlay for app names at sidebar edge */}\r\n\t\t\t\t\t\t\t<div className=\"absolute inset-y-0 right-0 w-8 bg-gradient-to-l from-bg-2 to-transparent pointer-events-none z-10\"></div>\r\n\t\t\t\t\t\t\t{/* Navigation */}\r\n\t\t\t\t\t\t\t<SidebarGroup>\r\n\t\t\t\t\t\t\t\t{expandedGroups.includes('apps') && (\r\n\t\t\t\t\t\t\t\t\t<SidebarGroupContent>\r\n\t\t\t\t\t\t\t\t\t\t{/* Search */}\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"relative bg-bg-3 mb-4 mt-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Search className=\"absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-text-tertiary\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<Input\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Search apps...\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={searchQuery}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetSearchQuery(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.target.value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-10 w-full pl-8 placeholder:text-primary/40\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<SidebarMenu>\r\n\t\t\t\t\t\t\t\t\t\t\t{isSearching ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t// Search Results\r\n\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{allAppsLoading ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center py-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tSearching...\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : searchResults.length >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t  0 ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"px-2 py-1 text-xs text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tFound{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsearchResults.length\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tapp\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{searchResults.length !==\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 's'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{searchResults.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(app) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AppMenuItem\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tapp.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tapp={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tapp\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigate(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`/app/${id}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"recent\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowActions={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisCollapsed={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisCollapsed\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetVisibilityIcon={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetVisibilityIcon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center py-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tNo apps\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfound for \"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsearchQuery\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t// Normal Recent Apps View\r\n\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{recentApps.map((app) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AppMenuItem\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={app.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tapp={app}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(id) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigate(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`/app/${id}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"recent\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowActions={true}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisCollapsed={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisCollapsed\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetVisibilityIcon={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetVisibilityIcon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{moreAvailable && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SidebarMenuButton\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigate(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'/apps',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"View all apps\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-text-tertiary hover:text-text-primary view-all-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronRight className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!isCollapsed && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-text-primary/80\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tView all\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tapps \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</SidebarMenuButton>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</SidebarMenu>\r\n\t\t\t\t\t\t\t\t\t</SidebarGroupContent>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</SidebarGroup>\r\n\r\n\t\t\t\t\t\t\t{/* Favorites */}\r\n\t\t\t\t\t\t\t{favoriteApps.length > 0 && (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<SidebarSeparator />\r\n\t\t\t\t\t\t\t\t\t<SidebarGroup className='mt-4'>\r\n\t\t\t\t\t\t\t\t\t\t<SidebarGroupLabel\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'flex items-center gap-2 text-md text-text-primary',\r\n\t\t\t\t\t\t\t\t\t\t\t\tisCollapsed &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'justify-center px-0',\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{!isCollapsed && 'Bookmarked'}\r\n\t\t\t\t\t\t\t\t\t\t\t<Bookmark className=\"h-5 w-5 fill-yellow-500 text-yellow-500\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t</SidebarGroupLabel>\r\n\t\t\t\t\t\t\t\t\t\t<SidebarGroupContent>\r\n\t\t\t\t\t\t\t\t\t\t\t<SidebarMenu>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{favoriteApps.map((app) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<AppMenuItem\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={app.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tapp={app}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(id) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigate(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`/app/${id}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowActions={true}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisCollapsed={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisCollapsed\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetVisibilityIcon={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetVisibilityIcon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t</SidebarMenu>\r\n\t\t\t\t\t\t\t\t\t\t</SidebarGroupContent>\r\n\t\t\t\t\t\t\t\t\t</SidebarGroup>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{/* Boards */}\r\n\t\t\t\t\t\t\t{boards.length > 0 && (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<SidebarSeparator />\r\n\t\t\t\t\t\t\t\t\t<SidebarGroup>\r\n\t\t\t\t\t\t\t\t\t\t<SidebarGroupLabel\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'flex items-center cursor-pointer hover:text-text-primary transition-colors',\r\n\t\t\t\t\t\t\t\t\t\t\t\tisCollapsed\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'justify-center px-0'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'justify-between',\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\ttoggleGroup('boards')\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{isCollapsed ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<TooltipProvider\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdelayDuration={0}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<TooltipTrigger>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Users className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</TooltipTrigger>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<TooltipContent\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tside=\"right\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"ml-2\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tMy Boards\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</TooltipContent>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</TooltipProvider>\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Users className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>My Boards</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronRight\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'h-4 w-4 transition-transform',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\texpandedGroups.includes(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'boards',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) && 'rotate-90',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</SidebarGroupLabel>\r\n\t\t\t\t\t\t\t\t\t\t{expandedGroups.includes('boards') && (\r\n\t\t\t\t\t\t\t\t\t\t\t<SidebarGroupContent>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<SidebarMenu>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{boards.map((board) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SidebarMenuItem\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={board.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SidebarMenuButton\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigate(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`/boards/${board.slug}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tboard.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"board-item-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'rounded-lg flex-shrink-0 flex items-center justify-center transition-colors',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'h-8 w-8',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisCollapsed\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-sidebar-accent'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-sidebar-accent/50',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Users2 className=\"h-4 w-4 text-sidebar-accent-foreground\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!isCollapsed && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm font-medium truncate\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tboard.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-text-tertiary truncate\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tboard.memberCount\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmembers\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tboard.appCount\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tapps\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</SidebarMenuButton>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SidebarMenuButton\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigate(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'/boards',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltip=\"Browse all boards\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-text-tertiary hover:text-text-primary view-all-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Plus className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!isCollapsed && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-text-primary/80 ml-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBrowse all\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tboards\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</SidebarMenuButton>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</SidebarMenu>\r\n\t\t\t\t\t\t\t\t\t\t\t</SidebarGroupContent>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</SidebarGroup>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</ScrollArea>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</SidebarContent>\r\n\r\n\t\t\t\t<SidebarFooter>\r\n\t\t\t\t\t{user && (\r\n\t\t\t\t\t\t<SidebarMenu>\r\n\t\t\t\t\t\t\t<SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t<SidebarMenuButton\r\n\t\t\t\t\t\t\t\t\tid=\"discover-link\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => navigate('/discover')}\r\n\t\t\t\t\t\t\t\t\ttooltip=\"Discover\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"group hover:opacity-80 hover:cursor-pointer hover:bg-bg-1/50 transition-all duration-200\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Compass className=\"h-6 w-6 text-text-primary/60 group-hover:text-primary/80 transition-colors\" />\r\n\t\t\t\t\t\t\t\t\t{!isCollapsed && (\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-text-primary/80 font-medium group-hover:text-primary transition-colors\">\r\n\t\t\t\t\t\t\t\t\t\t\tDiscover\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</SidebarMenuButton>\r\n\t\t\t\t\t\t\t</SidebarMenuItem>\r\n\t\t\t\t\t\t\t<SidebarMenuItem>\r\n\t\t\t\t\t\t\t\t<SidebarMenuButton\r\n\t\t\t\t\t\t\t\t\tonClick={() => navigate('/settings')}\r\n\t\t\t\t\t\t\t\t\ttooltip=\"Settings\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"group hover:opacity-80 hover:cursor-pointer hover:bg-bg-1/50 transition-all duration-200\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Settings className=\"h-6 w-6 text-text-primary/60 group-hover:text-primary/80 transition-colors\" />\r\n\t\t\t\t\t\t\t\t\t{!isCollapsed && (\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-text-primary/80 group-hover:text-primary transition-colors\">\r\n\t\t\t\t\t\t\t\t\t\t\tSettings\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</SidebarMenuButton>\r\n\t\t\t\t\t\t\t</SidebarMenuItem>\r\n\t\t\t\t\t\t</SidebarMenu>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</SidebarFooter>\r\n\t\t\t</Sidebar>\r\n\t\t</>\r\n\t);\r\n}\r\n","\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Avatar({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AvatarPrimitive.Root>) {\r\n  return (\r\n    <AvatarPrimitive.Root\r\n      data-slot=\"avatar\"\r\n      className={cn(\r\n        \"relative flex size-8 shrink-0 overflow-hidden rounded-full\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AvatarImage({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AvatarPrimitive.Image>) {\r\n  return (\r\n    <AvatarPrimitive.Image\r\n      data-slot=\"avatar-image\"\r\n      className={cn(\"aspect-square size-full\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AvatarFallback({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {\r\n  return (\r\n    <AvatarPrimitive.Fallback\r\n      data-slot=\"avatar-fallback\"\r\n      className={cn(\r\n        \"bg-bg-3 flex size-full items-center justify-center rounded-full\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Avatar, AvatarImage, AvatarFallback }\r\n","/**\r\n * Enhanced Auth Button\r\n * Provides OAuth + Email/Password authentication with enhanced UI\r\n */\r\n\r\nimport { useState } from 'react';\r\nimport { LogIn, LogOut, Settings } from 'lucide-react';\r\nimport { useNavigate } from 'react-router';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport clsx from 'clsx';\r\nimport { useAuth } from '../../contexts/auth-context';\r\nimport { LoginModal } from './login-modal';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '../ui/avatar';\r\nimport {\r\n\tDropdownMenu,\r\n\tDropdownMenuContent,\r\n\tDropdownMenuItem,\r\n\tDropdownMenuLabel,\r\n\tDropdownMenuTrigger,\r\n\tDropdownMenuGroup,\r\n} from '../ui/dropdown-menu';\r\nimport { Button } from '../ui/button';\r\nimport { Skeleton } from '../ui/skeleton';\r\n\r\ninterface AuthButtonProps {\r\n\tclassName?: string;\r\n}\r\n\r\nexport function AuthButton({ className }: AuthButtonProps) {\r\n\tconst {\r\n\t\tuser,\r\n\t\tisAuthenticated,\r\n\t\tisLoading,\r\n\t\terror,\r\n\t\tlogin, // OAuth method\r\n\t\tloginWithEmail,\r\n\t\tregister,\r\n\t\tlogout,\r\n\t\tclearError,\r\n\t} = useAuth();\r\n\r\n\tconst navigate = useNavigate();\r\n\tconst [showLoginModal, setShowLoginModal] = useState(false);\r\n\r\n\tif (isLoading) {\r\n\t\treturn <Skeleton className=\"w-10 h-10 rounded-full\" />;\r\n\t}\r\n\r\n\tif (!isAuthenticated || !user) {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tvariant=\"ghost\"\r\n\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\tonClick={() => setShowLoginModal(true)}\r\n\t\t\t\t\tclassName={clsx('gap-2', className)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<LogIn className=\"h-4 w-4\" />\r\n\t\t\t\t\t<span>Sign In</span>\r\n\t\t\t\t</Button>\r\n\r\n\t\t\t\t<LoginModal\r\n\t\t\t\t\tisOpen={showLoginModal}\r\n\t\t\t\t\tonClose={() => setShowLoginModal(false)}\r\n\t\t\t\t\tonLogin={(provider) => {\r\n\t\t\t\t\t\t// For backward compatibility with original login interface\r\n\t\t\t\t\t\tlogin(provider);\r\n\t\t\t\t\t\tsetShowLoginModal(false);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonEmailLogin={async (credentials) => {\r\n\t\t\t\t\t\tawait loginWithEmail(credentials);\r\n\t\t\t\t\t\tif (!error) {\r\n\t\t\t\t\t\t\tsetShowLoginModal(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonOAuthLogin={(provider) => {\r\n\t\t\t\t\t\tlogin(provider);\r\n\t\t\t\t\t\tsetShowLoginModal(false);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonRegister={async (data) => {\r\n\t\t\t\t\t\tawait register(data);\r\n\t\t\t\t\t\tif (!error) {\r\n\t\t\t\t\t\t\tsetShowLoginModal(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\terror={error}\r\n\t\t\t\t\tonClearError={clearError}\r\n\t\t\t\t/>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\t// Get user initials for avatar fallback\r\n\tconst getInitials = () => {\r\n\t\tif (user.displayName) {\r\n\t\t\treturn user.displayName\r\n\t\t\t\t.split(' ')\r\n\t\t\t\t.map((n) => n[0])\r\n\t\t\t\t.join('')\r\n\t\t\t\t.toUpperCase()\r\n\t\t\t\t.slice(0, 2);\r\n\t\t}\r\n\t\treturn user.email.charAt(0).toUpperCase();\r\n\t};\r\n\r\n\treturn (\r\n\t\t<DropdownMenu>\r\n\t\t\t<DropdownMenuTrigger asChild>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tvariant=\"ghost\"\r\n\t\t\t\t\tsize=\"icon\"\r\n\t\t\t\t\tclassName=\"relative rounded-full hover:ring-2 hover:ring-primary/20 transition-all\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Avatar className=\"h-8 w-8\">\r\n\t\t\t\t\t\t<AvatarImage\r\n\t\t\t\t\t\t\tsrc={user.avatarUrl}\r\n\t\t\t\t\t\t\talt={user.displayName || user.email}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<AvatarFallback className=\"bg-text-secondary/10 text-text-primary font-semibold\">\r\n\t\t\t\t\t\t\t{getInitials()}\r\n\t\t\t\t\t\t</AvatarFallback>\r\n\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t{user.emailVerified && (\r\n\t\t\t\t\t\t<div className=\"absolute -bottom-1 -right-1 h-3 w-3 bg-green-500 rounded-full border-2 border-background\" />\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Button>\r\n\t\t\t</DropdownMenuTrigger>\r\n\r\n\t\t\t<AnimatePresence>\r\n\t\t\t\t<DropdownMenuContent align=\"end\" className=\"w-72\" asChild>\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tinitial={{ opacity: 0, y: -10 }}\r\n\t\t\t\t\t\tanimate={{ opacity: 1, y: 0 }}\r\n\t\t\t\t\t\texit={{ opacity: 0, y: -10 }}\r\n\t\t\t\t\t\ttransition={{ duration: 0.2 }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<DropdownMenuLabel className=\"p-0\">\r\n\t\t\t\t\t\t\t<div className=\"flex items-start gap-3 p-4\">\r\n\t\t\t\t\t\t\t\t<Avatar className=\"h-12 w-12\">\r\n\t\t\t\t\t\t\t\t\t<AvatarImage\r\n\t\t\t\t\t\t\t\t\t\tsrc={user.avatarUrl}\r\n\t\t\t\t\t\t\t\t\t\talt={user.displayName || user.email}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<AvatarFallback className=\"bg-text-secondary/10 text-text-primary font-semibold text-lg\">\r\n\t\t\t\t\t\t\t\t\t\t{getInitials()}\r\n\t\t\t\t\t\t\t\t\t</AvatarFallback>\r\n\t\t\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t\t\t\t<div className=\"flex flex-col gap-1 flex-1 text-text-primary\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-semibold\">\r\n\t\t\t\t\t\t\t\t\t\t\t{user.displayName || 'User'}\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t{user.email}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</DropdownMenuLabel>\r\n\r\n\t\t\t\t\t\t<DropdownMenuGroup>\r\n\t\t\t\t\t\t\t<DropdownMenuItem\r\n\t\t\t\t\t\t\t\tonClick={() => navigate('/settings')}\r\n\t\t\t\t\t\t\t\tclassName=\"cursor-pointer\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Settings className=\"mr-1 h-4 w-4\" />\r\n\t\t\t\t\t\t\t\tSettings\r\n\t\t\t\t\t\t\t</DropdownMenuItem>\r\n\t\t\t\t\t\t</DropdownMenuGroup>\r\n\r\n\t\t\t\t\t\t<DropdownMenuItem\r\n\t\t\t\t\t\t\tonClick={() => logout()}\r\n\t\t\t\t\t\t\tclassName=\"cursor-pointer text-destructive focus:text-text-primary\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<LogOut className=\"mr-1 h-4 w-4\" />\r\n\t\t\t\t\t\t\tSign Out\r\n\t\t\t\t\t\t</DropdownMenuItem>\r\n\t\t\t\t\t</motion.div>\r\n\t\t\t\t</DropdownMenuContent>\r\n\t\t\t</AnimatePresence>\r\n\t\t</DropdownMenu>\r\n\t);\r\n}\r\n","import { Moon, Sun } from 'lucide-react';\r\nimport { Button } from './ui/button';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from './ui/dropdown-menu';\r\nimport { useTheme } from '../contexts/theme-context';\r\n\r\nexport function ThemeToggle() {\r\n  const { setTheme } = useTheme();\r\n\r\n  return (\r\n    <DropdownMenu>\r\n      <DropdownMenuTrigger asChild>\r\n        <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-text-primary\">\r\n          <Sun className=\"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0\" />\r\n          <Moon className=\"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100\" />\r\n          <span className=\"sr-only\">Toggle theme</span>\r\n        </Button>\r\n      </DropdownMenuTrigger>\r\n      <DropdownMenuContent align=\"end\">\r\n        <DropdownMenuItem onClick={() => setTheme('light')}>\r\n          <Sun className=\"mr-2 h-4 w-4\" />\r\n          <span>Light</span>\r\n        </DropdownMenuItem>\r\n        <DropdownMenuItem onClick={() => setTheme('dark')}>\r\n          <Moon className=\"mr-2 h-4 w-4\" />\r\n          <span>Dark</span>\r\n        </DropdownMenuItem>\r\n        <DropdownMenuItem onClick={() => setTheme('system')}>\r\n          <span className=\"mr-2 h-4 w-4\"></span>\r\n          <span>System</span>\r\n        </DropdownMenuItem>\r\n      </DropdownMenuContent>\r\n    </DropdownMenu>\r\n  );\r\n}","export function CloudflareLogo(props: React.SVGProps<SVGSVGElement> & { color1?: string, color2?: string}) {\r\n\treturn (\r\n\t\t<svg\r\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t// width={36}\r\n\t\t\t// height={16}\r\n\t\t\tviewBox=\"0 0 36 16\"\r\n\t\t\tfill=\"none\"\r\n\t\t\t{...props}\r\n\t\t>\r\n\t\t\t<path\r\n\t\t\t\tfill={props.color1 ?? \"#F6821F\"}\r\n\t\t\t\td=\"m24.156 15.775.181-.626c.216-.744.136-1.433-.227-1.938-.332-.466-.887-.74-1.56-.772l-12.76-.162a.253.253 0 0 1-.2-.107.258.258 0 0 1-.028-.23.34.34 0 0 1 .296-.226l12.878-.164c1.527-.07 3.181-1.31 3.76-2.82l.735-1.92a.447.447 0 0 0 .02-.253 8.386 8.386 0 0 0-16.124-.869 3.763 3.763 0 0 0-2.649-.733 3.778 3.778 0 0 0-3.27 4.688 5.366 5.366 0 0 0-5.15 6.139.25.25 0 0 0 .245.215L23.86 16h.006a.31.31 0 0 0 .291-.225Z\"\r\n\t\t\t/>\r\n\t\t\t<path\r\n\t\t\t\tfill={props.color2 ?? \"#FBAD41\"}\r\n\t\t\t\td=\"M28.408 6.95c-.119 0-.236.003-.354.009A.197.197 0 0 0 28 6.97a.201.201 0 0 0-.128.135l-.502 1.733c-.216.745-.136 1.432.226 1.938.333.466.888.74 1.561.772l2.72.164a.245.245 0 0 1 .236.217c.005.04 0 .081-.013.12a.34.34 0 0 1-.296.225l-2.826.164c-1.535.07-3.188 1.31-3.767 2.82l-.204.534a.15.15 0 0 0 .015.137.151.151 0 0 0 .12.068h9.73a.259.259 0 0 0 .25-.187 6.973 6.973 0 0 0-6.714-8.861Z\"\r\n\t\t\t/>\r\n\t\t</svg>\r\n\t);\r\n}\r\n\r\nexport function TypeScriptIcon(props: React.SVGProps<SVGSVGElement>) {\r\n\treturn (\r\n\t\t<svg viewBox=\"0 0 400 400\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" {...props}>\r\n\t\t\t<path className=\"st0\" d=\"M0 200V0h400v400H0\" fill=\"#007acc\" />\r\n\t\t\t<path className=\"st1\" d=\"M87.7 200.7V217h52v148h36.9V217h52v-16c0-9 0-16.3-.4-16.5 0-.3-31.7-.4-70.2-.4l-70 .3v16.4l-.3-.1zM321.4 184c10.2 2.4 18 7 25 14.3 3.7 4 9.2 11 9.6 12.8 0 .6-17.3 12.3-27.8 18.8-.4.3-2-1.4-3.6-4-5.2-7.4-10.5-10.6-18.8-11.2-12-.8-20 5.5-20 16 0 3.2.6 5 1.8 7.6 2.7 5.5 7.7 8.8 23.2 15.6 28.6 12.3 41 20.4 48.5 32 8.5 13 10.4 33.4 4.7 48.7-6.4 16.7-22 28-44.3 31.7-7 1.2-23 1-30.5-.3-16-3-31.3-11-40.7-21.3-3.7-4-10.8-14.7-10.4-15.4l3.8-2.4 15-8.7 11.3-6.6 2.6 3.5c3.3 5.2 10.7 12.2 15 14.6 13 6.7 30.4 5.8 39-2 3.7-3.4 5.3-7 5.3-12 0-4.6-.7-6.7-3-10.2-3.2-4.4-9.6-8-27.6-16-20.7-8.8-29.5-14.4-37.7-23-4.7-5.2-9-13.3-11-20-1.5-5.8-2-20-.6-25.7 4.3-20 19.4-34 41-38 7-1.4 23.5-.8 30.4 1l-.2.2z\" fill=\"#fff\" />\r\n\t\t</svg>);\r\n}\r\n\r\nexport function CSSIcon(props: React.SVGProps<SVGSVGElement>) {\r\n\treturn (\r\n\t\t<svg viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" {...props}>\r\n\t\t\t<path d=\"M6 28L4 3H28L26 28L16 31L6 28Z\" fill=\"#1172B8\" />\r\n\t\t\t<path d=\"M26 5H16V29.5L24 27L26 5Z\" fill=\"#33AADD\" />\r\n\t\t\t<path d=\"M19.5 17.5H9.5L9 14L17 11.5H9L8.5 8.5H24L23.5 12L17 14.5H23L22 24L16 26L10 24L9.5 19H12.5L13 21.5L16 22.5L19 21.5L19.5 17.5Z\" fill=\"white\" />\r\n\t\t</svg>\r\n\t);\r\n}\r\n\r\nexport const AIAvatar = (props: React.SVGProps<SVGSVGElement>) => (\r\n\t<svg\r\n\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\twidth={24}\r\n\t\theight={24}\r\n\t\tfill=\"none\"\r\n\t\t{...props}\r\n\t>\r\n\t\t<rect\r\n\t\t\twidth={23.5}\r\n\t\t\theight={23.5}\r\n\t\t\tx={0.25}\r\n\t\t\ty={0.25}\r\n\t\t\tfill=\"black\"\r\n\t\t\trx={11.75}\r\n\t\t/>\r\n\t\t<rect\r\n\t\t\twidth={23.5}\r\n\t\t\theight={23.5}\r\n\t\t\tx={0.25}\r\n\t\t\ty={0.25}\r\n\t\t\tstroke=\"black\"\r\n\t\t\tstrokeWidth={0.5}\r\n\t\t\trx={11.75}\r\n\t\t/>\r\n\t\t<path\r\n\t\t\tfill=\"white\"\r\n\t\t\tfillRule=\"evenodd\"\r\n\t\t\td=\"m.504 11.814 9.734-.123c1.765-.081 3.675-1.514 4.344-3.26l.849-2.217c.298-.46.918-.1.738.343l-.58 2.002c-.249.86-.156 1.655.262 2.24.384.539 1.025.855 1.803.892l3.143.188a.286.286 0 0 1 .257.39.394.394 0 0 1-.342.26l-3.265.19c-1.773.081-3.684 1.513-4.353 3.259l-.236.616c-.137.492-1.006.596-.98-.02l.21-.724c.248-.86.156-1.655-.262-2.24-.385-.538-1.026-.855-1.804-.891l-9.47-.121c-.025-.26-.041-.52-.048-.784Z\"\r\n\t\t\tclipRule=\"evenodd\"\r\n\t\t/>\r\n\t</svg>\r\n);\r\n","import { useEffect, useState } from 'react';\r\nimport type { PlatformStatusData } from '@/api-types';\r\nimport { apiClient } from '@/lib/api-client';\r\n\r\nconst defaultStatus: PlatformStatusData = {\r\n    globalUserMessage: '',\r\n    changeLogs: '',\r\n    hasActiveMessage: false,\r\n};\r\n\r\nlet cachedStatus: PlatformStatusData | null = null;\r\nlet inFlightRequest: Promise<void> | null = null;\r\n\r\nasync function fetchStatus(): Promise<void> {\r\n    try {\r\n        const response = await apiClient.getPlatformStatus(true);\r\n        if (response.success && response.data) {\r\n            cachedStatus = response.data;\r\n            return;\r\n        }\r\n    } catch (error) {\r\n        console.debug('Failed to load platform status', error);\r\n    }\r\n\r\n    if (!cachedStatus) {\r\n        cachedStatus = defaultStatus;\r\n    }\r\n}\r\n\r\nexport function usePlatformStatus() {\r\n    const [status, setStatus] = useState<PlatformStatusData>(cachedStatus ?? defaultStatus);\r\n\r\n    useEffect(() => {\r\n        let disposed = false;\r\n\r\n        if (!cachedStatus) {\r\n            if (!inFlightRequest) {\r\n                inFlightRequest = fetchStatus().finally(() => {\r\n                    inFlightRequest = null;\r\n                });\r\n            }\r\n\r\n            inFlightRequest\r\n                .then(() => {\r\n                    if (!disposed && cachedStatus) {\r\n                        setStatus(cachedStatus);\r\n                    }\r\n                })\r\n                .catch(() => {\r\n                    if (!disposed) {\r\n                        setStatus(defaultStatus);\r\n                    }\r\n                });\r\n        } else {\r\n            setStatus(cachedStatus);\r\n        }\r\n\r\n        return () => {\r\n            disposed = true;\r\n        };\r\n    }, []);\r\n\r\n    return {\r\n        status,\r\n    };\r\n}\r\n","import * as React from \"react\"\r\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\r\nimport { XIcon } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Dialog({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\r\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />\r\n}\r\n\r\nfunction DialogTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\r\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />\r\n}\r\n\r\nfunction DialogPortal({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\r\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />\r\n}\r\n\r\nfunction DialogClose({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\r\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />\r\n}\r\n\r\nfunction DialogOverlay({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\r\n  return (\r\n    <DialogPrimitive.Overlay\r\n      data-slot=\"dialog-overlay\"\r\n      className={cn(\r\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DialogContent({\r\n  className,\r\n  children,\r\n  showCloseButton = true,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Content> & {\r\n  showCloseButton?: boolean\r\n}) {\r\n  return (\r\n    <DialogPortal data-slot=\"dialog-portal\">\r\n      <DialogOverlay />\r\n      <DialogPrimitive.Content\r\n        data-slot=\"dialog-content\"\r\n        className={cn(\r\n          \"bg-bg-3 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg\",\r\n          className\r\n        )}\r\n        {...props}\r\n      >\r\n        {children}\r\n        {showCloseButton && (\r\n          <DialogPrimitive.Close\r\n            data-slot=\"dialog-close\"\r\n            className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-text-tertiary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\"\r\n          >\r\n            <XIcon />\r\n            <span className=\"sr-only\">Close</span>\r\n          </DialogPrimitive.Close>\r\n        )}\r\n      </DialogPrimitive.Content>\r\n    </DialogPortal>\r\n  )\r\n}\r\n\r\nfunction DialogHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"dialog-header\"\r\n      className={cn(\"flex flex-col gap-2 text-center sm:text-left\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DialogFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"dialog-footer\"\r\n      className={cn(\r\n        \"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DialogTitle({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\r\n  return (\r\n    <DialogPrimitive.Title\r\n      data-slot=\"dialog-title\"\r\n      className={cn(\"text-lg text-text-primary leading-none font-semibold\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction DialogDescription({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\r\n  return (\r\n    <DialogPrimitive.Description\r\n      data-slot=\"dialog-description\"\r\n      className={cn(\"text-text-tertiary text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Dialog,\r\n  DialogClose,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogOverlay,\r\n  DialogPortal,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { SidebarTrigger } from '@/components/ui/sidebar';\r\nimport { AuthButton } from '../auth/auth-button';\r\nimport { ThemeToggle } from '../theme-toggle';\r\nimport { motion } from 'framer-motion';\r\nimport { useAuth } from '@/contexts/auth-context';\r\nimport { ChevronRight, GithubIcon, AlertCircle } from 'lucide-react';\r\nimport { CloudflareLogo } from '../icons/logos';\r\nimport { usePlatformStatus } from '@/hooks/use-platform-status';\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { useLocation } from 'react-router';\r\nimport clsx from 'clsx';\r\n\r\nexport function GlobalHeader() {\r\n\tconst { user } = useAuth();\r\n\tconst { status } = usePlatformStatus();\r\n\tconst [isChangelogOpen, setIsChangelogOpen] = useState(false);\r\n\tconst hasMaintenanceMessage = Boolean(status.hasActiveMessage && status.globalUserMessage.trim().length > 0);\r\n\tconst hasChangeLogs = Boolean(status.changeLogs && status.changeLogs.trim().length > 0);\r\n\tconst { pathname } = useLocation();\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!hasChangeLogs) {\r\n\t\t\tsetIsChangelogOpen(false);\r\n\t\t}\r\n\t}, [hasChangeLogs]);\r\n\r\n\treturn (\r\n\t\t<Dialog open={isChangelogOpen} onOpenChange={setIsChangelogOpen}>\r\n\t\t\t<motion.header\r\n\t\t\t\tinitial={{ y: -10, opacity: 0 }}\r\n\t\t\t\tanimate={{ y: 0, opacity: 1 }}\r\n\t\t\t\ttransition={{ duration: 0.2, ease: 'easeOut' }}\r\n\t\t\t\tclassName={clsx(\"sticky top-0 z-50\", pathname !== \"/\" && \"bg-bg-3\")}\r\n\t\t\t>\r\n\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t{/* Subtle gradient accent */}\r\n\t\t\t\t\t<div className=\"absolute inset-0 z-0\" />\r\n\r\n\t\t\t\t\t{/* Main content */}\r\n\t\t\t\t\t<div className=\"relative z-10 grid grid-cols-[auto_1fr_auto] items-center gap-4 px-5 py-2\">\r\n\t\t\t\t\t\t{/* Left section */}\r\n\t\t\t\t\t\t{user ? (\r\n\t\t\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\t\t\twhileTap={{ scale: 0.95 }}\r\n\t\t\t\t\t\t\t\ttransition={{\r\n\t\t\t\t\t\t\t\t\ttype: 'spring',\r\n\t\t\t\t\t\t\t\t\tstiffness: 400,\r\n\t\t\t\t\t\t\t\t\tdamping: 17,\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tclassName='flex items-center'\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<SidebarTrigger className=\"h-8 w-8 text-text-primary rounded-md hover:bg-orange-50/40 transition-colors duration-200\" />\r\n\t\t\t\t\t\t\t\t<CloudflareLogo\r\n\t\t\t\t\t\t\t\t\tclassName=\"flex-shrink-0 mx-auto transition-all duration-300\"\r\n\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\twidth: '28px',\r\n\t\t\t\t\t\t\t\t\t\theight: '28px',\r\n\t\t\t\t\t\t\t\t\t\tmarginLeft: '8px',\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{hasMaintenanceMessage && (\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={hasChangeLogs ? () => setIsChangelogOpen(true) : undefined}\r\n\t\t\t\t\t\t\t\t\t\tdisabled={!hasChangeLogs}\r\n\t\t\t\t\t\t\t\t\t\tclassName={`flex max-w-full items-center gap-2 rounded-full border border-accent/40 bg-bg-4/80 px-3 ml-4 py-1.5 text-xs text-text-primary shadow-sm backdrop-blur transition-colors hover:bg-accent/10 focus:outline-none focus:ring-2 focus:ring-accent/40 dark:border-accent/30 dark:bg-bg-2/80 md:text-sm${!hasChangeLogs ? ' opacity-50 cursor-not-allowed pointer-events-none' : ''}`}\r\n\t\t\t\t\t\t\t\t\t\taria-label=\"Platform updates\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<AlertCircle className=\"h-4 w-4 text-accent\" />\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"truncate max-w-[46ch] md:max-w-[60ch]\">{status.globalUserMessage}</span>\r\n\t\t\t\t\t\t\t\t\t\t<ChevronRight className=\"ml-1 h-4 w-4 text-accent\" />\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</motion.div>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<div></div>\r\n\t\t\t\t\t\t)}\r\n\r\n\r\n\r\n\t\t\t\t\t\t{/* Right section */}\r\n\t\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\t\tinitial={{ opacity: 0, x: 10 }}\r\n\t\t\t\t\t\t\tanimate={{ opacity: 1, x: 0 }}\r\n\t\t\t\t\t\t\ttransition={{ delay: 0.2 }}\r\n\t\t\t\t\t\t\tclassName=\"flex flex-wrap items-center justify-end gap-3 justify-self-end\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div className=\"gap-6 flex flex-col justify-between border px-3 bg-bg-4 dark:bg-bg-2 rounded-md py-1.5 border-accent/50 dark:border-accent/50 !border-t-transparent rounded-t-none ml-2 md:ml-6 -mt-2\">\r\n\t\t\t\t\t\t\t\t<div className=\"flex w-full gap-2 items-center\">\r\n\t\t\t\t\t\t\t\t\t<div className='text-text-primary/80 mr-4 text-lg font-medium'>Deploy your own vibe-coding platform</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex font-semibold gap-2 items-center bg-accent dark:bg-accent text-white rounded px-2 hover:opacity-80 cursor-pointer\" onClick={() => window.open(\"https://deploy.workers.cloudflare.com/?url=https://github.com/cloudflare/vibesdk\", \"_blank\")}>\r\n\t\t\t\t\t\t\t\t\t\tDeploy <CloudflareLogo className='w-5 h-5' color1='#fff' />\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex font-semibold items-center bg-text-primary text-bg-4 rounded gap-1 px-2 hover:opacity-80 cursor-pointer\" onClick={() => window.open(\"https://github.com/cloudflare/vibesdk\", \"_blank\")} >\r\n\t\t\t\t\t\t\t\t\t\tFork <GithubIcon className=\"size-4\" />\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/* Disable cost display for now */}\r\n\t\t\t\t\t\t\t{/* {user && (\r\n\t\t\t\t\t\t\t<CostDisplay\r\n\t\t\t\t\t\t\t\t{...extractUserAnalyticsProps(analytics)}\r\n\t\t\t\t\t\t\t\tloading={analyticsLoading}\r\n\t\t\t\t\t\t\t\tvariant=\"inline\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)} */}\r\n\t\t\t\t\t\t\t<ThemeToggle />\r\n\t\t\t\t\t\t\t<AuthButton />\r\n\t\t\t\t\t\t</motion.div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</motion.header>\r\n\t\t\t{hasChangeLogs && (\r\n\t\t\t\t<DialogContent className=\"max-w-xl\">\r\n\t\t\t\t\t<DialogHeader>\r\n\t\t\t\t\t\t<DialogTitle>Platform updates</DialogTitle>\r\n\t\t\t\t\t\t{status.globalUserMessage && (\r\n\t\t\t\t\t\t\t<DialogDescription className=\"text-sm text-muted-foreground\">\r\n\t\t\t\t\t\t\t\t{status.globalUserMessage}\r\n\t\t\t\t\t\t\t</DialogDescription>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</DialogHeader>\r\n\t\t\t\t\t<ScrollArea className=\"max-h-[60vh] pr-4\">\r\n\t\t\t\t\t\t<p className=\"whitespace-pre-wrap text-sm leading-relaxed text-muted-foreground\">\r\n\t\t\t\t\t\t\t{status.changeLogs}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</ScrollArea>\r\n\t\t\t\t</DialogContent>\r\n\t\t\t)}\r\n\t\t</Dialog>\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport { Outlet, useLocation } from 'react-router';\r\nimport { SidebarProvider, SidebarInset } from '@/components/ui/sidebar';\r\nimport { AppSidebar } from './app-sidebar';\r\nimport { GlobalHeader } from './global-header';\r\nimport { AppsDataProvider } from '@/contexts/apps-data-context';\r\nimport clsx from 'clsx';\r\n\r\ninterface AppLayoutProps {\r\n  children?: React.ReactNode;\r\n}\r\n\r\nexport function AppLayout({ children }: AppLayoutProps) {\r\n  const { pathname } = useLocation();\r\n  return (\r\n    <AppsDataProvider>\r\n      <SidebarProvider \r\n        defaultOpen={false}\r\n        style={{\r\n          \"--sidebar-width\": \"320px\",\r\n          \"--sidebar-width-mobile\": \"280px\",\r\n          \"--sidebar-width-icon\": \"52px\"\r\n        } as React.CSSProperties}\r\n      >\r\n        <AppSidebar />\r\n        <SidebarInset className={clsx(\"bg-bg-3 flex flex-col h-screen relative\", pathname !== \"/\" && \"overflow-hidden\")}>\r\n          <GlobalHeader />\r\n          <div className={clsx(\"flex-1 bg-bg-3\", pathname !== \"/\" && \"min-h-0 overflow-auto\")}>\r\n            {children || <Outlet />}\r\n          </div>\r\n        </SidebarInset>\r\n      </SidebarProvider>\r\n    </AppsDataProvider>\r\n  );\r\n}","import * as Sentry from '@sentry/react';\r\nimport { ReactNode } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { AlertCircle } from 'lucide-react';\r\n\r\nfunction ErrorFallback({ error, resetError }: { error: Error | unknown; resetError: () => void; }) {\r\n  const errorMessage = error instanceof Error ? error.message : 'An unexpected error occurred';\r\n  return (\r\n    <div className=\"flex min-h-screen items-center justify-center p-4\">\r\n      <div className=\"max-w-md w-full space-y-6 text-center\">\r\n        <div className=\"flex justify-center\">\r\n          <AlertCircle className=\"h-16 w-16 text-red-500\" />\r\n        </div>\r\n        \r\n        <div className=\"space-y-2\">\r\n          <h1 className=\"text-2xl font-bold\">Something went wrong</h1>\r\n          <p className=\"text-muted-foreground\">\r\n            An unexpected error occurred. Our team has been notified.\r\n          </p>\r\n        </div>\r\n        \r\n        {import.meta.env.DEV && (\r\n          <div className=\"bg-muted p-4 rounded-lg text-left\">\r\n            <p className=\"font-mono text-sm text-red-600 break-all\">\r\n              {errorMessage}\r\n            </p>\r\n          </div>\r\n        )}\r\n        \r\n        <div className=\"flex gap-3 justify-center\">\r\n          <Button onClick={resetError} variant=\"default\">\r\n            Try Again\r\n          </Button>\r\n          <Button\r\n            onClick={() => window.location.href = '/'}\r\n            variant=\"outline\"\r\n          >\r\n            Go Home\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\ninterface ErrorBoundaryProps {\r\n  children: ReactNode;\r\n  showDialog?: boolean;\r\n}\r\n\r\nexport function ErrorBoundary({ \r\n  children, \r\n  showDialog = false \r\n}: ErrorBoundaryProps) {\r\n  return (\r\n    <Sentry.ErrorBoundary\r\n      fallback={ErrorFallback}\r\n      showDialog={showDialog}\r\n    >\r\n      {children}\r\n    </Sentry.ErrorBoundary>\r\n  );\r\n}\r\n\r\n// Export the default fallback component for reuse\r\nexport { ErrorFallback };\r\n","import { Outlet } from 'react-router';\r\nimport { AuthProvider } from './contexts/auth-context';\r\nimport { AuthModalProvider } from './components/auth/AuthModalProvider';\r\nimport { ThemeProvider } from './contexts/theme-context';\r\nimport { Toaster } from './components/ui/sonner';\r\nimport { AppLayout } from './components/layout/app-layout';\r\nimport { ErrorBoundary } from './components/ErrorBoundary';\r\n\r\nexport default function App() {\r\n  return (\r\n    <ErrorBoundary>\r\n      <ThemeProvider>\r\n        <AuthProvider>\r\n          <AuthModalProvider>\r\n            <AppLayout>\r\n              <Outlet />\r\n            </AppLayout>\r\n            <Toaster richColors position=\"top-right\" />\r\n          </AuthModalProvider>\r\n        </AuthProvider>\r\n      </ThemeProvider>\r\n    </ErrorBoundary>\r\n  );\r\n}","import { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { apiClient, ApiError } from '@/lib/api-client';\r\nimport type { EnhancedAppData, AppWithUserAndStats, PaginationInfo, TimePeriod, AppSortOption } from '@/api-types';\r\nimport { appEvents } from '@/lib/app-events';\r\n\r\nexport type AppType = 'user' | 'public';\r\nexport type AppListData = EnhancedAppData | AppWithUserAndStats;\r\n\r\ninterface UsePaginatedAppsOptions {\r\n  type: AppType;\r\n  defaultSort?: AppSortOption;\r\n  defaultPeriod?: TimePeriod;\r\n  defaultFramework?: string;\r\n  defaultVisibility?: string;\r\n  includeVisibility?: boolean;\r\n  limit?: number;\r\n  autoFetch?: boolean;\r\n}\r\n\r\ninterface FilterState {\r\n  searchQuery: string;\r\n  filterFramework: string;\r\n  filterVisibility: string;\r\n  sortBy: AppSortOption;\r\n  period: TimePeriod;\r\n}\r\n\r\ninterface PaginationState {\r\n  currentPage: number;\r\n  totalCount: number;\r\n  hasMore: boolean;\r\n}\r\n\r\ninterface UsePaginatedAppsResult extends FilterState {\r\n  apps: AppListData[];\r\n  loading: boolean;\r\n  loadingMore: boolean;\r\n  error: string | null;\r\n  pagination: PaginationInfo;\r\n  hasMore: boolean;\r\n  totalCount: number;\r\n  \r\n  setSearchQuery: (query: string) => void;\r\n  handleSearchSubmit: (e: React.FormEvent) => void;\r\n  handleSortChange: (sort: string) => void;\r\n  handlePeriodChange: (period: TimePeriod) => void;\r\n  handleFrameworkChange: (framework: string) => void;\r\n  handleVisibilityChange: (visibility: string) => void;\r\n  \r\n  refetch: () => Promise<void>;\r\n  loadMore: () => Promise<void>;\r\n  removeApp: (appId: string) => void;\r\n}\r\n\r\nexport function usePaginatedApps(options: UsePaginatedAppsOptions): UsePaginatedAppsResult {\r\n  const hasInitialized = useRef(false);\r\n  const currentPageRef = useRef(1);\r\n  const isLoadingMoreRef = useRef(false);\r\n  \r\n  const [filterState, setFilterState] = useState<FilterState>({\r\n    searchQuery: '',\r\n    filterFramework: options.defaultFramework || 'all',\r\n    filterVisibility: options.defaultVisibility || 'all',\r\n    sortBy: options.defaultSort || 'recent',\r\n    period: options.defaultPeriod || 'all'\r\n  });\r\n\r\n  const [debouncedSearchQuery, setDebouncedSearchQuery] = useState('');\r\n  const [apps, setApps] = useState<AppListData[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [loadingMore, setLoadingMore] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  const [paginationState, setPaginationState] = useState<PaginationState>({\r\n    currentPage: 1,\r\n    totalCount: 0,\r\n    hasMore: false\r\n  });\r\n\r\n  const limit = options.limit || 20;\r\n\r\n  useEffect(() => {\r\n    const timeoutId = setTimeout(() => {\r\n      setDebouncedSearchQuery(filterState.searchQuery);\r\n    }, 500);\r\n    return () => clearTimeout(timeoutId);\r\n  }, [filterState.searchQuery]);\r\n\r\n  const fetchAppsInternal = useCallback(async (\r\n    append: boolean,\r\n    targetPage: number | undefined,\r\n    filters: {\r\n      sortBy: AppSortOption;\r\n      period: TimePeriod;\r\n      filterFramework: string;\r\n      filterVisibility: string;\r\n      searchQuery: string;\r\n    }\r\n  ) => {\r\n    try {\r\n      if (!append) {\r\n        setLoading(true);\r\n        setError(null);\r\n      } else {\r\n        setLoadingMore(true);\r\n      }\r\n\r\n      const page = targetPage ?? (append ? currentPageRef.current + 1 : 1);\r\n\r\n      const params = {\r\n        page,\r\n        limit,\r\n        sort: filters.sortBy,\r\n        period: filters.period,\r\n        framework: filters.filterFramework === 'all' ? undefined : filters.filterFramework,\r\n        search: filters.searchQuery || undefined,\r\n        visibility: (options.includeVisibility && filters.filterVisibility !== 'all') ? filters.filterVisibility : undefined,\r\n      };\r\n\r\n      const cleanParams = Object.fromEntries(\r\n        Object.entries(params).filter(([, value]) => value !== undefined)\r\n      );\r\n\r\n      const response = options.type === 'user' \r\n        ? await apiClient.getUserAppsWithPagination(cleanParams)\r\n        : await apiClient.getPublicApps(cleanParams);\r\n\r\n      if (response.success && response.data) {\r\n        const responseData = response.data as { apps: AppListData[]; pagination: PaginationInfo };\r\n        const newApps = responseData.apps;\r\n        const newPagination = responseData.pagination;\r\n\r\n        if (append) {\r\n          setApps(prev => [...prev, ...newApps]);\r\n        } else {\r\n          setApps(newApps);\r\n        }\r\n\r\n        currentPageRef.current = page;\r\n        setPaginationState({\r\n          currentPage: page,\r\n          totalCount: newPagination.total,\r\n          hasMore: newPagination.hasMore\r\n        });\r\n      } else {\r\n        throw new Error(response.error?.message || 'Failed to fetch apps');\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching apps:', err);\r\n      const errorMessage = err instanceof ApiError \r\n        ? `${err.message} (${err.status})`\r\n        : err instanceof Error \r\n          ? err.message \r\n          : 'Failed to fetch apps';\r\n      setError(errorMessage);\r\n    } finally {\r\n      setLoading(false);\r\n      setLoadingMore(false);\r\n    }\r\n  }, [options.type, options.includeVisibility, limit]);\r\n\r\n  // Wrapper that uses current state\r\n  const fetchApps = useCallback(async (append = false, targetPage?: number) => {\r\n    return fetchAppsInternal(append, targetPage, {\r\n      ...filterState,\r\n      searchQuery: debouncedSearchQuery\r\n    });\r\n  }, [fetchAppsInternal, filterState, debouncedSearchQuery]);\r\n\r\n  const loadMore = useCallback(async () => {\r\n    // Use the current state directly to avoid stale closure\r\n    if (paginationState.hasMore && !loadingMore && !loading) {\r\n      isLoadingMoreRef.current = true;\r\n      await fetchApps(true);\r\n      isLoadingMoreRef.current = false;\r\n    }\r\n  }, [paginationState.hasMore, loadingMore, loading, fetchApps]);\r\n\r\n  const refetch = useCallback(async () => {\r\n    await fetchApps(false, 1);\r\n  }, [fetchApps]);\r\n\r\n  const removeApp = useCallback((appId: string) => {\r\n    setApps(prev => prev.filter(app => app.id !== appId));\r\n    setPaginationState(prev => ({ \r\n      ...prev, \r\n      totalCount: Math.max(0, prev.totalCount - 1) \r\n    }));\r\n  }, []);\r\n\r\n  const setSearchQuery = useCallback((query: string) => {\r\n    setFilterState(prev => ({ ...prev, searchQuery: query }));\r\n  }, []);\r\n\r\n  const handleSearchSubmit = useCallback((e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    // Force immediate search by setting debounced value and triggering fetch\r\n    setDebouncedSearchQuery(filterState.searchQuery);\r\n  }, [filterState.searchQuery]);\r\n\r\n  const handleSortChange = useCallback((newSort: string) => {\r\n    const sort = newSort as AppSortOption;\r\n    setFilterState(prev => ({ ...prev, sortBy: sort }));\r\n  }, []);\r\n\r\n  const handlePeriodChange = useCallback((newPeriod: TimePeriod) => {\r\n    setFilterState(prev => ({ ...prev, period: newPeriod }));\r\n  }, []);\r\n\r\n  const handleFrameworkChange = useCallback((framework: string) => {\r\n    setFilterState(prev => ({ ...prev, filterFramework: framework }));\r\n  }, []);\r\n\r\n  const handleVisibilityChange = useCallback((visibility: string) => {\r\n    setFilterState(prev => ({ ...prev, filterVisibility: visibility }));\r\n  }, []);\r\n\r\n  // Single consolidated effect for fetching apps\r\n  useEffect(() => {\r\n    // Skip if autoFetch is disabled and not initialized\r\n    if (options.autoFetch === false && !hasInitialized.current) {\r\n      return;\r\n    }\r\n\r\n    // Skip if we're currently loading more (pagination)\r\n    if (isLoadingMoreRef.current) {\r\n      return;\r\n    }\r\n\r\n    // Reset pagination when filters change\r\n    currentPageRef.current = 1;\r\n\r\n    // Fetch apps with current filters\r\n    const performFetch = async () => {\r\n      await fetchAppsInternal(false, 1, {\r\n        sortBy: filterState.sortBy,\r\n        period: filterState.period,\r\n        filterFramework: filterState.filterFramework,\r\n        filterVisibility: filterState.filterVisibility,\r\n        searchQuery: debouncedSearchQuery\r\n      });\r\n    };\r\n\r\n    performFetch();\r\n    hasInitialized.current = true;\r\n  }, [\r\n    // Only re-fetch when actual filter values change\r\n    filterState.sortBy,\r\n    filterState.period,\r\n    filterState.filterFramework,\r\n    filterState.filterVisibility,\r\n    debouncedSearchQuery,\r\n    fetchAppsInternal,\r\n    options.autoFetch\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = appEvents.on('app-deleted', (event) => {\r\n      removeApp(event.appId);\r\n    });\r\n    return unsubscribe;\r\n  }, [removeApp]);\r\n\r\n  const pagination: PaginationInfo = {\r\n    limit,\r\n    offset: (paginationState.currentPage - 1) * limit,\r\n    total: paginationState.totalCount,\r\n    hasMore: paginationState.hasMore\r\n  };\r\n\r\n  return {\r\n    searchQuery: filterState.searchQuery,\r\n    filterFramework: filterState.filterFramework,\r\n    filterVisibility: options.includeVisibility ? filterState.filterVisibility : 'all',\r\n    sortBy: filterState.sortBy,\r\n    period: filterState.period,\r\n    \r\n    apps,\r\n    loading,\r\n    loadingMore,\r\n    error,\r\n    pagination,\r\n    hasMore: paginationState.hasMore,\r\n    totalCount: paginationState.totalCount,\r\n    \r\n    setSearchQuery,\r\n    handleSearchSubmit,\r\n    handleSortChange,\r\n    handlePeriodChange,\r\n    handleFrameworkChange,\r\n    handleVisibilityChange,\r\n    \r\n    refetch,\r\n    loadMore,\r\n    removeApp,\r\n  };\r\n}","import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        \"bg-bg-4 dark:bg-bg-2 text-text-primary flex flex-col rounded-md border\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, variant, ...props }: React.ComponentProps<\"div\"> & { variant?: \"minimal\"}) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        \"flex items-start gap-1.5 py-4 px-4\",\r\n        className,\r\n        variant !== \"minimal\" ? \"py-4\" : \"py-1\",\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nconst CardTitle = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\r\n    {...props}\r\n  />\r\n))\r\nCardTitle.displayName = \"CardTitle\"\r\n\r\nconst CardDescription = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"text-sm text-text-secondary\", className)}\r\n    {...props}\r\n  />\r\n))\r\nCardDescription.displayName = \"CardDescription\"\r\n\r\nconst CardContent = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\r\n))\r\nCardContent.displayName = \"CardContent\"\r\n\r\nconst CardFooter = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"px-6  py-4\", className)}\r\n    {...props}\r\n  />\r\n))\r\nCardFooter.displayName = \"CardFooter\"\r\n\r\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\r\n","import React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { Card } from '@/components/ui/card';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport {\r\n\tStar,\r\n\tEye,\r\n\tShuffle,\r\n\tCode2,\r\n\tUser,\r\n\tLock,\r\n\tUsers2,\r\n\tGlobe,\r\n\tCloud,\r\n\tCloudOff,\r\n\tLoader2,\r\n\tGithub,\r\n} from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport type {\r\n\tAppWithFavoriteStatus,\r\n\tAppWithUserAndStats,\r\n\tEnhancedAppData,\r\n} from '@/api-types';\r\nimport { AppActionsDropdown } from './AppActionsDropdown';\r\nimport type { LucideIcon } from 'lucide-react';\r\n\r\n// Union type for both app types - make updatedAtFormatted optional\r\ntype AppCardData =\r\n\t| AppWithFavoriteStatus\r\n\t| (EnhancedAppData & { updatedAtFormatted?: string })\r\n\t| AppWithUserAndStats;\r\n\r\n// Type definitions for deployment and stats\r\ntype DeploymentStatus = 'none' | 'deploying' | 'deployed' | 'failed';\r\n\r\ninterface AppWithDeployment {\r\n\tdeploymentStatus?: DeploymentStatus;\r\n\tdeploymentUrl?: string;\r\n}\r\n\r\ninterface DeploymentStatusInfo {\r\n\ticon: LucideIcon;\r\n\tcolor: string;\r\n\tbgColor: string;\r\n\ttext: string;\r\n\tanimate?: boolean;\r\n}\r\n\r\ninterface StatsData {\r\n\tviewCount?: number;\r\n\tstarCount?: number;\r\n\tforkCount?: number;\r\n\tuserStarred?: boolean;\r\n}\r\n\r\n// Layout and design types for enhanced UI\r\ntype CardLayout = 'compact' | 'detailed';\r\n\r\ninterface LayoutConfig {\r\n\tlayout: CardLayout;\r\n\tshowUserInfo: boolean;\r\n\tprimaryMetadata: 'deployment' | 'social' | 'timestamp';\r\n\tshowDeploymentStatus: boolean;\r\n}\r\n\r\n// Constants - Single source of truth for deployment status configurations\r\nconst DEPLOYMENT_STATUS_CONFIG: Record<DeploymentStatus, DeploymentStatusInfo> =\r\n\t{\r\n\t\tdeployed: {\r\n\t\t\ticon: Cloud,\r\n\t\t\tcolor: 'text-green-500',\r\n\t\t\tbgColor: 'bg-green-50 dark:bg-green-950',\r\n\t\t\ttext: 'Deployed',\r\n\t\t},\r\n\t\tdeploying: {\r\n\t\t\ticon: Loader2,\r\n\t\t\tcolor: 'text-green-400',\r\n\t\t\tbgColor: 'bg-green-50 dark:bg-green-950',\r\n\t\t\ttext: 'Deploying',\r\n\t\t\tanimate: true,\r\n\t\t},\r\n\t\tfailed: {\r\n\t\t\ticon: CloudOff,\r\n\t\t\tcolor: 'text-gray-500',\r\n\t\t\tbgColor: 'bg-gray-50 dark:bg-gray-950',\r\n\t\t\ttext: 'Deploy Failed',\r\n\t\t},\r\n\t\tnone: {\r\n\t\t\ticon: CloudOff,\r\n\t\t\tcolor: 'text-gray-500',\r\n\t\t\tbgColor: 'bg-gray-50 dark:bg-gray-950',\r\n\t\t\ttext: 'Not Deployed',\r\n\t\t},\r\n\t};\r\n\r\n// Stats icons mapping\r\nconst STATS_ICONS = {\r\n\tviewCount: Eye,\r\n\tstarCount: Star,\r\n\tforkCount: Shuffle,\r\n} as const;\r\n\r\n// Type-safe utility functions\r\nfunction hasDeploymentFields(\r\n\tapp: AppCardData,\r\n): app is AppCardData & AppWithDeployment {\r\n\treturn 'deploymentStatus' in app || 'deploymentUrl' in app;\r\n}\r\n\r\nfunction getAppDeploymentStatus(app: AppCardData): DeploymentStatus {\r\n\tif (!hasDeploymentFields(app)) return 'none';\r\n\r\n\t// If has deployment URL, it's deployed\r\n\tif (app.deploymentUrl) return 'deployed';\r\n\r\n\t// Return deployment status or default to 'none'\r\n\treturn app.deploymentStatus || 'none';\r\n}\r\n\r\nfunction getAppStats(app: AppCardData): StatsData {\r\n\tif (isPublicApp(app)) {\r\n\t\treturn {\r\n\t\t\tviewCount: app.viewCount,\r\n\t\t\tstarCount: app.starCount,\r\n\t\t\tforkCount: app.forkCount,\r\n\t\t\tuserStarred: app.userStarred,\r\n\t\t};\r\n\t}\r\n\r\n\tif (isUserApp(app) || isEnhancedApp(app)) {\r\n\t\t// Type-safe access to stats fields that exist on enhanced/user app types\r\n\t\tconst enhancedApp = app as EnhancedAppData;\r\n\t\treturn {\r\n\t\t\tviewCount: enhancedApp.viewCount,\r\n\t\t\tstarCount: enhancedApp.starCount,\r\n\t\t\tforkCount: enhancedApp.forkCount,\r\n\t\t\tuserStarred: enhancedApp.userStarred,\r\n\t\t};\r\n\t}\r\n\r\n\treturn {};\r\n}\r\n\r\n// Type guards\r\nfunction isPublicApp(app: AppCardData): app is AppWithUserAndStats {\r\n\treturn (\r\n\t\t'userName' in app &&\r\n\t\t'starCount' in app &&\r\n\t\t'userStarred' in app &&\r\n\t\t'updatedAtFormatted' in app\r\n\t);\r\n}\r\n\r\nfunction isUserApp(app: AppCardData): app is AppWithFavoriteStatus {\r\n\treturn (\r\n\t\t'isFavorite' in app &&\r\n\t\t'updatedAtFormatted' in app &&\r\n\t\t!('userName' in app)\r\n\t);\r\n}\r\n\r\nfunction isEnhancedApp(app: AppCardData): app is EnhancedAppData {\r\n\treturn (\r\n\t\t'userFavorited' in app &&\r\n\t\t'starCount' in app &&\r\n\t\t!('isFavorite' in app) &&\r\n\t\t!('updatedAtFormatted' in app)\r\n\t);\r\n}\r\n\r\ninterface AppCardProps {\r\n\tapp: AppCardData;\r\n\tonClick: (appId: string) => void;\r\n\tonToggleFavorite?: (appId: string) => void;\r\n\tshowStats?: boolean;\r\n\tshowUser?: boolean;\r\n\tshowActions?: boolean;\r\n\tclassName?: string;\r\n}\r\n\r\nconst getVisibilityIcon = (visibility: string) => {\r\n\tswitch (visibility) {\r\n\t\tcase 'private':\r\n\t\t\treturn <Lock className=\"h-3 w-3\" />;\r\n\t\tcase 'team':\r\n\t\t\treturn <Users2 className=\"h-3 w-3\" />;\r\n\t\tcase 'board':\r\n\t\tcase 'public':\r\n\t\t\treturn <Globe className=\"h-3 w-3\" />;\r\n\t\tdefault:\r\n\t\t\treturn <Lock className=\"h-3 w-3\" />;\r\n\t}\r\n};\r\n\r\nfunction getDeploymentStatusInfo(\r\n\tapp: AppCardData,\r\n): DeploymentStatusInfo | null {\r\n\tif (!hasDeploymentFields(app)) return null;\r\n\r\n\tconst status = getAppDeploymentStatus(app);\r\n\treturn DEPLOYMENT_STATUS_CONFIG[status];\r\n}\r\n\r\nfunction getLayoutConfig(\r\n\tshowUser: boolean,\r\n\tshowActions: boolean,\r\n): LayoutConfig {\r\n\treturn {\r\n\t\tlayout: showUser ? 'detailed' : 'compact',\r\n\t\tshowUserInfo: showUser,\r\n\t\tprimaryMetadata: showUser ? 'social' : 'deployment',\r\n\t\tshowDeploymentStatus: !showUser && showActions,\r\n\t};\r\n}\r\n\r\n// Reusable components to eliminate duplicate JSX\r\nconst StatItem = ({\r\n\ticon: Icon,\r\n\tvalue,\r\n\thighlighted = false,\r\n}: {\r\n\ticon: LucideIcon;\r\n\tvalue: number;\r\n\thighlighted?: boolean;\r\n}) => (\r\n\t<div className=\"flex items-center gap-1 group-hover:scale-105 transition-transform duration-200\">\r\n\t\t<Icon\r\n\t\t\tclassName={cn(\r\n\t\t\t\t'h-4 w-4 transition-all duration-200 text-gray-400',\r\n\t\t\t\thighlighted && 'fill-yellow-500 text-yellow-500 drop-shadow-sm',\r\n\t\t\t\t!highlighted && 'group-hover:text-bg-2',\r\n\t\t\t)}\r\n\t\t/>\r\n\t\t<span className=\"font-medium text-xs text-text-tertiary group-hover:text-bg-2\">\r\n\t\t\t{value || 0}\r\n\t\t</span>\r\n\t</div>\r\n);\r\n\r\nconst StatsDisplay = ({ stats }: { stats: StatsData }) => (\r\n\t<div className=\"flex items-center gap-2 text-sm text-text-tertiary/80\">\r\n\t\t<StatItem\r\n\t\t\ticon={STATS_ICONS.starCount}\r\n\t\t\tvalue={stats.starCount || 0}\r\n\t\t\thighlighted={stats.userStarred}\r\n\t\t/>\r\n\t\t{/* Fork functionality temporarily removed - showing view count instead */}\r\n\t\t{/* <StatItem icon={STATS_ICONS.forkCount} value={stats.forkCount || 0} /> */}\r\n\t\t<StatItem icon={STATS_ICONS.viewCount} value={stats.viewCount || 0} />\r\n\t</div>\r\n);\r\n\r\nconst AppMetadata = ({\r\n\tapp,\r\n\tlayoutConfig,\r\n\thasOverlayStatus,\r\n}: {\r\n\tapp: AppCardData;\r\n\tlayoutConfig: LayoutConfig;\r\n\thasOverlayStatus?: boolean;\r\n}) => {\r\n\tif (layoutConfig.primaryMetadata === 'social' && isPublicApp(app)) {\r\n\t\t// Discover page layout - show user info\r\n\t\treturn (\r\n\t\t\t<div className=\"flex items-center gap-3 text-sm\">\r\n\t\t\t\t{app.userName === 'Anonymous User' ? (\r\n\t\t\t\t\t<div className=\"flex items-center gap-2 text-text-tertiary\">\r\n\t\t\t\t\t\t<div className=\"h-8 w-8 rounded-full bg-gradient-to-br from-gray-300 to-gray-400 flex items-center justify-center shadow-sm\">\r\n\t\t\t\t\t\t\t<User className=\"h-4 w-4 text-white\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t<Avatar className=\"h-8 w-8\">\r\n\t\t\t\t\t\t\t<AvatarImage src={app.userAvatar || undefined} />\r\n\t\t\t\t\t\t\t<AvatarFallback className=\"text-[10px] bg-gradient-to-br from-red-200 to-red-300 font-semibold\">\r\n\t\t\t\t\t\t\t\t{app.userName?.charAt(0).toUpperCase() || '?'}\r\n\t\t\t\t\t\t\t</AvatarFallback>\r\n\t\t\t\t\t\t</Avatar>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t\t<div className=\"flex flex-col line-clamp-1 gap-1 w-full text-text-primary group-hover:text-bg-2 \">\r\n\t\t\t\t\t<span className=\"truncate text-ellipsis max-w-60 font-medium\">\r\n\t\t\t\t\t\t{app.title}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<StatsDisplay stats={getAppStats(app)} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tif (\r\n\t\tlayoutConfig.primaryMetadata === 'deployment' &&\r\n\t\t(isUserApp(app) || isEnhancedApp(app))\r\n\t) {\r\n\t\t// My Apps page layout - show deployment status and update time\r\n\t\tconst deploymentStatus = getDeploymentStatusInfo(app);\r\n\t\treturn (\r\n\t\t\t<div className='flex flex-col'>\r\n\t\t\t\t<span className=\"truncate text-ellipsis max-w-60 font-medium group-hover:text-bg-2\">\r\n\t\t\t\t\t{app.title}\r\n\t\t\t\t</span>\r\n\t\t\t\t<div className=\"flex items-center gap-2.5 text-sm\">\r\n\t\t\t\t\t{/* Only show deployment status if there's no overlay status indicator */}\r\n\t\t\t\t\t{deploymentStatus && !hasOverlayStatus && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-1.5\">\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\t'w-2 h-2 rounded-full transition-all duration-200',\r\n\t\t\t\t\t\t\t\t\t\tdeploymentStatus.color ===\r\n\t\t\t\t\t\t\t\t\t\t\t'text-green-500' &&\r\n\t\t\t\t\t\t\t\t\t\t\t'bg-green-500 shadow-sm shadow-green-500/20',\r\n\t\t\t\t\t\t\t\t\t\tdeploymentStatus.color ===\r\n\t\t\t\t\t\t\t\t\t\t\t'text-green-400' &&\r\n\t\t\t\t\t\t\t\t\t\t\t'bg-green-400 animate-pulse shadow-sm shadow-green-400/20',\r\n\t\t\t\t\t\t\t\t\t\tdeploymentStatus.color ===\r\n\t\t\t\t\t\t\t\t\t\t\t'text-gray-500' &&\r\n\t\t\t\t\t\t\t\t\t\t\t'bg-gray-400 shadow-sm shadow-gray-400/20',\r\n\t\t\t\t\t\t\t\t\t\tdeploymentStatus.color ===\r\n\t\t\t\t\t\t\t\t\t\t\t'text-gray-500 ' && 'bg-gray-400',\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\t'text-xs font-medium transition-colors',\r\n\t\t\t\t\t\t\t\t\t\tdeploymentStatus.color ===\r\n\t\t\t\t\t\t\t\t\t\t\t'text-green-500' &&\r\n\t\t\t\t\t\t\t\t\t\t\t'text-green-600',\r\n\t\t\t\t\t\t\t\t\t\tdeploymentStatus.color ===\r\n\t\t\t\t\t\t\t\t\t\t\t'text-green-400' &&\r\n\t\t\t\t\t\t\t\t\t\t\t'text-green-600',\r\n\t\t\t\t\t\t\t\t\t\tdeploymentStatus.color ===\r\n\t\t\t\t\t\t\t\t\t\t\t'text-gray-500' && 'text-gray-600 group-hover:text-bg-2',\r\n\t\t\t\t\t\t\t\t\t\tdeploymentStatus.color ===\r\n\t\t\t\t\t\t\t\t\t\t\t'text-gray-500' &&\r\n\t\t\t\t\t\t\t\t\t\t\t'text-text-tertiary',\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{deploymentStatus.text}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<span className=\"text-text-tertiary/60\"></span>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<span className=\"text-xs text-text-tertiary/80 group-hover:text-bg-1 font-medium\">\r\n\t\t\t\t\t\tUpdated{' '}\r\n\t\t\t\t\t\t{isUserApp(app)\r\n\t\t\t\t\t\t\t? app.updatedAtFormatted\r\n\t\t\t\t\t\t\t: isEnhancedApp(app) && app.updatedAt\r\n\t\t\t\t\t\t\t\t? formatDistanceToNow(new Date(app.updatedAt), {\r\n\t\t\t\t\t\t\t\t\t\taddSuffix: true,\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t: 'Recently'}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Fallback for other cases\r\n\treturn (\r\n\t\t<div className=\"flex items-center gap-2 text-sm\">\r\n\t\t\t<span className=\"text-xs text-text-tertiary/80 font-medium\">\r\n\t\t\t\t{isUserApp(app)\r\n\t\t\t\t\t? `Updated ${app.updatedAtFormatted}`\r\n\t\t\t\t\t: 'Recently updated'}\r\n\t\t\t</span>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport const AppCard = React.memo<AppCardProps>(\r\n\t({\r\n\t\tapp,\r\n\t\tonClick,\r\n\t\tshowUser = false,\r\n\t\tshowActions = false,\r\n\t\tclassName,\r\n\t}) => {\r\n\t\tconst layoutConfig = getLayoutConfig(showUser, showActions);\r\n\t\tconst deploymentStatus = getDeploymentStatusInfo(app);\r\n\r\n\t\tconst itemVariants = {\r\n\t\t\thidden: { y: 10, opacity: 0 },\r\n\t\t\tvisible: {\r\n\t\t\t\ty: 0,\r\n\t\t\t\topacity: 1,\r\n\t\t\t\ttransition: {\r\n\t\t\t\t\ttype: 'spring' as const,\r\n\t\t\t\t\tstiffness: 200,\r\n\t\t\t\t\tdamping: 20,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\texit: {\r\n\t\t\t\ty: -10,\r\n\t\t\t\topacity: 0,\r\n\t\t\t\tscale: 0.98,\r\n\t\t\t\ttransition: {\r\n\t\t\t\t\tduration: 0.2,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\treturn (\r\n\t\t\t<motion.div\r\n\t\t\t\tvariants={itemVariants}\r\n\t\t\t\tinitial=\"hidden\"\r\n\t\t\t\tanimate=\"visible\"\r\n\t\t\t\texit=\"exit\"\r\n\t\t\t\tlayout\r\n\t\t\t\tclassName={className}\r\n\t\t\t>\r\n\t\t\t\t{/* Anchor wrapper for right-click context menu support */}\r\n\t\t\t\t<a\r\n\t\t\t\t\thref={`/app/${app.id}`}\r\n\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tonClick(app.id);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tclassName=\"block h-full no-underline\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Card\r\n\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t'h-full transition-all duration-300 ease-out cursor-pointer group relative overflow-hidden rounded-md p-2 bg-bg-1 hover:!bg-text hover:dark:!bg-text-primary',\r\n\t\t\t\t\t\t\t'border border-border-primary hover:border-border-primary/60',\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t{/* Enhanced Preview Section with High-Quality Rendering */}\r\n\t\t\t\t\t<div className=\"relative aspect-[16/9] rounded-lg overflow-hidden bg-gradient-to-br from-red-50 to-red-100 dark:from-red-950/20 dark:to-orange-900/20\">\r\n\t\t\t\t\t\t{app.screenshotUrl ? (\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tsrc={app.screenshotUrl}\r\n\t\t\t\t\t\t\t\talt={`${app.title} preview`}\r\n\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t'w-full h-full transition-all duration-300 ease-out',\r\n\t\t\t\t\t\t\t\t\t// High-quality rendering with smart cropping for better visual appeal\r\n\t\t\t\t\t\t\t\t\t'object-cover object-center',\r\n\t\t\t\t\t\t\t\t\t'bg-gradient-to-br from-red-50/60 to-red-100/60 dark:from-red-950/15 dark:to-red-900/15',\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\tloading=\"lazy\"\r\n\t\t\t\t\t\t\t\tfetchPriority=\"low\"\r\n\t\t\t\t\t\t\t\tsizes=\"(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw\"\r\n\t\t\t\t\t\t\t\tsrcSet={`${app.screenshotUrl} 1x, ${app.screenshotUrl} 1.5x, ${app.screenshotUrl} 2x, ${app.screenshotUrl} 3x`}\r\n\t\t\t\t\t\t\t\tdecoding=\"async\"\r\n\t\t\t\t\t\t\t\tonError={(e) => {\r\n\t\t\t\t\t\t\t\t\t// Smooth fallback to placeholder\r\n\t\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\r\n\t\t\t\t\t\t\t\t\ttarget.style.opacity = '0';\r\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\ttarget.style.display = 'none';\r\n\t\t\t\t\t\t\t\t\t\tconst placeholder =\r\n\t\t\t\t\t\t\t\t\t\t\ttarget.parentElement?.querySelector(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'.screenshot-placeholder',\r\n\t\t\t\t\t\t\t\t\t\t\t) as HTMLElement;\r\n\t\t\t\t\t\t\t\t\t\tif (placeholder) {\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder.classList.remove(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'hidden',\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder.style.opacity = '1';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}, 150);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonLoad={(e) => {\r\n\t\t\t\t\t\t\t\t\t// Ensure smooth appearance with advanced quality enhancement\r\n\t\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\r\n\t\t\t\t\t\t\t\t\ttarget.style.opacity = '1';\r\n\t\t\t\t\t\t\t\t\t// Apply dynamic quality optimizations after load\r\n\t\t\t\t\t\t\t\t\tconst devicePixelRatio =\r\n\t\t\t\t\t\t\t\t\t\twindow.devicePixelRatio || 1;\r\n\t\t\t\t\t\t\t\t\tif (devicePixelRatio >= 2) {\r\n\t\t\t\t\t\t\t\t\t\ttarget.style.imageRendering =\r\n\t\t\t\t\t\t\t\t\t\t\t'high-quality';\r\n\t\t\t\t\t\t\t\t\t\ttarget.style.filter =\r\n\t\t\t\t\t\t\t\t\t\t\t'contrast(1.05) saturate(1.06) brightness(1.02) unsharp-mask(0.7px 0.7px 0px)';\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\ttarget.style.imageRendering = 'auto';\r\n\t\t\t\t\t\t\t\t\t\ttarget.style.filter =\r\n\t\t\t\t\t\t\t\t\t\t\t'contrast(1.04) saturate(1.05) brightness(1.02) unsharp-mask(0.5px 0.5px 0px)';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\ttarget.style.backfaceVisibility = 'hidden';\r\n\t\t\t\t\t\t\t\t\ttarget.style.willChange = 'transform';\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\topacity: 0,\r\n\t\t\t\t\t\t\t\t\ttransition: 'opacity 0.3s ease-out',\r\n\t\t\t\t\t\t\t\t\t// Advanced CSS-level quality optimizations\r\n\t\t\t\t\t\t\t\t\timageRendering: 'auto',\r\n\t\t\t\t\t\t\t\t\tbackfaceVisibility: 'hidden',\r\n\t\t\t\t\t\t\t\t\ttransform: 'translate3d(0, 0, 0)',\r\n\t\t\t\t\t\t\t\t\twillChange: 'transform',\r\n\t\t\t\t\t\t\t\t\tcontain: 'layout style paint',\r\n\t\t\t\t\t\t\t\t\tisolation: 'isolate',\r\n\t\t\t\t\t\t\t\t\t// Enhanced quality filters with cross-browser support\r\n\t\t\t\t\t\t\t\t\tfilter: 'contrast(1.04) saturate(1.05) brightness(1.02)',\r\n\t\t\t\t\t\t\t\t\tWebkitFontSmoothing: 'subpixel-antialiased',\r\n\t\t\t\t\t\t\t\t\ttextRendering: 'optimizeLegibility',\r\n\t\t\t\t\t\t\t\t\tfontFeatureSettings: '\"kern\" 1',\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) : null}\r\n\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t'screenshot-placeholder w-full h-full flex flex-col items-center justify-center absolute inset-0 transition-all duration-300',\r\n\t\t\t\t\t\t\t\tapp.screenshotUrl\r\n\t\t\t\t\t\t\t\t\t? 'hidden opacity-0'\r\n\t\t\t\t\t\t\t\t\t: 'opacity-100',\r\n\t\t\t\t\t\t\t\t// Enhanced placeholder design\r\n\t\t\t\t\t\t\t\t'bg-gradient-to-br from-red-50 via-red-100/80 to-red-200/60 dark:from-red-950/30 dark:via-red-900/20 dark:to-red-800/10',\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div className=\"flex flex-col items-center gap-3 text-red-400/70 dark:text-red-500/50\">\r\n\t\t\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t\t\t<Code2 className=\"h-12 w-12 drop-shadow-sm\" />\r\n\t\t\t\t\t\t\t\t\t<div className=\"absolute inset-0 bg-gradient-to-t from-red-200/30 to-transparent rounded blur-sm\" />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"text-xs font-medium text-center px-4 opacity-60\">\r\n\t\t\t\t\t\t\t\t\tPreview Unavailable\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/* Deploying status indicator - only show when actually deploying */}\r\n\t\t\t\t\t\t{deploymentStatus?.color === 'text-green-400' &&\r\n\t\t\t\t\t\t\tgetAppDeploymentStatus(app) === 'deploying' && (\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName=\"absolute top-2 left-2 h-4 w-4 rounded-full bg-green-300/70 backdrop-blur-sm flex items-center justify-center shadow-sm border border-green-200/20\"\r\n\t\t\t\t\t\t\t\t\ttitle=\"App is deploying\"\r\n\t\t\t\t\t\t\t\t\taria-label=\"App deployment in progress\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Loader2 className=\"w-2 h-2 text-white/90 animate-spin\" />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{/* Failed deployment status indicator - only show when deployment actually failed */}\r\n\t\t\t\t\t\t{deploymentStatus?.color === 'text-gray-500' &&\r\n\t\t\t\t\t\t\tgetAppDeploymentStatus(app) === 'failed' && (\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName=\"absolute top-2 left-2 h-4 w-4 rounded-full bg-gray-400/70 backdrop-blur-sm flex items-center justify-center shadow-sm border border-gray-300/20\"\r\n\t\t\t\t\t\t\t\t\ttitle=\"Deployment failed\"\r\n\t\t\t\t\t\t\t\t\taria-label=\"App deployment failed\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<CloudOff className=\"w-2 h-2 text-white/90\" />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{/* GitHub Repository Badge - moved to app info section, removed from screenshot overlay */}\r\n\r\n\t\t\t\t\t\t{/* Actions Dropdown - positioned in top-right on hover */}\r\n\t\t\t\t\t\t{showActions && (\r\n\t\t\t\t\t\t\t<div className=\"absolute top-2 right-2\">\r\n\t\t\t\t\t\t\t\t<AppActionsDropdown\r\n\t\t\t\t\t\t\t\t\tappId={app.id}\r\n\t\t\t\t\t\t\t\t\tappTitle={app.title}\r\n\t\t\t\t\t\t\t\t\tshowOnHover={true}\r\n\t\t\t\t\t\t\t\t\tclassName=\"h-6 w-6 text-text-tertiary hover:text-text-primary bg-bg-3/90 backdrop-blur-sm hover:bg-bg-3\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{/* Visibility Badge for user apps (when not showing status overlays) */}\r\n\t\t\t\t\t\t{(isUserApp(app) || isEnhancedApp(app)) &&\r\n\t\t\t\t\t\t\t!deploymentStatus && (\r\n\t\t\t\t\t\t\t\t<div className=\"absolute bottom-2 left-2 bg-bg-3/90 dark:bg-bg-4/90 backdrop-blur-sm rounded-md p-1\">\r\n\t\t\t\t\t\t\t\t\t{getVisibilityIcon(app.visibility)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{/* Visibility Badge positioned differently when status overlay exists */}\r\n\t\t\t\t\t\t{(isUserApp(app) || isEnhancedApp(app)) &&\r\n\t\t\t\t\t\t\tdeploymentStatus && (\r\n\t\t\t\t\t\t\t\t<div className=\"absolute bottom-2 left-2 bg-bg-3/90 dark:bg-bg-4/90 backdrop-blur-sm rounded-md p-1\">\r\n\t\t\t\t\t\t\t\t\t{getVisibilityIcon(app.visibility)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"flex items-start justify-between gap-2 p-2 pb-1\">\r\n\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\r\n\t\t\t\t\t\t\t{/* Enhanced Adaptive Metadata with GitHub integration */}\r\n\t\t\t\t\t\t\t<div className=\"transition-all duration-200 ease-out \">\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t\t\t\t\t\t<AppMetadata\r\n\t\t\t\t\t\t\t\t\t\t\tapp={app}\r\n\t\t\t\t\t\t\t\t\t\t\tlayoutConfig={layoutConfig}\r\n\t\t\t\t\t\t\t\t\t\t\thasOverlayStatus={\r\n\t\t\t\t\t\t\t\t\t\t\t\t!!deploymentStatus &&\r\n\t\t\t\t\t\t\t\t\t\t\t\tdeploymentStatus.color !==\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'text-gray-500'\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{/* GitHub Repository Button - integrated into app info */}\r\n\t\t\t\t\t\t\t\t\t{app.githubRepositoryUrl &&\r\n\t\t\t\t\t\t\t\t\t\tapp.githubRepositoryVisibility !==\r\n\t\t\t\t\t\t\t\t\t\t\t'private' && (\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"group/github flex items-center gap-1.5 px-2 py-1 rounded-full bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 transition-all duration-200\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tapp.githubRepositoryUrl\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twindow.open(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tapp.githubRepositoryUrl,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'_blank',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'noopener,noreferrer',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle={`View on GitHub (${app.githubRepositoryVisibility || 'public'})`}\r\n\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"View repository on GitHub\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Github className=\"w-4 h-4 text-gray-600 dark:text-gray-400 group-hover/github:text-gray-800 dark:group-hover/github:text-gray-200 transition-colors\" />\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</a>\r\n\t\t\t</motion.div>\r\n\t\t);\r\n\t},\r\n);\r\n\r\nAppCard.displayName = 'AppCard';\r\n","/**\r\n * Centralized API types for the FE bundle.\r\n * - All `worker/*` and `shared/*` symbols are exported as TYPES ONLY so the client build never loads Worker code.\r\n * - Minimal browser-safe shims are provided where runtime values are expected (image attachment helpers).\r\n */\r\n\r\n// ---------- TYPE-ONLY RE-EXPORTS (no runtime imports) ----------\r\n\r\n// Auth/session types\r\nexport type { SessionResponse } from 'worker/utils/authUtils';\r\n\r\n// Secrets API Types\r\nexport type { SecretTemplate } from 'worker/types/secretsTemplates';\r\n\r\n// Base API Response Types\r\nexport type { ControllerResponse, ApiResponse } from 'worker/api/controllers/types';\r\n\r\n// Database Types\r\nexport type {\r\n  PaginationInfo,\r\n  EnhancedAppData,\r\n  AppWithFavoriteStatus,\r\n  TimePeriod,\r\n  AppSortOption,\r\n  SortOrder,\r\n  AppQueryOptions,\r\n  PublicAppQueryOptions,\r\n  FavoriteToggleResult,\r\n  UserStats,\r\n  UserActivity,\r\n  EncryptedSecret,\r\n  UserModelConfigWithMetadata,\r\n  ModelTestResult,\r\n} from 'worker/database/types';\r\n\r\n// App-related API Types\r\nexport type {\r\n  AppsListData,\r\n  PublicAppsData,\r\n  SingleAppData,\r\n  FavoriteToggleData,\r\n  CreateAppData,\r\n  UpdateAppVisibilityData,\r\n  AppDeleteData,\r\n  AppWithUserAndStats,\r\n} from 'worker/api/controllers/apps/types';\r\n\r\nexport type {\r\n  AppDetailsData,\r\n  AppStarToggleData,\r\n  GeneratedCodeFile,\r\n} from 'worker/api/controllers/appView/types';\r\n\r\n// User-related API Types\r\nexport type {\r\n  UserAppsData,\r\n  ProfileUpdateData,\r\n} from 'worker/api/controllers/user/types';\r\n\r\n// Stats API Types\r\nexport type {\r\n  UserStatsData,\r\n  UserActivityData,\r\n} from 'worker/api/controllers/stats/types';\r\n\r\n// Analytics API Types\r\nexport type {\r\n  UserAnalyticsResponseData,\r\n  AgentAnalyticsResponseData,\r\n} from 'worker/api/controllers/analytics/types';\r\n\r\nexport type { PlatformStatusData } from 'worker/api/controllers/status/types';\r\n\r\n// Model Config API Types\r\nexport type {\r\n  ModelConfigsData,\r\n  ModelConfigData,\r\n  ModelConfigUpdateData,\r\n  ModelConfigTestData,\r\n  ModelConfigResetData,\r\n  ModelConfigDefaultsData,\r\n  ModelConfigDeleteData,\r\n  ByokProvidersData,\r\n  UserProviderStatus,\r\n  ModelsByProvider,\r\n} from 'worker/api/controllers/modelConfig/types';\r\n\r\n// Model Provider API Types\r\nexport type {\r\n  ModelProvidersListData,\r\n  ModelProviderData,\r\n  ModelProviderCreateData,\r\n  ModelProviderUpdateData,\r\n  ModelProviderDeleteData,\r\n  ModelProviderTestData,\r\n  CreateProviderRequest,\r\n  UpdateProviderRequest,\r\n  TestProviderRequest,\r\n} from 'worker/api/controllers/modelProviders/types';\r\n\r\n// Database/Schema Types commonly used in frontend\r\nexport type {\r\n  App,\r\n  User,\r\n  UserModelConfig,\r\n  UserModelProvider,\r\n} from 'worker/database/schema';\r\n\r\n// Agent/Generator Types\r\nexport type {\r\n  Blueprint as BlueprintType,\r\n  ClientReportedErrorType,\r\n  CodeReviewOutputType,\r\n  FileConceptType,\r\n  FileOutputType as GeneratedFile,\r\n} from 'worker/agents/schemas';\r\n\r\nexport type { CodeGenState } from 'worker/agents/core/state';\r\n\r\nexport type { ConversationMessage } from 'worker/agents/inferutils/common';\r\n\r\nexport type {\r\n  RuntimeError,\r\n  StaticAnalysisResponse,\r\n} from 'worker/services/sandbox/sandboxTypes';\r\n\r\n// Config/Inference Types\r\nexport type {\r\n  AgentActionKey,\r\n  AgentConfig,\r\n  ModelConfig,\r\n  ReasoningEffortType as ReasoningEffort,\r\n  ProviderOverrideType as ProviderOverride,\r\n  AIModels,\r\n} from 'worker/agents/inferutils/config.types';\r\n\r\n// Rate limit / responses / agent\r\nexport type { RateLimitError } from 'worker/services/rate-limit/errors';\r\nexport type { AgentPreviewResponse, CodeGenArgs } from 'worker/api/controllers/agent/types';\r\nexport type { RateLimitErrorResponse } from 'worker/api/responses';\r\n\r\n// Error types (types-only)\r\nexport type {\r\n  RateLimitExceededError,\r\n  SecurityError,\r\n  SecurityErrorType,\r\n} from 'shared/types/errors';\r\n\r\n// Auth types imported from worker (types-only)\r\nexport type {\r\n  AuthSession,\r\n  ApiKeyInfo,\r\n  AuthResult,\r\n  AuthUser,\r\n  OAuthProvider,\r\n} from 'worker/types/auth-types';\r\n\r\n// GitHub export types\r\nexport type {\r\n  GitHubExportOptions,\r\n  GitHubExportResult,\r\n} from 'worker/services/github/types';\r\n\r\n// Frontend model config update interface that matches backend schema\r\nexport interface ModelConfigUpdate {\r\n  modelName?: string | null;\r\n  maxTokens?: number | null;\r\n  temperature?: number | null;\r\n  reasoningEffort?: string | null;\r\n  fallbackModel?: string | null;\r\n  isUserOverride?: boolean;\r\n}\r\n\r\n// Model selection types\r\nexport type ModelSelectionMode = 'platform' | 'byok' | 'custom';\r\n\r\n// Match chat FileType interface\r\nexport interface FileType {\r\n  filePath: string;\r\n  fileContents: string;\r\n  explanation?: string;\r\n  isGenerating?: boolean;\r\n  needsFixing?: boolean;\r\n  hasErrors?: boolean;\r\n  language?: string;\r\n}\r\n\r\n// Streaming response wrapper types for agent session creation\r\nexport interface StreamingResponse {\r\n  success: boolean;\r\n  stream: Response;\r\n}\r\nexport type AgentStreamingResponse = StreamingResponse;\r\n\r\n// ---------- IMAGE ATTACHMENT: client-safe shims ----------\r\n// If your UI needs these at runtime, keep these shims.\r\n// Replace the values to mirror your Worker defaults if required.\r\n\r\nexport type { ImageAttachment } from 'worker/types/image-attachment';\r\n\r\n// Browser-side defaults (adjust to match server if needed)\r\nexport const MAX_IMAGE_SIZE_BYTES = 10 * 1024 * 1024; // 10MB (update if your Worker differs)\r\nexport const MAX_IMAGES_PER_MESSAGE = 4;              // update to match Worker\r\nexport const SUPPORTED_IMAGE_MIME_TYPES = [\r\n  'image/png',\r\n  'image/jpeg',\r\n  'image/webp',\r\n  'image/gif',\r\n] as const;\r\n\r\nexport function isSupportedImageType(mime: string): boolean {\r\n  return SUPPORTED_IMAGE_MIME_TYPES.includes(mime as (typeof SUPPORTED_IMAGE_MIME_TYPES)[number]);\r\n}\r\n","import { useCallback, useState } from 'react';\r\nimport { toast } from 'sonner';\r\nimport { \r\n\ttype ImageAttachment, \r\n\tisSupportedImageType, \r\n\tMAX_IMAGE_SIZE_BYTES,\r\n\tMAX_IMAGES_PER_MESSAGE,\r\n\tSUPPORTED_IMAGE_MIME_TYPES\r\n} from '@/api-types';\r\n\r\nexport interface UseImageUploadOptions {\r\n\tmaxImages?: number;\r\n\tmaxSizeBytes?: number;\r\n\tonError?: (error: string) => void;\r\n}\r\n\r\nexport interface UseImageUploadReturn {\r\n\timages: ImageAttachment[];\r\n\taddImages: (files: File[]) => Promise<void>;\r\n\tremoveImage: (id: string) => void;\r\n\tclearImages: () => void;\r\n\tisProcessing: boolean;\r\n}\r\n\r\n/**\r\n * Hook for handling image uploads\r\n */\r\nexport function useImageUpload(options: UseImageUploadOptions = {}): UseImageUploadReturn {\r\n\tconst {\r\n\t\tmaxImages = MAX_IMAGES_PER_MESSAGE,\r\n\t\tmaxSizeBytes = MAX_IMAGE_SIZE_BYTES,\r\n\t\tonError,\r\n\t} = options;\r\n\r\n\tconst [images, setImages] = useState<ImageAttachment[]>([]);\r\n\tconst [isProcessing, setIsProcessing] = useState(false);\r\n\r\n\tconst processImageFile = useCallback(async (file: File): Promise<ImageAttachment | null> => {\r\n\t\t// Validate MIME type\r\n\t\tif (!isSupportedImageType(file.type)) {\r\n\t\t\tconst supportedTypes = SUPPORTED_IMAGE_MIME_TYPES.map(t => t.replace('image/', '').toUpperCase());\r\n\t\t\tconst errorMsg = `Unsupported image type: ${file.type}. Only ${supportedTypes.join(', ')} are supported.`;\r\n\t\t\ttoast.error(errorMsg);\r\n\t\t\tonError?.(errorMsg);\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst reader = new FileReader();\r\n\r\n\t\t\treader.onload = (e) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst result = e.target?.result as string;\r\n\t\t\t\t\tif (!result) {\r\n\t\t\t\t\t\treject(new Error('Failed to read file'));\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Extract base64 data (remove data URL prefix)\r\n\t\t\t\t\tconst base64Data = result.split(',')[1];\r\n\r\n\t\t\t\t\t// Try to get image dimensions\r\n\t\t\t\t\tconst img = new Image();\r\n\t\t\t\t\timg.onload = () => {\r\n\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\tid: `img-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n\t\t\t\t\t\t\tfilename: file.name,\r\n\t\t\t\t\t\t\tmimeType: file.type as ImageAttachment['mimeType'],\r\n\t\t\t\t\t\t\tbase64Data,\r\n\t\t\t\t\t\t\tsize: file.size,\r\n\t\t\t\t\t\t\tdimensions: {\r\n\t\t\t\t\t\t\t\twidth: img.width,\r\n\t\t\t\t\t\t\t\theight: img.height,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\timg.onerror = () => {\r\n\t\t\t\t\t\t// Fallback without dimensions if image loading fails\r\n\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\tid: `img-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n\t\t\t\t\t\t\tfilename: file.name,\r\n\t\t\t\t\t\t\tmimeType: file.type as ImageAttachment['mimeType'],\r\n\t\t\t\t\t\t\tbase64Data,\r\n\t\t\t\t\t\t\tsize: file.size,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\timg.src = result;\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\treject(error);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\treader.onerror = () => {\r\n\t\t\t\treject(new Error(`Failed to read file: ${file.name}`));\r\n\t\t\t};\r\n\r\n\t\t\treader.readAsDataURL(file);\r\n\t\t});\r\n\t}, [maxSizeBytes, onError]);\r\n\r\n\tconst addImages = useCallback(async (files: File[]) => {\r\n\t\tsetIsProcessing(true);\r\n\r\n\t\ttry {\r\n\t\t\t// Check if adding these files would exceed the limit\r\n\t\t\tif (images.length + files.length > maxImages) {\r\n\t\t\t\tconst errorMsg = `Maximum ${maxImages} images allowed per message.`;\r\n\t\t\t\ttoast.error(errorMsg);\r\n\t\t\t\tonError?.(errorMsg);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Process all files\r\n\t\t\tconst processedImages = await Promise.all(\r\n\t\t\t\tfiles.map(file => processImageFile(file))\r\n\t\t\t);\r\n\r\n\t\t\t// Filter out null results (failed validations)\r\n\t\t\tconst validImages = processedImages.filter((img): img is ImageAttachment => img !== null);\r\n\r\n\t\t\tif (validImages.length > 0) {\r\n\t\t\t\tsetImages(prev => [...prev, ...validImages]);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tonError?.(error instanceof Error ? error.message : 'Failed to process images');\r\n\t\t} finally {\r\n\t\t\tsetIsProcessing(false);\r\n\t\t}\r\n\t}, [images.length, maxImages, processImageFile, onError]);\r\n\r\n\tconst removeImage = useCallback((id: string) => {\r\n\t\tsetImages(prev => prev.filter(img => img.id !== id));\r\n\t}, []);\r\n\r\n\tconst clearImages = useCallback(() => {\r\n\t\tsetImages([]);\r\n\t}, []);\r\n\r\n\treturn {\r\n\t\timages,\r\n\t\taddImages,\r\n\t\tremoveImage,\r\n\t\tclearImages,\r\n\t\tisProcessing,\r\n\t};\r\n}\r\n","import { useCallback, useState, type DragEvent } from 'react';\r\n\r\nexport interface UseDragDropOptions {\r\n\tonFilesDropped: (files: File[]) => void;\r\n\taccept?: string[];\r\n\tdisabled?: boolean;\r\n}\r\n\r\nexport interface UseDragDropReturn {\r\n\tisDragging: boolean;\r\n\tdragHandlers: {\r\n\t\tonDragEnter: (e: DragEvent) => void;\r\n\t\tonDragOver: (e: DragEvent) => void;\r\n\t\tonDragLeave: (e: DragEvent) => void;\r\n\t\tonDrop: (e: DragEvent) => void;\r\n\t};\r\n}\r\n\r\n/**\r\n * Hook for handling drag and drop file uploads\r\n */\r\nexport function useDragDrop({\r\n\tonFilesDropped,\r\n\taccept,\r\n\tdisabled = false,\r\n}: UseDragDropOptions): UseDragDropReturn {\r\n\tconst [isDragging, setIsDragging] = useState(false);\r\n\r\n\tconst validateFile = useCallback((file: File): boolean => {\r\n\t\tif (!accept || accept.length === 0) return true;\r\n\t\treturn accept.includes(file.type);\r\n\t}, [accept]);\r\n\r\n\tconst handleDragEnter = useCallback((e: DragEvent) => {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t\tif (disabled) return;\r\n\t\tsetIsDragging(true);\r\n\t}, [disabled]);\r\n\r\n\tconst handleDragOver = useCallback((e: DragEvent) => {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t\tif (disabled) return;\r\n\t\tsetIsDragging(true);\r\n\t}, [disabled]);\r\n\r\n\tconst handleDragLeave = useCallback((e: DragEvent) => {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t\tif (disabled) return;\r\n\t\t\r\n\t\t// Only set isDragging to false if we're leaving the container itself\r\n\t\t// (not just moving to a child element)\r\n\t\tif (e.currentTarget === e.target) {\r\n\t\t\tsetIsDragging(false);\r\n\t\t}\r\n\t}, [disabled]);\r\n\r\n\tconst handleDrop = useCallback((e: DragEvent) => {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t\tsetIsDragging(false);\r\n\t\t\r\n\t\tif (disabled) return;\r\n\r\n\t\tconst files = Array.from(e.dataTransfer.files).filter(validateFile);\r\n\t\t\r\n\t\tif (files.length > 0) {\r\n\t\t\tonFilesDropped(files);\r\n\t\t}\r\n\t}, [disabled, validateFile, onFilesDropped]);\r\n\r\n\treturn {\r\n\t\tisDragging,\r\n\t\tdragHandlers: {\r\n\t\t\tonDragEnter: handleDragEnter,\r\n\t\t\tonDragOver: handleDragOver,\r\n\t\t\tonDragLeave: handleDragLeave,\r\n\t\t\tonDrop: handleDrop,\r\n\t\t},\r\n\t};\r\n}\r\n","import { useRef, type ChangeEvent } from 'react';\r\nimport { ImagePlus } from 'lucide-react';\r\nimport { SUPPORTED_IMAGE_MIME_TYPES } from '@/api-types';\r\n\r\nexport interface ImageUploadButtonProps {\r\n\tonFilesSelected: (files: File[]) => void;\r\n\tdisabled?: boolean;\r\n\tmultiple?: boolean;\r\n\tclassName?: string;\r\n\ticonClassName?: string;\r\n}\r\n\r\n/**\r\n * Button component for uploading images\r\n */\r\nexport function ImageUploadButton({\r\n\tonFilesSelected,\r\n\tdisabled = false,\r\n\tmultiple = true,\r\n\tclassName = '',\r\n\ticonClassName = 'size-4',\r\n}: ImageUploadButtonProps) {\r\n\tconst fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n\tconst handleClick = () => {\r\n\t\tfileInputRef.current?.click();\r\n\t};\r\n\r\n\tconst handleFileChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n\t\tconst files = Array.from(e.target.files || []);\r\n\t\tif (files.length > 0) {\r\n\t\t\tonFilesSelected(files);\r\n\t\t}\r\n\t\t// Reset input so the same file can be selected again\r\n\t\tif (fileInputRef.current) {\r\n\t\t\tfileInputRef.current.value = '';\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<input\r\n\t\t\t\tref={fileInputRef}\r\n\t\t\t\ttype=\"file\"\r\n\t\t\t\taccept={SUPPORTED_IMAGE_MIME_TYPES.join(',')}\r\n\t\t\t\tmultiple={multiple}\r\n\t\t\t\tonChange={handleFileChange}\r\n\t\t\t\tclassName=\"hidden\"\r\n\t\t\t\tdisabled={disabled}\r\n\t\t\t/>\r\n\t\t\t<button\r\n\t\t\t\ttype=\"button\"\r\n\t\t\t\tonClick={handleClick}\r\n\t\t\t\tdisabled={disabled}\r\n\t\t\t\tclassName={`p-1 rounded-md bg-transparent hover:bg-bg-3 text-text-secondary hover:text-text-primary transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed ${className}`}\r\n\t\t\t\taria-label=\"Upload image\"\r\n\t\t\t\ttitle=\"Upload image (PNG, JPEG, WEBP, HEIC, HEIF)\"\r\n\t\t\t>\r\n\t\t\t\t<ImagePlus className={iconClassName} strokeWidth={1.5} />\r\n\t\t\t</button>\r\n\t\t</>\r\n\t);\r\n}\r\n","import { X } from 'lucide-react';\r\nimport type { ImageAttachment } from '@/api-types';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nexport interface ImageAttachmentPreviewProps {\r\n\timages: ImageAttachment[];\r\n\tonRemove?: (id: string) => void;\r\n\tclassName?: string;\r\n\tcompact?: boolean;\r\n}\r\n\r\n/**\r\n * Component to display image attachment previews\r\n */\r\nexport function ImageAttachmentPreview({\r\n\timages,\r\n\tonRemove,\r\n\tclassName = '',\r\n\tcompact = false,\r\n}: ImageAttachmentPreviewProps) {\r\n\tif (images.length === 0) return null;\r\n\r\n\treturn (\r\n\t\t<div className={`flex flex-wrap gap-2 ${className}`}>\r\n\t\t\t<AnimatePresence mode=\"popLayout\">\r\n\t\t\t\t{images.map((image) => (\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tkey={image.id}\r\n\t\t\t\t\t\tinitial={{ opacity: 0, scale: 0.8 }}\r\n\t\t\t\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\t\t\t\texit={{ opacity: 0, scale: 0.8 }}\r\n\t\t\t\t\t\ttransition={{ duration: 0.2 }}\r\n\t\t\t\t\t\tclassName={`relative group ${compact ? 'w-12 h-12' : 'w-20 h-20'} rounded-lg overflow-hidden border border-border-primary bg-bg-3`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\tsrc={`data:${image.mimeType};base64,${image.base64Data}`}\r\n\t\t\t\t\t\t\talt={image.filename}\r\n\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{onRemove && (\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tonClick={() => onRemove(image.id)}\r\n\t\t\t\t\t\t\t\tclassName=\"absolute top-1 right-1 p-0.5 rounded-full bg-bg-1/90 hover:bg-bg-1 text-text-primary opacity-0 group-hover:opacity-100 transition-opacity\"\r\n\t\t\t\t\t\t\t\taria-label={`Remove ${image.filename}`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<X className=\"size-3\" />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{!compact && (\r\n\t\t\t\t\t\t\t<div className=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-bg-1/90 to-transparent p-1\">\r\n\t\t\t\t\t\t\t\t<p className=\"text-[10px] text-text-secondary truncate\">\r\n\t\t\t\t\t\t\t\t\t{image.filename}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</motion.div>\r\n\t\t\t\t))}\r\n\t\t\t</AnimatePresence>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { useRef, useState, useEffect, useMemo } from 'react';\r\nimport { ArrowRight, Info } from 'react-feather';\r\nimport { useNavigate } from 'react-router';\r\nimport { useAuth } from '@/contexts/auth-context';\r\nimport {\r\n\tAgentModeToggle,\r\n\ttype AgentMode,\r\n} from '../components/agent-mode-toggle';\r\nimport { useAuthGuard } from '../hooks/useAuthGuard';\r\nimport { usePaginatedApps } from '@/hooks/use-paginated-apps';\r\nimport { AnimatePresence, LayoutGroup, motion } from 'framer-motion';\r\nimport { AppCard } from '@/components/shared/AppCard';\r\nimport clsx from 'clsx';\r\nimport { useImageUpload } from '@/hooks/use-image-upload';\r\nimport { useDragDrop } from '@/hooks/use-drag-drop';\r\nimport { ImageUploadButton } from '@/components/image-upload-button';\r\nimport { ImageAttachmentPreview } from '@/components/image-attachment-preview';\r\nimport { SUPPORTED_IMAGE_MIME_TYPES } from '@/api-types';\r\n\r\nexport default function Home() {\r\n\tconst navigate = useNavigate();\r\n\tconst { requireAuth } = useAuthGuard();\r\n\tconst textareaRef = useRef<HTMLTextAreaElement>(null);\r\n\tconst [agentMode, setAgentMode] = useState<AgentMode>('deterministic');\r\n\tconst [query, setQuery] = useState('');\r\n\tconst { user } = useAuth();\r\n\r\n\tconst { images, addImages, removeImage, clearImages, isProcessing } = useImageUpload({\r\n\t\tonError: (error) => {\r\n\t\t\t// TODO: Show error toast/notification\r\n\t\t\tconsole.error('Image upload error:', error);\r\n\t\t},\r\n\t});\r\n\r\n\tconst { isDragging, dragHandlers } = useDragDrop({\r\n\t\tonFilesDropped: addImages,\r\n\t\taccept: [...SUPPORTED_IMAGE_MIME_TYPES],\r\n\t});\r\n\r\n\r\n\tconst placeholderPhrases = useMemo(() => [\r\n\t\t\"todo list app\",\r\n\t\t\"F1 fantasy game\",\r\n\t\t\"personal finance tracker\"\r\n\t], []);\r\n\tconst [currentPlaceholderPhraseIndex, setCurrentPlaceholderPhraseIndex] = useState(0);\r\n\tconst [currentPlaceholderText, setCurrentPlaceholderText] = useState(\"\");\r\n\tconst [isPlaceholderTyping, setIsPlaceholderTyping] = useState(true);\r\n\r\n\tconst {\r\n\t\tapps,\r\n\t\tloading,\r\n\t} = usePaginatedApps({\r\n\t\ttype: 'public',\r\n\t\tdefaultSort: 'popular',\r\n\t\tdefaultPeriod: 'week',\r\n\t\tlimit: 6,\r\n\t});\r\n\r\n\t// Discover section should appear only when enough apps are available and loading is done\r\n\tconst discoverReady = useMemo(() => !loading && (apps?.length ?? 0) > 5, [loading, apps]);\r\n\r\n\tconst handleCreateApp = (query: string, mode: AgentMode) => {\r\n\t\tconst encodedQuery = encodeURIComponent(query);\r\n\t\tconst encodedMode = encodeURIComponent(mode);\r\n\t\t\r\n\t\t// Encode images as JSON if present\r\n\t\tconst imageParam = images.length > 0 ? `&images=${encodeURIComponent(JSON.stringify(images))}` : '';\r\n\t\tconst intendedUrl = `/chat/new?query=${encodedQuery}&agentMode=${encodedMode}${imageParam}`;\r\n\r\n\t\tif (\r\n\t\t\t!requireAuth({\r\n\t\t\t\trequireFullAuth: true,\r\n\t\t\t\tactionContext: 'to create applications',\r\n\t\t\t\tintendedUrl: intendedUrl,\r\n\t\t\t})\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// User is already authenticated, navigate immediately\r\n\t\tnavigate(intendedUrl);\r\n\t\t// Clear images after navigation\r\n\t\tclearImages();\r\n\t};\r\n\r\n\t// Auto-resize textarea based on content\r\n\tconst adjustTextareaHeight = () => {\r\n\t\tif (textareaRef.current) {\r\n\t\t\ttextareaRef.current.style.height = 'auto';\r\n\t\t\tconst scrollHeight = textareaRef.current.scrollHeight;\r\n\t\t\tconst maxHeight = 300; // Maximum height in pixels\r\n\t\t\ttextareaRef.current.style.height =\r\n\t\t\t\tMath.min(scrollHeight, maxHeight) + 'px';\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tadjustTextareaHeight();\r\n\t}, []);\r\n\r\n\t// Typewriter effect\r\n\tuseEffect(() => {\r\n\t\tconst currentPhrase = placeholderPhrases[currentPlaceholderPhraseIndex];\r\n\r\n\t\tif (isPlaceholderTyping) {\r\n\t\t\tif (currentPlaceholderText.length < currentPhrase.length) {\r\n\t\t\t\tconst timeout = setTimeout(() => {\r\n\t\t\t\t\tsetCurrentPlaceholderText(currentPhrase.slice(0, currentPlaceholderText.length + 1));\r\n\t\t\t\t}, 100); // Typing speed\r\n\t\t\t\treturn () => clearTimeout(timeout);\r\n\t\t\t} else {\r\n\t\t\t\t// Pause before erasing\r\n\t\t\t\tconst timeout = setTimeout(() => {\r\n\t\t\t\t\tsetIsPlaceholderTyping(false);\r\n\t\t\t\t}, 2000); // Pause duration\r\n\t\t\t\treturn () => clearTimeout(timeout);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (currentPlaceholderText.length > 0) {\r\n\t\t\t\tconst timeout = setTimeout(() => {\r\n\t\t\t\t\tsetCurrentPlaceholderText(currentPlaceholderText.slice(0, -1));\r\n\t\t\t\t}, 50); // Erasing speed\r\n\t\t\t\treturn () => clearTimeout(timeout);\r\n\t\t\t} else {\r\n\t\t\t\t// Move to next phrase\r\n\t\t\t\tsetCurrentPlaceholderPhraseIndex((prev) => (prev + 1) % placeholderPhrases.length);\r\n\t\t\t\tsetIsPlaceholderTyping(true);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [currentPlaceholderText, currentPlaceholderPhraseIndex, isPlaceholderTyping, placeholderPhrases]);\r\n\r\n\tconst discoverLinkRef = useRef<HTMLDivElement>(null);\r\n\r\n\treturn (\r\n\t\t<div className=\"relative flex flex-col items-center size-full\">\r\n\t\t\t{/* Dotted background pattern - extends to full viewport */}\r\n\t\t\t<div className=\"fixed inset-0 text-accent z-0 opacity-20 pointer-events-none\">\r\n\t\t\t\t<svg width=\"100%\" height=\"100%\">\r\n\t\t\t\t\t<defs>\r\n\t\t\t\t\t\t<pattern\r\n\t\t\t\t\t\t\tid=\":S2:\"\r\n\t\t\t\t\t\t\tviewBox=\"-6 -6 12 12\"\r\n\t\t\t\t\t\t\tpatternUnits=\"userSpaceOnUse\"\r\n\t\t\t\t\t\t\twidth=\"12\"\r\n\t\t\t\t\t\t\theight=\"12\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<circle\r\n\t\t\t\t\t\t\t\tcx=\"0\"\r\n\t\t\t\t\t\t\t\tcy=\"0\"\r\n\t\t\t\t\t\t\t\tr=\"1\"\r\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t></circle>\r\n\t\t\t\t\t\t</pattern>\r\n\t\t\t\t\t</defs>\r\n\t\t\t\t\t<rect\r\n\t\t\t\t\t\twidth=\"100%\"\r\n\t\t\t\t\t\theight=\"100%\"\r\n\t\t\t\t\t\tfill=\"url(#:S2:)\"\r\n\t\t\t\t\t></rect>\r\n\t\t\t\t</svg>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<LayoutGroup>\r\n\t\t\t\t<div className=\"rounded-md w-full max-w-2xl overflow-hidden\">\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tlayout\r\n\t\t\t\t\t\ttransition={{ layout: { duration: 0.5, ease: [0.22, 1, 0.36, 1] } }}\r\n\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\"px-6 p-8 flex flex-col items-center z-10\",\r\n\t\t\t\t\t\t\tdiscoverReady ? \"mt-48\" : \"mt-[20vh] sm:mt-[24vh] md:mt-[28vh]\"\r\n\t\t\t\t\t\t)}>\r\n\t\t\t\t\t\t<h1 className=\"text-shadow-sm text-shadow-red-200 dark:text-shadow-red-900 text-accent font-medium leading-[1.1] tracking-tight text-5xl w-full mb-4 bg-clip-text bg-gradient-to-r from-text-primary to-text-primary/90\">\r\n\t\t\t\t\t\t\tWhat should we build today?\r\n\t\t\t\t\t\t</h1>\r\n\r\n\t\t\t\t\t\t<form\r\n\t\t\t\t\t\t\tmethod=\"POST\"\r\n\t\t\t\t\t\t\tonSubmit={(e) => {\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\tconst query = textareaRef.current!.value;\r\n\t\t\t\t\t\t\t\thandleCreateApp(query, agentMode);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tclassName=\"flex z-10 flex-col w-full min-h-[150px] bg-bg-4 border border-accent/30 dark:border-accent/50 dark:bg-bg-2 rounded-[18px] shadow-textarea p-5 transition-all duration-200\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div \r\n\t\t\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\t\t\"flex-1 flex flex-col relative\",\r\n\t\t\t\t\t\t\t\t\tisDragging && \"ring-2 ring-accent ring-offset-2 rounded-lg\"\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t{...dragHandlers}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{isDragging && (\r\n\t\t\t\t\t\t\t\t\t<div className=\"absolute inset-0 flex items-center justify-center bg-accent/10 backdrop-blur-sm rounded-lg z-30 pointer-events-none\">\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-accent font-medium\">Drop images here</p>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\t\tclassName=\"w-full resize-none ring-0 z-20 outline-0 placeholder:text-text-primary/60 text-text-primary\"\r\n\t\t\t\t\t\t\t\t\tname=\"query\"\r\n\t\t\t\t\t\t\t\t\tvalue={query}\r\n\t\t\t\t\t\t\t\t\tplaceholder={`Create a ${currentPlaceholderText}`}\r\n\t\t\t\t\t\t\t\t\tref={textareaRef}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tsetQuery(e.target.value);\r\n\t\t\t\t\t\t\t\t\t\tadjustTextareaHeight();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\tonInput={adjustTextareaHeight}\r\n\t\t\t\t\t\t\t\t\tonKeyDown={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tif (e.key === 'Enter' && !e.shiftKey) {\r\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\tconst query = textareaRef.current!.value;\r\n\t\t\t\t\t\t\t\t\t\t\thandleCreateApp(query, agentMode);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{images.length > 0 && (\r\n\t\t\t\t\t\t\t\t\t<div className=\"mt-3\">\r\n\t\t\t\t\t\t\t\t\t\t<ImageAttachmentPreview\r\n\t\t\t\t\t\t\t\t\t\t\timages={images}\r\n\t\t\t\t\t\t\t\t\t\t\tonRemove={removeImage}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between mt-4 pt-1\">\r\n\t\t\t\t\t\t\t\t{import.meta.env.VITE_AGENT_MODE_ENABLED ? (\r\n\t\t\t\t\t\t\t\t\t<AgentModeToggle\r\n\t\t\t\t\t\t\t\t\t\tvalue={agentMode}\r\n\t\t\t\t\t\t\t\t\t\tonChange={setAgentMode}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex-1\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<div></div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-end ml-4 gap-2\">\r\n\t\t\t\t\t\t\t\t<ImageUploadButton\r\n\t\t\t\t\t\t\t\t\tonFilesSelected={addImages}\r\n\t\t\t\t\t\t\t\t\tdisabled={isProcessing}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\t\tdisabled={!query.trim()}\r\n\t\t\t\t\t\t\t\t\tclassName=\"bg-accent text-white p-1 rounded-md *:size-5 transition-all duration-200 hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<ArrowRight />\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</motion.div>\r\n\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<AnimatePresence>\r\n\t\t\t\t\t{images.length > 0 && (\r\n\t\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\t\tinitial={{ opacity: 0, y: -10 }}\r\n\t\t\t\t\t\t\tanimate={{ opacity: 1, y: 0 }}\r\n\t\t\t\t\t\t\texit={{ opacity: 0, y: -10 }}\r\n\t\t\t\t\t\t\tclassName=\"w-full max-w-2xl px-6\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div className=\"flex items-start gap-2 px-4 py-3 rounded-xl bg-bg-4/50 dark:bg-bg-2/50 border border-accent/20 dark:border-accent/30 shadow-sm\">\r\n\t\t\t\t\t\t\t\t<Info className=\"size-4 text-accent flex-shrink-0 mt-0.5\" />\r\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-text-tertiary leading-relaxed\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-text-secondary\">Images Beta:</span> Images guide app layout and design but may not be replicated exactly. The coding agent cannot access images directly for app assets.\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</motion.div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</AnimatePresence>\r\n\r\n\t\t\t\t<AnimatePresence>\r\n\t\t\t\t\t{discoverReady && (\r\n\t\t\t\t\t\t<motion.section\r\n\t\t\t\t\t\t\tkey=\"discover-section\"\r\n\t\t\t\t\t\t\tlayout\r\n\t\t\t\t\t\t\tinitial={{ opacity: 0, height: 0 }}\r\n\t\t\t\t\t\t\tanimate={{ opacity: 1, height: \"auto\" }}\r\n\t\t\t\t\t\t\texit={{ opacity: 0, height: 0 }}\r\n\t\t\t\t\t\t\ttransition={{ duration: 0.5, ease: [0.22, 1, 0.36, 1] }}\r\n\t\t\t\t\t\t\tclassName={clsx('max-w-6xl mx-auto px-4 z-10', images.length > 0 ? 'mt-10' : 'mt-16 mb-8')}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div className='flex flex-col items-start'>\r\n\t\t\t\t\t\t\t\t<h2 className=\"text-2xl font-medium text-text-secondary/80\">Discover Apps built by the community</h2>\r\n\t\t\t\t\t\t\t\t<div ref={discoverLinkRef} className=\"text-md font-light mb-4 text-text-tertiary hover:underline underline-offset-4 select-text cursor-pointer\" onClick={() => navigate('/discover')} >View All</div>\r\n\t\t\t\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\t\t\t\tlayout\r\n\t\t\t\t\t\t\t\t\ttransition={{ duration: 0.4 }}\r\n\t\t\t\t\t\t\t\t\tclassName=\"grid grid-cols-2 xl:grid-cols-3 gap-6\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<AnimatePresence mode=\"popLayout\">\r\n\t\t\t\t\t\t\t\t\t\t{apps.map(app => (\r\n\t\t\t\t\t\t\t\t\t\t\t<AppCard\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={app.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\tapp={app}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => navigate(`/app/${app.id}`)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowStats={true}\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowUser={true}\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowActions={false}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t</AnimatePresence>\r\n\t\t\t\t\t\t\t\t</motion.div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</motion.section>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</AnimatePresence>\r\n\t\t\t</LayoutGroup>\r\n\r\n\t\t\t{/* Nudge towards Discover */}\r\n\t\t\t{user && <CurvedArrow sourceRef={discoverLinkRef} target={{ x: 50, y: window.innerHeight - 60 }} />}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n\r\n\r\ntype ArrowProps = {\r\n\t/** Ref to the source element the arrow starts from */\r\n\tsourceRef: React.RefObject<HTMLElement | null>;\r\n\t/** Target point in viewport/client coordinates */\r\n\ttarget: { x: number; y: number };\r\n\t/** Curve intensity (0.1 - 1.5 is typical) */\r\n\tcurvature?: number;\r\n\t/** Optional pixel offset from source element edge */\r\n\tsourceOffset?: number;\r\n\t/** If true, hides the arrow when the source is offscreen/not measurable */\r\n\thideWhenInvalid?: boolean;\r\n};\r\n\r\ntype Point = { x: number; y: number };\r\n\r\nexport const CurvedArrow: React.FC<ArrowProps> = ({\r\n\tsourceRef,\r\n\ttarget,\r\n\tcurvature = 0.5,\r\n\tsourceOffset = 6,\r\n\thideWhenInvalid = true,\r\n}) => {\r\n\tconst [start, setStart] = useState<Point | null>(null);\r\n\tconst [end, setEnd] = useState<Point | null>(null);\r\n\r\n\tconst rafRef = useRef<number | null>(null);\r\n\tconst roRef = useRef<ResizeObserver | null>(null);\r\n\r\n\tconst compute = () => {\r\n\t\tconst el = sourceRef.current;\r\n\t\tif (!el) {\r\n\t\t\tsetStart(null);\r\n\t\t\tsetEnd(null);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst rect = el.getBoundingClientRect();\r\n\t\tif (!rect || rect.width === 0 || rect.height === 0) {\r\n\t\t\tsetStart(null);\r\n\t\t\tsetEnd(null);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst endPoint: Point = { x: target.x, y: target.y };\r\n\r\n\t\t// Choose an anchor on the source: midpoint of the side facing the target\r\n\t\tconst centers = {\r\n\t\t\tright: { x: rect.right, y: rect.top + rect.height / 2 },\r\n\t\t\tleft: { x: rect.left, y: rect.top + rect.height / 2 },\r\n\t\t};\r\n\r\n\t\t// Distances to target from each side center\r\n\t\tconst dists = Object.fromEntries(\r\n\t\t\tObject.entries(centers).map(([side, p]) => [\r\n\t\t\t\tside,\r\n\t\t\t\t(p.x - endPoint.x) ** 2 + (p.y - endPoint.y) ** 2,\r\n\t\t\t])\r\n\t\t) as Record<keyof typeof centers, number>;\r\n\r\n\t\tconst bestSide = (Object.entries(dists).sort((a, b) => a[1] - b[1])[0][0] ||\r\n\t\t\t\"right\") as keyof typeof centers;\r\n\r\n\t\t// Nudge start point slightly outside the element for visual clarity\r\n\t\tconst nudge = (p: Point, side: keyof typeof centers, offset: number) => {\r\n\t\t\tswitch (side) {\r\n\t\t\t\tcase \"right\":\r\n\t\t\t\t\treturn { x: p.x + offset, y: p.y };\r\n\t\t\t\tcase \"left\":\r\n\t\t\t\t\treturn { x: p.x - offset, y: p.y };\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst startPoint = nudge(centers[bestSide], bestSide, sourceOffset);\r\n\r\n\t\tsetStart(startPoint);\r\n\t\tsetEnd(endPoint);\r\n\t};\r\n\r\n\t// Throttle updates with rAF to avoid layout thrash\r\n\tconst scheduleCompute = () => {\r\n\t\tif (rafRef.current != null) cancelAnimationFrame(rafRef.current);\r\n\t\trafRef.current = requestAnimationFrame(compute);\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tscheduleCompute();\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [target.x, target.y, sourceRef.current]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst onScroll = () => scheduleCompute();\r\n\t\tconst onResize = () => scheduleCompute();\r\n\r\n\t\twindow.addEventListener(\"scroll\", onScroll, { passive: true });\r\n\t\twindow.addEventListener(\"resize\", onResize);\r\n\r\n\t\t// Track source element size changes\r\n\t\tconst el = sourceRef.current;\r\n\t\tif (\"ResizeObserver\" in window) {\r\n\t\t\troRef.current = new ResizeObserver(() => scheduleCompute());\r\n\t\t\tif (el) roRef.current.observe(el);\r\n\t\t}\r\n\r\n\t\tscheduleCompute();\r\n\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"scroll\", onScroll);\r\n\t\t\twindow.removeEventListener(\"resize\", onResize);\r\n\t\t\tif (rafRef.current != null) cancelAnimationFrame(rafRef.current);\r\n\t\t\tif (roRef.current && el) roRef.current.unobserve(el);\r\n\t\t};\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\tconst d = useMemo(() => {\r\n\t\tif (!start || !end) return \"\";\r\n\r\n\t\tconst dx = end.x - start.x;\r\n\t\tconst dy = end.y - start.y;\r\n\r\n\t\t// Control points: bend the curve based on the primary axis difference.\r\n\t\t// This gives a nice S or C curve without sharp kinks.\r\n\t\tconst cpOffset = Math.max(Math.abs(dx), Math.abs(dy)) * curvature;\r\n\r\n\t\tconst c1: Point = { x: start.x + cpOffset * (dx >= 0 ? 1 : -1), y: start.y };\r\n\t\tconst c2: Point = { x: end.x - cpOffset * (dx >= 0 ? 1 : -1), y: end.y };\r\n\r\n\t\treturn `M ${start.x},${start.y} C ${c1.x},${c1.y} ${c2.x},${c2.y} ${end.x},${end.y}`;\r\n\t}, [start, end, curvature]);\r\n\r\n\tconst hidden = hideWhenInvalid && (!start || !end);\r\n\r\n\tif (start && end && (end.y - start.y > 420 || start.x - end.x < 100)) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<svg\r\n\t\t\taria-hidden=\"true\"\r\n\t\t\tstyle={{\r\n\t\t\t\tposition: \"fixed\",\r\n\t\t\t\tinset: 0,\r\n\t\t\t\twidth: \"100vw\",\r\n\t\t\t\theight: \"100vh\",\r\n\t\t\t\tpointerEvents: \"none\",\r\n\t\t\t\toverflow: \"visible\",\r\n\t\t\t\tzIndex: 9999,\r\n\t\t\t\tdisplay: hidden ? \"none\" : \"block\",\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<defs>\r\n\t\t\t\t<filter id=\"discover-squiggle\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\">\r\n\t\t\t\t\t<feTurbulence type=\"fractalNoise\" baseFrequency=\"0.8\" numOctaves=\"1\" seed=\"3\" result=\"noise\" />\r\n\t\t\t\t\t<feDisplacementMap in=\"SourceGraphic\" in2=\"noise\" scale=\"1\" xChannelSelector=\"R\" yChannelSelector=\"G\" />\r\n\t\t\t\t</filter>\r\n\t\t\t\t<marker id=\"discover-arrowhead\" markerWidth=\"8\" markerHeight=\"8\" refX=\"7\" refY=\"4\" orient=\"auto\" markerUnits=\"strokeWidth\" opacity={0.20}>\r\n\t\t\t\t\t<path d=\"M 0 1.2 L 7 4\" stroke=\"var(--color-text-tertiary)\" strokeWidth=\"1.6\" strokeLinecap=\"round\" fill=\"none\" />\r\n\t\t\t\t\t<path d=\"M 0 6.8 L 7 4\" stroke=\"var(--color-text-tertiary)\" strokeWidth=\"1.2\" strokeLinecap=\"round\" fill=\"none\" />\r\n\t\t\t\t</marker>\r\n\t\t\t</defs>\r\n\r\n\t\t\t<path\r\n\t\t\t\td={d}\r\n\t\t\t\t// stroke=\"var(--color-accent)\"\r\n\t\t\t\tstroke=\"var(--color-text-tertiary)\"\r\n\t\t\t\tstrokeOpacity={0.20}\r\n\t\t\t\tstrokeWidth={1.6}\r\n\t\t\t\tfill=\"none\"\r\n\t\t\t\tstrokeLinecap=\"round\"\r\n\t\t\t\tstrokeLinejoin=\"round\"\r\n\t\t\t\tvectorEffect=\"non-scaling-stroke\"\r\n\t\t\t\tmarkerEnd=\"url(#discover-arrowhead)\"\r\n\t\t\t/>\r\n\t\t\t{/* Soft squiggle overlay for hand-drawn feel */}\r\n\t\t\t<g filter=\"url(#discover-squiggle)\">\r\n\t\t\t\t<path\r\n\t\t\t\t\td={d}\r\n\t\t\t\t\t// stroke=\"var(--color-accent)\"\r\n\t\t\t\t\tstroke=\"var(--color-text-tertiary)\"\r\n\t\t\t\t\tstrokeOpacity={0.12}\r\n\t\t\t\t\tstrokeWidth={1}\r\n\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\tstrokeLinecap=\"round\"\r\n\t\t\t\t\tstrokeLinejoin=\"round\"\r\n\t\t\t\t\tstrokeDasharray=\"8 6 4 9 5 7\"\r\n\t\t\t\t\tvectorEffect=\"non-scaling-stroke\"\r\n\t\t\t\t/>\r\n\t\t\t</g>\r\n\t\t</svg>\r\n\t);\r\n};\r\n","export default \"import type { RouteObject } from 'react-router';\\r\\nimport React from 'react';\\r\\n\\r\\nimport App from './App';\\r\\nimport Home from './routes/home';\\r\\nimport Chat from './routes/chat/chat';\\r\\nimport Profile from './routes/profile';\\r\\nimport Settings from './routes/settings/index';\\r\\nimport AppsPage from './routes/apps';\\r\\nimport AppView from './routes/app';\\r\\nimport DiscoverPage from './routes/discover';\\r\\nimport { ProtectedRoute } from './routes/protected-route';\\r\\n\\r\\nconst routes = [\\r\\n\\t{\\r\\n\\t\\tpath: '/',\\r\\n\\t\\tComponent: App,\\r\\n\\t\\tchildren: [\\r\\n\\t\\t\\t{\\r\\n\\t\\t\\t\\tindex: true,\\r\\n\\t\\t\\t\\tComponent: Home,\\r\\n\\t\\t\\t},\\r\\n\\t\\t\\t{\\r\\n\\t\\t\\t\\tpath: 'chat/:chatId',\\r\\n\\t\\t\\t\\tComponent: Chat,\\r\\n\\t\\t\\t},\\r\\n\\t\\t\\t{\\r\\n\\t\\t\\t\\tpath: 'profile',\\r\\n\\t\\t\\t\\telement: React.createElement(ProtectedRoute, { children: React.createElement(Profile) }),\\r\\n\\t\\t\\t},\\r\\n\\t\\t\\t{\\r\\n\\t\\t\\t\\tpath: 'settings',\\r\\n\\t\\t\\t\\telement: React.createElement(ProtectedRoute, { children: React.createElement(Settings) }),\\r\\n\\t\\t\\t},\\r\\n\\t\\t\\t{\\r\\n\\t\\t\\t\\tpath: 'apps',\\r\\n\\t\\t\\t\\telement: React.createElement(ProtectedRoute, { children: React.createElement(AppsPage) }),\\r\\n\\t\\t\\t},\\r\\n\\t\\t\\t{\\r\\n\\t\\t\\t\\tpath: 'app/:id',\\r\\n\\t\\t\\t\\tComponent: AppView,\\r\\n\\t\\t\\t},\\r\\n\\t\\t\\t{\\r\\n\\t\\t\\t\\tpath: 'discover',\\r\\n\\t\\t\\t\\tComponent: DiscoverPage,\\r\\n\\t\\t\\t},\\r\\n\\t\\t],\\r\\n\\t},\\r\\n] satisfies RouteObject[];\\r\\n\\r\\nexport { routes };\\r\\n\"","import React, { memo, useEffect, useRef } from 'react';\r\nimport * as monaco from 'monaco-editor';\r\nimport { useTheme } from '../../contexts/theme-context';\r\n\r\nimport 'monaco-editor/esm/vs/editor/editor.all.js';\r\nimport editorWorker from 'monaco-editor/esm/vs/editor/editor.worker?worker';\r\nimport jsonWorker from 'monaco-editor/esm/vs/language/json/json.worker?worker';\r\nimport cssWorker from 'monaco-editor/esm/vs/language/css/css.worker?worker';\r\nimport htmlWorker from 'monaco-editor/esm/vs/language/html/html.worker?worker';\r\nimport tsWorker from 'monaco-editor/esm/vs/language/typescript/ts.worker?worker';\r\n\r\nimport defaultCode from '../../routes?raw';\r\nimport './monaco-editor.module.css';\r\n\r\nself.MonacoEnvironment = {\r\n\tgetWorker(_, label) {\r\n\t\tif (label === 'json') {\r\n\t\t\treturn new jsonWorker();\r\n\t\t}\r\n\t\tif (label === 'css' || label === 'scss' || label === 'less') {\r\n\t\t\treturn new cssWorker();\r\n\t\t}\r\n\t\tif (label === 'html' || label === 'handlebars' || label === 'razor') {\r\n\t\t\treturn new htmlWorker();\r\n\t\t}\r\n\t\tif (\r\n\t\t\tlabel === 'typescript' ||\r\n\t\t\tlabel === 'javascript' ||\r\n\t\t\tlabel === 'typescriptreact' ||\r\n\t\t\tlabel === 'javascriptreact'\r\n\t\t) {\r\n\t\t\treturn new tsWorker();\r\n\t\t}\r\n\t\treturn new editorWorker();\r\n\t},\r\n};\r\n\r\n// From GitHub Dark theme\r\nmonaco.editor.defineTheme('v1-dev-dark', {\r\n\tbase: 'vs-dark',\r\n\tinherit: true,\r\n\trules: [\r\n\t\t{ token: '', foreground: 'c9d1d9', background: '0d1117' },\r\n\t\t{ token: 'comment', foreground: '8b949e', fontStyle: 'italic' },\r\n\t\t{ token: 'keyword', foreground: 'ff7b72' },\r\n\t\t{ token: 'number', foreground: '79c0ff' },\r\n\t\t{ token: 'string', foreground: 'a5d6ff' },\r\n\t\t{ token: 'type', foreground: 'ffa657' },\r\n\t\t{ token: 'class', foreground: 'd2a8ff' },\r\n\t\t{ token: 'interface', foreground: 'ffdf5d' },\r\n\t\t{ token: 'function', foreground: 'd2a8ff' },\r\n\t\t{ token: 'member', foreground: '79c0ff' },\r\n\t\t{ token: 'variable', foreground: 'c9d1d9' },\r\n\t\t{ token: 'constant', foreground: 'ffab70' },\r\n\t\t{ token: 'operator', foreground: 'ff7b72' },\r\n\t\t{ token: 'namespace', foreground: 'ffab70' },\r\n\t\t{ token: 'predefined', foreground: 'ffa657' },\r\n\t\t{ token: 'invalid', foreground: 'ffffff', background: 'f85149' },\r\n\t],\r\n\tcolors: {\r\n\t\t// default backgorund, overriden to match theme\r\n\t\t// 'editor.background': '#0d1117',\r\n\t\t'editor.background': '#171512',\r\n\t\t'editor.foreground': '#c9d1d9',\r\n\t\t'editorLineNumber.foreground': '#444c56',\r\n\t\t'editorLineNumber.activeForeground': '#8b949e',\r\n\t\t'editorCursor.foreground': '#58a6ff',\r\n\t\t'editorIndentGuide.background': '#21262d',\r\n\t\t'editorIndentGuide.activeBackground': '#30363d',\r\n\t\t'editor.selectionBackground': '#264f78',\r\n\t\t'editor.inactiveSelectionBackground': '#1f6feb44',\r\n\t\t'editor.lineHighlightBackground': '#161b22',\r\n\t\t'editor.wordHighlightBackground': '#3fb95040',\r\n\t\t'editor.wordHighlightStrongBackground': '#ff7b7240',\r\n\t\t'editor.findMatchBackground': '#ffd33d44',\r\n\t\t'editor.findMatchHighlightBackground': '#ffd33d22',\r\n\t},\r\n});\r\n\r\nmonaco.editor.defineTheme('v1-dev', {\r\n\tbase: 'vs',\r\n\tinherit: true,\r\n\trules: [\r\n\t\t{ token: '', foreground: '000000', background: 'fbfbfc' },\r\n\t\t{ token: 'comment', foreground: '6e7781', fontStyle: 'italic' },\r\n\t\t{ token: 'keyword', foreground: '0092b8' },\r\n\t\t{ token: 'number', foreground: '0550ae' },\r\n\t\t{ token: 'string', foreground: '0a3069' },\r\n\t\t{ token: 'type', foreground: '0092b8' },\r\n\t\t{ token: 'class', foreground: '0092b8' },\r\n\t\t{ token: 'interface', foreground: '0092b8' },\r\n\t\t{ token: 'function', foreground: '953800' },\r\n\t\t{ token: 'member', foreground: '0550ae' },\r\n\t\t{ token: 'variable', foreground: '24292f' },\r\n\t\t{ token: 'constant', foreground: '0550ae' },\r\n\t\t{ token: 'operator', foreground: '0092b8' },\r\n\t\t{ token: 'namespace', foreground: '0092b8' },\r\n\t\t{ token: 'predefined', foreground: '0092b8' },\r\n\t\t{ token: 'invalid', foreground: 'ff0000' },\r\n\t],\r\n\tcolors: {\r\n\t\t'editor.background': '#fbfbfc',\r\n\t\t'editor.foreground': '#24292f',\r\n\t\t'editorLineNumber.foreground': '#8c959f',\r\n\t\t'editorLineNumber.activeForeground': '#24292f',\r\n\t\t'editorCursor.foreground': '#0092b8',\r\n\t\t'editorIndentGuide.background': '#d0d7de',\r\n\t\t'editorIndentGuide.activeBackground': '#8c959f',\r\n\t\t'editor.selectionBackground': '#0092b820',\r\n\t\t'editor.inactiveSelectionBackground': '#0092b810',\r\n\t\t'editor.lineHighlightBackground': '#0092b808',\r\n\t\t'editor.wordHighlightBackground': '#0092b815',\r\n\t\t'editor.wordHighlightStrongBackground': '#0092b820',\r\n\t\t'editor.findMatchBackground': '#0092b830',\r\n\t\t'editor.findMatchHighlightBackground': '#0092b815',\r\n\t},\r\n});\r\n\r\nmonaco.editor.setTheme('v1-dev');\r\n\r\nmonaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({\r\n\tnoSemanticValidation: true,\r\n\tnoSyntaxValidation: true,\r\n});\r\n\r\n// Configure TypeScript defaults for JSX support\r\nmonaco.languages.typescript.typescriptDefaults.setCompilerOptions({\r\n\tjsx: monaco.languages.typescript.JsxEmit.React,\r\n\tallowJs: true,\r\n\tallowSyntheticDefaultImports: true,\r\n\tesModuleInterop: true,\r\n\tmoduleResolution: monaco.languages.typescript.ModuleResolutionKind.NodeJs,\r\n\tmodule: monaco.languages.typescript.ModuleKind.ESNext,\r\n\ttarget: monaco.languages.typescript.ScriptTarget.ESNext,\r\n\tjsxFactory: 'React.createElement',\r\n\tjsxFragmentFactory: 'React.Fragment',\r\n});\r\n\r\n// Configure JavaScript defaults for JSX support\r\nmonaco.languages.typescript.javascriptDefaults.setCompilerOptions({\r\n\tallowJs: true,\r\n\tallowSyntheticDefaultImports: true,\r\n\tesModuleInterop: true,\r\n\tjsx: monaco.languages.typescript.JsxEmit.React,\r\n\tmoduleResolution: monaco.languages.typescript.ModuleResolutionKind.NodeJs,\r\n\tmodule: monaco.languages.typescript.ModuleKind.ESNext,\r\n\ttarget: monaco.languages.typescript.ScriptTarget.ESNext,\r\n\tjsxFactory: 'React.createElement',\r\n\tjsxFragmentFactory: 'React.Fragment',\r\n});\r\n\r\nexport type MonacoEditorProps = React.ComponentProps<'div'> & {\r\n\tcreateOptions?: monaco.editor.IStandaloneEditorConstructionOptions;\r\n\tfind?: string;\r\n\treplace?: string;\r\n};\r\n\r\n/**\r\n * TODO: Create a file map to properly manage multiple files in monaco\r\n */\r\n\r\nexport const MonacoEditor = memo<MonacoEditorProps>(function MonacoEditor({\r\n\tcreateOptions = {},\r\n\tfind,\r\n\treplace,\r\n\t...props\r\n}) {\r\n\tconst containerRef = useRef<HTMLDivElement>(null);\r\n\tconst editor = useRef<monaco.editor.IStandaloneCodeEditor>(undefined);\r\n\tconst prevValue = useRef<string>(createOptions.value || '');\r\n\tconst stickyScroll = useRef(true);\r\n\tconst { theme } = useTheme();\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tlet configuredTheme = theme;\r\n\t\tif (theme === 'system') {\r\n\t\t\tconfiguredTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'\r\n\t\t}\r\n\t\teditor.current = monaco.editor.create(containerRef.current!, {\r\n\t\t\tlanguage: createOptions.language || 'typescript',\r\n\t\t\tminimap: { enabled: false },\r\n\t\t\ttheme: configuredTheme === 'dark' ? 'v1-dev-dark' : 'v1-dev',\r\n\t\t\tautomaticLayout: true,\r\n\t\t\tvalue: defaultCode,\r\n\t\t\tfontSize: 13,\r\n\t\t\t...createOptions,\r\n\t\t});\r\n\r\n\t\t// Add scroll listener to detect user interaction\r\n\t\tconst editorDomNode = editor.current.getDomNode();\r\n\t\tif (editorDomNode) {\r\n\t\t\teditorDomNode.addEventListener('wheel', () => {\r\n\t\t\t\tif (stickyScroll.current) {\r\n\t\t\t\t\tstickyScroll.current = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\teditorDomNode.addEventListener('keydown', (e) => {\r\n\t\t\t\t// Disable sticky scroll on arrow keys, Page Up/Down\r\n\t\t\t\tif (e.key.includes('Arrow') || e.key.includes('Page')) {\r\n\t\t\t\t\tif (stickyScroll.current) {\r\n\t\t\t\t\t\tstickyScroll.current = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\teditor.current?.dispose();\r\n\t\t};\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (editor.current && createOptions.value !== prevValue.current) {\r\n\t\t\tconst model = editor.current.getModel();\r\n\t\t\tif (!model) return;\r\n\r\n\t\t\teditor.current.setValue(createOptions.value || '');\r\n\r\n\t\t\tif (stickyScroll.current) {\r\n\t\t\t\t// Scroll to bottom\r\n\t\t\t\tconst lineCount = model.getLineCount();\r\n\t\t\t\teditor.current.revealLine(lineCount);\r\n\t\t\t}\r\n\r\n\t\t\tif (createOptions.language) {\r\n\t\t\t\tmonaco.editor.setModelLanguage(model, createOptions.language);\r\n\t\t\t}\r\n\r\n\t\t\tprevValue.current = createOptions.value || '';\r\n\t\t}\r\n\t}, [createOptions.value, createOptions.language]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!editor.current || !find) return;\r\n\r\n\t\tconst model = editor.current.getModel();\r\n\t\tif (!model) return;\r\n\r\n\t\tconst decorations: monaco.editor.IModelDeltaDecoration[] = [];\r\n\t\tconst text = model.getValue();\r\n\t\tlet match: RegExpExecArray | null;\r\n\t\tconst regex = new RegExp(find.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'g');\r\n\r\n\t\twhile ((match = regex.exec(text)) !== null) {\r\n\t\t\tconst startPos = model.getPositionAt(match.index);\r\n\t\t\tconst endPos = model.getPositionAt(match.index + match[0].length);\r\n\r\n\t\t\tdecorations.push({\r\n\t\t\t\trange: new monaco.Range(\r\n\t\t\t\t\tstartPos.lineNumber,\r\n\t\t\t\t\tstartPos.column,\r\n\t\t\t\t\tendPos.lineNumber,\r\n\t\t\t\t\tendPos.column,\r\n\t\t\t\t),\r\n\t\t\t\toptions: {\r\n\t\t\t\t\tinlineClassName: 'diffDelete',\r\n\t\t\t\t\thoverMessage: {\r\n\t\t\t\t\t\tvalue: replace\r\n\t\t\t\t\t\t\t? `Will be replaced with: ${replace}`\r\n\t\t\t\t\t\t\t: 'Will be deleted',\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t});\r\n\r\n\t\t\tif (replace) {\r\n\t\t\t\tdecorations.push({\r\n\t\t\t\t\trange: new monaco.Range(\r\n\t\t\t\t\t\tstartPos.lineNumber,\r\n\t\t\t\t\t\tstartPos.column,\r\n\t\t\t\t\t\tendPos.lineNumber,\r\n\t\t\t\t\t\tendPos.column,\r\n\t\t\t\t\t),\r\n\t\t\t\t\toptions: {\r\n\t\t\t\t\t\tafter: {\r\n\t\t\t\t\t\t\tcontent: replace,\r\n\t\t\t\t\t\t\tinlineClassName: 'diffInsert',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst oldDecorations = editor.current.getModel()?.getAllDecorations() || [];\r\n\t\teditor.current.deltaDecorations(\r\n\t\t\toldDecorations.map((d) => d.id),\r\n\t\t\tdecorations,\r\n\t\t);\r\n\t}, [find, replace]);\r\n\r\n\t// Update theme when app theme changes\r\n\tuseEffect(() => {\r\n\t\tif (editor.current) {\r\n\t\t\tmonaco.editor.setTheme(theme === 'dark' ? 'v1-dev-dark' : 'v1-dev');\r\n\t\t}\r\n\t}, [theme]);\r\n\r\n\treturn <div {...props} ref={containerRef}></div>;\r\n});\r\n","import { AIAvatar } from '../../../components/icons/logos';\r\nimport clsx from 'clsx';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport remarkGfm from 'remark-gfm';\r\nimport rehypeExternalLinks from 'rehype-external-links';\r\nimport { LoaderCircle, Check, AlertTriangle } from 'lucide-react';\r\nimport type { ToolEvent } from '../utils/message-helpers';\r\n\r\n/**\r\n * Strip internal system tags that should not be displayed to users\r\n */\r\nfunction sanitizeMessageForDisplay(message: string): string {\r\n\t// Remove <system_context>...</system_context> tags and their content\r\n\treturn message.replace(/<system_context>[\\s\\S]*?<\\/system_context>\\n/gi, '').trim();\r\n}\r\n\r\nexport function UserMessage({ message }: { message: string }) {\r\n\tconst sanitizedMessage = sanitizeMessageForDisplay(message);\r\n\t\r\n\treturn (\r\n\t\t<div className=\"flex gap-3\">\r\n\t\t\t<div className=\"align-text-top pl-1\">\r\n\t\t\t\t<div className=\"size-6 flex items-center justify-center rounded-full bg-accent text-text-on-brand\">\r\n\t\t\t\t\t<span className=\"text-xs\">U</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"flex flex-col gap-2 min-w-0\">\r\n\t\t\t\t<div className=\"font-medium text-text-50\">You</div>\r\n\t\t\t\t<Markdown className=\"text-text-primary/80\">{sanitizedMessage}</Markdown>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport function AIMessage({\r\n\tmessage,\r\n\tisThinking,\r\n\ttoolEvents,\r\n}: {\r\n\tmessage: string;\r\n\tisThinking?: boolean;\r\n\ttoolEvents?: ToolEvent[];\r\n}) {\r\n\tconst sanitizedMessage = sanitizeMessageForDisplay(message);\r\n\t\r\n\treturn (\r\n\t\t<div className=\"flex gap-3\">\r\n\t\t\t<div className=\"align-text-top pl-1\">\r\n\t\t\t\t<AIAvatar className=\"size-6 text-orange-500\" />\r\n\t\t\t</div>\r\n\t\t\t<div className=\"flex flex-col gap-2 min-w-0\">\r\n\t\t\t\t<div className=\"font-mono font-medium text-text-50\">Orange</div>\r\n\t\t\t\t{toolEvents && toolEvents.length > 0 && (\r\n\t\t\t\t\t<div className=\"mb-1.5 flex flex-col gap-1\">\r\n\t\t\t\t\t\t{toolEvents.map((ev) => (\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tkey={`${ev.name}-${ev.timestamp}`}\r\n\t\t\t\t\t\t\t\tclassName=\"flex items-center gap-1.5 text-xs text-text-tertiary\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ev.status === 'start' && (\r\n\t\t\t\t\t\t\t\t\t<LoaderCircle className=\"size-3 animate-spin\" />\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t{ev.status === 'success' && <Check className=\"size-3\" />}\r\n\t\t\t\t\t\t\t\t{ev.status === 'error' && <AlertTriangle className=\"size-3\" />}\r\n\t\t\t\t\t\t\t\t<span className=\"font-mono tracking-tight\">\r\n\t\t\t\t\t\t\t\t\t{ev.status === 'start' && 'Running'}\r\n\t\t\t\t\t\t\t\t\t{ev.status === 'success' && 'Completed'}\r\n\t\t\t\t\t\t\t\t\t{ev.status === 'error' && 'Error'}\r\n\t\t\t\t\t\t\t\t\t{' '}\r\n\t\t\t\t\t\t\t\t\t{ev.name}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t\t<Markdown className={clsx('a-tag', isThinking ? 'animate-pulse' : '')}>\r\n\t\t\t\t\t{sanitizedMessage}\r\n\t\t\t\t</Markdown>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\ninterface MarkdownProps extends React.ComponentProps<'article'> {\r\n\tchildren: string;\r\n}\r\n\r\nexport function Markdown({ children, className, ...props }: MarkdownProps) {\r\n\treturn (\r\n\t\t<article\r\n\t\t\tclassName={clsx('prose prose-sm prose-teal', className)}\r\n\t\t\t{...props}\r\n\t\t>\r\n\t\t\t<ReactMarkdown\r\n\t\t\t\tremarkPlugins={[remarkGfm]}\r\n\t\t\t\trehypePlugins={[[rehypeExternalLinks, { target: '_blank' }]]}\r\n\t\t\t>\r\n\t\t\t\t{children}\r\n\t\t\t</ReactMarkdown>\r\n\t\t</article>\r\n\t);\r\n}\r\n","import type { BlueprintType } from '@/api-types';\r\nimport clsx from 'clsx';\r\nimport { Markdown } from './messages';\r\n\r\nexport function Blueprint({\r\n\tblueprint,\r\n\tclassName,\r\n\t...props\r\n}: React.ComponentProps<'div'> & {\r\n\tblueprint: BlueprintType;\r\n}) {\r\n\tif (!blueprint) return null;\r\n\r\n\treturn (\r\n\t\t<div className={clsx('w-full flex flex-col', className)} {...props}>\r\n\t\t\t<div className=\"bg-accent p-6 rounded-t-xl flex items-center bg-graph-paper\">\r\n\t\t\t\t<div className=\"flex flex-col gap-1\">\r\n\t\t\t\t\t<div className=\"uppercase text-xs tracking-wider text-text-on-brand/90\">\r\n\t\t\t\t\t\tBlueprint\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"text-2xl font-medium text-text-on-brand\">\r\n\t\t\t\t\t\t{blueprint.title}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"flex flex-col px-6 py-4 bg-bg-2 rounded-b-xl space-y-8\">\r\n\t\t\t\t{/* Basic Info */}\r\n\t\t\t\t<div className=\"grid grid-cols-[120px_1fr] gap-4 text-sm\">\r\n\t\t\t\t\t<div className=\"text-text-50/70 font-mono\">Description</div>\r\n\t\t\t\t\t<Markdown className=\"text-text-50\">{blueprint.description}</Markdown>\r\n\r\n\t\t\t\t\t{Array.isArray(blueprint.colorPalette) &&\r\n\t\t\t\t\t\tblueprint.colorPalette.length > 0 && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<div className=\"text-text-50/70 font-mono\">Color Palette</div>\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t{Array.isArray(blueprint.colorPalette) &&\r\n\t\t\t\t\t\t\t\t\t\tblueprint.colorPalette?.map((color, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={`color-${index}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"size-6 rounded-md border border-text/10 flex items-center justify-center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ backgroundColor: color }}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle={color}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"sr-only\">{color}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</div>{' '}\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<div className=\"text-text-50/70 font-mono\">Dependencies</div>\r\n\t\t\t\t\t<div className=\"flex flex-wrap gap-2 items-center\">\r\n\t\t\t\t\t\t{Array.isArray(blueprint.frameworks) &&\r\n\t\t\t\t\t\t\tblueprint.frameworks.map((framework, index) => {\r\n\t\t\t\t\t\t\t\tlet name: string, version: string | undefined;\r\n\r\n\t\t\t\t\t\t\t\t// support scoped packages\r\n\t\t\t\t\t\t\t\tif (framework.startsWith('@')) {\r\n\t\t\t\t\t\t\t\t\tconst secondAt = framework.lastIndexOf('@');\r\n\t\t\t\t\t\t\t\t\tif (secondAt === 0) {\r\n\t\t\t\t\t\t\t\t\t\tname = framework;\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tname = framework.slice(0, secondAt);\r\n\t\t\t\t\t\t\t\t\t\tversion = framework.slice(secondAt + 1);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t[name, version] = framework.split('@');\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\tkey={`framework-${framework}-${index}`}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center text-xs border border-text/20 rounded-full px-2 py-0.5 text-text-primary/90 hover:border-white/40 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">{name}</span>\r\n\t\t\t\t\t\t\t\t\t\t{version && (\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-text-primary/50\">@{version}</span>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Views */}\r\n\t\t\t\t{Array.isArray(blueprint.views) && blueprint.views.length > 0 && (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium mb-3 text-text-50/70 uppercase tracking-wider\">\r\n\t\t\t\t\t\t\tViews\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<div className=\"space-y-3\">\r\n\t\t\t\t\t\t\t{blueprint.views.map((view, index) => (\r\n\t\t\t\t\t\t\t\t<div key={`view-${index}`} className=\"space-y-1\">\r\n\t\t\t\t\t\t\t\t\t<h4 className=\"text-xs font-medium text-text-50/70\">\r\n\t\t\t\t\t\t\t\t\t\t{view.name}\r\n\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t<Markdown className=\"text-sm text-text-50\">\r\n\t\t\t\t\t\t\t\t\t\t{view.description}\r\n\t\t\t\t\t\t\t\t\t</Markdown>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* User Flow */}\r\n\t\t\t\t{blueprint.userFlow && (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium mb-3 text-text-50/70 uppercase tracking-wider\">\r\n\t\t\t\t\t\t\tUser Flow\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t{blueprint.userFlow?.uiLayout && (\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h4 className=\"text-xs font-medium mb-2 text-text-50/70\">\r\n\t\t\t\t\t\t\t\t\t\tUI Layout\r\n\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t<Markdown className=\"text-sm text-text-50\">\r\n\t\t\t\t\t\t\t\t\t\t{blueprint.userFlow.uiLayout}\r\n\t\t\t\t\t\t\t\t\t</Markdown>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{blueprint.userFlow?.uiDesign && (\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h4 className=\"text-xs font-medium mb-2 text-text-50/70\">\r\n\t\t\t\t\t\t\t\t\t\tUI Design\r\n\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t<Markdown className=\"text-sm text-text-50\">\r\n\t\t\t\t\t\t\t\t\t\t{blueprint.userFlow.uiDesign}\r\n\t\t\t\t\t\t\t\t\t</Markdown>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{blueprint.userFlow?.userJourney && (\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h4 className=\"text-xs font-medium mb-2 text-text-50/70\">\r\n\t\t\t\t\t\t\t\t\t\tUser Journey\r\n\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t<Markdown className=\"text-sm text-text-50\">\r\n\t\t\t\t\t\t\t\t\t\t{blueprint.userFlow?.userJourney}\r\n\t\t\t\t\t\t\t\t\t</Markdown>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Data Flow */}\r\n\t\t\t\t{(blueprint.dataFlow || blueprint.architecture?.dataFlow) && (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium mb-2 text-text-50/70 uppercase tracking-wider\">\r\n\t\t\t\t\t\t\tData Flow\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<Markdown className=\"text-sm text-text-50\">\r\n\t\t\t\t\t\t\t{blueprint.dataFlow || blueprint.architecture?.dataFlow}\r\n\t\t\t\t\t\t</Markdown>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Implementation Roadmap */}\r\n\t\t\t\t{Array.isArray(blueprint.implementationRoadmap) && blueprint.implementationRoadmap.length > 0 && (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium mb-2 text-text-50/70 uppercase tracking-wider\">\r\n\t\t\t\t\t\t\tImplementation Roadmap\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<div className=\"space-y-3\">\r\n\t\t\t\t\t\t\t{blueprint.implementationRoadmap.map((roadmapItem, index) => (\r\n\t\t\t\t\t\t\t\t<div key={`roadmap-${index}`} className=\"space-y-1\">\r\n\t\t\t\t\t\t\t\t\t<h4 className=\"text-xs font-medium text-text-50/70\">\r\n\t\t\t\t\t\t\t\t\t\tPhase {index + 1}: {roadmapItem.phase}\r\n\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t<Markdown className=\"text-sm text-text-50\">\r\n\t\t\t\t\t\t\t\t\t\t{roadmapItem.description}\r\n\t\t\t\t\t\t\t\t\t</Markdown>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Initial Phase */}\r\n\t\t\t\t{blueprint.initialPhase && (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium mb-2 text-text-50/70 uppercase tracking-wider\">\r\n\t\t\t\t\t\t\tInitial Phase\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<div className=\"space-y-3\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<h4 className=\"text-xs font-medium mb-2 text-text-50/70\">\r\n\t\t\t\t\t\t\t\t\t{blueprint.initialPhase.name}\r\n\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t<Markdown className=\"text-sm text-text-50 mb-3\">\r\n\t\t\t\t\t\t\t\t\t{blueprint.initialPhase.description}\r\n\t\t\t\t\t\t\t\t</Markdown>\r\n\t\t\t\t\t\t\t\t{Array.isArray(blueprint.initialPhase.files) && blueprint.initialPhase.files.length > 0 && (\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<h5 className=\"text-xs font-medium mb-2 text-text-50/60\">\r\n\t\t\t\t\t\t\t\t\t\t\tFiles to be created:\r\n\t\t\t\t\t\t\t\t\t\t</h5>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t{blueprint.initialPhase.files.map((file, fileIndex) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div key={`initial-phase-file-${fileIndex}`} className=\"border-l-2 border-text/10 pl-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"font-mono text-xs text-text-50/80\">{file.path}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-xs text-text-50/60\">{file.purpose}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Pitfalls */}\r\n\t\t\t\t{Array.isArray(blueprint.pitfalls) && blueprint.pitfalls.length > 0 && (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium mb-2 text-text-50/70 uppercase tracking-wider\">\r\n\t\t\t\t\t\t\tPitfalls\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<div className=\"prose prose-sm prose-invert\">\r\n\t\t\t\t\t\t\t<ul className=\"\">\r\n\t\t\t\t\t\t\t\t{blueprint.pitfalls?.map((pitfall, index) => (\r\n\t\t\t\t\t\t\t\t\t<li key={`pitfall-${index}`} className=\"\">\r\n\t\t\t\t\t\t\t\t\t\t{pitfall}\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { useState } from 'react';\r\nimport { LucideNetwork, ChevronRight, File } from 'lucide-react';\r\nimport type { FileType } from '../hooks/use-chat';\r\nimport clsx from 'clsx';\r\n\r\ninterface FileTreeItem {\r\n\tname: string;\r\n\ttype: 'file' | 'folder';\r\n\tfilePath: string;\r\n\tchildren?: { [key: string]: FileTreeItem };\r\n\tfile?: FileType;\r\n}\r\n\r\nexport function FileTreeItem({\r\n\titem,\r\n\tlevel = 0,\r\n\tcurrentFile,\r\n\tonFileClick,\r\n}: {\r\n\titem: FileTreeItem;\r\n\tlevel?: number;\r\n\tcurrentFile: FileType | undefined;\r\n\tonFileClick: (file: FileType) => void;\r\n}) {\r\n\tconst [isExpanded, setIsExpanded] = useState(true);\r\n\tconst isCurrentFile = currentFile?.filePath === item.filePath;\r\n\r\n\tif (item.type === 'file' && item.file) {\r\n\t\treturn (\r\n\t\t\t<button\r\n\t\t\t\tonClick={() => onFileClick(item.file!)}\r\n\t\t\t\tclassName={`flex items-center w-full gap-2 py-1 px-3 transition-colors text-sm ${\r\n\t\t\t\t\tisCurrentFile\r\n\t\t\t\t\t\t? 'text-brand bg-zinc-100'\r\n\t\t\t\t\t\t: 'text-text-primary/80 hover:bg-accent hover:text-text-primary'\r\n\t\t\t\t}`}\r\n\t\t\t\tstyle={{ paddingLeft: `${level * 12 + 12}px` }}\r\n\t\t\t>\r\n\t\t\t\t<File className=\"size-3\" />\r\n\t\t\t\t<span className=\"flex-1 text-left truncate\">{item.name}</span>\r\n\t\t\t\t{/* {item.file.isGenerating ? (\r\n\t\t\t\t\t<Loader className=\"size-3 animate-spin\" />\r\n\t\t\t\t) : null}\r\n\t\t\t\t{item.file.needsFixing && (\r\n\t\t\t\t\t<span className=\"text-[9px] text-orange-400\">fix</span>\r\n\t\t\t\t)}\r\n\t\t\t\t{item.file.hasRuntimeError && (\r\n\t\t\t\t\t<span className=\"text-[9px] text-red-400\">error</span>\r\n\t\t\t\t)} */}\r\n\t\t\t</button>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<button\r\n\t\t\t\tonClick={() => setIsExpanded(!isExpanded)}\r\n\t\t\t\tclassName=\"flex items-center gap-2 py-1 px-3 transition-colors text-sm text-text-primary/80 hover:bg-accent hover:text-text-primary w-full\"\r\n\t\t\t\tstyle={{ paddingLeft: `${level * 12 + 12}px` }}\r\n\t\t\t>\r\n\t\t\t\t<ChevronRight\r\n\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t'size-3 transition-transform duration-200 ease-in-out',\r\n\t\t\t\t\t\tisExpanded && 'rotate-90',\r\n\t\t\t\t\t)}\r\n\t\t\t\t/>\r\n\t\t\t\t<span className=\"flex-1 text-left truncate\">{item.name}</span>\r\n\t\t\t</button>\r\n\t\t\t{isExpanded && item.children && (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{Object.values(item.children).map((child) => (\r\n\t\t\t\t\t\t<FileTreeItem\r\n\t\t\t\t\t\t\tkey={child.filePath}\r\n\t\t\t\t\t\t\titem={child}\r\n\t\t\t\t\t\t\tlevel={level + 1}\r\n\t\t\t\t\t\t\tcurrentFile={currentFile}\r\n\t\t\t\t\t\t\tonFileClick={onFileClick}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction buildFileTree(files: FileType[]): FileTreeItem[] {\r\n\tconst root: { [key: string]: FileTreeItem } = {};\r\n\r\n\tfiles.forEach((file) => {\r\n\t\tconst parts = file.filePath.split('/');\r\n\t\tlet currentLevel: { [key: string]: FileTreeItem } = root;\r\n\r\n\t\tfor (let i = 0; i < parts.length - 1; i++) {\r\n\t\t\tconst part = parts[i];\r\n\t\t\tif (!currentLevel[part]) {\r\n\t\t\t\tcurrentLevel[part] = {\r\n\t\t\t\t\tname: part,\r\n\t\t\t\t\ttype: 'folder',\r\n\t\t\t\t\tfilePath: parts.slice(0, i + 1).join('/'),\r\n\t\t\t\t\tchildren: {},\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tif (!currentLevel[part].children) {\r\n\t\t\t\tcurrentLevel[part].children = {};\r\n\t\t\t}\r\n\t\t\tcurrentLevel = currentLevel[part].children;\r\n\t\t}\r\n\r\n\t\tconst fileName = parts[parts.length - 1];\r\n\t\tcurrentLevel[fileName] = {\r\n\t\t\tname: fileName,\r\n\t\t\ttype: 'file',\r\n\t\t\tfilePath: file.filePath,\r\n\t\t\tfile: file,\r\n\t\t};\r\n\t});\r\n\r\n\treturn Object.values(root);\r\n}\r\n\r\nexport function FileExplorer({\r\n\tfiles,\r\n\tbootstrapFiles,\r\n\tcurrentFile,\r\n\tonFileClick,\r\n}: {\r\n\tfiles: FileType[];\r\n\tbootstrapFiles: FileType[];\r\n\tcurrentFile: FileType | undefined;\r\n\tonFileClick: (file: FileType) => void;\r\n}) {\r\n\tconst fileTree = buildFileTree([...bootstrapFiles, ...files]);\r\n\r\n\treturn (\r\n\t\t<div className=\"w-full max-w-[200px] bg-bg-3 border-r border-text/10 h-full overflow-y-auto\">\r\n\t\t\t<div className=\"p-2 px-3 text-sm flex items-center gap-1 text-text-primary/50 font-medium\">\r\n\t\t\t\t<LucideNetwork className=\"size-4\" />\r\n\t\t\t\tFiles\r\n\t\t\t</div>\r\n\t\t\t<div className=\"flex flex-col\">\r\n\t\t\t\t{fileTree.map((item) => (\r\n\t\t\t\t\t<FileTreeItem\r\n\t\t\t\t\t\tkey={item.filePath}\r\n\t\t\t\t\t\titem={item}\r\n\t\t\t\t\t\tcurrentFile={currentFile}\r\n\t\t\t\t\t\tonFileClick={onFileClick}\r\n\t\t\t\t\t/>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { Sparkles } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nconst THINKING_PHRASES = [\r\n  'Thinking',\r\n  'Ideating',\r\n  'Planning',\r\n  'Designing',\r\n  'Crafting',\r\n  'Architecting',\r\n  'Conceptualizing',\r\n  'Envisioning',\r\n  'Strategizing',\r\n  'Formulating',\r\n  'Contemplating',\r\n  'Analyzing',\r\n  'Brainstorming',\r\n  'Sketching',\r\n  'Exploring',\r\n  'Imagining',\r\n  'Structuring',\r\n  'Orchestrating',\r\n  'Composing',\r\n  'Refining',\r\n];\r\n\r\ninterface ThinkingIndicatorProps {\r\n  visible: boolean;\r\n}\r\n\r\nexport function ThinkingIndicator({ visible }: ThinkingIndicatorProps) {\r\n  const [phraseIndex, setPhraseIndex] = useState(0);\r\n\r\n  useEffect(() => {\r\n    if (!visible) {\r\n      setPhraseIndex(0);\r\n      return;\r\n    }\r\n\r\n    const interval = setInterval(() => {\r\n      setPhraseIndex((prev) => (prev + 1) % THINKING_PHRASES.length);\r\n    }, 2000); // Change phrase every 2 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, [visible]);\r\n\r\n  if (!visible) return null;\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {visible && (\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 10, scale: 0.95 }}\r\n          animate={{ opacity: 1, y: 0, scale: 1 }}\r\n          exit={{ opacity: 0, y: -10, scale: 0.95 }}\r\n          transition={{ \r\n            duration: 0.4,\r\n            ease: [0.23, 1, 0.32, 1]\r\n          }}\r\n          className=\"flex items-center gap-2 mt-3\"\r\n        >\r\n          <motion.div\r\n            animate={{ \r\n              rotate: [0, 360],\r\n              scale: [1, 1.1, 1]\r\n            }}\r\n            transition={{ \r\n              rotate: { duration: 3, repeat: Infinity, ease: \"linear\" },\r\n              scale: { duration: 2, repeat: Infinity, ease: \"easeInOut\" }\r\n            }}\r\n          >\r\n            <Sparkles className=\"size-3 text-orange-400\" />\r\n          </motion.div>\r\n          <AnimatePresence mode=\"wait\">\r\n            <motion.span\r\n              key={phraseIndex}\r\n              initial={{ opacity: 0, x: -10 }}\r\n              animate={{ opacity: 1, x: 0 }}\r\n              exit={{ opacity: 0, x: 10 }}\r\n              transition={{ \r\n                duration: 0.3,\r\n                ease: [0.23, 1, 0.32, 1]\r\n              }}\r\n              className=\"text-sm text-text-50/60 font-medium flex items-center gap-1\"\r\n            >\r\n              {THINKING_PHRASES[phraseIndex]}...\r\n              <motion.span\r\n                animate={{ opacity: [1, 0.3, 1] }}\r\n                transition={{ duration: 1.5, repeat: Infinity }}\r\n                className=\"inline-block\"\r\n              >\r\n                ...\r\n              </motion.span>\r\n            </motion.span>\r\n          </AnimatePresence>\r\n        </motion.div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n}","import clsx from 'clsx';\r\nimport { Loader, Check, AlertCircle, ChevronDown, ChevronRight, ArrowUp, Zap } from 'lucide-react';\r\nimport { useState, useEffect, useRef, useMemo, useCallback } from 'react';\r\nimport type { RefObject } from 'react';\r\nimport { AnimatePresence, motion } from 'framer-motion';\r\nimport type { PhaseTimelineItem, FileType } from '../hooks/use-chat';\r\nimport { ThinkingIndicator } from './thinking-indicator';\r\n\r\nimport type { ProjectStage } from '../utils/project-stage-helpers';\r\n\r\n// Unified status type for consistency\r\ntype UnifiedStatus = 'pending' | 'active' | 'completed' | 'error' | 'generating' | 'validating';\r\n\r\n// Animation variants and transitions for consistent motion\r\nconst statusIconVariants = {\r\n\tinitial: { scale: 0.2, opacity: 0.4 },\r\n\tanimate: { scale: 1, opacity: 1 },\r\n\texit: { scale: 0.2, opacity: 0.4 },\r\n};\r\n\r\nconst commonTransitions = {\r\n\tsmooth: { duration: 0.3, ease: 'easeOut' as const },\r\n\tpremium: { duration: 0.4, ease: [0.23, 1, 0.32, 1] as const },\r\n\tfast: { duration: 0.2, ease: 'easeOut' as const },\r\n\tpremiumShort: { duration: 0.3, ease: [0.23, 1, 0.32, 1] as const },\r\n\tsmoothInOut: { duration: 0.3, ease: 'easeInOut' as const },\r\n};\r\n\r\n// Centralized phase status utilities\r\nconst getPhaseByStatus = (phases: PhaseTimelineItem[], status: PhaseTimelineItem['status']) =>\r\n\tphases.find(p => p.status === status);\r\n\r\nconst getLastCompletedPhase = (phases: PhaseTimelineItem[]) =>\r\n\t[...phases].reverse().find(p => p.status === 'completed');\r\n\r\nconst getCompletedPhaseCount = (phases: PhaseTimelineItem[]) =>\r\n\tphases.filter(p => p.status === 'completed').length;\r\n\r\n// Consolidated status-specific loader components\r\ninterface StatusLoaderProps {\r\n\tsize?: 'sm' | 'md';\r\n\tcolor?: 'accent' | 'blue' | 'orange' | 'tertiary' | 'green';\r\n}\r\n\r\nconst StatusLoader = ({ size = 'md', color = 'accent' }: StatusLoaderProps) => {\r\n\tconst sizeClass = size === 'sm' ? 'size-3' : 'w-4 h-4';\r\n\tconst colorMap = {\r\n\t\taccent: 'text-accent',\r\n\t\tblue: 'text-blue-400',\r\n\t\torange: 'text-orange-400',\r\n\t\ttertiary: 'text-text-tertiary',\r\n\t\tgreen: 'text-green-500'\r\n\t};\r\n\treturn <Loader className={`${sizeClass} animate-spin ${colorMap[color]}`} />;\r\n};\r\n\r\nconst StatusCheck = ({ size = 'md', color = 'green' }: StatusLoaderProps) => {\r\n\tconst sizeClass = size === 'sm' ? 'size-3' : 'w-4 h-4';\r\n\tconst colorMap = {\r\n\t\taccent: 'text-accent',\r\n\t\tblue: 'text-blue-400',\r\n\t\torange: 'text-orange-400',\r\n\t\ttertiary: 'text-text-tertiary',\r\n\t\tgreen: 'text-green-500'\r\n\t};\r\n\treturn <Check className={`${sizeClass} ${colorMap[color]}`} />;\r\n};\r\n\r\n// Unified StatusIcon component to eliminate DRY\r\ninterface StatusIconProps {\r\n\tstatus: UnifiedStatus;\r\n\tsize?: 'sm' | 'md';\r\n\tclassName?: string;\r\n}\r\n\r\nfunction StatusIcon({ status, size = 'md', className }: StatusIconProps) {\r\n\tconst sizeClasses = {\r\n\t\tsm: 'w-3 h-3',\r\n\t\tmd: 'w-4 h-4',\r\n\t};\r\n\r\n\tconst iconClasses = sizeClasses[size];\r\n\r\n\tswitch (status) {\r\n\t\tcase 'generating':\r\n\t\t\treturn <Loader className={clsx(iconClasses, 'animate-spin text-accent', className)} />;\r\n\t\tcase 'validating':\r\n\t\t\treturn <Loader className={clsx(iconClasses, 'animate-spin text-blue-400', className)} />;\r\n\t\tcase 'completed':\r\n\t\t\treturn <Check className={clsx(iconClasses, 'text-green-500', className)} />;\r\n\t\tcase 'error':\r\n\t\t\treturn <AlertCircle className={clsx(iconClasses, 'text-red-500', className)} />;\r\n\t\tcase 'active':\r\n\t\t\treturn <Loader className={clsx(iconClasses, 'animate-spin text-accent', className)} />;\r\n\t\tcase 'pending':\r\n\t\tdefault:\r\n\t\t\treturn <div className={clsx(iconClasses, 'bg-bg-3-foreground/40 dark:bg-bg-3-foreground/30 rounded-full', className)} />;\r\n\t}\r\n}\r\n\r\n// Animated Status Indicator for project stages\r\ninterface AnimatedStatusIndicatorProps {\r\n\tstatus: 'pending' | 'active' | 'completed' | 'error';\r\n\tsize?: number;\r\n}\r\n\r\nfunction AnimatedStatusIndicator({ status, size = 5 }: AnimatedStatusIndicatorProps) {\r\n\tconst sizeClass = `size-${size}`;\r\n\r\n\treturn (\r\n\t\t<div className=\"translate-y-px z-20\">\r\n\t\t\t<AnimatePresence mode=\"wait\">\r\n\t\t\t\t{status === 'pending' && (\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tkey=\"pending\"\r\n\t\t\t\t\t\tvariants={statusIconVariants}\r\n\t\t\t\t\t\tinitial=\"initial\"\r\n\t\t\t\t\t\tanimate=\"animate\"\r\n\t\t\t\t\t\texit=\"exit\"\r\n\t\t\t\t\t\ttransition={commonTransitions.smoothInOut}\r\n\t\t\t\t\t\tclassName={clsx(sizeClass, 'flex items-center justify-center')}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"size-2 rounded-full bg-zinc-300\" />\r\n\t\t\t\t\t</motion.div>\r\n\t\t\t\t)}\r\n\t\t\t\t{status === 'active' && (\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tkey=\"active\"\r\n\t\t\t\t\t\tvariants={statusIconVariants}\r\n\t\t\t\t\t\tinitial=\"initial\"\r\n\t\t\t\t\t\tanimate=\"animate\"\r\n\t\t\t\t\t\texit=\"exit\"\r\n\t\t\t\t\t\ttransition={commonTransitions.smoothInOut}\r\n\t\t\t\t\t\tclassName={clsx(sizeClass, 'bg-bg-4 dark:bg-bg-2 flex items-center justify-center')}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Loader className=\"size-3 text-accent animate-spin\" />\r\n\t\t\t\t\t</motion.div>\r\n\t\t\t\t)}\r\n\t\t\t\t{status === 'completed' && (\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tkey=\"completed\"\r\n\t\t\t\t\t\tvariants={statusIconVariants}\r\n\t\t\t\t\t\tinitial=\"initial\"\r\n\t\t\t\t\t\tanimate=\"animate\"\r\n\t\t\t\t\t\texit=\"exit\"\r\n\t\t\t\t\t\ttransition={commonTransitions.smoothInOut}\r\n\t\t\t\t\t\tclassName={clsx(sizeClass, 'flex items-center justify-center')}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"size-2 rounded-full bg-accent\" />\r\n\t\t\t\t\t</motion.div>\r\n\t\t\t\t)}\r\n\t\t\t\t{status === 'error' && (\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tkey=\"error\"\r\n\t\t\t\t\t\tvariants={statusIconVariants}\r\n\t\t\t\t\t\tinitial=\"initial\"\r\n\t\t\t\t\t\tanimate=\"animate\"\r\n\t\t\t\t\t\texit=\"exit\"\r\n\t\t\t\t\t\ttransition={commonTransitions.smoothInOut}\r\n\t\t\t\t\t\tclassName={clsx(sizeClass, 'flex items-center justify-center')}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<AlertCircle className=\"size-3 text-red-500\" />\r\n\t\t\t\t\t</motion.div>\r\n\t\t\t\t)}\r\n\t\t\t</AnimatePresence>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\ninterface PhaseTimelineProps {\r\n\tprojectStages: ProjectStage[];\r\n\tphaseTimeline: PhaseTimelineItem[];\r\n\tfiles: FileType[];\r\n\tview: string;\r\n\tactiveFile?: FileType;\r\n\tonFileClick: (file: FileType) => void;\r\n\tisThinkingNext?: boolean;\r\n\tisPreviewDeploying?: boolean;\r\n\tprogress: number;\r\n\ttotal: number;\r\n\tparentScrollRef?: RefObject<HTMLDivElement | null>;\r\n\tonViewChange?: (view: 'blueprint') => void;\r\n\t// Deployment functionality\r\n\tchatId?: string;\r\n\tisDeploying?: boolean;\r\n\thandleDeployToCloudflare?: (instanceId: string) => void;\r\n}\r\n\r\n// Helper function to truncate long file paths\r\nfunction truncateFilePath(filePath: string, maxLength: number = 30): string {\r\n\tif (filePath.length <= maxLength) return filePath;\r\n\r\n\tconst parts = filePath.split('/');\r\n\tconst fileName = parts[parts.length - 1];\r\n\r\n\t// If even the filename is too long, truncate it more aggressively\r\n\tif (fileName.length > maxLength - 8) {\r\n\t\tconst extension = fileName.includes('.') ? '.' + fileName.split('.').pop() : '';\r\n\t\tconst nameWithoutExt = fileName.replace(extension, '');\r\n\t\tconst truncatedName = nameWithoutExt.substring(0, Math.max(8, maxLength - 12));\r\n\t\treturn `[...]/${truncatedName}[...]${extension}`;\r\n\t}\r\n\r\n\t// Otherwise, truncate the path but keep the filename\r\n\tconst pathWithoutFile = parts.slice(0, -1).join('/');\r\n\tconst availableSpace = maxLength - fileName.length - 6; // 6 for '[...]/'\r\n\r\n\tif (availableSpace <= 0) {\r\n\t\treturn `[...]/${fileName}`;\r\n\t}\r\n\r\n\t// More aggressive path truncation\r\n\tif (pathWithoutFile.length > availableSpace) {\r\n\t\treturn `[...]/${fileName}`;\r\n\t}\r\n\r\n\treturn `${pathWithoutFile.substring(0, availableSpace)}[...]/${fileName}`;\r\n}\r\n\r\n// Helper function to truncate phase names consistently\r\nfunction truncatePhaseName(name: string, maxLength: number = 40): string {\r\n\treturn name.length > maxLength ? `${name.slice(0, maxLength)}...` : name;\r\n}\r\n\r\n// Helper function to calculate incremental line count for a file in a specific phase\r\nfunction calculateIncrementalLineCount(\r\n\tcurrentFilePath: string,\r\n\tcurrentPhaseIndex: number,\r\n\tphaseTimeline: PhaseTimelineItem[],\r\n\tglobalFiles: FileType[]\r\n): number {\r\n\tconst globalFile = globalFiles.find(f => f.filePath === currentFilePath);\r\n\tif (!globalFile) return 0;\r\n\r\n\tconst currentTotalLines = globalFile.fileContents.split('\\n').length;\r\n\r\n\t// Find the previous phase that contains this same file\r\n\tfor (let i = currentPhaseIndex - 1; i >= 0; i--) {\r\n\t\tconst previousPhase = phaseTimeline[i];\r\n\t\tconst previousPhaseFile = previousPhase.files.find(f => f.path === currentFilePath);\r\n\r\n\t\tif (previousPhaseFile && previousPhaseFile.contents) {\r\n\t\t\tconst previousLines = previousPhaseFile.contents.split('\\n').length;\r\n\t\t\treturn Math.max(0, currentTotalLines - previousLines); // Ensure non-negative\r\n\t\t}\r\n\t}\r\n\r\n\t// If this is the first appearance of the file, return the total line count\r\n\treturn currentTotalLines;\r\n}\r\n\r\n\r\nexport function PhaseTimeline({\r\n\tprojectStages,\r\n\tphaseTimeline,\r\n\tfiles,\r\n\tview,\r\n\tactiveFile,\r\n\tonFileClick,\r\n\tisThinkingNext,\r\n\tisPreviewDeploying,\r\n\tprogress,\r\n\ttotal,\r\n\tparentScrollRef,\r\n\tonViewChange,\r\n\tchatId,\r\n\tisDeploying,\r\n\thandleDeployToCloudflare\r\n}: PhaseTimelineProps) {\r\n\tconst [expandedPhases, setExpandedPhases] = useState<Set<string>>(new Set());\r\n\tconst [showCollapsedBar, setShowCollapsedBar] = useState(false);\r\n\tconst [isCollapsedBarExpanded, setIsCollapsedBarExpanded] = useState(false);\r\n\tconst componentRef = useRef<HTMLDivElement>(null);\r\n\tconst lastPhaseRef = useRef<HTMLDivElement>(null);\r\n\tconst timelineCardRef = useRef<HTMLDivElement>(null);\r\n\r\n\t// Auto-expand only the currently generating or validating phase\r\n\tuseEffect(() => {\r\n\t\tconst activePhase = phaseTimeline.find(p => p.status === 'generating' || p.status === 'validating');\r\n\t\tif (activePhase) {\r\n\t\t\tsetExpandedPhases(new Set([activePhase.id]));\r\n\t\t}\r\n\t}, [phaseTimeline]);\r\n\r\n\t// Reset collapsed bar expanded state when it disappears\r\n\tuseEffect(() => {\r\n\t\tif (!showCollapsedBar) {\r\n\t\t\tsetIsCollapsedBarExpanded(false);\r\n\t\t}\r\n\t}, [showCollapsedBar]);\r\n\r\n\t// Auto-scroll to bottom when new phases are added or thinking indicator appears\r\n\tuseEffect(() => {\r\n\t\tif (lastPhaseRef.current) {\r\n\t\t\tlastPhaseRef.current.scrollIntoView({ behavior: 'smooth', block: 'end' });\r\n\t\t}\r\n\t}, [phaseTimeline.length, isThinkingNext]);\r\n\r\n\t// Show/hide collapsed bar when 60% of timeline card has scrolled out of view\r\n\tuseEffect(() => {\r\n\t\tconst parentEl = parentScrollRef?.current;\r\n\t\tconst timelineCard = timelineCardRef.current;\r\n\t\tif (!timelineCard || !parentEl) return;\r\n\r\n\t\tconst observer = new IntersectionObserver(\r\n\t\t\t([entry]) => {\r\n\t\t\t\t// Show collapsed bar when 30% of timeline has scrolled out of view\r\n\t\t\t\tconst shouldCollapse = entry.intersectionRatio < 0.7; // 70% visible = 30% scrolled out\r\n\t\t\t\tconst hasContent = projectStages.length > 0 || phaseTimeline.length > 0;\r\n\t\t\t\tsetShowCollapsedBar(shouldCollapse && hasContent);\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\troot: parentEl,\r\n\t\t\t\trootMargin: '0px 0px 0px 0px', // No margin - watch the actual card\r\n\t\t\t\tthreshold: [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1] // Granular thresholds\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tobserver.observe(timelineCard);\r\n\t\treturn () => observer.disconnect();\r\n\t}, [parentScrollRef, projectStages.length, phaseTimeline.length]);\r\n\r\n\t// Get current status info for the collapsed bar\r\n\tconst collapsedBarInfo = useMemo(() => {\r\n\t\tconst completedPhases = getCompletedPhaseCount(phaseTimeline);\r\n\t\tconst phaseBadge = phaseTimeline.length > 0 ? `${completedPhases}/${phaseTimeline.length}` : undefined;\r\n\r\n\t\tconst validatingPhase = getPhaseByStatus(phaseTimeline, 'validating');\r\n\t\tif (validatingPhase) {\r\n\t\t\treturn {\r\n\t\t\t\ttext: `Reviewing: ${truncatePhaseName(validatingPhase.name)}`,\r\n\t\t\t\tsubtitle: 'Running tests and fixing issues...',\r\n\t\t\t\ticon: <StatusLoader color=\"blue\" />,\r\n\t\t\t\tbadge: phaseBadge\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tconst generatingPhase = getPhaseByStatus(phaseTimeline, 'generating');\r\n\t\tif (generatingPhase) {\r\n\t\t\treturn {\r\n\t\t\t\ttext: `Implementing: ${truncatePhaseName(generatingPhase.name)}`,\r\n\t\t\t\tsubtitle: `${progress}/${total} phases`,\r\n\t\t\t\ticon: <StatusLoader color=\"accent\" />,\r\n\t\t\t\tbadge: phaseBadge\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (isPreviewDeploying) {\r\n\t\t\treturn {\r\n\t\t\t\ttext: 'Deploying preview',\r\n\t\t\t\tsubtitle: 'Updating preview environment...',\r\n\t\t\t\ticon: <StatusLoader color=\"orange\" />,\r\n\t\t\t\tbadge: phaseBadge\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (isThinkingNext) {\r\n\t\t\treturn {\r\n\t\t\t\ttext: 'Planning next phase',\r\n\t\t\t\tsubtitle: 'Analyzing requirements...',\r\n\t\t\t\ticon: <StatusLoader color=\"tertiary\" />,\r\n\t\t\t\tbadge: phaseBadge\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tconst lastCompletedPhase = getLastCompletedPhase(phaseTimeline);\r\n\t\tif (lastCompletedPhase) {\r\n\t\t\treturn {\r\n\t\t\t\ttext: `Completed: ${truncatePhaseName(lastCompletedPhase.name)}`,\r\n\t\t\t\tsubtitle: 'Ready for next phase',\r\n\t\t\t\ticon: <StatusCheck color=\"green\" />,\r\n\t\t\t\tbadge: phaseBadge\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tconst completedStages = projectStages.filter(s => s.status === 'completed').length;\r\n\t\treturn {\r\n\t\t\ttext: 'Ready to implement',\r\n\t\t\tsubtitle: completedStages > 0 ? `${completedStages}/${projectStages.length} stages complete` : 'Waiting to begin...',\r\n\t\t\ticon: <div className=\"w-4 h-4 bg-gradient-to-br from-zinc-300/30 to-zinc-400/20 dark:from-zinc-600/30 dark:to-zinc-700/20 rounded-full\" />,\r\n\t\t\tbadge: undefined\r\n\t\t};\r\n\t}, [phaseTimeline, isThinkingNext, isPreviewDeploying, progress, total, projectStages]);\r\n\r\n\tconst togglePhase = (phaseId: string) => {\r\n\t\tsetExpandedPhases(prev => {\r\n\t\t\tconst newSet = new Set(prev);\r\n\t\t\tif (newSet.has(phaseId)) {\r\n\t\t\t\tnewSet.delete(phaseId);\r\n\t\t\t} else {\r\n\t\t\t\tnewSet.add(phaseId);\r\n\t\t\t}\r\n\t\t\treturn newSet;\r\n\t\t});\r\n\t};\r\n\r\n\tconst scrollToTop = useCallback(() => {\r\n\t\tif (parentScrollRef?.current) {\r\n\t\t\tparentScrollRef.current.scrollTo({ top: 0, behavior: 'smooth' });\r\n\t\t}\r\n\t}, [parentScrollRef]);\r\n\r\n\tconst getCurrentPhaseInfo = useMemo(() => {\r\n\t\tconst generatingPhase = getPhaseByStatus(phaseTimeline, 'generating');\r\n\t\tconst validatingPhase = getPhaseByStatus(phaseTimeline, 'validating');\r\n\t\tconst lastCompletedPhase = getLastCompletedPhase(phaseTimeline);\r\n\r\n\t\treturn generatingPhase || validatingPhase || lastCompletedPhase || phaseTimeline[phaseTimeline.length - 1];\r\n\t}, [phaseTimeline]);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{/* Collapsed Bar with elegant compression animation and surrounding frosted area */}\r\n\t\t\t<AnimatePresence>\r\n\t\t\t\t{showCollapsedBar && (\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tinitial={{\r\n\t\t\t\t\t\t\topacity: 0,\r\n\t\t\t\t\t\t\ty: -24,\r\n\t\t\t\t\t\t\tscaleY: 0.6,\r\n\t\t\t\t\t\t\ttransformOrigin: 'top center'\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tanimate={{\r\n\t\t\t\t\t\t\topacity: 1,\r\n\t\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\t\tscaleY: 1,\r\n\t\t\t\t\t\t\ttransformOrigin: 'top center'\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\texit={{\r\n\t\t\t\t\t\t\topacity: 0,\r\n\t\t\t\t\t\t\ty: -16,\r\n\t\t\t\t\t\t\tscaleY: 0.8,\r\n\t\t\t\t\t\t\ttransformOrigin: 'top center'\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\ttransition={{\r\n\t\t\t\t\t\t\tduration: 0.4,\r\n\t\t\t\t\t\t\tease: [0.16, 1, 0.3, 1],\r\n\t\t\t\t\t\t\topacity: { duration: 0.25, ease: 'easeOut' },\r\n\t\t\t\t\t\t\ty: { duration: 0.4, ease: [0.16, 1, 0.3, 1] },\r\n\t\t\t\t\t\t\tscaleY: { duration: 0.35, ease: [0.23, 1, 0.32, 1] }\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tclassName=\"absolute -top-2 -left-2 -right-2 z-50 px-2 pt-4 pb-2\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{/* Subtle frosted glass background area */}\r\n\t\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\t\tclassName=\"absolute inset-0 backdrop-blur-sm rounded-2xl bg-gradient-to-b from-white/[0.02] via-white/[0.01] to-transparent dark:from-black/[0.02] dark:via-black/[0.01] dark:to-transparent\"\r\n\t\t\t\t\t\t\tinitial={{\r\n\t\t\t\t\t\t\t\topacity: 0,\r\n\t\t\t\t\t\t\t\tscaleY: 0.8,\r\n\t\t\t\t\t\t\t\ttransformOrigin: 'top'\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tanimate={{\r\n\t\t\t\t\t\t\t\topacity: 1,\r\n\t\t\t\t\t\t\t\tscaleY: 1,\r\n\t\t\t\t\t\t\t\ttransformOrigin: 'top'\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\texit={{\r\n\t\t\t\t\t\t\t\topacity: 0,\r\n\t\t\t\t\t\t\t\tscaleY: 0.9,\r\n\t\t\t\t\t\t\t\ttransformOrigin: 'top'\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\ttransition={{\r\n\t\t\t\t\t\t\t\t...commonTransitions.premium,\r\n\t\t\t\t\t\t\t\topacity: commonTransitions.smooth,\r\n\t\t\t\t\t\t\t\tscaleY: { duration: 0.35, ease: [0.16, 1, 0.3, 1] }\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t{/* Bottom border demarkation */}\r\n\t\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\t\tclassName=\"absolute bottom-0 left-0 right-0 h-px bg-border-primary/50\"\r\n\t\t\t\t\t\t\tinitial={{ opacity: 0, scaleX: 0.8 }}\r\n\t\t\t\t\t\t\tanimate={{ opacity: 1, scaleX: 1 }}\r\n\t\t\t\t\t\t\texit={{ opacity: 0, scaleX: 0.9 }}\r\n\t\t\t\t\t\t\ttransition={commonTransitions.smooth}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t{/* Main frosted panel - Hoverable and Expandable */}\r\n\t\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\t\tclassName=\"relative bg-bg-4/95 dark:bg-bg-2/95 backdrop-blur-md border border-border-primary shadow-lg rounded-xl overflow-hidden mx-4 hover:bg-bg-3/95 dark:hover:bg-bg-1/95 transition-colors cursor-pointer group\"\r\n\t\t\t\t\t\t\tonClick={() => setIsCollapsedBarExpanded(!isCollapsedBarExpanded)}\r\n\t\t\t\t\t\t\tinitial={{ scale: 0.96 }}\r\n\t\t\t\t\t\t\tanimate={{ scale: 1 }}\r\n\t\t\t\t\t\t\texit={{ scale: 0.96 }}\r\n\t\t\t\t\t\t\ttransition={commonTransitions.premiumShort}\r\n\t\t\t\t\t\t\twhileHover={{ scale: 1.02 }}\r\n\t\t\t\t\t\t\twhileTap={{ scale: 0.98 }}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{/* Collapsed Header */}\r\n                            <motion.div\r\n                                className=\"px-4 py-3 flex items-center gap-3\"\r\n                                initial={{ opacity: 0.8 }}\r\n                                animate={{ opacity: 1 }}\r\n                                exit={{ opacity: 0.8 }}\r\n                                transition={commonTransitions.fast}\r\n                            >\r\n                                <div className=\"flex-shrink-0\">\r\n                                    {collapsedBarInfo.icon}\r\n                                </div>\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <div className=\"text-sm font-medium text-text-primary truncate\">\r\n                                        {collapsedBarInfo.text}\r\n                                    </div>\r\n                                    {collapsedBarInfo.subtitle && (\r\n                                        <div className=\"text-xs text-text-secondary truncate\">\r\n                                            {collapsedBarInfo.subtitle}\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                                {collapsedBarInfo.badge && (\r\n                                    <div className=\"flex-shrink-0\">\r\n                                        <span className=\"text-xs font-medium px-2 py-0.5 bg-accent/10 text-accent rounded-full\">\r\n                                            {collapsedBarInfo.badge}\r\n                                        </span>\r\n                                    </div>\r\n                                )}\r\n                                {chatId && handleDeployToCloudflare && (\r\n                                    <button\r\n                                        onClick={(e) => {\r\n                                            e.stopPropagation();\r\n                                            handleDeployToCloudflare(chatId);\r\n                                        }}\r\n                                        disabled={!!isDeploying}\r\n                                        className=\"ml-2 flex items-center gap-1.5 px-2.5 py-1 bg-accent hover:bg-accent/90 disabled:bg-accent/50 text-white rounded-full text-xs font-medium transition-colors disabled:cursor-not-allowed\"\r\n                                        title={isDeploying ? 'Deploying...' : 'Deploy to Cloudflare'}\r\n                                        aria-label={isDeploying ? 'Deploying' : 'Deploy to Cloudflare'}\r\n                                    >\r\n                                        {isDeploying ? (\r\n                                            <StatusLoader size=\"sm\" color=\"accent\" />\r\n                                        ) : (\r\n                                            <Zap className=\"w-3 h-3\" />\r\n                                        )}\r\n                                        <span className=\"hidden sm:inline\">{isDeploying ? 'Deploying...' : 'Deploy'}</span>\r\n                                    </button>\r\n                                )}\r\n                            </motion.div>\r\n\r\n\t\t\t\t\t\t\t{/* Expanded Content */}\r\n\t\t\t\t\t\t\t<AnimatePresence>\r\n\t\t\t\t\t\t\t\t{isCollapsedBarExpanded && (\r\n\t\t\t\t\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\t\t\t\t\tinitial={{ opacity: 0, height: 0 }}\r\n\t\t\t\t\t\t\t\t\t\tanimate={{ opacity: 1, height: 'auto' }}\r\n\t\t\t\t\t\t\t\t\t\texit={{ opacity: 0, height: 0 }}\r\n\t\t\t\t\t\t\t\t\t\ttransition={commonTransitions.premiumShort}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"border-t border-border-primary/20\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"p-4 space-y-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Files List */}\r\n\t\t\t\t\t\t\t\t\t\t\t{getCurrentPhaseInfo && getCurrentPhaseInfo.files.length > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-xs font-medium text-text-secondary mb-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tFiles ({getCurrentPhaseInfo.files.length}):\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"max-h-32 overflow-y-auto\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{getCurrentPhaseInfo.files.slice(0, 5).map((file, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div key={file.path} className=\"relative flex items-center gap-2 text-xs py-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Timeline connection line */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{index > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"absolute left-1.5 -top-1 w-px h-2 bg-accent/60\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Status dot/icon */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative z-10 flex-shrink-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<StatusIcon status={file.status} size=\"sm\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* File name offset to the right */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-mono text-text-tertiary truncate ml-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{truncateFilePath(file.path, 35)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Bottom connection line */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{index < Math.min(getCurrentPhaseInfo.files.length, 5) - 1 && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"absolute left-1.5 bottom-0 w-px h-1 bg-accent/60\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{getCurrentPhaseInfo.files.length > 5 && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative flex items-center gap-2 text-xs py-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Connection line from last file */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"absolute left-1.5 -top-1 w-px h-2 bg-accent/60\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative z-10 flex-shrink-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-3 h-3 rounded-full bg-accent/20 flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-1.5 h-1.5 rounded-full bg-accent/60\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-text-tertiary ml-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+{getCurrentPhaseInfo.files.length - 5} more files...\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Action Buttons */}\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 pt-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tscrollToTop();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center gap-1.5 px-3 py-1.5 bg-bg-2 hover:bg-bg-1 border border-border-primary rounded-lg text-xs font-medium text-text-primary transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ArrowUp className=\"w-3 h-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tScroll to Top\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t{chatId && handleDeployToCloudflare && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleDeployToCloudflare(chatId);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={isDeploying}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center gap-1.5 px-3 py-1.5 bg-accent hover:bg-accent/90 disabled:bg-accent/50 text-white rounded-lg text-xs font-medium transition-colors disabled:cursor-not-allowed\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{isDeploying ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<StatusLoader size=\"sm\" color=\"accent\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Zap className=\"w-3 h-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{isDeploying ? 'Deploying...' : 'Deploy to Cloudflare'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</motion.div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</AnimatePresence>\r\n\t\t\t\t\t\t</motion.div>\r\n\t\t\t\t\t</motion.div>\r\n\t\t\t\t)}\r\n\t\t\t</AnimatePresence>\r\n\r\n\t\t\t<motion.div\r\n\t\t\t\tlayout=\"position\"\r\n\t\t\t\tanimate={{\r\n\t\t\t\t\tscale: showCollapsedBar ? 0.97 : 1,\r\n\t\t\t\t\topacity: showCollapsedBar ? 0.85 : 1,\r\n\t\t\t\t\ttransformOrigin: 'top center'\r\n\t\t\t\t}}\r\n\t\t\t\ttransition={{\r\n\t\t\t\t\tduration: 0.4,\r\n\t\t\t\t\tease: [0.16, 1, 0.3, 1],\r\n\t\t\t\t\tscale: { duration: 0.35, ease: [0.23, 1, 0.32, 1] },\r\n\t\t\t\t\topacity: commonTransitions.smooth\r\n\t\t\t\t}}\r\n\t\t\t\tclassName=\"pl-9 mb-2 relative\"\r\n\t\t\t\tref={componentRef}\r\n\t\t\t>\r\n\t\t\t\t{/* Main Timeline Card */}\r\n\t\t\t\t<div ref={timelineCardRef} className=\"px-2 pr-3.5 py-3 flex-1 rounded-xl border border-black/12 bg-bg-4 dark:bg-bg-2\">\r\n\t\t\t\t{/* Project Stages */}\r\n\t\t\t\t{projectStages.map((stage, index) => (\r\n\t\t\t\t\t<div key={stage.id} className=\"flex relative w-full gap-2 pb-2.5 last:pb-0\">\r\n\t\t\t\t\t\t<AnimatedStatusIndicator status={stage.status} />\r\n\r\n\t\t\t\t\t\t<div className=\"flex flex-col gap-2 flex-1\">\r\n\t\t\t\t\t\t\t<div className=\"flex\">\r\n\t\t\t\t\t\t\t\t<span className={clsx(\r\n\t\t\t\t\t\t\t\t\t'font-medium',\r\n\t\t\t\t\t\t\t\t\tstage.status === 'pending'\r\n\t\t\t\t\t\t\t\t\t\t? 'text-text-tertiary'\r\n\t\t\t\t\t\t\t\t\t\t: 'text-text-secondary'\r\n\t\t\t\t\t\t\t\t)}>\r\n\t\t\t\t\t\t\t\t\t{stage.title}\r\n\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t{/* Progress for code stage */}\r\n\t\t\t\t\t\t\t\t{stage.id === 'code' && stage.status !== 'pending' && (\r\n\t\t\t\t\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\t\t\t\t\tinitial={{ x: -120 }}\r\n\t\t\t\t\t\t\t\t\t\tanimate={{ x: 0 }}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-zinc-300 mx-1\">&bull;</span>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t{progress}/{total} phases\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</motion.div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Blueprint button */}\r\n\t\t\t\t\t\t\t{stage.id === 'blueprint' && stage.status !== 'pending' && (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tonClick={() => onViewChange?.('blueprint')}\r\n\t\t\t\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\t\t\t'flex items-start ml-0.5 transition-colors font-mono',\r\n\t\t\t\t\t\t\t\t\t\tview === 'blueprint'\r\n\t\t\t\t\t\t\t\t\t\t\t? 'text-brand underline decoration-dotted'\r\n\t\t\t\t\t\t\t\t\t\t\t: 'text-text-secondary/80 hover:bg-bg-2/50 hover:text-text-secondary'\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-left truncate\">\r\n\t\t\t\t\t\t\t\t\t\tBlueprint.md\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{/* Detailed Phase Timeline for code stage */}\r\n\t\t\t\t\t\t\t{stage.id === 'code' && (\r\n\t\t\t\t\t\t\t\t<div className=\"space-y-2 max-h-[400px] overflow-y-auto pr-2 phase-timeline-scroll\">\r\n\t\t\t\t\t\t\t\t\t{phaseTimeline.map((phase, phaseIndex) => (\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tkey={phase.id}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"space-y-1 relative\"\r\n\t\t\t\t\t\t\t\t\t\t\tref={phaseIndex === phaseTimeline.length - 1 ? lastPhaseRef : undefined}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Phase Implementation Header */}\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => phase.status === 'completed' && togglePhase(phase.id)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-start gap-2 relative z-0 w-full text-left hover:bg-zinc-50/5 rounded px-1 py-1 transition-colors group\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={phase.status !== 'completed'}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{/* Expand/Collapse chevron for completed phases */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{phase.status === 'completed' && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0 opacity-60 group-hover:opacity-100 transition-opacity mt-0.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{expandedPhases.has(phase.id) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronDown className=\"size-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronRight className=\"size-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0 mt-0.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{phase.status === 'generating' ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<StatusLoader size=\"sm\" color=\"accent\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : phase.status === 'validating' ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<StatusLoader size=\"sm\" color=\"blue\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<StatusCheck size=\"sm\" color=\"green\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium text-text-50 flex-1 break-words\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{phase.status === 'completed' ? `Implemented ${phase.name}` :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t phase.status === 'validating' ? `Reviewing ${phase.name}` :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t `Implementing ${phase.name}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t{/* File count badge for collapsed completed phases */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{phase.status === 'completed' && !expandedPhases.has(phase.id) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-text-primary/50 bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded flex-shrink-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{phase.files.length} files\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Phase Files - Show when implementing, validating, or expanded */}\r\n\t\t\t\t\t\t\t\t\t\t\t{(phase.status === 'generating' || phase.status === 'validating' || (phase.status === 'completed' && expandedPhases.has(phase.id))) && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ml-6 space-y-0.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{phase.files.map((phaseFile) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Check if this file exists in the global files array for click handling\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst globalFile = files.find(f => f.filePath === phaseFile.path);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst isFileActive = view === 'editor' && activeFile?.filePath === phaseFile.path;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={phaseFile.path}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => globalFile && onFileClick(globalFile)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-start gap-2 py-1 transition-colors font-mono w-full text-left group hover:bg-zinc-50/5 rounded px-2 min-h-0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taria-selected={isFileActive}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={!globalFile}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Status Icon BEFORE filename */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"flex-shrink-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<StatusIcon status={phaseFile.status} size=\"sm\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* File Path with proper truncation and wrapping */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'text-xs text-left block transition-colors break-all leading-tight',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisFileActive\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'text-brand font-medium'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: globalFile ? 'text-text-primary/80 group-hover:text-text-primary' : 'text-text-primary/50',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={phaseFile.path}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{truncateFilePath(phaseFile.path)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Incremental line count with responsive width and truncation */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{globalFile && (() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst incrementalLines = calculateIncrementalLineCount(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tphaseFile.path,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tphaseIndex,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tphaseTimeline,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst displayCount = incrementalLines > 999 ? `${Math.floor(incrementalLines / 1000)}k` : incrementalLines.toString();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex-shrink-0 text-text-tertiary text-xs font-mono text-right w-12 ml-2\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={`${incrementalLines} lines added in this phase`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+{displayCount}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\r\n\t\t\t\t\t\t\t\t\t{/* Validation/Preview deployment indicator */}\r\n\t\t\t\t\t\t\t\t\t{(() => {\r\n\t\t\t\t\t\t\t\t\t\tconst validatingPhase = getPhaseByStatus(phaseTimeline, 'validating');\r\n\t\t\t\t\t\t\t\t\t\tif (validatingPhase) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-1 relative bg-blue-50/5 border border-blue-200/20 rounded-lg p-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<StatusLoader size=\"sm\" color=\"blue\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium text-blue-400\">Reviewing phase...</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-blue-300/80 ml-5\">Running tests and fixing any issues</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t} else if (isPreviewDeploying) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-1 relative bg-orange-50/5 border border-orange-200/20 rounded-lg p-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<StatusLoader size=\"sm\" color=\"orange\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium text-orange-400\">Deploying preview...</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-orange-300/80 ml-5\">Updating your preview environment</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\t\t\t})()}\r\n\r\n\t\t\t\t\t\t\t\t\t{/* Thinking indicator for next phase */}\r\n\t\t\t\t\t\t\t\t\t{isThinkingNext && (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"relative z-10\" ref={lastPhaseRef}>\r\n\t\t\t\t\t\t\t\t\t\t\t<ThinkingIndicator visible={isThinkingNext} />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t{/* Fallback for existing files when no phase timeline */}\r\n\t\t\t\t\t\t\t\t\t{phaseTimeline.length === 0 && files.map((file) => {\r\n\t\t\t\t\t\t\t\t\t\tconst isFileActive = view === 'editor' && activeFile?.filePath === file.filePath;\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={file.filePath}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => onFileClick(file)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-start gap-2 py-1 font-mono w-full text-left group hover:bg-zinc-50/5 rounded px-2 min-h-0\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"flex-shrink-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{file.isGenerating ? <StatusLoader size=\"sm\" color=\"accent\" /> : <StatusCheck size=\"sm\" color=\"green\" />}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className={clsx('text-xs block break-all leading-tight', isFileActive ? 'text-brand font-medium' : 'text-text-primary/80')}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{truncateFilePath(file.filePath)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"flex-shrink-0 text-text-tertiary text-xs font-mono text-right w-12 ml-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+{file.fileContents.split('\\n').length}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{stage.metadata && (\r\n\t\t\t\t\t\t\t\t<span className=\"font-mono text-xs text-zinc-500 tracking-tighter\">\r\n\t\t\t\t\t\t\t\t\t{stage.metadata}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{index !== projectStages.length - 1 && (\r\n\t\t\t\t\t\t\t<div className={clsx(\r\n\t\t\t\t\t\t\t\t'absolute left-[9.25px] w-px h-full top-2.5 z-10',\r\n\t\t\t\t\t\t\t\tstage.status === 'completed'\r\n\t\t\t\t\t\t\t\t\t? 'bg-accent'\r\n\t\t\t\t\t\t\t\t\t: 'bg-text/5'\r\n\t\t\t\t\t\t\t)} />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t</motion.div>\r\n\t\t</>\r\n\t);\r\n}\r\n","import { useEffect, useState, useRef, forwardRef, useCallback } from 'react';\r\nimport { RefreshCw, AlertCircle } from 'lucide-react';\r\nimport { WebSocket } from 'partysocket';\r\n\r\ninterface PreviewIframeProps {\r\n    src: string;\r\n    className?: string;\r\n    title?: string;\r\n    shouldRefreshPreview?: boolean;\r\n    manualRefreshTrigger?: number;\r\n    webSocket?: WebSocket | null;\r\n}\r\n\r\n// ============================================================================\r\n// Types & Constants\r\n// ============================================================================\r\n\r\ninterface LoadState {\r\n    status: 'idle' | 'loading' | 'postload' | 'loaded' | 'error';\r\n    attempt: number;\r\n    loadedSrc: string | null;\r\n    errorMessage: string | null;\r\n    previewType?: 'sandbox' | 'dispatcher';\r\n}\r\n\r\nconst MAX_RETRIES = 10;\r\nconst REDEPLOY_AFTER_ATTEMPT = 8;\r\nconst POST_LOAD_WAIT_SANDBOX = 0;\r\nconst POST_LOAD_WAIT_DISPATCHER = 0;\r\n\r\nconst getRetryDelay = (attempt: number): number => {\r\n\t// 1s, 2s, 4s, 8s (capped)\r\n\treturn Math.min(1000 * Math.pow(2, attempt), 8000);\r\n};\r\n\r\n// ============================================================================\r\n// Main Component\r\n// ============================================================================\r\n\r\nexport const PreviewIframe = forwardRef<HTMLIFrameElement, PreviewIframeProps>(\r\n\t({ src, className = '', title = 'Preview', shouldRefreshPreview = false, manualRefreshTrigger, webSocket }, ref) => {\r\n\t\t\r\n\t\tconst [loadState, setLoadState] = useState<LoadState>({\r\n\t\t\tstatus: 'idle',\r\n\t\t\tattempt: 0,\r\n\t\t\tloadedSrc: null,\r\n\t\t\terrorMessage: null,\r\n\t\t});\r\n\r\n\t\tconst retryTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\t\tconst hasRequestedRedeployRef = useRef(false);\r\n        const postLoadTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\t\t// ====================================================================\r\n\t\t// Core Loading Logic\r\n\t\t// ====================================================================\r\n\r\n\t\t/**\r\n\t\t * Test if URL is accessible using a simple HEAD request\r\n\t\t * Returns preview type if accessible, null otherwise\r\n\t\t */\r\n\t\tconst testAvailability = useCallback(async (url: string): Promise<'sandbox' | 'dispatcher' | null> => {\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await fetch(url, {\r\n\t\t\t\t\tmethod: 'HEAD',\r\n\t\t\t\t\tmode: 'cors', // Using CORS to read security-validated headers\r\n\t\t\t\t\tcache: 'no-cache',\r\n\t\t\t\t\tsignal: AbortSignal.timeout(8000),\r\n\t\t\t\t});\r\n                console.log('Preview availability test response:', response, response.headers.forEach((value, key) => console.log(\"Header: \",key, value)));\r\n\t\t\t\t\r\n\t\t\t\tif (!response.ok) {\r\n\t\t\t\t\tconsole.log('Preview not ready (status:', response.status, ')');\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Read the custom header to determine preview type\r\n\t\t\t\t// Header will only be present if origin validation passed on server\r\n\t\t\t\tconst previewType = response.headers.get('X-Preview-Type');\r\n\t\t\t\t\r\n                if (previewType === 'sandbox-error') {\r\n                    console.log('Preview not ready (sandbox error)');\r\n                    return null;\r\n                } else if (previewType === 'sandbox' || previewType === 'dispatcher') {\r\n\t\t\t\t\tconsole.log('Preview available, type:', previewType);\r\n\t\t\t\t\treturn previewType;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Fallback: If no header present (shouldn't happen with valid origin)\r\n\t\t\t\t// but the response is OK, assume sandbox for backward compatibility\r\n\t\t\t\tconsole.log('Preview available (type unknown, assuming sandbox)');\r\n\t\t\t\treturn 'sandbox';\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log('Preview not available yet:', error);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}, []);\r\n\r\n\t\t/**\r\n\t\t * Request automatic redeployment via WebSocket\r\n\t\t */\r\n\t\tconst requestRedeploy = useCallback(() => {\r\n\t\t\tif (!webSocket || webSocket.readyState !== WebSocket.OPEN) {\r\n\t\t\t\tconsole.warn('Cannot request redeploy: WebSocket not connected');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (hasRequestedRedeployRef.current) {\r\n\t\t\t\tconsole.log('Redeploy already requested, skipping duplicate request');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log('Requesting automatic preview redeployment');\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\twebSocket.send(JSON.stringify({\r\n\t\t\t\t\ttype: 'preview',\r\n\t\t\t\t}));\r\n\t\t\t\thasRequestedRedeployRef.current = true;\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('Failed to send redeploy request:', error);\r\n\t\t\t}\r\n\t\t}, [webSocket]);\r\n\r\n\t\t/**\r\n\t\t * Request screenshot capture via WebSocket\r\n\t\t */\r\n\t\tconst requestScreenshot = useCallback((url: string) => {\r\n\t\t\tif (!webSocket || webSocket.readyState !== WebSocket.OPEN) {\r\n\t\t\t\tconsole.warn('Cannot request screenshot: WebSocket not connected');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log('Requesting screenshot capture');\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\twebSocket.send(JSON.stringify({\r\n\t\t\t\t\ttype: 'capture_screenshot',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\turl,\r\n\t\t\t\t\t\tviewport: { width: 1280, height: 720 },\r\n\t\t\t\t\t},\r\n\t\t\t\t}));\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('Failed to send screenshot request:', error);\r\n\t\t\t}\r\n\t\t}, [webSocket]);\r\n\r\n\t\t/**\r\n\t\t * Attempt to load the preview with retry logic\r\n\t\t */\r\n\t\tconst loadWithRetry = useCallback(async (url: string, attempt: number) => {\r\n\t\t\t// Clear any pending retry\r\n\t\t\tif (retryTimeoutRef.current) {\r\n\t\t\t\tclearTimeout(retryTimeoutRef.current);\r\n\t\t\t\tretryTimeoutRef.current = null;\r\n\t\t\t}\r\n\r\n            if (postLoadTimeoutRef.current) {\r\n                clearTimeout(postLoadTimeoutRef.current);\r\n                postLoadTimeoutRef.current = null;\r\n            }\r\n\r\n\t\t\t// Check if we've exceeded max retries\r\n\t\t\tif (attempt >= MAX_RETRIES) {\r\n\t\t\t\tsetLoadState({\r\n\t\t\t\t\tstatus: 'error',\r\n\t\t\t\t\tattempt,\r\n\t\t\t\t\tloadedSrc: null,\r\n\t\t\t\t\terrorMessage: 'Preview failed to load after multiple attempts',\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Update state to show loading\r\n\t\t\tsetLoadState({\r\n\t\t\t\tstatus: 'loading',\r\n\t\t\t\tattempt: attempt + 1,\r\n\t\t\t\tloadedSrc: null,\r\n\t\t\t\terrorMessage: null,\r\n\t\t\t});\r\n\r\n\t\t\t// Test availability\r\n\t\t\tconst previewType = await testAvailability(url);\r\n\r\n\t\t\tif (previewType) {\r\n\t\t\t\t// Success: put component into postload state, keep loading UI visible\r\n\t\t\t\tconsole.log(`Preview available (${previewType}) at attempt ${attempt + 1}`);\r\n\t\t\t\tsetLoadState({\r\n\t\t\t\t\tstatus: 'postload',\r\n\t\t\t\t\tattempt: attempt + 1,\r\n\t\t\t\t\tloadedSrc: url,\r\n\t\t\t\t\terrorMessage: null,\r\n\t\t\t\t\tpreviewType,\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Wait for page to render before revealing iframe and capturing screenshot\r\n\t\t\t\tconst waitTime = previewType === 'dispatcher' ? POST_LOAD_WAIT_DISPATCHER : POST_LOAD_WAIT_SANDBOX;\r\n\t\t\t\tconsole.log(`Waiting ${waitTime}ms before showing preview and capturing screenshot (${previewType} app)`);\r\n\t\t\t\tpostLoadTimeoutRef.current = setTimeout(() => {\r\n\t\t\t\t\tsetLoadState(prev => ({\r\n\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\tstatus: 'loaded',\r\n\t\t\t\t\t}));\r\n\t\t\t\t\trequestScreenshot(url);\r\n\t\t\t\t}, waitTime);\r\n\t\t\t} else {\r\n\t\t\t\t// Not available yet - retry with backoff\r\n\t\t\t\tconst delay = getRetryDelay(attempt);\r\n\t\t\t\tconst nextAttempt = attempt + 1;\r\n\t\t\t\t\r\n\t\t\t\tconsole.log(`Preview not ready. Retrying in ${Math.ceil(delay / 1000)}s (attempt ${nextAttempt}/${MAX_RETRIES})`);\r\n\r\n\t\t\t\t// Auto-redeploy after 3 failed attempts\r\n\t\t\t\tif (nextAttempt === REDEPLOY_AFTER_ATTEMPT) {\r\n\t\t\t\t\trequestRedeploy();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Schedule next retry\r\n\t\t\t\tretryTimeoutRef.current = setTimeout(() => {\r\n\t\t\t\t\tloadWithRetry(url, nextAttempt);\r\n\t\t\t\t}, delay);\r\n\t\t\t}\r\n\t\t}, [testAvailability, requestScreenshot, requestRedeploy]);\r\n\r\n\t\t/**\r\n\t\t * Force a fresh reload from scratch\r\n\t\t */\r\n\t\tconst forceReload = useCallback(() => {\r\n\t\t\tconsole.log('Force reloading preview');\r\n\t\t\thasRequestedRedeployRef.current = false;\r\n\t\t\t\r\n\t\t\tif (retryTimeoutRef.current) {\r\n\t\t\t\tclearTimeout(retryTimeoutRef.current);\r\n\t\t\t\tretryTimeoutRef.current = null;\r\n\t\t\t}\r\n\r\n            if (postLoadTimeoutRef.current) {\r\n                clearTimeout(postLoadTimeoutRef.current);\r\n                postLoadTimeoutRef.current = null;\r\n            }\r\n\r\n\t\t\tsetLoadState({\r\n\t\t\t\tstatus: 'idle',\r\n\t\t\t\tattempt: 0,\r\n\t\t\t\tloadedSrc: null,\r\n\t\t\t\terrorMessage: null,\r\n\t\t\t});\r\n\r\n\t\t\t// Start loading\r\n\t\t\tloadWithRetry(src, 0);\r\n\t\t}, [src, loadWithRetry]);\r\n\r\n\t\t// ====================================================================\r\n\t\t// Effects\r\n\t\t// ====================================================================\r\n\r\n\t\t/**\r\n\t\t * Effect: Load when src changes\r\n\t\t */\r\n\t\tuseEffect(() => {\r\n\t\t\tif (!src) return;\r\n\r\n\t\t\tconsole.log('Preview src changed, starting load:', src);\r\n\t\t\thasRequestedRedeployRef.current = false;\r\n\t\t\t\r\n\t\t\tif (retryTimeoutRef.current) {\r\n\t\t\t\tclearTimeout(retryTimeoutRef.current);\r\n\t\t\t\tretryTimeoutRef.current = null;\r\n\t\t\t}\r\n\r\n            if (postLoadTimeoutRef.current) {\r\n                clearTimeout(postLoadTimeoutRef.current);\r\n                postLoadTimeoutRef.current = null;\r\n            }\r\n\r\n\t\t\tsetLoadState({\r\n\t\t\t\tstatus: 'idle',\r\n\t\t\t\tattempt: 0,\r\n\t\t\t\tloadedSrc: null,\r\n\t\t\t\terrorMessage: null,\r\n\t\t\t});\r\n\r\n\t\t\tloadWithRetry(src, 0);\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tif (retryTimeoutRef.current) {\r\n\t\t\t\t\tclearTimeout(retryTimeoutRef.current);\r\n\t\t\t\t\tretryTimeoutRef.current = null;\r\n\t\t\t\t}\r\n\t\t\t\tif (postLoadTimeoutRef.current) {\r\n\t\t\t\t\tclearTimeout(postLoadTimeoutRef.current);\r\n\t\t\t\t\tpostLoadTimeoutRef.current = null;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}, [src, loadWithRetry]);\r\n\r\n\t\t/**\r\n\t\t * Effect: Auto-refresh after deployment\r\n\t\t */\r\n\t\tuseEffect(() => {\r\n\t\t\tif (shouldRefreshPreview && loadState.status === 'loaded' && loadState.loadedSrc) {\r\n\t\t\t\tconsole.log('Auto-refreshing preview after deployment');\r\n\t\t\t\tforceReload();\r\n\t\t\t}\r\n\t\t}, [shouldRefreshPreview, loadState.status, loadState.loadedSrc, forceReload]);\r\n\r\n\t\t/**\r\n\t\t * Effect: Manual refresh trigger\r\n\t\t */\r\n\t\tuseEffect(() => {\r\n\t\t\tif (manualRefreshTrigger && manualRefreshTrigger > 0) {\r\n\t\t\t\tconsole.log('Manual refresh triggered');\r\n\t\t\t\tforceReload();\r\n\t\t\t}\r\n\t\t}, [manualRefreshTrigger, forceReload]);\r\n\r\n\t\t/**\r\n\t\t * Effect: Cleanup on unmount\r\n\t\t */\r\n\t\tuseEffect(() => {\r\n\t\t\treturn () => {\r\n\t\t\t\tif (retryTimeoutRef.current) {\r\n\t\t\t\t\tclearTimeout(retryTimeoutRef.current);\r\n\t\t\t\t}\r\n\t\t\t\tif (postLoadTimeoutRef.current) {\r\n\t\t\t\t\tclearTimeout(postLoadTimeoutRef.current);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}, []);\r\n\r\n\t\t// ====================================================================\r\n\t\t// Render\r\n\t\t// ====================================================================\r\n\r\n\t\t// Successfully loaded - show iframe\r\n\t\tif (loadState.status === 'loaded' && loadState.loadedSrc) {\r\n\t\t\treturn (\r\n\t\t\t\t<iframe\r\n\t\t\t\t\tref={ref}\r\n\t\t\t\t\tsrc={loadState.loadedSrc}\r\n\t\t\t\t\tclassName={className}\r\n\t\t\t\t\ttitle={title}\r\n\t\t\t\t\tonError={() => {\r\n\t\t\t\t\t\tconsole.error('Iframe failed to load');\r\n\t\t\t\t\t\tsetLoadState(prev => ({\r\n\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\tstatus: 'error',\r\n\t\t\t\t\t\t\terrorMessage: 'Preview failed to render',\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Loading state\r\n\t\tif (loadState.status === 'loading' || loadState.status === 'idle' || loadState.status === 'postload') {\r\n\t\t\tconst delay = getRetryDelay(loadState.attempt - 1);\r\n\t\t\tconst delaySeconds = Math.ceil(delay / 1000);\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<div className={`${className} relative flex flex-col items-center justify-center bg-bg-3 border border-text/10 rounded-lg`}>\r\n                    {loadState.status === 'postload' && loadState.loadedSrc && (\r\n                        <iframe\r\n                            ref={ref}\r\n                            src={loadState.loadedSrc}\r\n                            className=\"absolute inset-0 opacity-0 pointer-events-none\"\r\n                            title={title}\r\n                            aria-hidden=\"true\"\r\n                            onError={() => {\r\n                                console.error('Iframe failed to load');\r\n                                setLoadState(prev => ({\r\n                                    ...prev,\r\n                                    status: 'error',\r\n                                    errorMessage: 'Preview failed to render',\r\n                                }));\r\n                            }}\r\n                        />\r\n                    )}\r\n\t\t\t\t\t<div className=\"text-center p-8 max-w-md\">\r\n\t\t\t\t\t\t<RefreshCw className=\"size-8 text-accent animate-spin mx-auto mb-4\" />\r\n\t\t\t\t\t\t<h3 className=\"text-lg font-medium text-text-primary mb-2\">\r\n\t\t\t\t\t\t\tLoading Preview\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<p className=\"text-text-primary/70 text-sm mb-4\">\r\n\t\t\t\t\t\t\t{loadState.attempt === 0\r\n\t\t\t\t\t\t\t\t? 'Checking if your deployed preview is ready...'\r\n\t\t\t\t\t\t\t\t: `Preview not ready yet. Retrying in ${delaySeconds}s... (attempt ${loadState.attempt}/${MAX_RETRIES})`\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t{loadState.attempt >= REDEPLOY_AFTER_ATTEMPT && (\r\n\t\t\t\t\t\t\t<p className=\"text-xs text-accent/70\">\r\n\t\t\t\t\t\t\t\tAuto-redeployment triggered to refresh the preview\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<div className=\"text-xs text-text-primary/50 mt-2\">\r\n\t\t\t\t\t\t\tPreview URLs may take a moment to become available after deployment\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Error state - after max retries\r\n\t\treturn (\r\n\t\t\t<div className={`${className} flex flex-col items-center justify-center bg-bg-3 border border-text/10 rounded-lg`}>\r\n\t\t\t\t<div className=\"text-center p-8 max-w-md\">\r\n\t\t\t\t\t<AlertCircle className=\"size-8 text-orange-500 mx-auto mb-4\" />\r\n\t\t\t\t\t<h3 className=\"text-lg font-medium text-text-primary mb-2\">\r\n\t\t\t\t\t\tPreview Not Available\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<p className=\"text-text-primary/70 text-sm mb-6\">\r\n\t\t\t\t\t\t{loadState.errorMessage || 'The preview failed to load after multiple attempts.'}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<div className=\"space-y-3\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={forceReload}\r\n\t\t\t\t\t\t\tclassName=\"flex items-center justify-center gap-2 px-6 py-3 bg-accent hover:bg-accent/90 text-white rounded-lg transition-colors text-sm mx-auto font-medium w-full\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<RefreshCw className=\"size-4\" />\r\n\t\t\t\t\t\t\tTry Again\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<p className=\"text-xs text-text-primary/60\">\r\n\t\t\t\t\t\t\tIf the issue persists, please describe the problem in chat so I can help diagnose and fix it.\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n);\r\n\r\nPreviewIframe.displayName = 'PreviewIframe';\r\n","import clsx from 'clsx';\r\nimport { AnimatePresence, motion } from 'framer-motion';\r\nimport { Eye, Code } from 'lucide-react';\r\n\r\nexport function ViewModeSwitch({\r\n\tview,\r\n\tonChange,\r\n\tpreviewAvailable = false,\r\n\tshowTooltip = false,\r\n}: {\r\n\tview: 'preview' | 'editor' | 'blueprint'\r\n\tonChange: (mode: 'preview' | 'editor' | 'blueprint') => void;\r\n\tpreviewAvailable: boolean;\r\n\tshowTooltip: boolean;\r\n}) {\r\n\tif (!previewAvailable) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"flex items-center gap-1 bg-bg-1 rounded-md p-0.5 relative\">\r\n\t\t\t<AnimatePresence>\r\n\t\t\t\t{showTooltip && (\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tinitial={{ opacity: 0, scale: 0.4 }}\r\n\t\t\t\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\t\t\t\texit={{ opacity: 0, scale: 0 }}\r\n\t\t\t\t\t\tclassName=\"absolute z-50 top-10 left-0 bg-bg-2 text-text-primary text-xs px-2 py-1 rounded whitespace-nowrap animate-fade-in\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tYou can view code anytime from here\r\n\t\t\t\t\t</motion.div>\r\n\t\t\t\t)}\r\n\t\t\t</AnimatePresence>\r\n\r\n\t\t\t<button\r\n\t\t\t\tonClick={() => onChange('preview')}\r\n\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t'p-1 flex items-center justify-between h-full rounded-md transition-colors',\r\n\t\t\t\t\tview === 'preview'\r\n\t\t\t\t\t\t? 'bg-bg-4 text-text-primary'\r\n\t\t\t\t\t\t: 'text-text-50/70 hover:text-text-primary hover:bg-accent',\r\n\t\t\t\t)}\r\n\t\t\t>\r\n\t\t\t\t<Eye className=\"size-4\" />\r\n\t\t\t</button>\r\n\t\t\t<button\r\n\t\t\t\tonClick={() => onChange('editor')}\r\n\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t'p-1 flex items-center justify-between h-full rounded-md transition-colors',\r\n\t\t\t\t\tview === 'editor'\r\n\t\t\t\t\t\t? 'bg-bg-4 text-text-primary'\r\n\t\t\t\t\t\t: 'text-text-50/70 hover:text-text-primary hover:bg-accent',\r\n\t\t\t\t)}\r\n\t\t\t>\r\n\t\t\t\t<Code className=\"size-4\" />\r\n\t\t\t</button>\r\n\t\t\t{/* {terminalAvailable && (\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => onChange('terminal')}\r\n\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t'p-1 flex items-center justify-between h-full rounded-md transition-colors',\r\n\t\t\t\t\t\tview === 'terminal'\r\n\t\t\t\t\t\t\t? 'bg-bg-4 text-text-primary'\r\n\t\t\t\t\t\t\t: 'text-text-50/70 hover:text-text-primary hover:bg-accent',\r\n\t\t\t\t\t)}\r\n\t\t\t\t\ttitle=\"Terminal\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Terminal className=\"size-4\" />\r\n\t\t\t\t</button>\r\n\t\t\t)} */}\r\n\t\t</div>\r\n\t);\r\n}\r\n","import clsx from 'clsx';\r\n\r\ntype ButtonProps = React.ComponentProps<'button'> & {\r\n\tvariant?: 'primary' | 'secondary';\r\n};\r\n\r\nexport function Button({\r\n\tvariant = 'secondary',\r\n\tchildren,\r\n\tclassName,\r\n\t...props\r\n}: ButtonProps) {\r\n\treturn (\r\n\t\t<button\r\n\t\t\tclassName={clsx(\r\n\t\t\t\t'inline-flex items-center gap-1 px-2 h-8 rounded-lg text-sm font-medium',\r\n\t\t\t\tvariant === 'primary' && 'bg-bg-bright text-black',\r\n\t\t\t\tvariant === 'secondary' && 'bg-bg-darkest text-text-primary',\r\n\t\t\t\tclassName,\r\n\t\t\t)}\r\n\t\t\t{...props}\r\n\t\t>\r\n\t\t\t{children}\r\n\t\t</button>\r\n\t);\r\n}\r\n","import html2canvas from 'html2canvas-pro';\r\n\r\nexport interface ScreenshotOptions {\r\n  quality?: number;\r\n  format?: 'png' | 'jpeg' | 'webp';\r\n  excludeElements?: string[]; // CSS selectors to exclude\r\n  scale?: number;\r\n  width?: number;\r\n  height?: number;\r\n  element?: HTMLElement; // Optional specific element to capture\r\n}\r\n\r\nexport interface ScreenshotResult {\r\n  dataUrl: string;\r\n  blob: Blob;\r\n  metadata: {\r\n    timestamp: number;\r\n    url: string;\r\n    viewport: { width: number; height: number };\r\n    userAgent: string;\r\n  };\r\n}\r\n\r\n/**\r\n * Captures a screenshot of the current page with advanced options\r\n * Automatically handles hiding specified elements during capture\r\n */\r\nexport async function captureScreenshot(options: ScreenshotOptions = {}): Promise<ScreenshotResult> {\r\n  const {\r\n    quality = 0.8,\r\n    format = 'jpeg',\r\n    excludeElements = [],\r\n    scale = 1,\r\n    width,\r\n    height,\r\n    element\r\n  } = options;\r\n\r\n  // Store original styles of elements to hide\r\n  const elementsToHide: Array<{ element: HTMLElement; originalStyle: string }> = [];\r\n  \r\n  try {\r\n    // Hide specified elements\r\n    excludeElements.forEach(selector => {\r\n      const elements = document.querySelectorAll(selector);\r\n      elements.forEach(el => {\r\n        const htmlEl = el as HTMLElement;\r\n        elementsToHide.push({\r\n          element: htmlEl,\r\n          originalStyle: htmlEl.style.display\r\n        });\r\n        htmlEl.style.display = 'none';\r\n      });\r\n    });\r\n\r\n    // Capture screenshot of the specified element or the entire body\r\n    const targetElement = element || document.body;\r\n    const canvas = await html2canvas(targetElement, {\r\n      useCORS: true,\r\n      allowTaint: false,\r\n      scale,\r\n      width,\r\n      height,\r\n      backgroundColor: '#ffffff',\r\n      logging: false,\r\n      ignoreElements: (element) => {\r\n        // Additional element filtering if needed\r\n        return element.classList.contains('screenshot-exclude');\r\n      }\r\n    });\r\n\r\n    // Convert to desired format\r\n    const dataUrl = canvas.toDataURL(`image/${format}`, quality);\r\n    \r\n    // Convert to blob for easier handling\r\n    const blob = await new Promise<Blob>((resolve) => {\r\n      canvas.toBlob((blob) => {\r\n        resolve(blob!);\r\n      }, `image/${format}`, quality);\r\n    });\r\n\r\n    return {\r\n      dataUrl,\r\n      blob,\r\n      metadata: {\r\n        timestamp: Date.now(),\r\n        url: window.location.href,\r\n        viewport: {\r\n          width: window.innerWidth,\r\n          height: window.innerHeight\r\n        },\r\n        userAgent: navigator.userAgent\r\n      }\r\n    };\r\n  } finally {\r\n    // Restore original styles\r\n    elementsToHide.forEach(({ element, originalStyle }) => {\r\n      element.style.display = originalStyle;\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * Captures a screenshot specifically for debug purposes\r\n * Automatically excludes debug panels and overlays\r\n */\r\nexport async function captureDebugScreenshot(): Promise<ScreenshotResult> {\r\n  return captureScreenshot({\r\n    quality: 0.8,\r\n    format: 'jpeg',\r\n    excludeElements: [\r\n      '[data-debug-panel]',\r\n      '[data-overlay]',\r\n      '.debug-panel',\r\n      '.modal-overlay',\r\n      '.toast-container',\r\n      '.notification'\r\n    ],\r\n    scale: 1\r\n  });\r\n}\r\n\r\n/**\r\n * Captures a screenshot for deployment documentation\r\n * High quality capture for production use\r\n */\r\nexport async function captureDeploymentScreenshot(): Promise<ScreenshotResult> {\r\n  return captureScreenshot({\r\n    quality: 0.9,\r\n    format: 'png',\r\n    excludeElements: [\r\n      '[data-debug-panel]',\r\n      '[data-overlay]',\r\n      '.debug-panel'\r\n    ],\r\n    scale: 1\r\n  });\r\n}\r\n\r\n/**\r\n * Auto screenshot system for tracking page states\r\n */\r\nexport class AutoScreenshotSystem {\r\n  private enabled = false;\r\n  private lastScreenshot: ScreenshotResult | null = null;\r\n  private screenshotHistory: ScreenshotResult[] = [];\r\n  private maxHistory = 10;\r\n\r\n  constructor(private onScreenshot?: (screenshot: ScreenshotResult) => void) {}\r\n\r\n  enable() {\r\n    this.enabled = true;\r\n    this.setupListeners();\r\n  }\r\n\r\n  disable() {\r\n    this.enabled = false;\r\n  }\r\n\r\n  private setupListeners() {\r\n    // Capture on page navigation\r\n    window.addEventListener('popstate', () => {\r\n      if (this.enabled) {\r\n        this.captureAuto('navigation');\r\n      }\r\n    });\r\n\r\n    // Capture on significant DOM changes (debounced)\r\n    let domChangeTimeout: NodeJS.Timeout;\r\n    const observer = new MutationObserver(() => {\r\n      if (this.enabled) {\r\n        clearTimeout(domChangeTimeout);\r\n        domChangeTimeout = setTimeout(() => {\r\n          this.captureAuto('dom_change');\r\n        }, 2000);\r\n      }\r\n    });\r\n\r\n    observer.observe(document.body, {\r\n      childList: true,\r\n      subtree: true,\r\n      attributes: false\r\n    });\r\n  }\r\n\r\n  private async captureAuto(trigger: string) {\r\n    try {\r\n      const screenshot = await captureScreenshot({\r\n        quality: 0.6,\r\n        format: 'jpeg',\r\n        scale: 0.5,\r\n        excludeElements: [\r\n          '[data-debug-panel]',\r\n          '[data-overlay]'\r\n        ]\r\n      });\r\n\r\n      this.lastScreenshot = screenshot;\r\n      this.screenshotHistory.push(screenshot);\r\n      \r\n      // Keep only recent screenshots\r\n      if (this.screenshotHistory.length > this.maxHistory) {\r\n        this.screenshotHistory.shift();\r\n      }\r\n\r\n      this.onScreenshot?.(screenshot);\r\n      \r\n      console.log(`Auto screenshot captured: ${trigger}`, {\r\n        timestamp: screenshot.metadata.timestamp,\r\n        url: screenshot.metadata.url\r\n      });\r\n    } catch (error) {\r\n      console.error('Auto screenshot failed:', error);\r\n    }\r\n  }\r\n\r\n  getHistory(): ScreenshotResult[] {\r\n    return [...this.screenshotHistory];\r\n  }\r\n\r\n  getLastScreenshot(): ScreenshotResult | null {\r\n    return this.lastScreenshot;\r\n  }\r\n}\r\n\r\n// Global auto screenshot system instance\r\nexport const autoScreenshotSystem = new AutoScreenshotSystem();\r\n","import { useState, useRef, useMemo, Component } from 'react';\r\nimport { Bug, X, Download, Mail, Maximize2, Minimize2, Clock, BookmarkPlus, Bookmark, Activity, BarChart3 } from 'lucide-react';\r\nimport { Button } from '../../../components/primitives/button';\r\nimport { captureDebugScreenshot } from '../../../utils/screenshot';\r\n\r\n// Custom Error Boundary to prevent debug panel crashes from affecting main site\r\nclass DebugPanelErrorBoundary extends Component<\r\n  { children: React.ReactNode },\r\n  { hasError: boolean; error?: Error }\r\n> {\r\n  constructor(props: { children: React.ReactNode }) {\r\n    super(props);\r\n    this.state = { hasError: false };\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error) {\r\n    return { hasError: true, error };\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\r\n    console.error('Debug Panel Error:', error, errorInfo);\r\n    // Log to external service if needed\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return (\r\n        <div className=\"fixed bottom-6 right-6 z-50 p-4 bg-red-50 border border-red-200 rounded-lg shadow-lg max-w-sm\">\r\n          <div className=\"flex items-center gap-2 text-red-800 mb-2\">\r\n            <Bug className=\"w-4 h-4\" />\r\n            <span className=\"font-medium\">Debug Panel Error</span>\r\n          </div>\r\n          <p className=\"text-sm text-red-700 mb-3\">\r\n            The debug panel encountered an error but your main application is still working normally.\r\n          </p>\r\n          <button\r\n            onClick={() => this.setState({ hasError: false, error: undefined })}\r\n            className=\"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors\"\r\n          >\r\n            Retry Debug Panel\r\n          </button>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport interface DebugMessage {\r\n  id: string;\r\n  timestamp: number;\r\n  type: 'error' | 'warning' | 'info' | 'websocket';\r\n  message: string;\r\n  details?: string;\r\n  source?: string;\r\n  messageType?: string;\r\n  rawMessage?: unknown;\r\n  wsCategory?: 'generation' | 'phase' | 'file' | 'deployment' | 'system';\r\n  duration?: number; // Time since previous message\r\n  isBookmarked?: boolean;\r\n  performance?: {\r\n    tokens?: number;\r\n    fileCount?: number;\r\n    memoryUsage?: number;\r\n  };\r\n}\r\n\r\ninterface DebugPanelProps {\r\n  messages: DebugMessage[];\r\n  onClear: () => void;\r\n  chatSessionId?: string;\r\n}\r\n\r\ninterface DebugDump {\r\n  timestamp: number;\r\n  chatSessionId: string;\r\n  messages: DebugMessage[];\r\n  appState: {\r\n    url: string;\r\n    userAgent: string;\r\n    viewport: { width: number; height: number };\r\n  };\r\n  screenshot?: string;\r\n}\r\n\r\nfunction DebugPanelCore({ messages, onClear, chatSessionId }: DebugPanelProps) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [isMaximized, setIsMaximized] = useState(false);\r\n  const [expandedMessages, setExpandedMessages] = useState<Set<string>>(new Set());\r\n  const [filter, setFilter] = useState<'all' | 'error' | 'warning' | 'info' | 'websocket'>('all');\r\n  const [wsFilter, setWsFilter] = useState<'all' | 'generation' | 'phase' | 'file' | 'deployment' | 'system'>('all');\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [isGeneratingDump, setIsGeneratingDump] = useState(false);\r\n  const [viewMode, setViewMode] = useState<'list' | 'timeline' | 'analytics'>('list');\r\n  const [bookmarkedMessages, setBookmarkedMessages] = useState<Set<string>>(new Set());\r\n  // notifications removed per design request\r\n  \r\n  // Helper functions defined first to avoid hoisting issues\r\n  const calculateOperationMetrics = (wsMessages: DebugMessage[]) => {\r\n    try {\r\n      const operations = {\r\n        phaseGeneration: [] as number[],\r\n        fileGeneration: [] as { duration: number; lines: number; chars: number }[],\r\n        cfDeployment: [] as number[],\r\n        runnerDeployment: [] as number[]\r\n      };\r\n      \r\n      // Track phase lifecycle: phase_generating  phase_generated  phase_implementing  phase_implemented\r\n      const phaseStarts = wsMessages.filter(m => m.messageType === 'phase_generating');\r\n      const phaseCompletes = wsMessages.filter(m => m.messageType === 'phase_implemented');\r\n      \r\n      phaseStarts.forEach(start => {\r\n        const complete = phaseCompletes.find(c => c.timestamp > start.timestamp);\r\n        if (complete) {\r\n          operations.phaseGeneration.push(complete.timestamp - start.timestamp);\r\n        }\r\n      });\r\n      \r\n      // Enhanced file generation tracking with content analysis\r\n      const fileStarts = wsMessages.filter(m => m.messageType === 'file_generating');\r\n      const fileCompletes = wsMessages.filter(m => m.messageType === 'file_generated');\r\n      \r\n      fileStarts.forEach(start => {\r\n        const complete = fileCompletes.find(c => c.timestamp > start.timestamp);\r\n        if (complete) {\r\n          const duration = complete.timestamp - start.timestamp;\r\n          \r\n          // Extract file content info from message if available\r\n          let lines = 0;\r\n          let chars = 0;\r\n          \r\n          try {\r\n            // Try to extract content metrics from the complete message\r\n            const content = complete.message || '';\r\n            \r\n            // Look for content indicators in the message\r\n            const linesMatch = content.match(/(\\d+)\\s*lines?/i);\r\n            const charsMatch = content.match(/(\\d+)\\s*characters?/i);\r\n            const sizeMatch = content.match(/(\\d+)\\s*bytes?/i);\r\n            \r\n            if (linesMatch) {\r\n              lines = parseInt(linesMatch[1]);\r\n            } else {\r\n              // Estimate lines from file content if present\r\n              const fileContentMatch = content.match(/```[\\s\\S]*?```/g);\r\n              if (fileContentMatch) {\r\n                lines = fileContentMatch[0].split('\\n').length - 2; // Subtract code fence lines\r\n              }\r\n            }\r\n            \r\n            if (charsMatch) {\r\n              chars = parseInt(charsMatch[1]);\r\n            } else if (sizeMatch) {\r\n              chars = parseInt(sizeMatch[1]);\r\n            } else {\r\n              // Estimate characters from content\r\n              const fileContentMatch = content.match(/```[\\s\\S]*?```/g);\r\n              if (fileContentMatch) {\r\n                chars = fileContentMatch[0].length;\r\n              } else {\r\n                chars = content.length;\r\n              }\r\n            }\r\n            \r\n            // Fallback estimates if no metrics found\r\n            if (lines === 0 && chars > 0) {\r\n              lines = Math.max(1, Math.floor(chars / 50)); // Estimate ~50 chars per line\r\n            }\r\n            if (chars === 0 && lines > 0) {\r\n              chars = lines * 50; // Estimate 50 chars per line\r\n            }\r\n            \r\n          } catch (parseError) {\r\n            // Use default estimates for unknown content\r\n            lines = 50; // Default estimate\r\n            chars = 2500; // Default estimate\r\n          }\r\n          \r\n          operations.fileGeneration.push({ duration, lines, chars });\r\n        }\r\n      });\r\n      \r\n      // Track CF deployment: cloudflare_deployment_started  cloudflare_deployment_completed\r\n      const cfStarts = wsMessages.filter(m => m.messageType === 'cloudflare_deployment_started');\r\n      const cfCompletes = wsMessages.filter(m => m.messageType === 'cloudflare_deployment_completed');\r\n      \r\n      cfStarts.forEach(start => {\r\n        const complete = cfCompletes.find(c => c.timestamp > start.timestamp);\r\n        if (complete) {\r\n          operations.cfDeployment.push(complete.timestamp - start.timestamp);\r\n        }\r\n      });\r\n      \r\n      // Track runner deployment: phase_implemented  deployment_completed\r\n      const runnerStarts = wsMessages.filter(m => m.messageType === 'phase_implemented');\r\n      const runnerCompletes = wsMessages.filter(m => m.messageType === 'deployment_completed');\r\n      \r\n      runnerStarts.forEach(start => {\r\n        const complete = runnerCompletes.find(c => c.timestamp > start.timestamp);\r\n        if (complete) {\r\n          operations.runnerDeployment.push(complete.timestamp - start.timestamp);\r\n        }\r\n      });\r\n      \r\n      // Calculate statistics for duration-only operations\r\n      const getStats = (durations: number[]) => {\r\n        if (durations.length === 0) return { avg: 0, median: 0, p99: 0, count: 0 };\r\n        \r\n        const sorted = [...durations].sort((a, b) => a - b);\r\n        const avg = durations.reduce((a, b) => a + b, 0) / durations.length;\r\n        const median = sorted.length % 2 === 0 ? \r\n          (sorted[sorted.length/2-1] + sorted[sorted.length/2]) / 2 :\r\n          sorted[Math.floor(sorted.length/2)];\r\n        const p99Index = Math.ceil(sorted.length * 0.99) - 1;\r\n        const p99 = sorted[Math.max(0, p99Index)];\r\n        \r\n        return { avg, median, p99, count: durations.length };\r\n      };\r\n      \r\n      // Calculate enhanced file generation statistics\r\n      const getFileStats = (fileOps: { duration: number; lines: number; chars: number }[]) => {\r\n        if (fileOps.length === 0) {\r\n          return {\r\n            duration: { avg: 0, median: 0, p99: 0, count: 0 },\r\n            linesPerSecond: { avg: 0, median: 0, p99: 0 },\r\n            charsPerSecond: { avg: 0, median: 0, p99: 0 },\r\n            totalLines: 0,\r\n            totalChars: 0\r\n          };\r\n        }\r\n        \r\n        const durations = fileOps.map(op => op.duration);\r\n        const linesPerSec = fileOps.map(op => op.duration > 0 ? (op.lines / (op.duration / 1000)) : 0);\r\n        const charsPerSec = fileOps.map(op => op.duration > 0 ? (op.chars / (op.duration / 1000)) : 0);\r\n        \r\n        const totalLines = fileOps.reduce((sum, op) => sum + op.lines, 0);\r\n        const totalChars = fileOps.reduce((sum, op) => sum + op.chars, 0);\r\n        \r\n        const calcStats = (values: number[]) => {\r\n          const sorted = [...values].sort((a, b) => a - b);\r\n          const avg = values.reduce((a, b) => a + b, 0) / values.length;\r\n          const median = sorted.length % 2 === 0 ? \r\n            (sorted[sorted.length/2-1] + sorted[sorted.length/2]) / 2 :\r\n            sorted[Math.floor(sorted.length/2)];\r\n          const p99Index = Math.ceil(sorted.length * 0.99) - 1;\r\n          const p99 = sorted[Math.max(0, p99Index)];\r\n          return { avg, median, p99 };\r\n        };\r\n        \r\n        return {\r\n          duration: { ...getStats(durations), count: fileOps.length },\r\n          linesPerSecond: calcStats(linesPerSec),\r\n          charsPerSecond: calcStats(charsPerSec),\r\n          totalLines,\r\n          totalChars\r\n        };\r\n      };\r\n      \r\n      return {\r\n        phaseGeneration: getStats(operations.phaseGeneration),\r\n        fileGeneration: getFileStats(operations.fileGeneration),\r\n        cfDeployment: getStats(operations.cfDeployment),\r\n        runnerDeployment: getStats(operations.runnerDeployment)\r\n      };\r\n    } catch (error) {\r\n      console.error('Error calculating operation metrics:', error);\r\n      return {\r\n        phaseGeneration: { avg: 0, median: 0, p99: 0, count: 0 },\r\n        fileGeneration: {\r\n          duration: { avg: 0, median: 0, p99: 0, count: 0 },\r\n          linesPerSecond: { avg: 0, median: 0, p99: 0 },\r\n          charsPerSecond: { avg: 0, median: 0, p99: 0 },\r\n          totalLines: 0,\r\n          totalChars: 0\r\n        },\r\n        cfDeployment: { avg: 0, median: 0, p99: 0, count: 0 },\r\n        runnerDeployment: { avg: 0, median: 0, p99: 0, count: 0 }\r\n      };\r\n    }\r\n  };\r\n  \r\n  const processTimelineData = (messages: DebugMessage[]) => {\r\n    try {\r\n      if (!messages || messages.length === 0) return { events: [], lanes: [] };\r\n      \r\n      const events = messages.map((msg, index) => ({\r\n        id: msg.id || `msg-${index}`,\r\n        timestamp: msg.timestamp || Date.now(),\r\n        message: msg.message || 'Unknown message',\r\n        type: msg.type || 'info',\r\n        messageType: msg.messageType,\r\n        category: msg.wsCategory || categorizeWebSocketMessage(msg.messageType),\r\n        duration: index > 0 ? (msg.timestamp || 0) - (messages[index - 1]?.timestamp || 0) : 0,\r\n        isBookmarked: bookmarkedMessages.has(msg.id || '')\r\n      }));\r\n      \r\n      // Group events into lanes by category for better visualization\r\n      const lanes = [\r\n        { id: 'generation', label: 'Generation', color: 'bg-blue-100 border-blue-300' },\r\n        { id: 'phase', label: 'Phases', color: 'bg-green-100 border-green-300' },\r\n        { id: 'file', label: 'Files', color: 'bg-purple-100 border-purple-300' },\r\n        { id: 'deployment', label: 'Deployment', color: 'bg-orange-100 border-orange-300' },\r\n        { id: 'system', label: 'System', color: 'bg-red-100 border-red-300' }\r\n      ];\r\n      \r\n      return { events, lanes };\r\n    } catch (error) {\r\n      console.error('Error processing timeline data:', error);\r\n      return { events: [], lanes: [] };\r\n    }\r\n  };\r\n  \r\n  // Advanced performance analytics - only compute when panel is open\r\n  const analyticsData = useMemo(() => {\r\n    try {\r\n      if (!isOpen) return null; // Performance optimization: don't compute when closed\r\n      \r\n      const now = Date.now();\r\n      const last24h = messages.filter(m => now - m.timestamp < 24 * 60 * 60 * 1000);\r\n      const errors = messages.filter(m => m.type === 'error');\r\n      const warnings = messages.filter(m => m.type === 'warning');\r\n      const wsMessages = messages.filter(m => m.type === 'websocket');\r\n      \r\n      // Calculate statistical metrics for message intervals\r\n      const intervals = [];\r\n      for (let i = 1; i < messages.length; i++) {\r\n        intervals.push(messages[i].timestamp - messages[i-1].timestamp);\r\n      }\r\n      \r\n      const sortedIntervals = [...intervals].sort((a, b) => a - b);\r\n      const median = sortedIntervals.length > 0 ? \r\n        sortedIntervals.length % 2 === 0 ? \r\n          (sortedIntervals[sortedIntervals.length/2-1] + sortedIntervals[sortedIntervals.length/2]) / 2 :\r\n          sortedIntervals[Math.floor(sortedIntervals.length/2)] : 0;\r\n      \r\n      const p99Index = Math.ceil(sortedIntervals.length * 0.99) - 1;\r\n      const p99 = sortedIntervals.length > 0 ? sortedIntervals[Math.max(0, p99Index)] : 0;\r\n      const avgInterval = intervals.length > 0 ? intervals.reduce((a, b) => a + b, 0) / intervals.length : 0;\r\n      \r\n      // Track operation-specific durations\r\n      const operationMetrics = calculateOperationMetrics(wsMessages);\r\n      \r\n      return {\r\n        totalMessages: messages.length,\r\n        last24h: last24h.length,\r\n        errorRate: messages.length > 0 ? (errors.length / messages.length * 100).toFixed(1) : '0',\r\n        warningRate: messages.length > 0 ? (warnings.length / messages.length * 100).toFixed(1) : '0',\r\n        wsMessages: wsMessages.length,\r\n        intervals: {\r\n          avg: avgInterval > 1000 ? `${(avgInterval/1000).toFixed(1)}s` : `${avgInterval.toFixed(0)}ms`,\r\n          median: median > 1000 ? `${(median/1000).toFixed(1)}s` : `${median.toFixed(0)}ms`,\r\n          p99: p99 > 1000 ? `${(p99/1000).toFixed(1)}s` : `${p99.toFixed(0)}ms`\r\n        },\r\n        operations: operationMetrics\r\n      };\r\n    } catch (error) {\r\n      console.error('Error calculating analytics data:', error);\r\n      return null;\r\n    }\r\n  }, [messages, isOpen, bookmarkedMessages]);\r\n  \r\n  // Timeline data processing - optimized for performance\r\n  const timelineData = useMemo(() => {\r\n    try {\r\n      if (!isOpen || viewMode !== 'timeline') return null; // Only compute when timeline is active\r\n      \r\n      return processTimelineData(messages);\r\n    } catch (error) {\r\n      console.error('Error processing timeline data:', error);\r\n      return null;\r\n    }\r\n  }, [messages, isOpen, viewMode, bookmarkedMessages]);\r\n  \r\n  // notifications logic removed\r\n  \r\n  // Message bookmarking functionality\r\n  const toggleBookmark = (messageId: string) => {\r\n    const newBookmarks = new Set(bookmarkedMessages);\r\n    if (newBookmarks.has(messageId)) {\r\n      newBookmarks.delete(messageId);\r\n    } else {\r\n      newBookmarks.add(messageId);\r\n    }\r\n    setBookmarkedMessages(newBookmarks);\r\n  };\r\n  \r\n  // WebSocket message categorization\r\n  const categorizeWebSocketMessage = (messageType?: string): 'generation' | 'phase' | 'file' | 'deployment' | 'system' | undefined => {\r\n    if (!messageType) return undefined;\r\n    \r\n    // Generation messages\r\n    if (['generation_started', 'generation_complete', 'generation_errors'].includes(messageType)) {\r\n      return 'generation';\r\n    }\r\n    \r\n    // Phase messages  \r\n    if (['phase_generating', 'phase_generated', 'phase_implementing', 'phase_implemented'].includes(messageType)) {\r\n      return 'phase';\r\n    }\r\n    \r\n    // File operation messages\r\n    if (['file_generating', 'file_generated', 'file_regenerated', 'file_chunk_generated', 'file_enhanced', 'file_regenerating'].includes(messageType)) {\r\n      return 'file';\r\n    }\r\n    \r\n    // Deployment messages\r\n    if (['cloudflare_deployment_started', 'cloudflare_deployment_completed', 'cloudflare_deployment_error', 'deployment_completed'].includes(messageType)) {\r\n      return 'deployment';\r\n    }\r\n    \r\n    // System/Runtime messages\r\n    if (['runtime_error_found', 'command_executing', 'code_review', 'error'].includes(messageType)) {\r\n      return 'system';\r\n    }\r\n    \r\n    return 'system'; // Default fallback\r\n  };\r\n  \r\n  const panelRef = useRef<HTMLDivElement>(null);\r\n\r\n  const filteredMessages = messages.filter(msg => {\r\n    // Basic type filtering\r\n    if (filter !== 'all' && msg.type !== filter) return false;\r\n    \r\n    // WebSocket category filtering\r\n    if (filter === 'websocket' && wsFilter !== 'all') {\r\n      const category = msg.wsCategory || categorizeWebSocketMessage(msg.messageType);\r\n      if (category !== wsFilter) return false;\r\n    }\r\n    \r\n    // Search filtering\r\n    if (searchQuery) {\r\n      const query = searchQuery.toLowerCase();\r\n      return msg.message.toLowerCase().includes(query) ||\r\n             msg.source?.toLowerCase().includes(query) ||\r\n             msg.messageType?.toLowerCase().includes(query);\r\n    }\r\n    return true;\r\n  });\r\n\r\n  const toggleExpanded = (messageId: string) => {\r\n    const newExpanded = new Set(expandedMessages);\r\n    if (newExpanded.has(messageId)) {\r\n      newExpanded.delete(messageId);\r\n    } else {\r\n      newExpanded.add(messageId);\r\n    }\r\n    setExpandedMessages(newExpanded);\r\n  };\r\n\r\n  const captureScreenshot = async (): Promise<string | undefined> => {\r\n    try {\r\n      const result = await captureDebugScreenshot();\r\n      return result.dataUrl;\r\n    } catch (error) {\r\n      console.error('Screenshot capture failed:', error);\r\n      return undefined;\r\n    }\r\n  };\r\n\r\n  const generateDebugDump = async (): Promise<DebugDump> => {\r\n    const screenshot = await captureScreenshot();\r\n    \r\n    return {\r\n      timestamp: Date.now(),\r\n      chatSessionId: chatSessionId || 'unknown',\r\n      messages: messages.map(msg => ({...msg})), // Deep copy\r\n      appState: {\r\n        url: window.location.href,\r\n        userAgent: navigator.userAgent,\r\n        viewport: {\r\n          width: window.innerWidth,\r\n          height: window.innerHeight\r\n        }\r\n      },\r\n      screenshot\r\n    };\r\n  };\r\n\r\n  const downloadDump = async () => {\r\n    setIsGeneratingDump(true);\r\n    try {\r\n      const dump = await generateDebugDump();\r\n      const blob = new Blob([JSON.stringify(dump, null, 2)], { type: 'application/json' });\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `debug-dump-${new Date().toISOString().slice(0,19)}.json`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(url);\r\n    } finally {\r\n      setIsGeneratingDump(false);\r\n    }\r\n  };\r\n\r\n  const emailDump = async () => {\r\n    setIsGeneratingDump(true);\r\n    try {\r\n      const dump = await generateDebugDump();\r\n      const subject = `Debug Dump - ${chatSessionId || 'Unknown Session'}`;\r\n      const body = `Debug dump generated at ${new Date().toISOString()}\\n\\nDump data attached as JSON.`;\r\n      \r\n      // Create mailto link with dump as attachment workaround\r\n      const mailtoLink = `mailto:ashishsingh@cloudflare.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body + '\\n\\n' + JSON.stringify(dump, null, 2))}`;\r\n      window.open(mailtoLink);\r\n    } finally {\r\n      setIsGeneratingDump(false);\r\n    }\r\n  };\r\n\r\n  const errorCount = messages.filter(m => m.type === 'error').length;\r\n  const warningCount = messages.filter(m => m.type === 'warning').length;\r\n\r\n  return (\r\n    <>\r\n      {/* Toggle Button */}\r\n      <button\r\n        onClick={() => setIsOpen(!isOpen)}\r\n        className={`fixed bottom-6 right-6 z-50 p-3 rounded-full shadow-lg transition-all duration-300 hover:scale-105 ${\r\n          (errorCount > 0 || warningCount > 0) && !isOpen\r\n            ? 'bg-red-500 text-white animate-pulse'\r\n            : 'bg-zinc-800 text-white hover:bg-zinc-700'\r\n        }`}\r\n        title={`Debug Console (${errorCount + warningCount} issues)`}\r\n      >\r\n        <Bug className=\"w-4 h-4\" />\r\n        {(errorCount > 0 || warningCount > 0) && (\r\n          <span className=\"absolute -top-2 -right-2 bg-red-500 text-white text-xs px-1.5 py-0.5 rounded-full\">\r\n            {errorCount > 0 ? errorCount : warningCount}\r\n          </span>\r\n        )}\r\n      </button>\r\n\r\n      {/* Debug Panel */}\r\n      <div\r\n        ref={panelRef}\r\n        className={`fixed right-0 top-0 h-full bg-bg-3 dark:bg-bg-4 shadow-2xl border-l border-border-primary z-[60] transform transition-all duration-300 ease-in-out flex flex-col ${\r\n          isMaximized ? 'w-[80vw]' : 'w-[600px]'\r\n        } ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n      >\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-4 border-b border-border-primary bg-gradient-to-r from-muted to-accent\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Bug className=\"w-5 h-5 text-text-primary\" />\r\n            <h3 className=\"font-semibold text-text-primary\">Debug Console</h3>\r\n            <span className=\"bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded-full\">\r\n              {filteredMessages.length}/{messages.length}\r\n            </span>\r\n            {bookmarkedMessages.size > 0 && (\r\n              <span className=\"bg-amber-100 text-amber-700 text-xs px-2 py-1 rounded-full flex items-center gap-1\">\r\n                <Bookmark className=\"w-3 h-3\" />\r\n                {bookmarkedMessages.size}\r\n              </span>\r\n            )}\r\n          </div>\r\n          <div className=\"flex items-center gap-2 flex-wrap justify-end\">\r\n            {/* View Mode Toggle */}\r\n            <div className=\"flex bg-bg-3 dark:bg-zinc-800 rounded p-0.5\">\r\n              {[\r\n                { key: 'list' as const, icon: Bug, label: 'List' },\r\n                { key: 'analytics' as const, icon: BarChart3, label: 'Analytics' },\r\n                { key: 'timeline' as const, icon: Activity, label: 'Timeline' }\r\n              ].map(({ key, icon: Icon, label }) => (\r\n                <button\r\n                  key={key}\r\n                  onClick={() => setViewMode(key)}\r\n                  className={`px-2 py-1 text-xs rounded transition-all flex items-center gap-1 ${\r\n                    viewMode === key\r\n                      ? 'bg-bg-3 text-text-primary shadow-sm'\r\n                      : 'text-text-tertiary hover:text-text-primary'\r\n                  }`}\r\n                  title={`${label} view`}\r\n                >\r\n                  <Icon className=\"w-3 h-3\" />\r\n                  {label}\r\n                </button>\r\n              ))}\r\n            </div>\r\n            \r\n            {/* Notifications removed per design */}\r\n            <div className=\"flex items-center gap-2 basis-full justify-end pt-2\">\r\n              <Button\r\n                onClick={downloadDump}\r\n                disabled={isGeneratingDump}\r\n                title=\"Download debug dump\"\r\n              >\r\n                <Download className=\"w-4 h-4\" />\r\n                {isGeneratingDump ? 'Generating...' : 'Download'}\r\n              </Button>\r\n              <Button\r\n                onClick={emailDump}\r\n                disabled={isGeneratingDump}\r\n                title=\"Email debug dump to developers\"\r\n              >\r\n                <Mail className=\"w-4 h-4\" />\r\n                Email\r\n              </Button>\r\n            </div>\r\n            <div className=\"flex items-center gap-2 w-full sm:w-auto pt-2 sm:pt-0\">\r\n              <button\r\n                onClick={() => setIsMaximized(!isMaximized)}\r\n                className=\"text-text-tertiary hover:text-text-primary p-1 hover:bg-bg-3 rounded transition-colors\"\r\n                title={isMaximized ? 'Minimize panel' : 'Maximize panel'}\r\n              >\r\n                {isMaximized ? <Minimize2 className=\"w-4 h-4\" /> : <Maximize2 className=\"w-4 h-4\" />}\r\n              </button>\r\n              <button\r\n                onClick={onClear}\r\n                className=\"text-xs text-text-tertiary hover:text-text-primary px-2 py-1 hover:bg-bg-3 rounded transition-colors\"\r\n              >\r\n                Clear\r\n              </button>\r\n              <button\r\n                onClick={() => setIsOpen(false)}\r\n                className=\"text-text-tertiary hover:text-text-primary p-1 hover:bg-bg-3 rounded transition-colors\"\r\n              >\r\n                <X className=\"w-4 h-4\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <div className=\"p-3 border-b border-border-primary dark:border-border-primary bg-bg-3/30 dark:bg-bg-3/20\">\r\n          <div className=\"flex gap-2 mb-3\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search messages...\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"flex-1 px-3 py-1.5 text-sm bg-input border border-border-primary rounded focus:outline-none focus:ring-2 focus:ring-ring text-text-primary\"\r\n            />\r\n          </div>\r\n          <div className=\"flex gap-1 flex-wrap\">\r\n            {[\r\n              { key: 'all' as const, label: 'All', count: messages.length },\r\n              { key: 'error' as const, label: 'Errors', count: errorCount },\r\n              { key: 'warning' as const, label: 'Warnings', count: warningCount },\r\n              { key: 'websocket' as const, label: 'WebSocket', count: messages.filter(m => m.type === 'websocket').length },\r\n              { key: 'info' as const, label: 'Info', count: messages.filter(m => m.type === 'info').length }\r\n            ].map(({ key, label, count }) => (\r\n              <button\r\n                key={key}\r\n                onClick={() => {\r\n                  setFilter(key);\r\n                  if (key !== 'websocket') {\r\n                    setWsFilter('all'); // Reset WebSocket filter when not filtering by WebSocket\r\n                  }\r\n                }}\r\n                className={`px-3 py-1 text-xs rounded-full transition-all ${\r\n                  filter === key\r\n                    ? 'bg-blue-500 text-white'\r\n                    : 'bg-bg-3 text-text-primary hover:bg-bg-3 border border-border-primary'\r\n                }`}\r\n              >\r\n                {label} ({count})\r\n              </button>\r\n            ))}\r\n          </div>\r\n          \r\n          {/* WebSocket Category Filters - Show only when WebSocket filter is active */}\r\n          {filter === 'websocket' && (\r\n            <div className=\"mt-3 pt-3 border-t border-border-primary\">\r\n              <div className=\"text-xs text-text-tertiary mb-2 font-medium\">WebSocket Message Types:</div>\r\n              <div className=\"flex gap-1 flex-wrap\">\r\n                {[\r\n                  { key: 'all' as const, label: 'All WS', count: messages.filter(m => m.type === 'websocket').length },\r\n                  { key: 'generation' as const, label: 'Generation', count: messages.filter(m => m.type === 'websocket' && (m.wsCategory === 'generation' || categorizeWebSocketMessage(m.messageType) === 'generation')).length },\r\n                  { key: 'phase' as const, label: 'Phases', count: messages.filter(m => m.type === 'websocket' && (m.wsCategory === 'phase' || categorizeWebSocketMessage(m.messageType) === 'phase')).length },\r\n                  { key: 'file' as const, label: 'Files', count: messages.filter(m => m.type === 'websocket' && (m.wsCategory === 'file' || categorizeWebSocketMessage(m.messageType) === 'file')).length },\r\n                  { key: 'deployment' as const, label: 'Deploy', count: messages.filter(m => m.type === 'websocket' && (m.wsCategory === 'deployment' || categorizeWebSocketMessage(m.messageType) === 'deployment')).length },\r\n                  { key: 'system' as const, label: 'System', count: messages.filter(m => m.type === 'websocket' && (m.wsCategory === 'system' || categorizeWebSocketMessage(m.messageType) === 'system')).length }\r\n                ].map(({ key, label, count }) => (\r\n                  <button\r\n                    key={key}\r\n                    onClick={() => setWsFilter(key)}\r\n                    className={`px-2 py-1 text-xs rounded transition-all ${\r\n                      wsFilter === key\r\n                        ? 'bg-purple-600 text-white dark:bg-purple-700'\r\n                        : 'bg-purple-50 text-purple-700 hover:bg-purple-100 border border-purple-200 dark:bg-purple-900/30 dark:text-purple-200 dark:hover:bg-purple-900/40 dark:border-purple-800'\r\n                    }`}\r\n                  >\r\n                    {label} ({count})\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Content Area - Changes based on view mode */}\r\n        <div className=\"flex-1 overflow-y-auto\">\r\n          {viewMode === 'analytics' ? (\r\n            /* Analytics Dashboard */\r\n            <div className=\"p-6 space-y-6\">\r\n              {analyticsData ? (\r\n                <>\r\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                    <div className=\"bg-blue-50 p-4 rounded-lg\">\r\n                      <div className=\"text-2xl font-bold text-blue-600\">{analyticsData.totalMessages}</div>\r\n                      <div className=\"text-sm text-blue-800\">Total Messages</div>\r\n                    </div>\r\n                    <div className=\"bg-red-50 p-4 rounded-lg\">\r\n                      <div className=\"text-2xl font-bold text-red-600\">{analyticsData.errorRate}%</div>\r\n                      <div className=\"text-sm text-red-800\">Error Rate</div>\r\n                    </div>\r\n                    <div className=\"bg-yellow-50 p-4 rounded-lg\">\r\n                      <div className=\"text-2xl font-bold text-yellow-600\">{analyticsData.warningRate}%</div>\r\n                      <div className=\"text-sm text-yellow-800\">Warning Rate</div>\r\n                    </div>\r\n                    <div className=\"bg-green-50 p-4 rounded-lg\">\r\n                      <div className=\"text-2xl font-bold text-green-600\">{analyticsData.intervals.avg}</div>\r\n                      <div className=\"text-sm text-green-800\">Avg Interval</div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Statistical Analysis */}\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                    <div className=\"bg-bg-3/50 p-4 rounded-lg\">\r\n                      <h4 className=\"font-medium text-text-primary mb-2\">Response Time Statistics</h4>\r\n                      <div className=\"space-y-1 text-sm\">\r\n                        <div>Average: <span className=\"font-mono\">{analyticsData.intervals.avg}</span></div>\r\n                        <div>Median: <span className=\"font-mono\">{analyticsData.intervals.median}</span></div>\r\n                        <div>P99: <span className=\"font-mono\">{analyticsData.intervals.p99}</span></div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"bg-purple-50 p-4 rounded-lg\">\r\n                      <h4 className=\"font-medium text-purple-800 mb-2 flex items-center gap-2\">\r\n                        <BarChart3 className=\"w-4 h-4\" />\r\n                        WebSocket Activity\r\n                      </h4>\r\n                      <div className=\"text-lg font-bold text-purple-600\">{analyticsData.wsMessages} messages</div>\r\n                      <div className=\"text-sm text-purple-700\">Last 24h: {analyticsData.last24h} messages</div>\r\n                    </div>\r\n                    <div className=\"bg-amber-50 p-4 rounded-lg\">\r\n                      <h4 className=\"font-medium text-amber-800 mb-2\">Performance Score</h4>\r\n                      <div className=\"text-2xl font-bold text-amber-600\">\r\n                        {analyticsData.errorRate === '0' ? '100' : (100 - parseFloat(analyticsData.errorRate)).toFixed(0)}%\r\n                      </div>\r\n                      <div className=\"text-sm text-amber-700\">System Health</div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Enhanced Operation-Specific Metrics */}\r\n                  <div className=\"space-y-6\">\r\n                    <h4 className=\"font-medium text-text-primary text-lg\"> Operation Performance Metrics</h4>\r\n                    \r\n                    {/* File Generation - Special Enhanced Display */}\r\n                    {analyticsData.operations.fileGeneration.duration.count > 0 && (\r\n                      <div className=\"bg-gradient-to-br from-purple-50 to-indigo-50 border border-purple-200 rounded-xl p-6\">\r\n                        <div className=\"flex items-center gap-3 mb-4\">\r\n                          <div className=\"w-3 h-3 bg-purple-500 rounded-full\"></div>\r\n                          <h5 className=\"font-bold text-purple-900 text-lg\"> File Generation Performance</h5>\r\n                        </div>\r\n                        \r\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\r\n                          <div className=\"bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4 text-center\">\r\n                            <div className=\"text-2xl font-bold text-purple-600\">\r\n                              {analyticsData.operations.fileGeneration.linesPerSecond.avg.toFixed(1)}\r\n                            </div>\r\n                            <div className=\"text-sm text-purple-800\">Lines/sec (avg)</div>\r\n                          </div>\r\n                          <div className=\"bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4 text-center\">\r\n                            <div className=\"text-2xl font-bold text-indigo-600\">\r\n                              {(analyticsData.operations.fileGeneration.charsPerSecond.avg / 1000).toFixed(1)}k\r\n                            </div>\r\n                            <div className=\"text-sm text-indigo-800\">Chars/sec (avg)</div>\r\n                          </div>\r\n                          <div className=\"bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4 text-center\">\r\n                            <div className=\"text-2xl font-bold text-blue-600\">\r\n                              {analyticsData.operations.fileGeneration.totalLines.toLocaleString()}\r\n                            </div>\r\n                            <div className=\"text-sm text-blue-800\">Total Lines</div>\r\n                          </div>\r\n                          <div className=\"bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4 text-center\">\r\n                            <div className=\"text-2xl font-bold text-teal-600\">\r\n                              {analyticsData.operations.fileGeneration.duration.count}\r\n                            </div>\r\n                            <div className=\"text-sm text-teal-800\">Files Generated</div>\r\n                          </div>\r\n                        </div>\r\n                        \r\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                          <div className=\"bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4\">\r\n                            <h6 className=\"font-medium text-text-primary mb-2\"> Generation Speed</h6>\r\n                            <div className=\"space-y-1 text-sm\">\r\n                              <div>Avg: <span className=\"font-mono font-medium\">{analyticsData.operations.fileGeneration.linesPerSecond.avg.toFixed(1)} lines/s</span></div>\r\n                              <div>Median: <span className=\"font-mono font-medium\">{analyticsData.operations.fileGeneration.linesPerSecond.median.toFixed(1)} lines/s</span></div>\r\n                              <div>Peak (P99): <span className=\"font-mono font-medium\">{analyticsData.operations.fileGeneration.linesPerSecond.p99.toFixed(1)} lines/s</span></div>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4\">\r\n                            <h6 className=\"font-medium text-text-primary mb-2\"> Duration Stats</h6>\r\n                            <div className=\"space-y-1 text-sm\">\r\n                              <div>Avg: <span className=\"font-mono font-medium\">{analyticsData.operations.fileGeneration.duration.avg > 1000 ? `${(analyticsData.operations.fileGeneration.duration.avg/1000).toFixed(1)}s` : `${analyticsData.operations.fileGeneration.duration.avg.toFixed(0)}ms`}</span></div>\r\n                              <div>Median: <span className=\"font-mono font-medium\">{analyticsData.operations.fileGeneration.duration.median > 1000 ? `${(analyticsData.operations.fileGeneration.duration.median/1000).toFixed(1)}s` : `${analyticsData.operations.fileGeneration.duration.median.toFixed(0)}ms`}</span></div>\r\n                              <div>P99: <span className=\"font-mono font-medium\">{analyticsData.operations.fileGeneration.duration.p99 > 1000 ? `${(analyticsData.operations.fileGeneration.duration.p99/1000).toFixed(1)}s` : `${analyticsData.operations.fileGeneration.duration.p99.toFixed(0)}ms`}</span></div>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4\">\r\n                            <h6 className=\"font-medium text-text-primary mb-2\"> Content Volume</h6>\r\n                            <div className=\"space-y-1 text-sm\">\r\n                              <div>Total Characters: <span className=\"font-mono font-medium\">{analyticsData.operations.fileGeneration.totalChars.toLocaleString()}</span></div>\r\n                              <div>Avg File Size: <span className=\"font-mono font-medium\">{Math.round(analyticsData.operations.fileGeneration.totalChars / analyticsData.operations.fileGeneration.duration.count).toLocaleString()} chars</span></div>\r\n                              <div>Avg Lines/File: <span className=\"font-mono font-medium\">{Math.round(analyticsData.operations.fileGeneration.totalLines / analyticsData.operations.fileGeneration.duration.count)}</span></div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    \r\n                    {/* Other Operations */}\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                      {Object.entries(analyticsData.operations)\r\n                        .filter(([operation]) => operation !== 'fileGeneration')\r\n                        .map(([operation, stats]) => {\r\n                          const simpleStats = stats as { avg: number; median: number; p99: number; count: number };\r\n                          const operationConfig = {\r\n                            phaseGeneration: { icon: '', color: 'green', label: 'Phase Generation' },\r\n                            cfDeployment: { icon: '', color: 'orange', label: 'CF Deployment' },\r\n                            runnerDeployment: { icon: '', color: 'blue', label: 'Runner Deployment' }\r\n                          }[operation] || { icon: '', color: 'gray', label: operation };\r\n                          \r\n                          return (\r\n                            <div key={operation} className={`bg-${operationConfig.color}-50 border border-${operationConfig.color}-200 rounded-lg p-4`}>\r\n                              <div className=\"flex items-center gap-2 mb-3\">\r\n                                <span className=\"text-lg\">{operationConfig.icon}</span>\r\n                                <h5 className=\"font-medium text-text-primary\">{operationConfig.label}</h5>\r\n                              </div>\r\n                              {simpleStats.count > 0 ? (\r\n                                <div className=\"space-y-3\">\r\n                                  <div className=\"text-center\">\r\n                                    <div className={`text-2xl font-bold text-${operationConfig.color}-600`}>\r\n                                      {simpleStats.avg > 1000 ? `${(simpleStats.avg/1000).toFixed(1)}s` : `${simpleStats.avg.toFixed(0)}ms`}\r\n                                    </div>\r\n                                    <div className={`text-sm text-${operationConfig.color}-800`}>Average Duration</div>\r\n                                  </div>\r\n                                  <div className=\"grid grid-cols-2 gap-2 text-xs\">\r\n                                    <div>\r\n                                      <div className=\"text-text-tertiary\">Median</div>\r\n                                      <div className=\"font-mono font-medium\">{simpleStats.median > 1000 ? `${(simpleStats.median/1000).toFixed(1)}s` : `${simpleStats.median.toFixed(0)}ms`}</div>\r\n                                    </div>\r\n                                    <div>\r\n                                      <div className=\"text-text-tertiary\">P99</div>\r\n                                      <div className=\"font-mono font-medium\">{simpleStats.p99 > 1000 ? `${(simpleStats.p99/1000).toFixed(1)}s` : `${simpleStats.p99.toFixed(0)}ms`}</div>\r\n                                    </div>\r\n                                  </div>\r\n                                  <div className=\"pt-2 border-t border-border-primary text-center\">\r\n                                    <div className=\"text-text-tertiary text-sm\">{simpleStats.count} operations</div>\r\n                                  </div>\r\n                                </div>\r\n                              ) : (\r\n                                <div className=\"text-text-tertiary text-sm text-center py-4\">No operations recorded</div>\r\n                              )}\r\n                            </div>\r\n                          );\r\n                        })}\r\n                    </div>\r\n                  </div>\r\n                </>\r\n              ) : (\r\n                <div className=\"text-center py-12 text-text-tertiary\">\r\n                  <BarChart3 className=\"w-12 h-12 mx-auto mb-4 opacity-30\" />\r\n                  <p className=\"text-sm\">Analytics loading...</p>\r\n                </div>\r\n              )}\r\n              \r\n              {bookmarkedMessages.size > 0 && (\r\n                <div className=\"bg-amber-50 p-4 rounded-lg\">\r\n                  <h4 className=\"font-medium text-amber-800 mb-3 flex items-center gap-2\">\r\n                    <Bookmark className=\"w-4 h-4\" />\r\n                    Bookmarked Messages\r\n                  </h4>\r\n                  <div className=\"space-y-2\">\r\n                    {messages.filter(m => bookmarkedMessages.has(m.id)).slice(0, 5).map(msg => (\r\n                      <div key={msg.id} className=\"text-sm text-amber-700 truncate\">\r\n                        <Clock className=\"w-3 h-3 inline mr-1\" />\r\n                        {new Date(msg.timestamp).toLocaleTimeString()}: {msg.message}\r\n                      </div>\r\n                    ))}\r\n                    {bookmarkedMessages.size > 5 && (\r\n                      <div className=\"text-xs text-amber-600\">+{bookmarkedMessages.size - 5} more...</div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ) : viewMode === 'timeline' ? (\r\n            /* Timeline View */\r\n            <div className=\"p-4\">\r\n              {timelineData && timelineData.events.length > 0 ? (\r\n                <div className=\"space-y-6\">\r\n                  {/* Timeline Header */}\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <h4 className=\"font-medium text-text-primary flex items-center gap-2\">\r\n                      <Activity className=\"w-4 h-4\" />\r\n                      Message Timeline ({timelineData.events.length} events)\r\n                    </h4>\r\n                    <div className=\"text-sm text-text-tertiary\">\r\n                      Duration: {((timelineData.events[timelineData.events.length - 1]?.timestamp || 0) - (timelineData.events[0]?.timestamp || 0)) > 1000 ? \r\n                        `${(((timelineData.events[timelineData.events.length - 1]?.timestamp || 0) - (timelineData.events[0]?.timestamp || 0)) / 1000).toFixed(1)}s` : \r\n                        `${((timelineData.events[timelineData.events.length - 1]?.timestamp || 0) - (timelineData.events[0]?.timestamp || 0)).toFixed(0)}ms`}\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Lane Legend */}\r\n                  <div className=\"flex flex-wrap gap-2 mb-4\">\r\n                    {timelineData.lanes.map(lane => (\r\n                      <div key={lane.id} className={`px-3 py-1 rounded text-xs font-medium ${lane.color}`}>\r\n                        {lane.label}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                  \r\n                  {/* Timeline Events */}\r\n                  <div className=\"relative\">\r\n                    {/* Vertical timeline line */}\r\n                    <div className=\"absolute left-4 top-0 bottom-0 w-0.5 bg-border\"></div>\r\n                    \r\n                    <div className=\"space-y-4\">\r\n                      {timelineData.events.map((event, index) => {\r\n                        const lane = timelineData.lanes.find(l => l.id === event.category) || timelineData.lanes[4]; // Default to system\r\n                        const relativeTime = index > 0 ? event.timestamp - timelineData.events[0].timestamp : 0;\r\n                        \r\n                        return (\r\n                          <div key={event.id} className=\"relative flex items-start\">\r\n                            {/* Timeline marker */}\r\n                            <div className={`relative z-10 flex items-center justify-center w-8 h-8 rounded-full border-2 ${lane.color} ${event.isBookmarked ? 'ring-2 ring-amber-400' : ''}`}>\r\n                              {event.type === 'error' ? (\r\n                                <div className=\"w-3 h-3 bg-red-500 rounded-full\"></div>\r\n                              ) : event.type === 'warning' ? (\r\n                                <div className=\"w-3 h-3 bg-yellow-500 rounded-full\"></div>\r\n                              ) : event.type === 'websocket' ? (\r\n                                <div className=\"w-3 h-3 bg-purple-500 rounded-full\"></div>\r\n                              ) : (\r\n                                <div className=\"w-3 h-3 bg-blue-500 rounded-full\"></div>\r\n                              )}\r\n                            </div>\r\n                            \r\n                            {/* Event content */}\r\n                            <div className=\"ml-4 flex-1 min-w-0\">\r\n                              <div className=\"flex items-center justify-between\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  <span className={`px-2 py-1 text-xs font-medium rounded ${lane.color}`}>\r\n                                    {lane.label}\r\n                                  </span>\r\n                                  {event.messageType && (\r\n                                    <span className=\"px-2 py-1 text-xs bg-bg-3 text-text-tertiary rounded font-mono\">\r\n                                      {event.messageType}\r\n                                    </span>\r\n                                  )}\r\n                                  {event.isBookmarked && (\r\n                                    <Bookmark className=\"w-3 h-3 text-amber-500 fill-current\" />\r\n                                  )}\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2 text-xs text-text-tertiary\">\r\n                                  <span>+{relativeTime > 1000 ? `${(relativeTime/1000).toFixed(1)}s` : `${relativeTime.toFixed(0)}ms`}</span>\r\n                                  <span>{new Date(event.timestamp).toLocaleTimeString()}</span>\r\n                                </div>\r\n                              </div>\r\n                              \r\n                              <div className=\"mt-2 text-sm text-text-primary truncate\" title={event.message}>\r\n                                {event.message}\r\n                              </div>\r\n                              \r\n                              {event.duration > 0 && (\r\n                                <div className=\"mt-1 text-xs text-text-tertiary\">\r\n                                  Duration: {event.duration > 1000 ? `${(event.duration/1000).toFixed(1)}s` : `${event.duration.toFixed(0)}ms`}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <div className=\"text-center py-12 text-text-tertiary\">\r\n                  <Activity className=\"w-12 h-12 mx-auto mb-4 opacity-30\" />\r\n                  <p className=\"text-sm\">No timeline events to display</p>\r\n                  <p className=\"text-xs text-text-tertiary/70 mt-2\">Messages will appear here as they are logged</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ) : (\r\n            /* List View */\r\n            <div className=\"p-4 space-y-3\">\r\n              {filteredMessages.length === 0 ? (\r\n                <div className=\"text-center py-12 text-text-tertiary\">\r\n                  <Bug className=\"w-12 h-12 mx-auto mb-4 opacity-30\" />\r\n                  <p className=\"text-sm\">No messages match your filters</p>\r\n                </div>\r\n              ) : (\r\n            filteredMessages\r\n              .slice()\r\n              .reverse()\r\n              .map((message) => {\r\n                const isExpanded = expandedMessages.has(message.id);\r\n                return (\r\n                  <div\r\n                    key={message.id}\r\n                    className={`border-l-4 rounded-r-lg p-3 pr-10 transition-all relative ${\r\n                      message.type === 'error'\r\n                        ? 'border-red-500 bg-red-50 dark:bg-red-900/20 dark:border-red-400'\r\n                        : message.type === 'warning'\r\n                        ? 'border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-400'\r\n                        : message.type === 'websocket'\r\n                        ? 'border-purple-500 bg-purple-50 dark:bg-purple-900/20 dark:border-purple-400'\r\n                        : 'border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-400'\r\n                    } ${bookmarkedMessages.has(message.id) ? 'ring-2 ring-amber-300' : ''}`}\r\n                  >\r\n                    {/* Bookmark Button */}\r\n                    <button\r\n                      onClick={() => toggleBookmark(message.id)}\r\n                      className={`absolute top-2 right-2 p-1 rounded transition-all ${\r\n                        bookmarkedMessages.has(message.id)\r\n                          ? 'text-amber-500 hover:text-amber-600'\r\n                          : 'text-text-tertiary hover:text-amber-500'\r\n                      }`}\r\n                      title={bookmarkedMessages.has(message.id) ? 'Remove bookmark' : 'Add bookmark'}\r\n                    >\r\n                      {bookmarkedMessages.has(message.id) ? (\r\n                        <Bookmark className=\"w-4 h-4 fill-current\" />\r\n                      ) : (\r\n                        <BookmarkPlus className=\"w-4 h-4\" />\r\n                      )}\r\n                    </button>\r\n                    <div className=\"flex items-start justify-between gap-2 mb-2 pr-6\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"font-medium text-sm capitalize\">\r\n                          {message.type}\r\n                        </span>\r\n                        {message.messageType && (\r\n                          <span className=\"text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full font-mono dark:bg-purple-900/40 dark:text-purple-200 dark:border dark:border-purple-800\">\r\n                            {message.messageType}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                      <span className=\"text-xs text-text-tertiary\">\r\n                        {new Date(message.timestamp).toLocaleTimeString()}\r\n                      </span>\r\n                    </div>\r\n\r\n                    <div className=\"text-sm text-text-primary mb-2\">\r\n                      {message.message}\r\n                    </div>\r\n\r\n                    {message.details && (\r\n                      <div>\r\n                        <button\r\n                          onClick={() => toggleExpanded(message.id)}\r\n                          className=\"text-xs text-blue-600 hover:text-blue-800 underline\"\r\n                        >\r\n                          {isExpanded ? 'Hide details' : 'Show details'}\r\n                        </button>\r\n                        {isExpanded && (\r\n                          <pre className=\"mt-2 text-xs bg-bg-3 dark:bg-zinc-900 p-2 rounded overflow-x-auto text-text-tertiary whitespace-pre-wrap max-h-40\">\r\n                            {message.details}\r\n                          </pre>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                );\r\n              })\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Frosted Glass Backdrop */}\r\n      {isOpen && (\r\n        <div\r\n          className=\"fixed inset-0 z-30 transition-all duration-300 backdrop-blur-sm bg-black/10\"\r\n          onClick={() => setIsOpen(false)}\r\n          style={{\r\n            backdropFilter: 'blur(8px) saturate(180%)',\r\n            WebkitBackdropFilter: 'blur(8px) saturate(180%)'\r\n          }}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\n// Wrap DebugPanel with Error Boundary to prevent crashes from affecting main site\r\nexport function DebugPanel(props: DebugPanelProps) {\r\n  return (\r\n    <DebugPanelErrorBoundary>\r\n      <DebugPanelCore {...props} />\r\n    </DebugPanelErrorBoundary>\r\n  );\r\n}\r\n","import { useState, useRef, useEffect } from 'react';\r\nimport { Button } from '../../../components/primitives/button';\r\nimport { Loader, ExternalLink, Zap, Check, Globe, Lock, Share2 } from 'lucide-react';\r\nimport clsx from 'clsx';\r\nimport { apiClient } from '../../../lib/api-client';\r\nimport { toast } from 'sonner';\r\n\r\ninterface DeploymentControlsProps {\r\n\t// Deployment state\r\n\tisPhase1Complete: boolean;\r\n\tisDeploying: boolean;\r\n\tdeploymentUrl?: string;\r\n\tinstanceId: string;\r\n\tisRedeployReady: boolean;\r\n\tdeploymentError?: string;\r\n\t\r\n\t// App state\r\n\tappId?: string;\r\n\tappVisibility?: 'public' | 'private';\r\n\t\r\n\t// Generation state (kept for compatibility but pause button will not be rendered)\r\n\tisGenerating: boolean;\r\n\tisPaused: boolean;\r\n\t\r\n\t// Actions\r\n\tonDeploy: (instanceId: string) => void;\r\n\tonStopGeneration: () => void;\r\n\tonResumeGeneration: () => void;\r\n\tonVisibilityUpdate?: (newVisibility: 'public' | 'private') => void;\r\n}\r\n\r\n// Deployment state enum for better state management\r\nenum DeploymentState {\r\n\tWAITING_PHASE1 = 'waiting_phase1',\r\n\tREADY_TO_DEPLOY = 'ready_to_deploy',\r\n\tDEPLOYING = 'deploying',\r\n\tDEPLOYED = 'deployed',\r\n\tREDEPLOYING = 'redeploying',\r\n\tERROR = 'error'\r\n}\r\n\r\nexport function DeploymentControls({\r\n\tisPhase1Complete,\r\n\tisDeploying,\r\n\tdeploymentUrl,\r\n\tinstanceId,\r\n\tisRedeployReady,\r\n\tdeploymentError,\r\n\tappId,\r\n\tappVisibility = 'private',\r\n\tonDeploy,\r\n\tonVisibilityUpdate,\r\n}: DeploymentControlsProps) {\r\n\tconst [isDeployButtonClicked, setIsDeployButtonClicked] = useState(false);\r\n\tconst [copyButtonText, setCopyButtonText] = useState('Copy');\r\n\tconst [shareableLinkCopyText, setShareableLinkCopyText] = useState('Copy Link');\r\n\tconst [isUpdatingVisibility, setIsUpdatingVisibility] = useState(false);\r\n\tconst [localVisibility, setLocalVisibility] = useState(appVisibility);\r\n\tconst deploymentRef = useRef<HTMLDivElement>(null);\r\n\r\n\t// Reset deployment button state when deployment completes (success or failure)\r\n\tuseEffect(() => {\r\n\t\tif (!isDeploying) {\r\n\t\t\tsetIsDeployButtonClicked(false);\r\n\t\t}\r\n\t}, [isDeploying]);\r\n\r\n\t// Sync local visibility with prop\r\n\tuseEffect(() => {\r\n\t\tsetLocalVisibility(appVisibility);\r\n\t}, [appVisibility]);\r\n\r\n\t// Determine current deployment state with proper logic\r\n\tconst getCurrentDeploymentState = (): DeploymentState => {\r\n\t\tif (deploymentError && !isDeploying) {\r\n\t\t\treturn DeploymentState.ERROR;\r\n\t\t}\r\n\t\t\r\n\t\tif (isDeploying) {\r\n\t\t\tif (deploymentUrl) {\r\n\t\t\t\treturn DeploymentState.REDEPLOYING;\r\n\t\t\t} else {\r\n\t\t\t\treturn DeploymentState.DEPLOYING;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (deploymentUrl && !isDeploying) {\r\n\t\t\treturn DeploymentState.DEPLOYED;\r\n\t\t}\r\n\t\t\r\n\t\tif (isPhase1Complete) {\r\n\t\t\treturn DeploymentState.READY_TO_DEPLOY;\r\n\t\t}\r\n\t\t\r\n\t\treturn DeploymentState.WAITING_PHASE1;\r\n\t};\r\n\r\n\tconst currentState = getCurrentDeploymentState();\r\n\r\n\tconst handleDeploy = () => {\r\n\t\tsetIsDeployButtonClicked(true);\r\n\t\t\r\n\t\t// Smooth scroll animation to deployment section\r\n\t\tif (deploymentRef.current) {\r\n\t\t\tdeploymentRef.current.scrollIntoView({ \r\n\t\t\t\tbehavior: 'smooth', \r\n\t\t\t\tblock: 'center' \r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tonDeploy(instanceId);\r\n\t};\r\n\r\n\tconst handleToggleVisibility = async () => {\r\n\t\tif (!appId) {\r\n\t\t\ttoast.error('App ID not found');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tsetIsUpdatingVisibility(true);\r\n\t\t\tconst newVisibility = localVisibility === 'private' ? 'public' : 'private';\r\n\r\n\t\t\tconst response = await apiClient.updateAppVisibility(appId, newVisibility);\r\n\r\n\t\t\tif (response.success && response.data) {\r\n\t\t\t\tsetLocalVisibility(newVisibility);\r\n\t\t\t\tonVisibilityUpdate?.(newVisibility);\r\n\t\t\t\t\r\n\t\t\t\tif (newVisibility === 'public') {\r\n\t\t\t\t\ttoast.success(' Your app is now public! Share the link with anyone.');\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttoast.success('App is now private');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(response.error?.message || 'Failed to update visibility');\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error updating app visibility:', error);\r\n\t\t\ttoast.error('Failed to update visibility');\r\n\t\t} finally {\r\n\t\t\tsetIsUpdatingVisibility(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// State-based styling and content\r\n\tconst getStateConfig = (state: DeploymentState) => {\r\n\t\tswitch (state) {\r\n\t\t\tcase DeploymentState.WAITING_PHASE1:\r\n\t\t\t\treturn {\r\n\t\t\t\t\tpanelClass: \"bg-bg-3/30 dark:bg-bg-3/20 border-border-primary/50 dark:border-border-primary/40\",\r\n\t\t\t\t\ticonClass: \"bg-bg-3-foreground/40 dark:bg-bg-3-foreground/30 border-muted-foreground/40 dark:border-muted-foreground/30\",\r\n\t\t\t\t\ticon: null,\r\n\t\t\t\t\ttitleColor: \"text-text-tertiary dark:text-text-tertiary\",\r\n\t\t\t\t\tsubtitleColor: \"text-text-tertiary/80 dark:text-text-tertiary/70\",\r\n\t\t\t\t\ttitle: \"Deploy to Cloudflare\",\r\n\t\t\t\t\tsubtitle: \"Deploy will be enabled after Phase 1 is implemented\",\r\n\t\t\t\t\tbuttonDisabled: true,\r\n\t\t\t\t\tbuttonVariant: \"secondary\" as const,\r\n\t\t\t\t\tbuttonClass: \"bg-bg-3 dark:bg-bg-3 text-text-tertiary dark:text-text-tertiary border-muted dark:border-muted cursor-not-allowed\"\r\n\t\t\t\t};\r\n\t\t\t\r\n\t\t\tcase DeploymentState.READY_TO_DEPLOY:\r\n\t\t\t\treturn {\r\n\t\t\t\t\tpanelClass: \"bg-accent/5 dark:bg-accent/10 border-accent/20 dark:border-accent/20\",\r\n\t\t\t\t\ticonClass: \"bg-accent border-accent\",\r\n\t\t\t\t\ticon: <Zap className=\"w-2.5 h-2.5 text-white\" />,\r\n\t\t\t\t\ttitleColor: \"text-text-primary dark:text-text-primary\",\r\n\t\t\t\t\tsubtitleColor: \"text-text-tertiary dark:text-text-tertiary\",\r\n\t\t\t\t\ttitle: \"Ready to Deploy\",\r\n\t\t\t\t\tsubtitle: \"It's Free! Deploys to Cloudflare Workers for Platform\",\r\n\t\t\t\t\tbuttonDisabled: false,\r\n\t\t\t\t\tbuttonVariant: \"primary\" as const,\r\n\t\t\t\t\tbuttonClass: \"bg-accent text-white border-orange-500 dark:border-orange-600 hover:scale-105\"\r\n\t\t\t\t};\r\n\t\t\t\r\n\t\t\tcase DeploymentState.DEPLOYING:\r\n\t\t\t\treturn {\r\n\t\t\t\t\tpanelClass: \"bg-blue-50/40 dark:bg-blue-950/20 border-blue-200/60 dark:border-blue-800/30 shadow-sm dark:shadow-blue-900/20\",\r\n\t\t\t\t\ticonClass: \"bg-blue-500 dark:bg-blue-600 border-blue-500 dark:border-blue-600 animate-pulse\",\r\n\t\t\t\t\ticon: <Loader className=\"w-2.5 h-2.5 text-white animate-spin\" />,\r\n\t\t\t\t\ttitleColor: \"text-blue-900 dark:text-blue-100\",\r\n\t\t\t\t\tsubtitleColor: \"text-blue-600 dark:text-blue-300\",\r\n\t\t\t\t\ttitle: \"Deploying to Cloudflare\",\r\n\t\t\t\t\tsubtitle: \"Please wait while your application is being deployed...\",\r\n\t\t\t\t\tbuttonDisabled: true,\r\n\t\t\t\t\tbuttonVariant: \"primary\" as const,\r\n\t\t\t\t\tbuttonClass: \"bg-blue-500 hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700 text-white border-blue-500 dark:border-blue-600 scale-105 shadow-lg dark:shadow-blue-900/50\"\r\n\t\t\t\t};\r\n\t\t\t\r\n\t\t\tcase DeploymentState.REDEPLOYING:\r\n\t\t\t\treturn {\r\n\t\t\t\t\tpanelClass: \"bg-blue-50/40 dark:bg-blue-950/20 border-blue-200/60 dark:border-blue-800/30 shadow-sm dark:shadow-blue-900/20\",\r\n\t\t\t\t\ticonClass: \"bg-blue-500 dark:bg-blue-600 border-blue-500 dark:border-blue-600 animate-pulse\",\r\n\t\t\t\t\ticon: <Loader className=\"w-2.5 h-2.5 text-white animate-spin\" />,\r\n\t\t\t\t\ttitleColor: \"text-blue-900 dark:text-blue-100\",\r\n\t\t\t\t\tsubtitleColor: \"text-blue-600 dark:text-blue-300\",\r\n\t\t\t\t\ttitle: \"Redeploying to Cloudflare\",\r\n\t\t\t\t\tsubtitle: \"Please wait while your application is being redeployed...\",\r\n\t\t\t\t\tbuttonDisabled: true,\r\n\t\t\t\t\tbuttonVariant: \"primary\" as const,\r\n\t\t\t\t\tbuttonClass: \"bg-blue-500 hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700 text-white border-blue-500 dark:border-blue-600 scale-105 shadow-lg dark:shadow-blue-900/50\"\r\n\t\t\t\t};\r\n\t\t\t\r\n\t\t\tcase DeploymentState.ERROR:\r\n\t\t\t\treturn {\r\n\t\t\t\t\tpanelClass: \"bg-red-50/40 dark:bg-red-950/20 border-red-200/60 dark:border-red-800/30 shadow-sm dark:shadow-red-900/20\",\r\n\t\t\t\t\ticonClass: \"bg-red-500 dark:bg-red-600 border-red-500 dark:border-red-600\",\r\n\t\t\t\t\ticon: <svg className=\"w-2.5 h-2.5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"></path></svg>,\r\n\t\t\t\t\ttitleColor: \"text-red-900 dark:text-red-100\",\r\n\t\t\t\t\tsubtitleColor: \"text-red-600 dark:text-red-300\",\r\n\t\t\t\t\ttitle: \" Deployment Failed\",\r\n\t\t\t\t\tsubtitle: \"Error in deployment, please try again\",\r\n\t\t\t\t\tbuttonDisabled: !isPhase1Complete,\r\n\t\t\t\t\tbuttonVariant: \"primary\" as const,\r\n\t\t\t\t\tbuttonClass: isPhase1Complete \r\n\t\t\t\t\t\t? \"bg-orange-500 hover:bg-orange-600 dark:bg-orange-600 dark:hover:bg-orange-700 text-white border-orange-500 dark:border-orange-600 hover:scale-105\"\r\n\t\t\t\t\t\t: \"bg-bg-3 dark:bg-bg-3 text-text-tertiary dark:text-text-tertiary border-muted dark:border-muted cursor-not-allowed\"\r\n\t\t\t\t};\r\n\t\t\t\r\n\t\t\tdefault:\r\n\t\t\t\treturn getStateConfig(DeploymentState.WAITING_PHASE1);\r\n\t\t}\r\n\t};\r\n\r\n\tconst stateConfig = getStateConfig(currentState);\r\n\tconst isCurrentlyDeploying = currentState === DeploymentState.DEPLOYING || currentState === DeploymentState.REDEPLOYING;\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-3 deployment-controls\">\r\n\t\t\t{/* Main Deployment Panel - Always visible, changes based on state */}\r\n\t\t\t{currentState !== DeploymentState.DEPLOYED && (\r\n\t\t\t\t<div \r\n\t\t\t\t\tref={deploymentRef}\r\n\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\"border rounded-lg p-3 transition-all duration-500 mt-2\",\r\n\t\t\t\t\t\tstateConfig.panelClass\r\n\t\t\t\t\t)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t{/* Enhanced Status Icon with deployment state */}\r\n\t\t\t\t\t\t<div className={clsx(\r\n\t\t\t\t\t\t\t\"flex-shrink-0 w-4 h-4 rounded border-2 flex items-center justify-center transition-all duration-500\",\r\n\t\t\t\t\t\t\tstateConfig.iconClass\r\n\t\t\t\t\t\t)}>\r\n\t\t\t\t\t\t\t{stateConfig.icon}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* Enhanced Deployment Section Content */}\r\n\t\t\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t\t\t<div className={clsx(\r\n\t\t\t\t\t\t\t\t\"text-sm font-medium transition-colors duration-300\",\r\n\t\t\t\t\t\t\t\tstateConfig.titleColor\r\n\t\t\t\t\t\t\t)}>\r\n\t\t\t\t\t\t\t\t{stateConfig.title}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className={clsx(\r\n\t\t\t\t\t\t\t\t\"text-xs mt-0.5 transition-colors duration-300\",\r\n\t\t\t\t\t\t\t\tstateConfig.subtitleColor\r\n\t\t\t\t\t\t\t)}>\r\n\t\t\t\t\t\t\t\t{stateConfig.subtitle}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* Enhanced Deploy Button - Always visible, state-aware */}\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tonClick={handleDeploy}\r\n\t\t\t\t\t\t\tdisabled={stateConfig.buttonDisabled || isCurrentlyDeploying || isDeployButtonClicked}\r\n\t\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\t\"h-8 px-4 text-sm font-medium transition-all duration-300 transform\",\r\n\t\t\t\t\t\t\t\tstateConfig.buttonClass\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{isCurrentlyDeploying ? (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<Loader className=\"w-4 h-4 mr-2 animate-spin\" />\r\n\t\t\t\t\t\t\t\t\t{currentState === DeploymentState.REDEPLOYING ? 'Redeploying...' : 'Deploying...'}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<Zap className=\"w-4 h-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\tDeploy to Cloudflare\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Deployed Success State - Enhanced with Visibility Toggle */}\r\n\t\t\t{currentState === DeploymentState.DEPLOYED && (\r\n\t\t\t\t<div \r\n\t\t\t\t\tref={deploymentRef}\r\n\t\t\t\t\tclassName=\"border rounded-lg p-4 bg-gradient-to-r from-green-50/40 to-emerald-50/40 dark:from-green-950/20 dark:to-emerald-950/20 border-green-200/60 dark:border-green-800/30 transition-all duration-700 mt-2 animate-in slide-in-from-top-2 shadow-sm dark:shadow-green-900/20\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div className=\"flex items-center gap-3 mb-3\">\r\n\t\t\t\t\t\t{/* Success Icon with animation */}\r\n\t\t\t\t\t\t<div className=\"flex-shrink-0 w-5 h-5 bg-green-500 border-2 border-green-500 rounded-full flex items-center justify-center animate-in zoom-in-50 duration-500\">\r\n\t\t\t\t\t\t\t<Check className=\"w-3 h-3 text-white\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* Success Header */}\r\n\t\t\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t\t\t<div className=\"text-sm font-semibold text-green-900 dark:text-green-100\">\r\n\t\t\t\t\t\t\t\t Successfully Deployed!\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"text-xs text-green-700 dark:text-green-300 mt-0.5\">\r\n\t\t\t\t\t\t\t\tYour application is now live on Cloudflare Workers\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t{/* Elegant URL Display */}\r\n\t\t\t\t\t<div className=\"bg-bg-3/60 dark:bg-bg-4/60 border border-green-200/40 dark:border-green-800/20 rounded-md p-3 mb-3\">\r\n\t\t\t\t\t\t<div className=\"text-xs text-green-600 dark:text-green-400 font-medium mb-1\">Live URL:</div>\r\n\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t<code className=\"flex-1 text-sm font-mono text-green-800 dark:text-green-200 bg-green-50/50 dark:bg-green-950/30 px-2 py-1 rounded text-ellipsis overflow-hidden\">\r\n\t\t\t\t\t\t\t\t{deploymentUrl}\r\n\t\t\t\t\t\t\t</code>\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\tif (deploymentUrl) {\r\n\t\t\t\t\t\t\t\t\t\tawait navigator.clipboard.writeText(deploymentUrl);\r\n\t\t\t\t\t\t\t\t\t\tsetCopyButtonText('Copied!');\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => setCopyButtonText('Copy'), 2000);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\t\t\tclassName=\"h-7 px-2 text-xs bg-bg-3 dark:bg-bg-4 border border-green-300 dark:border-green-300/50 text-green-700 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-950 hover:border-green-400 transition-all flex-shrink-0\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{copyButtonText}\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Shareable Link - Only shown when app is public */}\r\n\t\t\t\t\t{localVisibility === 'public' && appId && (\r\n\t\t\t\t\t\t<div className=\"bg-accent/5 border border-accent/20 rounded-md p-3 mb-3\">\r\n\t\t\t\t\t\t\t<div className=\"text-xs text-accent font-medium mb-1 flex items-center gap-1\">\r\n\t\t\t\t\t\t\t\t<Share2 className=\"w-3 h-3\" />\r\n\t\t\t\t\t\t\t\tShareable Link:\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t<code className=\"flex-1 text-sm font-mono text-accent bg-accent/5 px-2 py-1 rounded text-ellipsis overflow-hidden\">\r\n\t\t\t\t\t\t\t\t\t{window.location.origin}/app/{appId}\r\n\t\t\t\t\t\t\t\t</code>\r\n\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\t\t\t\t\tconst shareableUrl = `${window.location.origin}/app/${appId}`;\r\n\t\t\t\t\t\t\t\t\t\tawait navigator.clipboard.writeText(shareableUrl);\r\n\t\t\t\t\t\t\t\t\t\tsetShareableLinkCopyText('Copied!');\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => setShareableLinkCopyText('Copy Link'), 2000);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"h-7 px-2 text-xs bg-accent/10 border border-accent/30 text-accent hover:bg-accent/20 transition-all flex-shrink-0\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{shareableLinkCopyText}\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t\r\n\t\t\t\t\t{/* Action Buttons - Enhanced with visibility toggle */}\r\n\t\t\t\t\t<div className={clsx(\r\n\t\t\t\t\t\t\"grid gap-3\",\r\n\t\t\t\t\t\tisRedeployReady ? \"grid-cols-3\" : \"grid-cols-2\"\r\n\t\t\t\t\t)}>\r\n\t\t\t\t\t\t{/* View Live Site Button */}\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tonClick={() => deploymentUrl && window.open(deploymentUrl, '_blank')}\r\n\t\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\t\tclassName=\"h-10 text-sm bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 text-white border-green-600 dark:border-green-700 font-medium shadow-sm hover:shadow-md dark:hover:shadow-green-900/50 transition-all duration-200 hover:scale-[1.02]\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<ExternalLink className=\"w-4 h-4 mr-2\" />\r\n\t\t\t\t\t\t\tView Live\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* Make Public/Private Button - Always visible after deployment */}\r\n\t\t\t\t\t\t{appId && (\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tonClick={handleToggleVisibility}\r\n\t\t\t\t\t\t\t\tdisabled={isUpdatingVisibility}\r\n\t\t\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\t\t\"h-10 text-sm font-medium transition-all duration-200 shadow-sm\",\r\n\t\t\t\t\t\t\t\t\tlocalVisibility === 'private'\r\n\t\t\t\t\t\t\t\t\t\t? \"bg-accent hover:bg-accent/90 text-white border-accent hover:shadow-md hover:scale-[1.02]\"\r\n\t\t\t\t\t\t\t\t\t\t: \"bg-bg-3 hover:bg-bg-4 text-text-primary border-border-primary hover:shadow-sm hover:scale-[1.02]\"\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{isUpdatingVisibility ? (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<Loader className=\"w-4 h-4 mr-2 animate-spin\" />\r\n\t\t\t\t\t\t\t\t\t\tUpdating...\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t) : localVisibility === 'private' ? (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<Globe className=\"w-4 h-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\tMake Public\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<Lock className=\"w-4 h-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\tMake Private\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* Redeploy Button - Only shown when changes are made */}\r\n\t\t\t\t\t\t{isRedeployReady && (\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tonClick={handleDeploy}\r\n\t\t\t\t\t\t\t\tdisabled={isDeploying || isDeployButtonClicked}\r\n\t\t\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\t\t\"h-10 text-sm font-medium transition-all duration-200 shadow-sm\",\r\n\t\t\t\t\t\t\t\t\t!isDeploying\r\n\t\t\t\t\t\t\t\t\t\t? \"bg-blue-500 hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700 text-white border-blue-500 dark:border-blue-600 hover:shadow-md dark:hover:shadow-blue-900/50 hover:scale-[1.02]\" \r\n\t\t\t\t\t\t\t\t\t\t: \"bg-bg-3 dark:bg-bg-3 text-text-tertiary dark:text-text-tertiary border-muted dark:border-muted cursor-not-allowed\"\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{isDeploying ? (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<Loader className=\"w-4 h-4 mr-2 animate-spin\" />\r\n\t\t\t\t\t\t\t\t\t\tRedeploying...\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<Zap className=\"w-4 h-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\tRedeploy\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n}\r\n","export async function* ndjsonStream(response: Response) {\r\n    const reader = response.body!.getReader();\r\n    const decoder = new TextDecoder();\r\n    let buffer = '';\r\n\r\n    while (true) {\r\n        const { done, value } = await reader.read();\r\n        if (done) break;\r\n\r\n        buffer += decoder.decode(value, { stream: true });\r\n\r\n        const lines = buffer.split('\\n');\r\n        buffer = lines.pop() ?? \"\";\r\n\r\n        for (const line of lines) {\r\n            if (line.trim()) {\r\n                yield JSON.parse(line);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Handle leftover buffer\r\n    if (buffer.trim()) {\r\n        yield JSON.parse(buffer);\r\n    }\r\n}\r\n\r\n\r\n// Synchronous NDJSON parser for testing\r\ntype JSONValue = string | number | boolean | null | JSONValue[] | { [key: string]: JSONValue };\r\n\r\nexport class NDJSONStreamParser {\r\n    private buffer = '';\r\n    private onMessage: (message: JSONValue) => void;\r\n\r\n    constructor(onMessage: (message: JSONValue) => void) {\r\n        this.onMessage = onMessage;\r\n    }\r\n\r\n    processChunk(chunk: string): void {\r\n        this.buffer += chunk;\r\n        \r\n        // Handle both \\n and \\r\\n line endings\r\n        const lines = this.buffer.split(/\\r?\\n/);\r\n        \r\n        // Keep the last partial line in the buffer\r\n        this.buffer = lines.pop() || '';\r\n        \r\n        // Process complete lines\r\n        for (const line of lines) {\r\n            if (line.trim()) {\r\n                try {\r\n                    const message = JSON.parse(line);\r\n                    this.onMessage(message);\r\n                } catch (error) {\r\n                    // Silently ignore invalid JSON\r\n                    console.warn('Invalid JSON in NDJSON stream:', line);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport function createRepairingJSONParser() {\r\n    let buffer = '';\r\n\r\n    /* util  try JSON.parse without crashing -------------------------- */\r\n    const parse = (str: string) => { try { return JSON.parse(str); } catch { \r\n        // pass\r\n    } };\r\n\r\n    /* STEP-1: close strings when required ----------------------------- */\r\n    function closeStrings(src: string) {\r\n        const out = [];\r\n        let inStr = false, esc = false;\r\n\r\n        for (let i = 0; i < src.length; i++) {\r\n            const ch = src[i];\r\n\r\n            if (inStr) {\r\n                if (esc) { esc = false; out.push(ch); continue; }\r\n                if (ch === '\\\\') { esc = true; out.push(ch); continue; }\r\n                if (ch === '\"') { inStr = false; out.push(ch); continue; }\r\n\r\n                if (ch === ',') {                         // possible string-end\r\n                    let j = i + 1;\r\n                    while (j < src.length && /\\s/.test(src[j])) j++;\r\n                    const nxt = src[j] || '';\r\n                    if (nxt === '\"' || nxt === '}' || nxt === ']') {\r\n                        out.push('\"');                        //  close the string\r\n                        inStr = false;\r\n                        i--;                                 // re-process the comma\r\n                        continue;\r\n                    }\r\n                }\r\n                out.push(ch);                             // normal char in str\r\n                continue;\r\n            }\r\n\r\n            if (ch === '\"') { inStr = true; out.push(ch); }\r\n            else out.push(ch);\r\n        }\r\n        if (inStr) out.push('\"');                     // EOF inside a string\r\n        return out.join('');\r\n    }\r\n\r\n    /* STEP-2: kill dangling commas ------------------------------------ */\r\n    const stripCommas = (s: string) => s.replace(/,\\s*([}\\]])/g, '$1');\r\n\r\n    /* STEP-3: add missing  }  and  ]  --------------------------------- */\r\n    function balanceBrackets(s: string) {\r\n        let inStr = false, esc = false, obj = 0, arr = 0;\r\n        for (const ch of s) {\r\n            if (inStr) {\r\n                if (esc) esc = false;\r\n                else if (ch === '\\\\') esc = true;\r\n                else if (ch === '\"') inStr = false;\r\n                continue;\r\n            }\r\n            if (ch === '\"') inStr = true;\r\n            else if (ch === '{') obj++;\r\n            else if (ch === '}') obj--;\r\n            else if (ch === '[') arr++;\r\n            else if (ch === ']') arr--;\r\n        }\r\n        return s + ']'.repeat(Math.max(0, arr)) + '}'.repeat(Math.max(0, obj));\r\n    }\r\n\r\n    /* STEP-4: give empty string to dangling keys ---------------------- */\r\n    function fixKeys(s: string) {\r\n        // (a) key right before a }\r\n        s = s.replace(/([{,]\\s*)\"([^\"\\\\]*(?:\\\\.[^\"\\\\]*)*)\"\\s*}(?=,?\\s*[\\]}]|$)/g,\r\n            (_, pre, k) => `${pre}\"${k}\": \"\"}`);\r\n\r\n        // (b) key that already has a colon but no value\r\n        s = s.replace(/\"([^\"\\\\]*(?:\\\\.[^\"\\\\]*)*)\"\\s*:\\s*(?=[}\\],]|$)/g,\r\n            '\"$1\": \"\"');\r\n\r\n        // (c) key at very end of the stream\r\n        s = s.replace(/\"([^\"\\\\]*(?:\\\\.[^\"\\\\]*)*)\"\\s*$/g,\r\n            '\"$1\": \"\"');\r\n\r\n        return s;\r\n    }\r\n\r\n    /* ---------- public API ------------------------------------------ */\r\n    return {\r\n        feed(chunk: string) { buffer += chunk; },\r\n\r\n        finalize() {\r\n            let txt = buffer, obj = parse(txt);\r\n\r\n            if (obj) return obj;\r\n\r\n            txt = closeStrings(txt); \r\n            obj = parse(txt)\r\n            if (obj) return obj;\r\n            txt = stripCommas(txt); \r\n            obj = parse(txt)\r\n            if (obj) return obj;\r\n            txt = balanceBrackets(txt);\r\n            obj = parse(txt)\r\n            if (obj) return obj;\r\n            txt = fixKeys(txt); \r\n            obj = parse(txt)\r\n            if (obj) return obj;\r\n\r\n            throw new Error('createRepairingJSONParser: unable to repair JSON');\r\n        }\r\n    };\r\n}\r\n\r\n","export const getFileType = (path: string): string => {\r\n\tif (!path || typeof path !== 'string') return 'plaintext';\r\n\tconst extension = path.split('.').pop();\r\n\r\n\tswitch (extension) {\r\n\t\tcase 'ts':\r\n\t\tcase 'tsx':\r\n\t\t\treturn 'typescript';\r\n\t\tcase 'js':\r\n\t\tcase 'jsx':\r\n\t\t\treturn 'javascript';\r\n\t\tcase 'css':\r\n\t\t\treturn 'css';\r\n\t\tcase 'html':\r\n\t\t\treturn 'html';\r\n\t\tcase 'json':\r\n\t\t\treturn 'json';\r\n\t\tdefault:\r\n\t\t\treturn 'plaintext';\r\n\t}\r\n};\r\n\r\nexport const formatFileSize = (bytes?: number) => {\r\n\tif (!bytes) return '';\r\n\tconst units = ['B', 'KB', 'MB', 'GB'];\r\n\tlet size = bytes;\r\n\tlet unitIndex = 0;\r\n\twhile (size >= 1024 && unitIndex < units.length - 1) {\r\n\t\tsize /= 1024;\r\n\t\tunitIndex++;\r\n\t}\r\n\treturn `${size.toFixed(1)} ${units[unitIndex]}`;\r\n};\r\n"," \r\nexport type LogLevel = 'debug' | 'info' | 'warn' | 'error';\r\n\r\ninterface LoggerOptions {\r\n\tlevel?: LogLevel;\r\n\tprefix?: string;\r\n\tenabled?: boolean;\r\n}\r\n\r\nexport class Logger {\r\n\tprivate level: LogLevel;\r\n\tprivate prefix: string;\r\n\tprivate enabled: boolean;\r\n\r\n\tprivate static levels: Record<LogLevel, number> = {\r\n\t\tdebug: 0,\r\n\t\tinfo: 1,\r\n\t\twarn: 2,\r\n\t\terror: 3,\r\n\t};\r\n\r\n\tconstructor(options: LoggerOptions = {}) {\r\n\t\tthis.level = options.level ?? 'info';\r\n\t\tthis.prefix = options.prefix ?? '';\r\n\t\tthis.enabled = options.enabled ?? true;\r\n\t}\r\n\r\n\tprivate shouldLog(level: LogLevel): boolean {\r\n\t\treturn this.enabled && Logger.levels[level] >= Logger.levels[this.level];\r\n\t}\r\n\r\n\tprivate formatMessage(_level: LogLevel, args: unknown[]): unknown[] {\r\n\t\t// const time = new Date().toISOString();\r\n\t\tconst prefix = this.prefix ? `[${this.prefix}]` : '';\r\n\t\t// return [`[${time}] ${prefix} [${level.toUpperCase()}]`, ...args];\r\n\t\treturn [prefix, ...args];\r\n\t\t// return args;\r\n\t}\r\n\r\n\tdebug(...args: unknown[]) {\r\n\t\tif (this.shouldLog('debug')) {\r\n\t\t\tconsole.debug(...this.formatMessage('debug', args));\r\n\t\t}\r\n\t}\r\n\r\n\tinfo(...args: unknown[]) {\r\n\t\tif (this.shouldLog('info')) {\r\n\t\t\tconsole.info(...this.formatMessage('info', args));\r\n\t\t}\r\n\t}\r\n\r\n\twarn(...args: unknown[]) {\r\n\t\tif (this.shouldLog('warn')) {\r\n\t\t\tconsole.warn(...this.formatMessage('warn', args));\r\n\t\t}\r\n\t}\r\n\r\n\terror(...args: unknown[]) {\r\n\t\tif (this.shouldLog('error')) {\r\n\t\t\tconsole.error(...this.formatMessage('error', args));\r\n\t\t}\r\n\t}\r\n\r\n\tsetLevel(level: LogLevel) {\r\n\t\tthis.level = level;\r\n\t}\r\n\r\n\tenable() {\r\n\t\tthis.enabled = true;\r\n\t}\r\n\r\n\tdisable() {\r\n\t\tthis.enabled = false;\r\n\t}\r\n}\r\n\r\nexport const logger = new Logger({\r\n\tlevel: import.meta.env.DEV ? 'debug' : 'info',\r\n});\r\n","import type { FileType, PhaseTimelineItem } from '../hooks/use-chat';\r\nimport { getFileType } from '@/utils/string';\r\n\r\n/**\r\n * Update a specific file in the files array\r\n */\r\nexport function updateFileInArray(\r\n    files: FileType[],\r\n    filePath: string,\r\n    updates: Partial<FileType>\r\n): FileType[] {\r\n    const existingFileIndex = files.findIndex(f => f.filePath === filePath);\r\n    \r\n    if (existingFileIndex >= 0) {\r\n        return files.map((file, index) => \r\n            index === existingFileIndex \r\n                ? { ...file, ...updates }\r\n                : file\r\n        );\r\n    }\r\n    \r\n    // Add new file if it doesn't exist\r\n    return [...files, {\r\n        filePath,\r\n        fileContents: '',\r\n        isGenerating: false,\r\n        needsFixing: false,\r\n        hasErrors: false,\r\n        language: getFileType(filePath),\r\n        ...updates\r\n    }];\r\n}\r\n\r\n/**\r\n * Update file status in phase timeline\r\n */\r\nexport function updatePhaseFileStatus(\r\n    phaseTimeline: PhaseTimelineItem[],\r\n    filePath: string,\r\n    status: 'generating' | 'completed' | 'error' | 'validating',\r\n    fileContents?: string\r\n): PhaseTimelineItem[] {\r\n    const updatedTimeline = [...phaseTimeline];\r\n    \r\n    // Find the most recent phase containing this file (iterate backwards)\r\n    for (let i = updatedTimeline.length - 1; i >= 0; i--) {\r\n        const phase = updatedTimeline[i];\r\n        if (phase.status === 'completed' && status !== 'completed') {\r\n            continue; // Skip completed phases unless we're marking as completed\r\n        }\r\n        \r\n        const fileInPhase = phase.files.find(f => f.path === filePath);\r\n        if (fileInPhase) {\r\n            fileInPhase.status = status;\r\n            if (fileContents !== undefined) {\r\n                fileInPhase.contents = fileContents;\r\n            }\r\n            console.log(`File ${status} in phase ${phase.name}: ${filePath}`);\r\n            break;\r\n        }\r\n    }\r\n    \r\n    return updatedTimeline;\r\n}\r\n\r\n/**\r\n * Add or update a file with generating state\r\n */\r\nexport function setFileGenerating(\r\n    files: FileType[],\r\n    filePath: string,\r\n    explanation?: string\r\n): FileType[] {\r\n    return updateFileInArray(files, filePath, {\r\n        filePath,\r\n        fileContents: '',\r\n        explanation: explanation || '',\r\n        isGenerating: true,\r\n        needsFixing: false,\r\n        hasErrors: false,\r\n        language: getFileType(filePath),\r\n    });\r\n}\r\n\r\n/**\r\n * Update file content chunk\r\n */\r\nexport function appendFileChunk(\r\n    files: FileType[],\r\n    filePath: string,\r\n    chunk: string\r\n): FileType[] {\r\n    const existingFile = files.find(f => f.filePath === filePath);\r\n    \r\n    if (existingFile) {\r\n        return files.map(file => \r\n            file.filePath === filePath\r\n                ? { ...file, fileContents: file.fileContents + chunk }\r\n                : file\r\n        );\r\n    }\r\n    \r\n    // Create new file with chunk\r\n    return [...files, {\r\n        filePath,\r\n        fileContents: chunk,\r\n        explanation: '',\r\n        isGenerating: true,\r\n        needsFixing: false,\r\n        hasErrors: false,\r\n        language: getFileType(filePath),\r\n    }];\r\n}\r\n\r\n/**\r\n * Mark file as completed\r\n */\r\nexport function setFileCompleted(\r\n    files: FileType[],\r\n    filePath: string,\r\n    fileContents: string\r\n): FileType[] {\r\n    return updateFileInArray(files, filePath, {\r\n        fileContents,\r\n        isGenerating: false,\r\n        needsFixing: false,\r\n        hasErrors: false,\r\n    });\r\n}\r\n\r\n/**\r\n * Mark all files as completed\r\n */\r\nexport function setAllFilesCompleted(files: FileType[]): FileType[] {\r\n    return files.map(file => ({\r\n        ...file,\r\n        isGenerating: false,\r\n        needsFixing: false,\r\n        hasErrors: false,\r\n    }));\r\n}\r\n","/**\r\n * ID Generation Utility for Frontend\r\n * Simple wrapper around crypto.randomUUID() for consistent ID generation\r\n */\r\n\r\nexport function generateId(): string {\r\n    return crypto.randomUUID();\r\n}\r\n\r\nexport function generateShortId(): string {\r\n    return crypto.randomUUID().replace(/-/g, '').substring(0, 16);\r\n}","import { toast } from 'sonner';\r\nimport { generateId } from '@/utils/id-generator';\r\nimport type { RateLimitError, ConversationMessage } from '@/api-types';\r\n\r\nexport type ToolEvent = {\r\n    name: string;\r\n    status: 'start' | 'success' | 'error';\r\n    timestamp: number;\r\n};\r\n\r\nexport type ChatMessage = Omit<ConversationMessage, 'content'> & {\r\n    content: string;\r\n    ui?: {\r\n        isThinking?: boolean;\r\n        toolEvents?: ToolEvent[];\r\n    };\r\n};\r\n\r\n/**\r\n * Check if a message ID should appear in conversational chat\r\n */\r\nexport function isConversationalMessage(messageId: string): boolean {\r\n    const conversationalIds = [\r\n        'main',\r\n        'creating-blueprint',\r\n        'conversation_response',\r\n        'fetching-chat',\r\n        'chat-not-found',\r\n        'resuming-chat',\r\n        'chat-welcome',\r\n        'deployment-status',\r\n        'code_reviewed',\r\n    ];\r\n    \r\n    return conversationalIds.includes(messageId) || messageId.startsWith('conv-');\r\n}\r\n\r\n/**\r\n * Create an assistant message\r\n */\r\nexport function createAIMessage(\r\n    conversationId: string,\r\n    content: string,\r\n    isThinking?: boolean\r\n): ChatMessage {\r\n    return {\r\n        role: 'assistant',\r\n        conversationId,\r\n        content,\r\n        ui: { isThinking },\r\n    };\r\n}\r\n\r\n/**\r\n * Create a user message\r\n */\r\nexport function createUserMessage(message: string): ChatMessage {\r\n    return {\r\n        role: 'user',\r\n        conversationId: generateId(),\r\n        content: message,\r\n    };\r\n}\r\n\r\n/**\r\n * Handle rate limit errors consistently\r\n */\r\nexport function handleRateLimitError(\r\n    rateLimitError: RateLimitError,\r\n    onDebugMessage?: (\r\n        type: 'error' | 'warning' | 'info' | 'websocket',\r\n        message: string,\r\n        details?: string,\r\n        source?: string,\r\n        messageType?: string,\r\n        rawMessage?: unknown\r\n    ) => void\r\n): ChatMessage {\r\n    let displayMessage = rateLimitError.message;\r\n    \r\n    if (rateLimitError.suggestions && rateLimitError.suggestions.length > 0) {\r\n        displayMessage += `\\n\\n Suggestions:\\n${rateLimitError.suggestions.map(s => ` ${s}`).join('\\n')}`;\r\n    }\r\n    \r\n    toast.error(displayMessage);\r\n    \r\n    onDebugMessage?.(\r\n        'error',\r\n        `Rate Limit: ${rateLimitError.limitType.replace('_', ' ')} limit exceeded`,\r\n        `Limit: ${rateLimitError.limit} per ${Math.floor((rateLimitError.period || 0) / 3600)}h\\nRetry after: ${(rateLimitError.period || 0) / 3600}h\\n\\nSuggestions:\\n${rateLimitError.suggestions?.join('\\n') || 'None'}`,\r\n        'Rate Limiting',\r\n        rateLimitError.limitType,\r\n        rateLimitError\r\n    );\r\n    \r\n    return createAIMessage(\r\n        `rate_limit_${Date.now()}`,\r\n        ` ${displayMessage}`\r\n    );\r\n}\r\n\r\n/**\r\n * Add or update a message in the messages array\r\n */\r\nexport function addOrUpdateMessage(\r\n    messages: ChatMessage[],\r\n    newMessage: ChatMessage,\r\n): ChatMessage[] {\r\n    // Special handling for 'main' assistant message - update if thinking, otherwise append\r\n    if (newMessage.conversationId === 'main') {\r\n        const mainMessageIndex = messages.findIndex(m => m.conversationId === 'main' && m.ui?.isThinking);\r\n        if (mainMessageIndex !== -1) {\r\n            return messages.map((msg, index) =>\r\n                index === mainMessageIndex \r\n                    ? { ...msg, ...newMessage }\r\n                    : msg\r\n            );\r\n        }\r\n    }\r\n    // For all other messages, append\r\n    return [...messages, newMessage];\r\n}\r\n\r\n/**\r\n * Handle streaming conversation messages\r\n */\r\nexport function handleStreamingMessage(\r\n    messages: ChatMessage[],\r\n    conversationId: string,\r\n    chunk: string,\r\n    isNewMessage: boolean\r\n): ChatMessage[] {\r\n    const existingMessageIndex = messages.findIndex(m => m.conversationId === conversationId && m.role === 'assistant');\r\n    if (existingMessageIndex !== -1 && !isNewMessage) {\r\n        // Append chunk to existing assistant message\r\n        return messages.map((msg, index) =>\r\n            index === existingMessageIndex\r\n                ? { ...msg, content: msg.content + chunk }\r\n                : msg\r\n        );\r\n    } else {\r\n        // Create new streaming assistant message\r\n        return [...messages, createAIMessage(conversationId, chunk, false)];\r\n    }\r\n}\r\n\r\n/**\r\n * Append or update a tool event inline within an AI message bubble\r\n * - If a message with messageId doesn't exist yet, create a placeholder AI message with empty content\r\n * - If a matching 'start' exists and a 'success' comes in for the same tool, update that entry in place\r\n */\r\nexport function appendToolEvent(\r\n    messages: ChatMessage[],\r\n    conversationId: string,\r\n    tool: { name: string; status: 'start' | 'success' | 'error' }\r\n): ChatMessage[] {\r\n    const idx = messages.findIndex(m => m.conversationId === conversationId && m.role === 'assistant');\r\n    const timestamp = Date.now();\r\n\r\n    // If message is not present, create a new placeholder assistant message with tool event\r\n    if (idx === -1) {\r\n        const newMsg: ChatMessage = {\r\n            role: 'assistant',\r\n            conversationId,\r\n            content: '',\r\n            ui: { toolEvents: [{ name: tool.name, status: tool.status, timestamp }] },\r\n        };\r\n        return [...messages, newMsg];\r\n    }\r\n\r\n    return messages.map((m, i) => {\r\n        if (i !== idx) return m;\r\n        const current = m.ui?.toolEvents ?? [];\r\n        if (tool.status === 'success') {\r\n            // Find last 'start' for this tool and flip it to success\r\n            for (let j = current.length - 1; j >= 0; j--) {\r\n                if (current[j].name === tool.name) {\r\n                    return {\r\n                        ...m,\r\n                        ui: {\r\n                            ...m.ui,\r\n                            toolEvents: current.map((ev, k) =>\r\n                                k === j ? { ...ev, status: 'success', timestamp } : ev\r\n                            ),\r\n                        }\r\n                    };\r\n                }\r\n            }\r\n            // If no prior start, just append success as a separate line\r\n            return { ...m, ui: { ...m.ui, toolEvents: [...current, { name: tool.name, status: 'success', timestamp }] } };\r\n        }\r\n        // Default: append event\r\n        return { ...m, ui: { ...m.ui, toolEvents: [...current, { name: tool.name, status: tool.status, timestamp }] } };\r\n    });\r\n}\r\n","export interface ProjectStage {\r\n    id: 'bootstrap' | 'blueprint' | 'code' | 'validate' | 'fix';\r\n    title: string;\r\n    status: 'pending' | 'active' | 'completed' | 'error';\r\n    metadata?: string;\r\n}\r\n\r\nexport const initialStages: ProjectStage[] = [\r\n    {\r\n        id: 'bootstrap',\r\n        title: 'Bootstrapping project',\r\n        status: 'active',\r\n    },\r\n    {\r\n        id: 'blueprint',\r\n        title: 'Generating Blueprint',\r\n        status: 'pending',\r\n    },\r\n    { id: 'code', title: 'Generating code', status: 'pending' },\r\n    { id: 'validate', title: 'Reviewing & fixing code', status: 'pending' },\r\n    { id: 'fix', title: 'Fixing issues', status: 'pending' },\r\n];\r\n\r\n/**\r\n * Update a specific stage's status and metadata\r\n */\r\nexport function updateStage(\r\n    stages: ProjectStage[],\r\n    stageId: ProjectStage['id'],\r\n    updates: Partial<Omit<ProjectStage, 'id'>>\r\n): ProjectStage[] {\r\n    return stages.map(stage =>\r\n        stage.id === stageId\r\n            ? { ...stage, ...updates }\r\n            : stage\r\n    );\r\n}\r\n\r\n/**\r\n * Complete multiple stages at once\r\n */\r\nexport function completeStages(\r\n    stages: ProjectStage[],\r\n    stageIds: ProjectStage['id'][]\r\n): ProjectStage[] {\r\n    return stages.map(stage =>\r\n        stageIds.includes(stage.id)\r\n            ? { ...stage, status: 'completed' as const }\r\n            : stage\r\n    );\r\n}\r\n\r\n/**\r\n * Get the status of a specific stage\r\n */\r\nexport function getStageStatus(\r\n    stages: ProjectStage[],\r\n    stageId: ProjectStage['id']\r\n): ProjectStage['status'] | undefined {\r\n    return stages.find(stage => stage.id === stageId)?.status;\r\n}\r\n\r\n/**\r\n * Check if a stage is completed\r\n */\r\nexport function isStageCompleted(\r\n    stages: ProjectStage[],\r\n    stageId: ProjectStage['id']\r\n): boolean {\r\n    return getStageStatus(stages, stageId) === 'completed';\r\n}\r\n","import type { WebSocket } from 'partysocket';\r\n\r\n/**\r\n * Check if WebSocket is ready for communication\r\n */\r\nexport function isWebSocketReady(websocket: WebSocket | undefined): websocket is WebSocket {\r\n    return !!websocket && websocket.readyState === 1; // OPEN state\r\n}\r\n\r\n/**\r\n * Send a message via WebSocket if connection is ready\r\n */\r\nexport function sendWebSocketMessage(\r\n    websocket: WebSocket | undefined,\r\n    type: string,\r\n    data?: Record<string, unknown>\r\n): boolean {\r\n    if (!isWebSocketReady(websocket)) {\r\n        console.warn(`WebSocket not ready for message type: ${type}`);\r\n        return false;\r\n    }\r\n    \r\n    websocket.send(JSON.stringify({ type, ...data }));\r\n    return true;\r\n}\r\n","import type { WebSocket } from 'partysocket';\r\nimport type { WebSocketMessage, BlueprintType, ConversationMessage } from '@/api-types';\r\nimport { logger } from '@/utils/logger';\r\nimport { getFileType } from '@/utils/string';\r\nimport { getPreviewUrl } from '@/lib/utils';\r\nimport {\r\n    setFileGenerating,\r\n    appendFileChunk,\r\n    setFileCompleted,\r\n    setAllFilesCompleted,\r\n    updatePhaseFileStatus,\r\n} from './file-state-helpers';\r\nimport { \r\n    createAIMessage,\r\n    handleRateLimitError,\r\n    handleStreamingMessage,\r\n    appendToolEvent,\r\n    type ChatMessage,\r\n} from './message-helpers';\r\nimport { completeStages } from './project-stage-helpers';\r\nimport { sendWebSocketMessage } from './websocket-helpers';\r\nimport type { FileType, PhaseTimelineItem } from '../hooks/use-chat';\r\nimport { toast } from 'sonner';\r\n\r\nexport interface HandleMessageDeps {\r\n    // State setters\r\n    setFiles: React.Dispatch<React.SetStateAction<FileType[]>>;\r\n    setPhaseTimeline: React.Dispatch<React.SetStateAction<PhaseTimelineItem[]>>;\r\n    setProjectStages: React.Dispatch<React.SetStateAction<any[]>>;\r\n    setMessages: React.Dispatch<React.SetStateAction<ChatMessage[]>>;\r\n    setBlueprint: React.Dispatch<React.SetStateAction<BlueprintType | undefined>>;\r\n    setQuery: React.Dispatch<React.SetStateAction<string | undefined>>;\r\n    setPreviewUrl: React.Dispatch<React.SetStateAction<string | undefined>>;\r\n    setTotalFiles: React.Dispatch<React.SetStateAction<number | undefined>>;\r\n    setIsRedeployReady: React.Dispatch<React.SetStateAction<boolean>>;\r\n    setIsPreviewDeploying: React.Dispatch<React.SetStateAction<boolean>>;\r\n    setIsThinking: React.Dispatch<React.SetStateAction<boolean>>;\r\n    setIsInitialStateRestored: React.Dispatch<React.SetStateAction<boolean>>;\r\n    setShouldRefreshPreview: React.Dispatch<React.SetStateAction<boolean>>;\r\n    setIsDeploying: React.Dispatch<React.SetStateAction<boolean>>;\r\n    setCloudflareDeploymentUrl: React.Dispatch<React.SetStateAction<string>>;\r\n    setDeploymentError: React.Dispatch<React.SetStateAction<string | undefined>>;\r\n    setIsGenerationPaused: React.Dispatch<React.SetStateAction<boolean>>;\r\n    setIsGenerating: React.Dispatch<React.SetStateAction<boolean>>;\r\n    setIsPhaseProgressActive: React.Dispatch<React.SetStateAction<boolean>>;\r\n    \r\n    // Current state\r\n    isInitialStateRestored: boolean;\r\n    blueprint: BlueprintType | undefined;\r\n    query: string | undefined;\r\n    bootstrapFiles: FileType[];\r\n    files: FileType[];\r\n    phaseTimeline: PhaseTimelineItem[];\r\n    previewUrl: string | undefined;\r\n    projectStages: any[];\r\n    isGenerating: boolean;\r\n    urlChatId: string | undefined;\r\n    \r\n    // Functions\r\n    updateStage: (stageId: string, updates: any) => void;\r\n    sendMessage: (message: ConversationMessage) => void;\r\n    loadBootstrapFiles: (files: FileType[]) => void;\r\n    onDebugMessage?: (\r\n        type: 'error' | 'warning' | 'info' | 'websocket',\r\n        message: string,\r\n        details?: string,\r\n        source?: string,\r\n        messageType?: string,\r\n        rawMessage?: unknown\r\n    ) => void;\r\n    onTerminalMessage?: (log: { \r\n        id: string; \r\n        content: string; \r\n        type: 'command' | 'stdout' | 'stderr' | 'info' | 'error' | 'warn' | 'debug'; \r\n        timestamp: number; \r\n        source?: string \r\n    }) => void;\r\n}\r\n\r\nexport function createWebSocketMessageHandler(deps: HandleMessageDeps) {\r\n    const extractTextContent = (content: ConversationMessage['content']): string => {\r\n        if (!content) return '';\r\n        if (typeof content === 'string') return content;\r\n        if (Array.isArray(content)) {\r\n            return content\r\n                .map(c => (c && 'type' in c && c.type === 'text') ? c.text : '')\r\n                .join(' ')\r\n                .trim();\r\n        }\r\n        return '';\r\n    };\r\n    return (websocket: WebSocket, message: WebSocketMessage) => {\r\n        const {\r\n            setFiles,\r\n            setPhaseTimeline,\r\n            setProjectStages,\r\n            setMessages,\r\n            setBlueprint,\r\n            setQuery,\r\n            setPreviewUrl,\r\n            setTotalFiles,\r\n            setIsRedeployReady,\r\n            setIsPreviewDeploying,\r\n            setIsThinking,\r\n            setIsInitialStateRestored,\r\n            setShouldRefreshPreview,\r\n            setIsDeploying,\r\n            setCloudflareDeploymentUrl,\r\n            setDeploymentError,\r\n            setIsGenerationPaused,\r\n            setIsGenerating,\r\n            setIsPhaseProgressActive,\r\n            isInitialStateRestored,\r\n            blueprint,\r\n            query,\r\n            bootstrapFiles,\r\n            files,\r\n            phaseTimeline,\r\n            previewUrl,\r\n            projectStages,\r\n            isGenerating,\r\n            urlChatId,\r\n            updateStage,\r\n            sendMessage,\r\n            loadBootstrapFiles,\r\n            onDebugMessage,\r\n            onTerminalMessage,\r\n        } = deps;\r\n\r\n        // Log messages except for frequent ones\r\n        if (message.type !== 'file_chunk_generated' && message.type !== 'cf_agent_state' && message.type.length <= 50) {\r\n            logger.info('received message', message.type, message);\r\n            onDebugMessage?.('websocket', \r\n                `${message.type}`,\r\n                JSON.stringify(message, null, 2),\r\n                'WebSocket',\r\n                message.type,\r\n                message\r\n            );\r\n        }\r\n        \r\n        switch (message.type) {\r\n            case 'cf_agent_state': {\r\n                const { state } = message;\r\n                logger.debug(' Agent state update received:', state);\r\n\r\n                if (!isInitialStateRestored) {\r\n                    logger.debug(' Performing initial state restoration');\r\n                    \r\n                    if (state.blueprint && !blueprint) {\r\n                        setBlueprint(state.blueprint);\r\n                        updateStage('blueprint', { status: 'completed' });\r\n                    }\r\n\r\n                    if (state.query && !query) {\r\n                        setQuery(state.query);\r\n                    }\r\n\r\n                    if (state.templateDetails?.files && bootstrapFiles.length === 0) {\r\n                        loadBootstrapFiles(state.templateDetails.files);\r\n                    }\r\n\r\n                    if (state.generatedFilesMap && files.length === 0) {\r\n                        setFiles(\r\n                            Object.values(state.generatedFilesMap).map((file: any) => ({\r\n                                filePath: file.filePath,\r\n                                fileContents: file.fileContents,\r\n                                isGenerating: false,\r\n                                needsFixing: false,\r\n                                hasErrors: false,\r\n                                language: getFileType(file.filePath),\r\n                            })),\r\n                        );\r\n                    }\r\n\r\n                    if (state.generatedPhases && state.generatedPhases.length > 0 && phaseTimeline.length === 0) {\r\n                        logger.debug(' Restoring phase timeline:', state.generatedPhases);\r\n                        const timeline = state.generatedPhases.map((phase: any, index: number) => ({\r\n                            id: `phase-${index}`,\r\n                            name: phase.name,\r\n                            description: phase.description,\r\n                            status: phase.completed ? 'completed' as const : 'generating' as const,\r\n                            files: phase.files.map((filesConcept: any) => {\r\n                                const file = state.generatedFilesMap?.[filesConcept.path];\r\n                                return {\r\n                                    path: filesConcept.path,\r\n                                    purpose: filesConcept.purpose,\r\n                                    status: (file ? 'completed' as const : 'generating' as const),\r\n                                    contents: file?.fileContents\r\n                                };\r\n                            }),\r\n                            timestamp: Date.now(),\r\n                        }));\r\n                        setPhaseTimeline(timeline);\r\n                    }\r\n                    \r\n                    updateStage('bootstrap', { status: 'completed' });\r\n                    \r\n                    if (state.blueprint) {\r\n                        updateStage('blueprint', { status: 'completed' });\r\n                    }\r\n                    \r\n                    if (state.generatedFilesMap && Object.keys(state.generatedFilesMap).length > 0) {\r\n                        updateStage('code', { status: 'completed' });\r\n                        updateStage('validate', { status: 'completed' });\r\n                    }\r\n\r\n                    setIsInitialStateRestored(true);\r\n\r\n                    if (state.generatedFilesMap && Object.keys(state.generatedFilesMap).length > 0 && \r\n                        urlChatId !== 'new') {\r\n                        logger.debug(' Requesting preview deployment for existing chat with files');\r\n                        sendWebSocketMessage(websocket, 'preview');\r\n                    }\r\n                }\r\n\r\n                if (state.shouldBeGenerating) {\r\n                    logger.debug(' shouldBeGenerating=true detected, auto-resuming generation');\r\n                    updateStage('code', { status: 'active' });\r\n                    \r\n                    logger.debug(' Sending auto-resume generate_all message');\r\n                    sendWebSocketMessage(websocket, 'generate_all');\r\n                } else {\r\n                    const codeStage = projectStages.find((stage: any) => stage.id === 'code');\r\n                    if (codeStage?.status === 'active' && !isGenerating) {\r\n                        if (state.generatedFilesMap && Object.keys(state.generatedFilesMap).length > 0) {\r\n                            updateStage('code', { status: 'completed' });\r\n                            updateStage('validate', { status: 'completed' });\r\n\r\n                            if (!previewUrl) {\r\n                                logger.debug(' Generated files exist but no preview URL - auto-deploying preview');\r\n                                sendWebSocketMessage(websocket, 'preview');\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                logger.debug(' Agent state update processed');\r\n                break;\r\n            }\r\n\r\n            case 'conversation_state': {\r\n                const { state } = message;\r\n                const history: ReadonlyArray<ConversationMessage> = state?.runningHistory ?? [];\r\n                logger.debug('Received conversation_state with messages:', history.length);\r\n\r\n                const restoredMessages: ChatMessage[] = history.reduce<ChatMessage[]>((acc, msg) => {\r\n                    if (msg.role !== 'user' && msg.role !== 'assistant') return acc;\r\n                    const text = extractTextContent(msg.content);\r\n                    if (!text || text.includes('<Internal Memo>')) return acc;\r\n\r\n                    const convId = msg.conversationId;\r\n                    const isArchive = msg.role === 'assistant' && convId.startsWith('archive-');\r\n\r\n                    acc.push({\r\n                        role: msg.role,\r\n                        conversationId: convId,\r\n                        content: isArchive ? 'previous history was compacted' : text,\r\n                    });\r\n                    return acc;\r\n                }, []);\r\n\r\n                if (restoredMessages.length > 0) {\r\n                    logger.debug('Replacing messages with conversation_state history:', restoredMessages.length);\r\n                    setMessages(restoredMessages);\r\n                }\r\n                break;\r\n            }\r\n\r\n            case 'file_generating': {\r\n                setFiles((prev) => setFileGenerating(prev, message.filePath));\r\n                break;\r\n            }\r\n\r\n            case 'file_chunk_generated': {\r\n                setFiles((prev) => appendFileChunk(prev, message.filePath, message.chunk));\r\n                break;\r\n            }\r\n\r\n            case 'file_generated': {\r\n                setFiles((prev) => setFileCompleted(prev, message.file.filePath, message.file.fileContents));\r\n                setPhaseTimeline((prev) => updatePhaseFileStatus(\r\n                    prev,\r\n                    message.file.filePath,\r\n                    'completed',\r\n                    message.file.fileContents\r\n                ));\r\n                break;\r\n            }\r\n\r\n            case 'file_regenerated': {\r\n                setIsRedeployReady(true);\r\n                setFiles((prev) => setFileCompleted(prev, message.file.filePath, message.file.fileContents));\r\n                setPhaseTimeline((prev) => updatePhaseFileStatus(\r\n                    prev,\r\n                    message.file.filePath,\r\n                    'completed',\r\n                    message.file.fileContents\r\n                ));\r\n                break;\r\n            }\r\n\r\n            case 'file_regenerating': {\r\n                setFiles((prev) => setFileGenerating(prev, message.filePath, 'File being regenerated...'));\r\n                setPhaseTimeline((prev) => updatePhaseFileStatus(prev, message.filePath, 'generating'));\r\n                break;\r\n            }\r\n\r\n            case 'generation_started': {\r\n                updateStage('code', { status: 'active' });\r\n                setTotalFiles(message.totalFiles);\r\n                break;\r\n            }\r\n\r\n            case 'generation_complete': {\r\n                setIsRedeployReady(true);\r\n                setFiles((prev) => setAllFilesCompleted(prev));\r\n                setProjectStages((prev) => completeStages(prev, ['code', 'validate', 'fix']));\r\n\r\n                sendMessage(createAIMessage('generation-complete', 'Code generation has been completed.'));\r\n                setIsPhaseProgressActive(false);\r\n                break;\r\n            }\r\n\r\n            case 'deployment_started': {\r\n                setIsPreviewDeploying(true);\r\n                break;\r\n            }\r\n\r\n            case 'deployment_completed': {\r\n                setIsPreviewDeploying(false);\r\n                const finalPreviewURL = getPreviewUrl(message.previewURL, message.tunnelURL);\r\n                setPreviewUrl(finalPreviewURL);\r\n                break;\r\n            }\r\n\r\n            case 'deployment_failed': {\r\n                toast.error(`Error: ${message.message}`);\r\n                break;\r\n            }\r\n\r\n            case 'code_reviewed': {\r\n                const reviewData = message.review;\r\n                const totalIssues = reviewData?.filesToFix?.reduce((count: number, file: any) => \r\n                    count + file.issues.length, 0) || 0;\r\n                \r\n                let reviewMessage = 'Code review complete';\r\n                if (reviewData?.issuesFound) {\r\n                    reviewMessage = `Code review complete - ${totalIssues} issue${totalIssues !== 1 ? 's' : ''} found across ${reviewData.filesToFix?.length || 0} file${reviewData.filesToFix?.length !== 1 ? 's' : ''}`;\r\n                } else {\r\n                    reviewMessage = 'Code review complete - no issues found';\r\n                }\r\n                \r\n                sendMessage(createAIMessage('code_reviewed', reviewMessage));\r\n                break;\r\n            }\r\n\r\n            case 'runtime_error_found': {\r\n                logger.info('Runtime error found in sandbox', message.errors);\r\n                \r\n                onDebugMessage?.('error', \r\n                    `Runtime Error (${message.count} errors)`,\r\n                    message.errors.map((e: any) => `${e.message}\\nStack: ${e.stack || 'N/A'}`).join('\\n\\n'),\r\n                    'Runtime Detection'\r\n                );\r\n                break;\r\n            }\r\n\r\n            case 'code_reviewing': {\r\n                const totalIssues =\r\n                    (message.staticAnalysis?.lint?.issues?.length || 0) +\r\n                    (message.staticAnalysis?.typecheck?.issues?.length || 0) +\r\n                    (message.runtimeErrors.length || 0);\r\n\r\n                updateStage('validate', { status: 'active' });\r\n\r\n                if (totalIssues > 0) {\r\n                    updateStage('fix', { status: 'active', metadata: `Fixing ${totalIssues} issues` });\r\n                    \r\n                    const errorDetails = [\r\n                        `Lint Issues: ${JSON.stringify(message.staticAnalysis?.lint?.issues)}`,\r\n                        `Type Errors: ${JSON.stringify(message.staticAnalysis?.typecheck?.issues)}`,\r\n                        `Runtime Errors: ${JSON.stringify(message.runtimeErrors)}`,\r\n                        `Client Errors: ${JSON.stringify(message.clientErrors)}`,\r\n                    ].filter(Boolean).join('\\n');\r\n                    \r\n                    onDebugMessage?.('warning', \r\n                        `Generation Issues Found (${totalIssues} total)`,\r\n                        errorDetails,\r\n                        'Code Generation'\r\n                    );\r\n                }\r\n                break;\r\n            }\r\n\r\n            case 'phase_generating': {\r\n                updateStage('validate', { status: 'completed' });\r\n                updateStage('fix', { status: 'completed' });\r\n                sendMessage(createAIMessage('phase_generating', message.message));\r\n                setIsThinking(true);\r\n                setIsPhaseProgressActive(true);\r\n                break;\r\n            }\r\n\r\n            case 'phase_generated': {\r\n                sendMessage(createAIMessage('phase_generated', message.message));\r\n                setIsThinking(false);\r\n                setIsPhaseProgressActive(false);\r\n                break;\r\n            }\r\n\r\n            case 'phase_implementing': {\r\n                sendMessage(createAIMessage('phase_implementing', message.message));\r\n                updateStage('code', { status: 'active' });\r\n                \r\n                if (message.phase) {\r\n                    setPhaseTimeline(prev => {\r\n                        const existingPhase = prev.find(p => p.name === message.phase.name);\r\n                        if (existingPhase) {\r\n                            logger.debug('Phase already exists in timeline:', message.phase.name);\r\n                            return prev;\r\n                        }\r\n                        \r\n                        const newPhase = {\r\n                            id: `${message.phase.name}-${Date.now()}`,\r\n                            name: message.phase.name,\r\n                            description: message.phase.description,\r\n                            files: message.phase.files?.map((f: any) => ({\r\n                                path: f.path,\r\n                                purpose: f.purpose,\r\n                                status: 'generating' as const,\r\n                            })) || [],\r\n                            status: 'generating' as const,\r\n                            timestamp: Date.now()\r\n                        };\r\n                        \r\n                        logger.debug('Added new phase to timeline:', message.phase.name);\r\n                        return [...prev, newPhase];\r\n                    });\r\n                }\r\n                break;\r\n            }\r\n\r\n            case 'phase_validating': {\r\n                sendMessage(createAIMessage('phase_validating', message.message));\r\n                updateStage('validate', { status: 'active' });\r\n                \r\n                setPhaseTimeline(prev => {\r\n                    const updated = [...prev];\r\n                    if (updated.length > 0) {\r\n                        const lastPhase = updated[updated.length - 1];\r\n                        lastPhase.status = 'validating';\r\n                        logger.debug(`Phase validating: ${lastPhase.name}`);\r\n                    }\r\n                    return updated;\r\n                });\r\n                setIsPreviewDeploying(false);\r\n                setIsPhaseProgressActive(false);\r\n                break;\r\n            }\r\n\r\n            case 'phase_validated': {\r\n                sendMessage(createAIMessage('phase_validated', message.message));\r\n                updateStage('validate', { status: 'completed' });\r\n                break;\r\n            }\r\n\r\n            case 'phase_implemented': {\r\n                sendMessage(createAIMessage('phase_implemented', message.message));\r\n\r\n                updateStage('code', { status: 'completed' });\r\n                setIsRedeployReady(true);\r\n                setIsPhaseProgressActive(false);\r\n                \r\n                if (message.phase) {\r\n                    setPhaseTimeline(prev => {\r\n                        const updated = [...prev];\r\n                        if (updated.length > 0) {\r\n                            const lastPhase = updated[updated.length - 1];\r\n                            lastPhase.status = 'completed';\r\n                            lastPhase.files = lastPhase.files.map(f => ({ ...f, status: 'completed' as const }));\r\n                            logger.debug(`Phase completed: ${lastPhase.name}`);\r\n                        }\r\n                        return updated;\r\n                    });\r\n                }\r\n\r\n                logger.debug(' Scheduling preview refresh in 1 second after deployment completion');\r\n                setTimeout(() => {\r\n                    logger.debug(' Triggering preview refresh after deployment completion');\r\n                    setShouldRefreshPreview(true);\r\n                    \r\n                    setTimeout(() => {\r\n                        setShouldRefreshPreview(false);\r\n                    }, 100);\r\n                    \r\n                    onDebugMessage?.('info',\r\n                        'Preview Auto-Refresh Triggered',\r\n                        `Preview refreshed 1 second after deployment completion`,\r\n                        'Preview Auto-Refresh'\r\n                    );\r\n                }, 1000);\r\n                break;\r\n            }\r\n\r\n            case 'generation_stopped': {\r\n                setIsGenerating(false);\r\n                setIsGenerationPaused(true);\r\n                sendMessage(createAIMessage('generation_stopped', message.message));\r\n                break;\r\n            }\r\n\r\n            case 'generation_resumed': {\r\n                setIsGenerating(true);\r\n                setIsGenerationPaused(false);\r\n                sendMessage(createAIMessage('generation_resumed', message.message));\r\n                break;\r\n            }\r\n\r\n            case 'cloudflare_deployment_started': {\r\n                setIsDeploying(true);\r\n                sendMessage(createAIMessage('cloudflare_deployment_started', message.message));\r\n                break;\r\n            }\r\n\r\n            case 'cloudflare_deployment_completed': {\r\n                setIsDeploying(false);\r\n                setCloudflareDeploymentUrl(message.deploymentUrl);\r\n                setDeploymentError('');\r\n                setIsRedeployReady(false);\r\n                \r\n                sendMessage(createAIMessage('cloudflare_deployment_completed', `Your project has been permanently deployed to Cloudflare Workers: ${message.deploymentUrl}`));\r\n                \r\n                onDebugMessage?.('info', \r\n                    'Deployment Completed - Redeploy Reset',\r\n                    `Deployment URL: ${message.deploymentUrl}\\nPhase count at deployment: ${phaseTimeline.length}\\nRedeploy button disabled until next phase`,\r\n                    'Redeployment Management'\r\n                );\r\n                break;\r\n            }\r\n\r\n            case 'cloudflare_deployment_error': {\r\n                setIsDeploying(false);\r\n                setDeploymentError(message.error || 'Unknown deployment error');\r\n                setCloudflareDeploymentUrl('');\r\n                setIsRedeployReady(true);\r\n                \r\n                sendMessage(createAIMessage('cloudflare_deployment_error', ` Deployment failed: ${message.error}\\n\\n You can try deploying again.`));\r\n\r\n                toast.error(`Error: ${message.error}`);\r\n                \r\n                onDebugMessage?.('error', \r\n                    'Deployment Failed - State Reset',\r\n                    `Error: ${message.error}\\nDeployment button reset for retry`,\r\n                    'Deployment Error Recovery'\r\n                );\r\n                break;\r\n            }\r\n\r\n            case 'github_export_started': {\r\n                sendMessage(createAIMessage('github_export_started', message.message));\r\n                break;\r\n            }\r\n\r\n            case 'github_export_progress': {\r\n                sendMessage(createAIMessage('github_export_progress', message.message));\r\n                break;\r\n            }\r\n\r\n            case 'github_export_completed': {\r\n                sendMessage(createAIMessage('github_export_completed', message.message));\r\n                break;\r\n            }\r\n\r\n            case 'github_export_error': {\r\n                sendMessage(createAIMessage('github_export_error', ` GitHub export failed: ${message.error}`));\r\n\r\n                toast.error(`Error: ${message.error}`);\r\n                \r\n                break;\r\n            }\r\n\r\n            case 'conversation_response': {\r\n                // Use concrete conversationId when available; otherwise use placeholder id\r\n                let conversationId = message.conversationId ?? 'conversation_response';\r\n\r\n                // If a concrete id arrives later, update placeholder once\r\n                if (message.conversationId) {\r\n                    const convId = message.conversationId;\r\n                    setMessages(prev => {\r\n                        const genericIdx = prev.findIndex(m => m.role === 'assistant' && m.conversationId === 'conversation_response');\r\n                        if (genericIdx !== -1) {\r\n                            return prev.map((m, i) => i === genericIdx ? { ...m, conversationId: convId } : m);\r\n                        }\r\n                        return prev;\r\n                    });\r\n                    conversationId = convId;\r\n                }\r\n\r\n                const isArchive = conversationId.startsWith('archive-');\r\n                const placeholder = 'previous history was compacted';\r\n\r\n                if (message.tool) {\r\n                    const tool = message.tool;\r\n                    setMessages(prev => appendToolEvent(prev, conversationId, { name: tool.name, status: tool.status }));\r\n                    break;\r\n                }\r\n\r\n                if (message.isStreaming) {\r\n                    setMessages(prev => handleStreamingMessage(prev, conversationId, isArchive ? placeholder : message.message, false));\r\n                    break;\r\n                }\r\n\r\n                setMessages(prev => {\r\n                    const idx = prev.findIndex(m => m.role === 'assistant' && m.conversationId === conversationId);\r\n                    if (idx !== -1) return prev.map((m, i) => i === idx ? { ...m, content: (isArchive ? placeholder : message.message) } : m);\r\n                    return [...prev, createAIMessage(conversationId, isArchive ? placeholder : message.message)];\r\n                });\r\n                break;\r\n            }\r\n\r\n            case 'terminal_output': {\r\n                // Handle terminal output from server\r\n                if (onTerminalMessage) {\r\n                    const terminalLog = {\r\n                        id: `terminal-${Date.now()}-${Math.random().toString(36).substring(2, 11)}`,\r\n                        content: message.output,\r\n                        type: message.outputType as 'stdout' | 'stderr' | 'info',\r\n                        timestamp: message.timestamp\r\n                    };\r\n                    onTerminalMessage(terminalLog);\r\n                }\r\n                break;\r\n            }\r\n\r\n            case 'server_log': {\r\n                // Handle server logs\r\n                if (onTerminalMessage) {\r\n                    const serverLog = {\r\n                        id: `log-${Date.now()}-${Math.random().toString(36).substring(2, 11)}`,\r\n                        content: message.message,\r\n                        type: message.level as 'info' | 'warn' | 'error' | 'debug',\r\n                        timestamp: message.timestamp,\r\n                        source: message.source\r\n                    };\r\n                    onTerminalMessage(serverLog);\r\n                }\r\n                break;\r\n            }\r\n\r\n            case 'error': {\r\n                const errorData = message;\r\n                setMessages(prev => [\r\n                    ...prev,\r\n                    createAIMessage(`error_${Date.now()}`, ` ${errorData.error}`)\r\n                ]);\r\n                \r\n                onDebugMessage?.(\r\n                    'error',\r\n                    'WebSocket Error',\r\n                    errorData.error,\r\n                    'WebSocket',\r\n                    'error',\r\n                    errorData\r\n                );\r\n                break;\r\n            }\r\n\r\n            case 'rate_limit_error': {\r\n                const errorData = message.error;\r\n                const rateLimitMessage = handleRateLimitError(\r\n                    errorData.details,\r\n                    onDebugMessage\r\n                );\r\n                setMessages(prev => [...prev, rateLimitMessage]);\r\n                \r\n                break;\r\n            }\r\n\r\n            default:\r\n                logger.warn('Unhandled message:', message);\r\n        }\r\n    };\r\n}\r\n","import { WebSocket } from 'partysocket';\r\nimport { useCallback, useEffect, useRef, useState } from 'react';\r\nimport { toast } from 'sonner';\r\nimport type { RateLimitExceededError } from \"@/api-types\";\r\nimport {\r\n\ttype BlueprintType,\r\n\ttype WebSocketMessage,\r\n\ttype CodeFixEdits,\r\n\ttype ImageAttachment\r\n} from '@/api-types';\r\nimport {\r\n\tcreateRepairingJSONParser,\r\n\tndjsonStream,\r\n} from '@/utils/ndjson-parser/ndjson-parser';\r\nimport { getFileType } from '@/utils/string';\r\nimport { logger } from '@/utils/logger';\r\nimport { apiClient } from '@/lib/api-client';\r\nimport { appEvents } from '@/lib/app-events';\r\nimport { createWebSocketMessageHandler, type HandleMessageDeps } from '../utils/handle-websocket-message';\r\nimport { isConversationalMessage, addOrUpdateMessage, createUserMessage, handleRateLimitError, createAIMessage, type ChatMessage } from '../utils/message-helpers';\r\nimport { sendWebSocketMessage } from '../utils/websocket-helpers';\r\nimport { initialStages as defaultStages, updateStage as updateStageHelper } from '../utils/project-stage-helpers';\r\nimport type { ProjectStage } from '../utils/project-stage-helpers';\r\n\r\n\r\nexport interface FileType {\r\n\tfilePath: string;\r\n\tfileContents: string;\r\n\texplanation?: string;\r\n\tisGenerating?: boolean;\r\n\tneedsFixing?: boolean;\r\n\thasErrors?: boolean;\r\n\tlanguage?: string;\r\n}\r\n\r\n// New interface for phase timeline tracking\r\nexport interface PhaseTimelineItem {\r\n\tid: string;\r\n\tname: string;\r\n\tdescription: string;\r\n\tfiles: {\r\n\t\tpath: string;\r\n\t\tpurpose: string;\r\n\t\tstatus: 'generating' | 'completed' | 'error' | 'validating';\r\n\t\tcontents?: string;\r\n\t}[];\r\n\tstatus: 'generating' | 'completed' | 'error' | 'validating';\r\n\ttimestamp: number;\r\n}\r\n\r\nexport function useChat({\r\n\tchatId: urlChatId,\r\n\tquery: userQuery,\r\n\timages: userImages,\r\n\tagentMode = 'deterministic',\r\n\tonDebugMessage,\r\n\tonTerminalMessage,\r\n}: {\r\n\tchatId?: string;\r\n\tquery: string | null;\r\n\timages?: ImageAttachment[];\r\n\tagentMode?: 'deterministic' | 'smart';\r\n\tonDebugMessage?: (type: 'error' | 'warning' | 'info' | 'websocket', message: string, details?: string, source?: string, messageType?: string, rawMessage?: unknown) => void;\r\n\tonTerminalMessage?: (log: { id: string; content: string; type: 'command' | 'stdout' | 'stderr' | 'info' | 'error' | 'warn' | 'debug'; timestamp: number; source?: string }) => void;\r\n}) {\r\n\tconst connectionStatus = useRef<'idle' | 'connecting' | 'connected' | 'failed' | 'retrying'>('idle');\r\n\tconst retryCount = useRef(0);\r\n\tconst maxRetries = 5;\r\n\tconst retryTimeouts = useRef<NodeJS.Timeout[]>([]);\r\n\t// Track whether component is mounted and should attempt reconnects\r\n\tconst shouldReconnectRef = useRef(true);\r\n\t// Track the latest connection attempt to avoid handling stale socket events\r\n\tconst connectAttemptIdRef = useRef(0);\r\n\tconst [chatId, setChatId] = useState<string>();\r\n\tconst [messages, setMessages] = useState<ChatMessage[]>([\r\n\t\tcreateAIMessage('main', 'Thinking...', true),\r\n\t]);\r\n\r\n\tconst [bootstrapFiles, setBootstrapFiles] = useState<FileType[]>([]);\r\n\tconst [blueprint, setBlueprint] = useState<BlueprintType>();\r\n\tconst [previewUrl, setPreviewUrl] = useState<string>();\r\n\tconst [query, setQuery] = useState<string>();\r\n\r\n\tconst [websocket, setWebsocket] = useState<WebSocket>();\r\n\r\n\tconst [isGeneratingBlueprint, setIsGeneratingBlueprint] = useState(false);\r\n\tconst [isBootstrapping, setIsBootstrapping] = useState(true);\r\n\r\n\tconst [projectStages, setProjectStages] = useState<ProjectStage[]>(defaultStages);\r\n\r\n\t// New state for phase timeline tracking\r\n\tconst [phaseTimeline, setPhaseTimeline] = useState<PhaseTimelineItem[]>([]);\r\n\r\n\tconst [files, setFiles] = useState<FileType[]>([]);\r\n\r\n\tconst [totalFiles, setTotalFiles] = useState<number>();\r\n\r\n\tconst [edit, setEdit] = useState<Omit<CodeFixEdits, 'type'>>();\r\n\r\n\t// Deployment and generation control state\r\n\tconst [isDeploying, setIsDeploying] = useState(false);\r\n\tconst [cloudflareDeploymentUrl, setCloudflareDeploymentUrl] = useState<string>('');\r\n\tconst [deploymentError, setDeploymentError] = useState<string>();\r\n\t\r\n\t// Preview deployment state\r\n\tconst [isPreviewDeploying, setIsPreviewDeploying] = useState(false);\r\n\t\r\n\t// Redeployment state - tracks when redeploy button should be enabled\r\n\tconst [isRedeployReady, setIsRedeployReady] = useState(false);\r\n\t// const [lastDeploymentPhaseCount, setLastDeploymentPhaseCount] = useState(0);\r\n\tconst [isGenerationPaused, setIsGenerationPaused] = useState(false);\r\n\tconst [isGenerating, setIsGenerating] = useState(false);\r\n\r\n\t// Phase progress visual indicator (used to apply subtle throb on chat)\r\n\tconst [isPhaseProgressActive, setIsPhaseProgressActive] = useState(false);\r\n\r\n\tconst [isThinking, setIsThinking] = useState(false);\r\n\t\r\n\t// Preview refresh state - triggers preview reload after deployment\r\n\tconst [shouldRefreshPreview, setShouldRefreshPreview] = useState(false);\r\n\t\r\n\t// Track whether we've completed initial state restoration to avoid disrupting active sessions\r\n\tconst [isInitialStateRestored, setIsInitialStateRestored] = useState(false);\r\n\r\n\tconst updateStage = useCallback(\r\n\t\t(stageId: ProjectStage['id'], data: Partial<Omit<ProjectStage, 'id'>>) => {\r\n\t\t\tlogger.debug('updateStage', { stageId, ...data });\r\n\t\t\tsetProjectStages(prev => updateStageHelper(prev, stageId, data));\r\n\t\t},\r\n\t\t[],\r\n\t);\r\n\r\n\tconst onCompleteBootstrap = useCallback(() => {\r\n\t\tupdateStage('bootstrap', { status: 'completed' });\r\n\t}, [updateStage]);\r\n\r\n\tconst clearEdit = useCallback(() => {\r\n\t\tsetEdit(undefined);\r\n\t}, []);\r\n\r\n\r\n\tconst sendMessage = useCallback((message: ChatMessage) => {\r\n\t\t// Only add conversational messages to the chat UI\r\n\t\tif (!isConversationalMessage(message.conversationId)) return;\r\n\t\tsetMessages((prev: ChatMessage[]) => addOrUpdateMessage(prev, message));\r\n\t}, []);\r\n\r\n\tconst sendUserMessage = useCallback((message: string) => {\r\n\t\tsetMessages(prev => [...prev, createUserMessage(message)]);\r\n\t}, []);\r\n\r\n\tconst loadBootstrapFiles = (files: FileType[]) => {\r\n\t\tsetBootstrapFiles((prev) => [\r\n\t\t\t...prev,\r\n\t\t\t...files.map((file) => ({\r\n\t\t\t\t...file,\r\n\t\t\t\tlanguage: getFileType(file.filePath),\r\n\t\t\t})),\r\n\t\t]);\r\n\t};\r\n\r\n\t// Create the WebSocket message handler\r\n\tconst handleWebSocketMessage = useCallback(\r\n\t\tcreateWebSocketMessageHandler({\r\n\t\t\t// State setters\r\n\t\t\tsetFiles,\r\n\t\t\tsetPhaseTimeline,\r\n\t\t\tsetProjectStages,\r\n\t\t\tsetMessages,\r\n\t\t\tsetBlueprint,\r\n\t\t\tsetQuery,\r\n\t\t\tsetPreviewUrl,\r\n\t\t\tsetTotalFiles,\r\n\t\t\tsetIsRedeployReady,\r\n\t\t\tsetIsPreviewDeploying,\r\n\t\t\tsetIsThinking,\r\n\t\t\tsetIsInitialStateRestored,\r\n\t\t\tsetShouldRefreshPreview,\r\n\t\t\tsetIsDeploying,\r\n\t\t\tsetCloudflareDeploymentUrl,\r\n\t\t\tsetDeploymentError,\r\n\t\t\tsetIsGenerationPaused,\r\n\t\t\tsetIsGenerating,\r\n\t\t\tsetIsPhaseProgressActive,\r\n\t\t\t// Current state\r\n\t\t\tisInitialStateRestored,\r\n\t\t\tblueprint,\r\n\t\t\tquery,\r\n\t\t\tbootstrapFiles,\r\n\t\t\tfiles,\r\n\t\t\tphaseTimeline,\r\n\t\t\tpreviewUrl,\r\n\t\t\tprojectStages,\r\n\t\t\tisGenerating,\r\n\t\t\turlChatId,\r\n\t\t\t// Functions\r\n\t\t\tupdateStage,\r\n\t\t\tsendMessage,\r\n\t\t\tloadBootstrapFiles,\r\n\t\t\tonDebugMessage,\r\n\t\t\tonTerminalMessage,\r\n\t\t} as HandleMessageDeps),\r\n\t\t[\r\n\t\t\tisInitialStateRestored,\r\n\t\t\tblueprint,\r\n\t\t\tquery,\r\n\t\t\tbootstrapFiles,\r\n\t\t\tfiles,\r\n\t\t\tphaseTimeline,\r\n\t\t\tpreviewUrl,\r\n\t\t\tprojectStages,\r\n\t\t\tisGenerating,\r\n\t\t\turlChatId,\r\n\t\t\tupdateStage,\r\n\t\t\tsendMessage,\r\n\t\t\tloadBootstrapFiles,\r\n\t\t\tonDebugMessage,\r\n\t\t\tonTerminalMessage,\r\n\t\t]\r\n\t);\r\n\r\n\t// WebSocket connection with retry logic\r\n\tconst connectWithRetry = useCallback(\r\n\t\t(\r\n\t\t\twsUrl: string,\r\n\t\t\t{ disableGenerate = false, isRetry = false }: { disableGenerate?: boolean; isRetry?: boolean } = {},\r\n\t\t) => {\r\n\t\t\tlogger.debug(` ${isRetry ? 'Retrying' : 'Attempting'} WebSocket connection (attempt ${retryCount.current + 1}/${maxRetries + 1}):`, wsUrl);\r\n\t\t\t\r\n\t\t\tif (!wsUrl) {\r\n\t\t\t\tlogger.error(' WebSocket URL is required');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconnectionStatus.current = isRetry ? 'retrying' : 'connecting';\r\n\r\n\t\t\ttry {\r\n\t\t\t\tlogger.debug(' Attempting WebSocket connection to:', wsUrl);\r\n\t\t\t\tconst ws = new WebSocket(wsUrl);\r\n\t\t\t\tsetWebsocket(ws);\r\n\r\n\t\t\t\t// Mark this attempt id\r\n\t\t\t\tconst myAttemptId = ++connectAttemptIdRef.current;\r\n\r\n\t\t\t\t// Connection timeout - if connection doesn't open within 30 seconds\r\n\t\t\t\tconst connectionTimeout = setTimeout(() => {\r\n\t\t\t\t\t// Only handle timeout for the latest attempt\r\n\t\t\t\t\tif (myAttemptId !== connectAttemptIdRef.current) return;\r\n\t\t\t\t\tif (ws.readyState === WebSocket.CONNECTING) {\r\n\t\t\t\t\t\tlogger.warn(' WebSocket connection timeout');\r\n\t\t\t\t\t\tws.close();\r\n\t\t\t\t\t\thandleConnectionFailure(wsUrl, disableGenerate, 'Connection timeout');\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 30000);\r\n\r\n\t\t\t\tws.addEventListener('open', () => {\r\n\t\t\t\t\t// Ignore stale open events\r\n\t\t\t\t\tif (!shouldReconnectRef.current) {\r\n\t\t\t\t\t\tws.close();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (myAttemptId !== connectAttemptIdRef.current) return;\r\n\t\t\t\t\t\r\n\t\t\t\t\tclearTimeout(connectionTimeout);\r\n\t\t\t\t\tlogger.info(' WebSocket connection established successfully!');\r\n\t\t\t\t\tconnectionStatus.current = 'connected';\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Reset retry count on successful connection\r\n\t\t\t\t\tretryCount.current = 0;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Clear any pending retry timeouts\r\n\t\t\t\t\tretryTimeouts.current.forEach(clearTimeout);\r\n\t\t\t\t\tretryTimeouts.current = [];\r\n\r\n\t\t\t\t\t// Send success message to user\r\n\t\t\t\t\tif (isRetry) {\r\n\t\t\t\t\t\tsendMessage(createAIMessage('websocket_reconnected', ' Connection restored! Continuing with code generation...'));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Always request conversation state explicitly (running/full history)\r\n\t\t\t\t\tsendWebSocketMessage(ws, 'get_conversation_state');\r\n\r\n\t\t\t\t\t// Request file generation for new chats only\r\n\t\t\t\t\tif (!disableGenerate && urlChatId === 'new') {\r\n\t\t\t\t\t\tlogger.debug(' Starting code generation for new chat');\r\n\t\t\t\t\t\tsendWebSocketMessage(ws, 'generate_all');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tws.addEventListener('message', (event) => {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tconst message: WebSocketMessage = JSON.parse(event.data);\r\n\t\t\t\t\t\thandleWebSocketMessage(ws, message);\r\n\t\t\t\t\t} catch (parseError) {\r\n\t\t\t\t\t\tlogger.error(' Error parsing WebSocket message:', parseError, event.data);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tws.addEventListener('error', (error) => {\r\n\t\t\t\t\tclearTimeout(connectionTimeout);\r\n\t\t\t\t\t// Only handle error for the latest attempt and when we should reconnect\r\n\t\t\t\t\tif (myAttemptId !== connectAttemptIdRef.current) return;\r\n\t\t\t\t\tif (!shouldReconnectRef.current) return;\r\n\t\t\t\t\tlogger.error(' WebSocket error:', error);\r\n\t\t\t\t\thandleConnectionFailure(wsUrl, disableGenerate, 'WebSocket error');\r\n\t\t\t\t});\r\n\r\n\t\t\t\tws.addEventListener('close', (event) => {\r\n\t\t\t\t\tclearTimeout(connectionTimeout);\r\n\t\t\t\t\tlogger.info(\r\n\t\t\t\t\t\t` WebSocket connection closed with code ${event.code}: ${event.reason || 'No reason provided'}`,\r\n\t\t\t\t\t\tevent,\r\n\t\t\t\t\t);\r\n\t\t\t\t\t// Only handle close for the latest attempt and when we should reconnect\r\n\t\t\t\t\tif (myAttemptId !== connectAttemptIdRef.current) return;\r\n\t\t\t\t\tif (!shouldReconnectRef.current) return;\r\n\t\t\t\t\t// Retry on any close while mounted (including 1000) to improve resilience\r\n\t\t\t\t\thandleConnectionFailure(wsUrl, disableGenerate, `Connection closed (code: ${event.code})`);\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn function disconnect() {\r\n\t\t\t\t\tclearTimeout(connectionTimeout);\r\n\t\t\t\t\tws.close();\r\n\t\t\t\t};\r\n\t\t\t} catch (error) {\r\n\t\t\t\tlogger.error(' Error establishing WebSocket connection:', error);\r\n\t\t\t\thandleConnectionFailure(wsUrl, disableGenerate, 'Connection setup failed');\r\n\t\t\t}\r\n\t\t},\r\n\t\t[retryCount, maxRetries, retryTimeouts],\r\n\t);\r\n\r\n\t// Handle connection failures with exponential backoff retry\r\n\tconst handleConnectionFailure = useCallback(\r\n\t\t(wsUrl: string, disableGenerate: boolean, reason: string) => {\r\n\t\t\tconnectionStatus.current = 'failed';\r\n\t\t\t\r\n\t\t\tif (retryCount.current >= maxRetries) {\r\n\t\t\t\tlogger.error(` WebSocket connection failed permanently after ${maxRetries + 1} attempts`);\r\n\t\t\t\tsendMessage(createAIMessage('websocket_failed', ` Connection failed permanently after ${maxRetries + 1} attempts.\\n\\n Reason: ${reason}\\n\\n Please refresh the page to try again.`));\r\n\t\t\t\t\r\n\t\t\t\t// Debug logging for permanent failure\r\n\t\t\t\tonDebugMessage?.('error',\r\n\t\t\t\t\t'WebSocket Connection Failed Permanently',\r\n\t\t\t\t\t`Failed after ${maxRetries + 1} attempts. Reason: ${reason}`,\r\n\t\t\t\t\t'WebSocket Resilience'\r\n\t\t\t\t);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tretryCount.current++;\r\n\t\t\t\r\n\t\t\t// Exponential backoff: 2^attempt * 1000ms (1s, 2s, 4s, 8s, 16s)\r\n\t\t\tconst retryDelay = Math.pow(2, retryCount.current) * 1000;\r\n\t\t\tconst maxDelay = 30000; // Cap at 30 seconds\r\n\t\t\tconst actualDelay = Math.min(retryDelay, maxDelay);\r\n\r\n\t\t\tlogger.warn(` Retrying WebSocket connection in ${actualDelay / 1000}s (attempt ${retryCount.current + 1}/${maxRetries + 1})`);\r\n\t\t\t\r\n\t\t\tsendMessage(createAIMessage('websocket_retrying', ` Connection failed. Retrying in ${Math.ceil(actualDelay / 1000)} seconds... (attempt ${retryCount.current + 1}/${maxRetries + 1})\\n\\n Reason: ${reason}`, true));\r\n\r\n\t\t\tconst timeoutId = setTimeout(() => {\r\n\t\t\t\tconnectWithRetry(wsUrl, { disableGenerate, isRetry: true });\r\n\t\t\t}, actualDelay);\r\n\t\t\t\r\n\t\t\tretryTimeouts.current.push(timeoutId);\r\n\t\t\t\r\n\t\t\t// Debug logging for retry attempt\r\n\t\t\tonDebugMessage?.('warning',\r\n\t\t\t\t'WebSocket Connection Retry',\r\n\t\t\t\t`Retry ${retryCount.current}/${maxRetries} in ${actualDelay / 1000}s. Reason: ${reason}`,\r\n\t\t\t\t'WebSocket Resilience'\r\n\t\t\t);\r\n\t\t},\r\n\t\t[maxRetries, retryCount, retryTimeouts, onDebugMessage, sendMessage],\r\n\t);\r\n\r\n    // No legacy wrapper; call connectWithRetry directly\r\n\r\n\tuseEffect(() => {\r\n\t\tasync function init() {\r\n\t\t\tif (!urlChatId || connectionStatus.current !== 'idle') return;\r\n\r\n\t\t\ttry {\r\n\t\t\t\tif (urlChatId === 'new') {\r\n\t\t\t\t\tif (!userQuery) {\r\n\t\t\t\t\t\tconst errorMsg = 'Please enter a description of what you want to build';\r\n\t\t\t\t\t\tlogger.error('Query is required for new code generation');\r\n\t\t\t\t\t\ttoast.error(errorMsg);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Start new code generation using API client\r\n\t\t\t\t\tconst response = await apiClient.createAgentSession({\r\n\t\t\t\t\t\tquery: userQuery,\r\n\t\t\t\t\t\tagentMode,\r\n\t\t\t\t\t\timages: userImages, // Pass images from URL params for multi-modal blueprint\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tconst parser = createRepairingJSONParser();\r\n\r\n\t\t\t\t\tconst result: {\r\n\t\t\t\t\t\twebsocketUrl: string;\r\n\t\t\t\t\t\tagentId: string;\r\n\t\t\t\t\t\ttemplate: {\r\n\t\t\t\t\t\t\tfiles: FileType[];\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t} = {\r\n\t\t\t\t\t\twebsocketUrl: '',\r\n\t\t\t\t\t\tagentId: '',\r\n\t\t\t\t\t\ttemplate: {\r\n\t\t\t\t\t\t\tfiles: [],\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tlet startedBlueprintStream = false;\r\n\t\t\t\t\tsendMessage(createAIMessage('main', \"Sure, let's get started. Bootstrapping the project first...\", true));\r\n\r\n\t\t\t\t\tfor await (const obj of ndjsonStream(response.stream)) {\r\n                        logger.debug('Received chunk from server:', obj);\r\n\t\t\t\t\t\tif (obj.chunk) {\r\n\t\t\t\t\t\t\tif (!startedBlueprintStream) {\r\n\t\t\t\t\t\t\t\tsendMessage(createAIMessage('main', 'Blueprint is being generated...', true));\r\n\t\t\t\t\t\t\t\tlogger.info('Blueprint stream has started');\r\n\t\t\t\t\t\t\t\tsetIsBootstrapping(false);\r\n\t\t\t\t\t\t\t\tsetIsGeneratingBlueprint(true);\r\n\t\t\t\t\t\t\t\tstartedBlueprintStream = true;\r\n\t\t\t\t\t\t\t\tupdateStage('bootstrap', { status: 'completed' });\r\n\t\t\t\t\t\t\t\tupdateStage('blueprint', { status: 'active' });\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tparser.feed(obj.chunk);\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tconst partial = parser.finalize();\r\n\t\t\t\t\t\t\t\tsetBlueprint(partial);\r\n\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\tlogger.error('Error parsing JSON:', e, obj.chunk);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t\tif (obj.agentId) {\r\n\t\t\t\t\t\t\tresult.agentId = obj.agentId;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (obj.websocketUrl) {\r\n\t\t\t\t\t\t\tresult.websocketUrl = obj.websocketUrl;\r\n\t\t\t\t\t\t\tlogger.debug(' Received WebSocket URL from server:', result.websocketUrl)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (obj.template) {\r\n                            logger.debug('Received template from server:', obj.template);\r\n\t\t\t\t\t\t\tresult.template = obj.template;\r\n\t\t\t\t\t\t\tif (obj.template.files) {\r\n\t\t\t\t\t\t\t\tloadBootstrapFiles(obj.template.files);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tupdateStage('blueprint', { status: 'completed' });\r\n\t\t\t\t\tsetIsGeneratingBlueprint(false);\r\n\t\t\t\t\tsendMessage(createAIMessage('main', 'Blueprint generation complete. Now starting the code generation...', true));\r\n\r\n\t\t\t\t\t// Connect to WebSocket\r\n\t\t\t\t\tlogger.debug('connecting to ws with created id');\r\n\t\t\t\t\tconnectWithRetry(result.websocketUrl);\r\n\t\t\t\t\tsetChatId(result.agentId); // This comes from the server response\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Emit app-created event for sidebar updates\r\n\t\t\t\t\tappEvents.emitAppCreated(result.agentId, {\r\n\t\t\t\t\t\ttitle: userQuery || 'New App',\r\n\t\t\t\t\t\tdescription: userQuery,\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (connectionStatus.current === 'idle') {\r\n\t\t\t\t\tsetIsBootstrapping(false);\r\n\t\t\t\t\t// Get existing progress\r\n\t\t\t\t\tsendMessage(createAIMessage('fetching-chat', 'Fetching your previous chat...'));\r\n\r\n\t\t\t\t\t// Fetch existing agent connection details\r\n\t\t\t\t\tconst response = await apiClient.connectToAgent(urlChatId);\r\n\t\t\t\t\tif (!response.success || !response.data) {\r\n\t\t\t\t\t\tlogger.error('Failed to fetch existing chat:', { chatId: urlChatId, error: response.error });\r\n\t\t\t\t\t\tthrow new Error(response.error?.message || 'Failed to connect to agent');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlogger.debug('Existing agentId API result', response.data);\r\n\t\t\t\t\t// Set the chatId for existing chat - this enables the chat input\r\n\t\t\t\t\tsetChatId(urlChatId);\r\n\r\n\t\t\t\t\tsendMessage(createAIMessage('resuming-chat', 'Starting from where you left off...'));\r\n\r\n\t\t\t\t\tlogger.debug('connecting from init for existing chatId');\r\n\t\t\t\t\tconnectWithRetry(response.data.websocketUrl, {\r\n\t\t\t\t\t\tdisableGenerate: true, // We'll handle generation resume in the WebSocket open handler\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tlogger.error('Error initializing code generation:', error);\r\n\t\t\t\tif (error instanceof RateLimitExceededError) {\r\n\t\t\t\t\tconst rateLimitMessage = handleRateLimitError(error.details, onDebugMessage);\r\n\t\t\t\t\tsetMessages(prev => [...prev, rateLimitMessage]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tinit();\r\n\t}, []);\r\n\r\n    // Mount/unmount: enable/disable reconnection and clear pending retries\r\n    useEffect(() => {\r\n        shouldReconnectRef.current = true;\r\n        return () => {\r\n            shouldReconnectRef.current = false;\r\n            retryTimeouts.current.forEach(clearTimeout);\r\n            retryTimeouts.current = [];\r\n        };\r\n    }, []);\r\n\r\n    // Close previous websocket on change\r\n    useEffect(() => {\r\n        return () => {\r\n            websocket?.close();\r\n        };\r\n    }, [websocket]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (edit) {\r\n\t\t\t// When edit is cleared, write the edit changes\r\n\t\t\treturn () => {\r\n\t\t\t\tsetFiles((prev) =>\r\n\t\t\t\t\tprev.map((file) => {\r\n\t\t\t\t\t\tif (file.filePath === edit.filePath) {\r\n\t\t\t\t\t\t\tfile.fileContents = file.fileContents.replace(\r\n\t\t\t\t\t\t\t\tedit.search,\r\n\t\t\t\t\t\t\t\tedit.replacement,\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn file;\r\n\t\t\t\t\t}),\r\n\t\t\t\t);\r\n\t\t\t};\r\n\t\t}\r\n\t}, [edit]);\r\n\r\n\t// Control functions for deployment and generation\r\n\tconst handleStopGeneration = useCallback(() => {\r\n\t\tsendWebSocketMessage(websocket, 'stop_generation');\r\n\t}, [websocket]);\r\n\r\n\tconst handleResumeGeneration = useCallback(() => {\r\n\t\tsendWebSocketMessage(websocket, 'resume_generation');\r\n\t}, [websocket]);\r\n\r\n\tconst handleDeployToCloudflare = useCallback(async (instanceId: string) => {\r\n\t\ttry {\r\n\t\t\t// Send deployment command via WebSocket instead of HTTP request\r\n\t\t\tif (sendWebSocketMessage(websocket, 'deploy', { instanceId })) {\r\n\t\t\t\tlogger.debug(' Deployment WebSocket message sent:', instanceId);\r\n\t\t\t\t\r\n\t\t\t\t// Set 1-minute timeout for deployment\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (isDeploying) {\r\n\t\t\t\t\t\tlogger.warn(' Deployment timeout after 1 minute');\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Reset deployment state\r\n\t\t\t\t\t\tsetIsDeploying(false);\r\n\t\t\t\t\t\tsetCloudflareDeploymentUrl('');\r\n\t\t\t\t\t\tsetIsRedeployReady(false);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Show timeout message\r\n\t\t\t\t\t\tsendMessage(createAIMessage('deployment_timeout', ` Deployment timed out after 1 minute.\\n\\n Please try deploying again. The server may be busy.`));\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Debug logging for timeout\r\n\t\t\t\t\t\tonDebugMessage?.('warning', \r\n\t\t\t\t\t\t\t'Deployment Timeout',\r\n\t\t\t\t\t\t\t`Deployment for ${instanceId} timed out after 60 seconds`,\r\n\t\t\t\t\t\t\t'Deployment Timeout Management'\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 60000); // 1 minute = 60,000ms\r\n\t\t\t\t\r\n\t\t\t\t// Store timeout ID for cleanup if deployment completes early\r\n\t\t\t\t// Note: In a real implementation, you'd want to clear this timeout\r\n\t\t\t\t// when deployment completes successfully\r\n\t\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error('WebSocket connection not available');\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tlogger.error(' Error sending deployment WebSocket message:', error);\r\n\t\t\t\r\n\t\t\t// Set deployment state immediately for UI feedback\r\n\t\t\tsetIsDeploying(true);\r\n\t\t\t// Clear any previous deployment error\r\n\t\t\tsetDeploymentError('');\r\n\t\t\tsetCloudflareDeploymentUrl('');\r\n\t\t\tsetIsRedeployReady(false);\r\n\t\t\t\r\n\t\t\tsendMessage(createAIMessage('deployment_error', ` Failed to initiate deployment: ${error instanceof Error ? error.message : 'Unknown error'}\\n\\n You can try again.`));\r\n\t\t}\r\n\t}, [websocket, sendMessage, isDeploying, onDebugMessage]);\r\n\r\n\treturn {\r\n\t\tmessages,\r\n\t\tedit,\r\n\t\tbootstrapFiles,\r\n\t\tchatId,\r\n\t\tquery,\r\n\t\tfiles,\r\n\t\tblueprint,\r\n\t\tpreviewUrl,\r\n\t\tisGeneratingBlueprint,\r\n\t\tisBootstrapping,\r\n\t\ttotalFiles,\r\n\t\twebsocket,\r\n\t\tsendUserMessage,\r\n\t\tsendAiMessage: sendMessage,\r\n\t\tclearEdit,\r\n\t\tprojectStages,\r\n\t\tphaseTimeline,\r\n\t\tisThinking,\r\n\t\tonCompleteBootstrap,\r\n\t\t// Deployment and generation control\r\n\t\tisDeploying,\r\n\t\tcloudflareDeploymentUrl,\r\n\t\tdeploymentError,\r\n\t\tisRedeployReady,\r\n\t\tisGenerationPaused,\r\n\t\tisGenerating,\r\n\t\thandleStopGeneration,\r\n\t\thandleResumeGeneration,\r\n\t\thandleDeployToCloudflare,\r\n\t\t// Preview refresh control\r\n\t\tshouldRefreshPreview,\r\n\t\t// Preview deployment state\r\n\t\tisPreviewDeploying,\r\n\t\t// Phase progress visual indicator\r\n\t\tisPhaseProgressActive,\r\n\t};\r\n}\r\n","import { AnimatePresence, motion } from 'framer-motion';\r\nimport { useState } from 'react';\r\nimport { Check, Link2 } from 'react-feather';\r\n\r\nconst MotionCheck = motion.create(Check);\r\nconst MotionLink = motion.create(Link2);\r\n\r\nexport function Copy({ text }: { text: string }) {\r\n\tconst [copied, setCopied] = useState(false);\r\n\r\n\treturn (\r\n\t\t<button\r\n\t\t\tclassName=\"p-1\"\r\n\t\t\tonClick={() => {\r\n\t\t\t\tnavigator.clipboard.writeText(text);\r\n\t\t\t\tsetCopied(true);\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tsetCopied(false);\r\n\t\t\t\t}, 2500);\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<AnimatePresence>\r\n\t\t\t\t{copied ? (\r\n\t\t\t\t\t<MotionCheck\r\n\t\t\t\t\t\tinitial={{ scale: 0.4 }}\r\n\t\t\t\t\t\tanimate={{ scale: 1 }}\r\n\t\t\t\t\t\texit={{ scale: 0.4 }}\r\n\t\t\t\t\t\tclassName=\"size-4 text-green-300/70\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<MotionLink\r\n\t\t\t\t\t\tinitial={{ scale: 0.4 }}\r\n\t\t\t\t\t\tanimate={{ scale: 1 }}\r\n\t\t\t\t\t\texit={{ scale: 0.4 }}\r\n\t\t\t\t\t\tclassName=\"size-4 text-text-primary/60\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\t\t\t</AnimatePresence>\r\n\t\t</button>\r\n\t);\r\n}\r\n","import { useState, useEffect, useRef } from 'react';\r\nimport type { FileType } from './use-chat';\r\n\r\n/**\r\n * A hook that streams file contents one by one at a specified rate\r\n */\r\nexport function useFileContentStream(\r\n\tfiles: FileType[],\r\n\toptions: { tps: number; enabled: boolean },\r\n) {\r\n\tconst [streamedFiles, setStreamedFiles] = useState<FileType[]>([]);\r\n\tconst [doneStreaming, setDoneStreaming] = useState(false);\r\n\tconst timeoutRef = useRef<NodeJS.Timeout | undefined>(undefined);\r\n\tconst currentFileRef = useRef<number>(0);\r\n\tconst currentPositionRef = useRef<number>(0);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!options.enabled) {\r\n\t\t\tsetStreamedFiles(files);\r\n\t\t\tsetDoneStreaming(true);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Reset state when files change\r\n\t\tsetStreamedFiles([]);\r\n\t\tcurrentFileRef.current = 0;\r\n\t\tcurrentPositionRef.current = 0;\r\n\r\n\t\t// Clear any existing timeout\r\n\t\tif (timeoutRef.current) {\r\n\t\t\tclearTimeout(timeoutRef.current);\r\n\t\t}\r\n\r\n\t\tconst streamNextChunk = () => {\r\n\t\t\t// If we've processed all files, stop\r\n\t\t\tif (currentFileRef.current >= files.length) {\r\n\t\t\t\tsetDoneStreaming(true);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst currentFile = files[currentFileRef.current];\r\n\t\t\tconst content = currentFile.fileContents;\r\n\t\t\tconst chunkSize = Math.max(1, Math.floor(options.tps / 10)); // Update every 100ms\r\n\r\n\t\t\t// If this is a new file, add it to streamed files\r\n\t\t\tif (currentPositionRef.current === 0) {\r\n\t\t\t\tsetStreamedFiles((prev) => [\r\n\t\t\t\t\t...prev,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t...currentFile,\r\n\t\t\t\t\t\tfileContents: '',\r\n\t\t\t\t\t},\r\n\t\t\t\t]);\r\n\t\t\t}\r\n\r\n\t\t\t// Calculate next chunk\r\n\t\t\tconst nextPosition = Math.min(\r\n\t\t\t\tcontent.length,\r\n\t\t\t\tcurrentPositionRef.current + chunkSize,\r\n\t\t\t);\r\n\t\t\tconst chunk = content.slice(currentPositionRef.current, nextPosition);\r\n\r\n\t\t\t// Update the current file's content\r\n\t\t\tsetStreamedFiles((prev) =>\r\n\t\t\t\tprev.map((file, index) => {\r\n\t\t\t\t\tif (index === prev.length - 1) {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t...file,\r\n\t\t\t\t\t\t\tfileContents: file.fileContents + chunk,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn file;\r\n\t\t\t\t}),\r\n\t\t\t);\r\n\r\n\t\t\tcurrentPositionRef.current = nextPosition;\r\n\r\n\t\t\t// If we've finished the current file, move to next file\r\n\t\t\tif (currentPositionRef.current >= content.length) {\r\n\t\t\t\tcurrentFileRef.current++;\r\n\t\t\t\tcurrentPositionRef.current = 0;\r\n\t\t\t}\r\n\r\n\t\t\t// Schedule next chunk\r\n\t\t\ttimeoutRef.current = setTimeout(streamNextChunk, 100);\r\n\t\t};\r\n\r\n\t\tif (files.length > 0) {\r\n\t\t\tstreamNextChunk();\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\tif (timeoutRef.current) {\r\n\t\t\t\tclearTimeout(timeoutRef.current);\r\n\t\t\t}\r\n\t\t};\r\n\t}, [files, options.tps, options.enabled]);\r\n\r\n\treturn { streamedFiles, doneStreaming };\r\n}\r\n","import { useState, useEffect, useCallback } from 'react';\r\nimport { apiClient } from '@/lib/api-client';\r\nimport type { AppDetailsData } from '@/api-types';\r\n\r\nexport function useApp(appId: string | undefined) {\r\n  // Always declare hooks in the same order to satisfy React Rules of Hooks\r\n  const [app, setApp] = useState<AppDetailsData | null>(null);\r\n  const [loading, setLoading] = useState<boolean>(!!appId && appId !== 'new');\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const fetchApp = useCallback(async () => {\r\n    // Guard: if no valid appId or it's a new app, reset state and skip fetching\r\n    if (!appId || appId === 'new') {\r\n      setApp(null);\r\n      setError(null);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      const response = await apiClient.getAppDetails(appId);\r\n      setApp(response.data || null);\r\n      setError(null);\r\n    } catch (err) {\r\n      console.error('Error fetching app:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to fetch app');\r\n      setApp(null);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [appId]);\r\n\r\n  useEffect(() => {\r\n    void fetchApp();\r\n  }, [fetchApp]);\r\n\r\n  return { app, loading, error, refetch: fetchApp };\r\n}\r\n","import { useState, useCallback, useEffect } from 'react';\r\nimport { WebSocket } from 'partysocket';\r\nimport { useAuth } from '@/contexts/auth-context';\r\nimport { apiClient } from '@/lib/api-client';\r\nimport type {\r\n    AuthUser,\r\n    GitHubExportOptions,\r\n    GitHubExportResult\r\n} from '../api-types';\r\nimport type { WebSocketMessageData } from '@/api-types';\r\n\r\n// Use existing backend WebSocket types\r\ntype GitHubExportProgress = WebSocketMessageData<'github_export_progress'>;\r\n\r\nexport interface GitHubExportState {\r\n    isExporting: boolean;\r\n    progress?: GitHubExportProgress;\r\n    result?: GitHubExportResult;\r\n    isModalOpen: boolean;\r\n}\r\n\r\nexport interface GitHubInstallationData {\r\n    installationId: number;\r\n    username: string;\r\n    repositories?: string[];\r\n}\r\n\r\nexport function useGitHubExport(_websocket?: WebSocket | null, agentId?: string): {\r\n    isExporting: boolean;\r\n    progress?: GitHubExportProgress;\r\n    result?: GitHubExportResult;\r\n    isModalOpen: boolean;\r\n    openModal: () => void;\r\n    closeModal: () => void;\r\n    startExport: (options: GitHubExportOptions) => Promise<void>;\r\n    isAuthenticated: boolean;\r\n    user: AuthUser | null;\r\n    retry: () => void;\r\n} {\r\n    const { user, isAuthenticated } = useAuth();\r\n    const [state, setState] = useState<GitHubExportState>({\r\n        isExporting: false,\r\n        isModalOpen: false\r\n    });\r\n\r\n    // NOTE: WebSocket-based GitHub export has been replaced with secure OAuth flow\r\n    // All GitHub export now happens via HTTP API with proper OAuth authorization\r\n\r\n    // Open the export modal\r\n    const openModal = useCallback(() => {\r\n        setState(prev => ({\r\n            ...prev,\r\n            isModalOpen: true,\r\n            result: undefined // Clear any previous results\r\n        }));\r\n    }, []);\r\n\r\n    // Close the export modal\r\n    const closeModal = useCallback(() => {\r\n        setState(prev => ({\r\n            ...prev,\r\n            isModalOpen: false,\r\n            isExporting: false,\r\n            progress: undefined,\r\n            result: undefined\r\n        }));\r\n    }, []);\r\n\r\n    // Check for GitHub export callback results on component mount\r\n    useEffect(() => {\r\n        const urlParams = new URLSearchParams(window.location.search);\r\n        const githubExport = urlParams.get('github_export');\r\n        \r\n        if (githubExport === 'success') {\r\n            const repositoryUrl = urlParams.get('repository_url');\r\n            setState(prev => ({\r\n                ...prev,\r\n                isExporting: false,\r\n                isModalOpen: true, // Auto-open modal to show success result\r\n                result: {\r\n                    success: true,\r\n                    repositoryUrl: repositoryUrl || undefined\r\n                }\r\n            }));\r\n            \r\n            // Clean up URL\r\n            const newUrl = new URL(window.location.href);\r\n            newUrl.searchParams.delete('github_export');\r\n            newUrl.searchParams.delete('repository_url');\r\n            window.history.replaceState({}, '', newUrl.toString());\r\n            \r\n        } else if (githubExport === 'error') {\r\n            const reason = urlParams.get('reason') || 'Unknown error';\r\n            setState(prev => ({\r\n                ...prev,\r\n                isExporting: false,\r\n                isModalOpen: true, // Auto-open modal to show error result\r\n                result: {\r\n                    success: false,\r\n                    error: `GitHub export failed: ${reason}`\r\n                }\r\n            }));\r\n            \r\n            // Clean up URL\r\n            const newUrl = new URL(window.location.href);\r\n            newUrl.searchParams.delete('github_export');\r\n            newUrl.searchParams.delete('reason');\r\n            window.history.replaceState({}, '', newUrl.toString());\r\n        }\r\n    }, []);\r\n\r\n    // Start GitHub export with secure backend flow\r\n    const startExport = useCallback(async (options: GitHubExportOptions) => {\r\n        setState(prev => ({\r\n            ...prev,\r\n            isExporting: true,\r\n            progress: { message: 'Initiating GitHub authorization...', step: 'creating_repository', progress: 10 },\r\n            result: undefined\r\n        }));\r\n\r\n        try {\r\n            // Validate agentId is available (should be from URL params)\r\n            if (!agentId) {\r\n                setState(prev => ({\r\n                    ...prev,\r\n                    isExporting: false,\r\n                    result: {\r\n                        success: false,\r\n                        error: 'Invalid chat session. Please ensure you are on a valid chat page.'\r\n                    }\r\n                }));\r\n                return;\r\n            }\r\n\r\n            // Initiate GitHub export with OAuth flow\r\n            const response = await apiClient.initiateGitHubExport({\r\n                repositoryName: options.repositoryName,\r\n                description: options.description,\r\n                isPrivate: options.isPrivate,\r\n                agentId: agentId\r\n            });\r\n\r\n            if (response.data?.authUrl) {\r\n                setState(prev => ({\r\n                    ...prev,\r\n                    progress: { message: 'Redirecting to GitHub...', step: 'creating_repository', progress: 25 }\r\n                }));\r\n                \r\n                // Small delay for user feedback, then redirect\r\n                setTimeout(() => {\r\n                    window.location.href = response.data?.authUrl || '';\r\n                }, 500);\r\n            } else {\r\n                setState(prev => ({\r\n                    ...prev,\r\n                    isExporting: false,\r\n                    result: {\r\n                        success: false,\r\n                        error: 'Failed to initiate GitHub authorization'\r\n                    }\r\n                }));\r\n            }\r\n        } catch (error: any) {\r\n            setState(prev => ({\r\n                ...prev,\r\n                isExporting: false,\r\n                result: {\r\n                    success: false,\r\n                    error: error?.message || 'Failed to initiate GitHub export'\r\n                }\r\n            }));\r\n        }\r\n    }, [agentId]);\r\n\r\n    // Retry function that resets state and allows a new export attempt\r\n    const retry = useCallback(() => {\r\n        setState(prev => ({\r\n            ...prev,\r\n            result: undefined,\r\n            progress: undefined,\r\n            isExporting: false\r\n        }));\r\n    }, []);\r\n\r\n    return {\r\n        ...state,\r\n        openModal,\r\n        closeModal,\r\n        startExport,\r\n        isAuthenticated,\r\n        user,\r\n        retry\r\n    };\r\n}","import React, { useState, useCallback } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n    X, \r\n    Github, \r\n    Lock, \r\n    Globe, \r\n    Upload, \r\n    CheckCircle, \r\n    AlertCircle, \r\n    Loader\r\n} from 'lucide-react';\r\n\r\ninterface GitHubExportModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onExport: (options: {\r\n        repositoryName: string;\r\n        isPrivate: boolean;\r\n        description?: string;\r\n    }) => void;\r\n    isExporting?: boolean;\r\n    exportProgress?: {\r\n        message: string;\r\n        step: 'creating_repository' | 'uploading_files' | 'finalizing';\r\n        progress: number;\r\n    };\r\n    exportResult?: {\r\n        success: boolean;\r\n        repositoryUrl?: string;\r\n        error?: string;\r\n    };\r\n    onRetry?: () => void;\r\n}\r\n\r\nexport function GitHubExportModal({\r\n    isOpen,\r\n    onClose,\r\n    onExport,\r\n    isExporting = false,\r\n    exportProgress,\r\n    exportResult,\r\n    onRetry\r\n}: GitHubExportModalProps) {\r\n    const [repositoryName, setRepositoryName] = useState('');\r\n    const [description, setDescription] = useState('');\r\n    const [isPrivate, setIsPrivate] = useState(false);\r\n\r\n    const handleSubmit = useCallback((e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        \r\n        if (!repositoryName.trim()) {\r\n            return;\r\n        }\r\n\r\n        // Always call onExport - the parent component will handle OAuth flow\r\n        onExport({\r\n            repositoryName: repositoryName.trim(),\r\n            isPrivate,\r\n            description: description.trim() || undefined\r\n        });\r\n    }, [repositoryName, description, isPrivate, onExport]);\r\n\r\n    const handleClose = useCallback(() => {\r\n        if (!isExporting) {\r\n            onClose();\r\n        }\r\n    }, [isExporting, onClose]);\r\n\r\n    // Auto-generate repository name based on current timestamp\r\n    React.useEffect(() => {\r\n        if (isOpen && !repositoryName) {\r\n            const timestamp = new Date().toISOString().slice(0, 19).replace(/[-:]/g, '').replace('T', '-');\r\n            setRepositoryName(`generated-app-${timestamp}`);\r\n        }\r\n    }, [isOpen, repositoryName]);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <AnimatePresence>\r\n            <motion.div\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n                exit={{ opacity: 0 }}\r\n                className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\"\r\n                onClick={handleClose}\r\n            >\r\n                <motion.div\r\n                    initial={{ scale: 0.95, opacity: 0 }}\r\n                    animate={{ scale: 1, opacity: 1 }}\r\n                    exit={{ scale: 0.95, opacity: 0 }}\r\n                    className=\"bg-bg-4 border border-border-primary rounded-xl max-w-md w-full p-6\"\r\n                    onClick={(e) => e.stopPropagation()}\r\n                >\r\n                    {/* Header */}\r\n                    <div className=\"flex items-center justify-between mb-6\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"p-2 bg-bg-2 rounded-lg\">\r\n                                <Github className=\"w-5 h-5 text-text-secondary\" />\r\n                            </div>\r\n                            <div>\r\n                                <h2 className=\"text-lg font-semibold text-text-secondary\">Export to GitHub</h2>\r\n                                <p className=\"text-sm text-text-primary/60\">Create a new repository with your generated code</p>\r\n                            </div>\r\n                        </div>\r\n                        {!isExporting && (\r\n                            <button\r\n                                onClick={handleClose}\r\n                                className=\"p-1 hover:bg-bg-2 rounded-md transition-colors\"\r\n                            >\r\n                                <X className=\"w-5 h-5 text-text-primary/60\" />\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Content */}\r\n                    {exportResult ? (\r\n                        /* Export Result */\r\n                        <div className=\"text-center py-8\">\r\n                            {exportResult.success ? (\r\n                                <div>\r\n                                    <CheckCircle className=\"w-12 h-12 text-green-500 mx-auto mb-4\" />\r\n                                    <h3 className=\"text-lg font-semibold text-text-primary mb-2\">Export Successful!</h3>\r\n                                    <p className=\"text-sm text-text-primary/60 mb-4\">\r\n                                        Your code has been successfully exported to GitHub\r\n                                    </p>\r\n                                    <a\r\n                                        href={exportResult.repositoryUrl}\r\n                                        target=\"_blank\"\r\n                                        rel=\"noopener noreferrer\"\r\n                                        className=\"inline-flex items-center gap-2 bg-bg-2 hover:bg-border text-text-primary py-2 px-4 rounded-lg transition-colors\"\r\n                                    >\r\n                                        <Github className=\"w-4 h-4\" />\r\n                                        View Repository\r\n                                    </a>\r\n                                </div>\r\n                            ) : (\r\n                                <div>\r\n                                    <AlertCircle className=\"w-12 h-12 text-red-500 mx-auto mb-4\" />\r\n                                    <h3 className=\"text-lg font-semibold text-text-primary mb-2\">Export Failed</h3>\r\n                                    <p className=\"text-sm text-text-primary/60 mb-4\">\r\n                                        {exportResult.error || 'An error occurred during export'}\r\n                                    </p>\r\n                                    <div className=\"space-x-2\">\r\n                                        <button\r\n                                            onClick={onRetry || (() => window.location.reload())}\r\n                                            className=\"bg-bg-2 hover:bg-border text-text-primary py-2 px-4 rounded-lg transition-colors\"\r\n                                        >\r\n                                            Try Again\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={onClose}\r\n                                            className=\"bg-transparent hover:bg-bg-2 text-text-primary/60 hover:text-text-primary py-2 px-4 rounded-lg transition-colors\"\r\n                                        >\r\n                                            Close\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    ) : isExporting && exportProgress ? (\r\n                        /* Export Progress */\r\n                        <div className=\"py-8\">\r\n                            <div className=\"text-center mb-6\">\r\n                                <Loader className=\"w-8 h-8 text-brand mx-auto mb-4 animate-spin\" />\r\n                                <h3 className=\"text-lg font-semibold text-text-primary mb-2\">Exporting to GitHub</h3>\r\n                                <p className=\"text-sm text-text-primary/60\">{exportProgress.message}</p>\r\n                            </div>\r\n                            \r\n                            {/* Progress Bar */}\r\n                            <div className=\"mb-4\">\r\n                                <div className=\"flex justify-between text-xs text-text-primary/60 mb-2\">\r\n                                    <span>Progress</span>\r\n                                    <span>{exportProgress.progress}%</span>\r\n                                </div>\r\n                                <div className=\"w-full bg-bg-2 rounded-full h-2\">\r\n                                    <motion.div\r\n                                        className=\"bg-brand h-2 rounded-full\"\r\n                                        initial={{ width: 0 }}\r\n                                        animate={{ width: `${exportProgress.progress}%` }}\r\n                                        transition={{ duration: 0.5 }}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            {/* Step Indicators */}\r\n                            <div className=\"flex justify-between text-xs\">\r\n                                <div className={`flex items-center gap-1 ${\r\n                                    exportProgress.step === 'creating_repository' ? 'text-brand' : \r\n                                    exportProgress.progress > 30 ? 'text-green-500' : 'text-text-primary/40'\r\n                                }`}>\r\n                                    <div className=\"w-2 h-2 rounded-full bg-current\" />\r\n                                    Creating Repository\r\n                                </div>\r\n                                <div className={`flex items-center gap-1 ${\r\n                                    exportProgress.step === 'uploading_files' ? 'text-brand' : \r\n                                    exportProgress.progress > 70 ? 'text-green-500' : 'text-text-primary/40'\r\n                                }`}>\r\n                                    <div className=\"w-2 h-2 rounded-full bg-current\" />\r\n                                    Uploading Files\r\n                                </div>\r\n                                <div className={`flex items-center gap-1 ${\r\n                                    exportProgress.step === 'finalizing' ? 'text-brand' : \r\n                                    exportProgress.progress > 90 ? 'text-green-500' : 'text-text-primary/40'\r\n                                }`}>\r\n                                    <div className=\"w-2 h-2 rounded-full bg-current\" />\r\n                                    Finalizing\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        /* Export Form */\r\n                        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                            {/* Repository Name */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-text-primary mb-2\">\r\n                                    Repository Name *\r\n                                </label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={repositoryName}\r\n                                    onChange={(e) => setRepositoryName(e.target.value)}\r\n                                    placeholder=\"my-awesome-app\"\r\n                                    className=\"w-full px-3 py-2 bg-bg-2 border border-border-primary rounded-lg text-text-primary placeholder:text-text-primary/40 focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Description */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-text-primary mb-2\">\r\n                                    Description (Optional)\r\n                                </label>\r\n                                <textarea\r\n                                    value={description}\r\n                                    onChange={(e) => setDescription(e.target.value)}\r\n                                    placeholder=\"A brief description of your app...\"\r\n                                    rows={3}\r\n                                    className=\"w-full px-3 py-2 bg-bg-2 border border-border-primary rounded-lg text-text-primary placeholder:text-text-primary/40 focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand resize-none\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Privacy Setting */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-text-primary mb-3\">\r\n                                    Repository Privacy\r\n                                </label>\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"flex items-center gap-3 p-3 bg-bg-2 rounded-lg cursor-pointer hover:bg-border transition-colors\">\r\n                                        <input\r\n                                            type=\"radio\"\r\n                                            name=\"privacy\"\r\n                                            checked={!isPrivate}\r\n                                            onChange={() => setIsPrivate(false)}\r\n                                            className=\"w-4 h-4 text-brand focus:ring-brand/50\"\r\n                                        />\r\n                                        <Globe className=\"w-4 h-4 text-text-primary/60\" />\r\n                                        <div>\r\n                                            <p className=\"text-sm font-medium text-text-secondary\">Public</p>\r\n                                            <p className=\"text-xs text-text-primary/60\">Anyone can see this repository</p>\r\n                                        </div>\r\n                                    </label>\r\n                                    <label className=\"flex items-center gap-3 p-3 bg-bg-2 rounded-lg cursor-pointer hover:bg-border transition-colors\">\r\n                                        <input\r\n                                            type=\"radio\"\r\n                                            name=\"privacy\"\r\n                                            checked={isPrivate}\r\n                                            onChange={() => setIsPrivate(true)}\r\n                                            className=\"w-4 h-4 text-brand focus:ring-brand/50\"\r\n                                        />\r\n                                        <Lock className=\"w-4 h-4 text-text-primary/60\" />\r\n                                        <div>\r\n                                            <p className=\"text-sm font-medium text-text-secondary\">Private</p>\r\n                                            <p className=\"text-xs text-text-primary/60\">Only you can see this repository</p>\r\n                                        </div>\r\n                                    </label>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Submit Button */}\r\n                            <div className=\"flex gap-3 pt-4\">\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={handleClose}\r\n                                    className=\"flex-1 bg-bg-2 hover:bg-border text-text-primary py-2 px-4 rounded-lg transition-colors\"\r\n                                >\r\n                                    Cancel\r\n                                </button>\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={!repositoryName.trim()}\r\n                                    className=\"flex-1 bg-brand hover:bg-brand/90 disabled:bg-brand/50 text-text-on-brand py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2\"\r\n                                >\r\n                                    <Upload className=\"w-4 h-4\" />\r\n                                    Export to GitHub\r\n                                </button>\r\n                            </div>\r\n                        </form>\r\n                    )}\r\n                </motion.div>\r\n            </motion.div>\r\n        </AnimatePresence>\r\n    );\r\n}","import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst badgeVariants = cva(\r\n  \"inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"border-transparent bg-text-secondary text-bg-3 [a&]:hover:bg-text-secondary/90\",\r\n        secondary:\r\n          \"border-transparent bg-bg-2 text-text-secondary [a&]:hover:bg-bg-2/90\",\r\n        destructive:\r\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\r\n        outline:\r\n          \"text-text-primary [a&]:hover:bg-accent [a&]:hover:text-text-secondary\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nfunction Badge({\r\n  className,\r\n  variant,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"span\"> &\r\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\r\n  const Comp = asChild ? Slot : \"span\"\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"badge\"\r\n      className={cn(badgeVariants({ variant }), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Badge, badgeVariants }\r\n","import * as React from \"react\"\r\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Tabs({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\r\n  return (\r\n    <TabsPrimitive.Root\r\n      data-slot=\"tabs\"\r\n      className={cn(\"flex flex-col gap-2\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsList({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\r\n  return (\r\n    <TabsPrimitive.List\r\n      data-slot=\"tabs-list\"\r\n      className={cn(\r\n        \"bg-bg-3 text-text-tertiary inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsTrigger({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\r\n  return (\r\n    <TabsPrimitive.Trigger\r\n      data-slot=\"tabs-trigger\"\r\n      className={cn(\r\n        \"data-[state=active]:bg-bg-3 dark:data-[state=active]:text-text-primary focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-bg-2 text-text-primary dark:text-text-tertiary inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsContent({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\r\n  return (\r\n    <TabsPrimitive.Content\r\n      data-slot=\"tabs-content\"\r\n      className={cn(\"flex-1 outline-none\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\r\n","import { useState } from 'react';\r\nimport { Info, Settings } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport type { ModelConfig, UserModelConfigWithMetadata } from '@/api-types';\r\nimport type { AgentDisplayConfig } from '@/components/model-config-tabs';\r\n\r\n// Reuse workflow tabs from settings (DRY principle)\r\nconst WORKFLOW_TABS = {\r\n  quickstart: {\r\n    id: 'quickstart',\r\n    label: 'Quick Start',\r\n    icon: Settings,\r\n    description: 'Most commonly used agents',\r\n  },\r\n  planning: {\r\n    id: 'planning', \r\n    label: 'Planning',\r\n    icon: Settings,\r\n    description: 'Project planning and setup',\r\n  },\r\n  coding: {\r\n    id: 'coding',\r\n    label: 'Coding', \r\n    icon: Settings,\r\n    description: 'Development and implementation',\r\n  },\r\n  debugging: {\r\n    id: 'debugging',\r\n    label: 'Debugging',\r\n    icon: Settings,\r\n    description: 'Code fixing and review',\r\n  },\r\n  advanced: {\r\n    id: 'advanced',\r\n    label: 'Advanced',\r\n    icon: Settings,\r\n    description: 'Specialized operations',\r\n  }\r\n} as const;\r\n\r\n// Reuse categorization logic from settings (DRY principle)\r\nconst categorizeAgent = (agentKey: string): string => {\r\n  const specificMappings: Record<string, string> = {\r\n    'templateSelection': 'quickstart',\r\n    'blueprint': 'quickstart', \r\n    'conversationalResponse': 'quickstart',\r\n    'phaseGeneration': 'planning',\r\n    'projectSetup': 'planning',\r\n    'phaseImplementation': 'coding',\r\n    'firstPhaseImplementation': 'coding',\r\n    'fileRegeneration': 'coding',\r\n    'realtimeCodeFixer': 'debugging',\r\n    'fastCodeFixer': 'debugging',\r\n    'codeReview': 'debugging',\r\n    'screenshotAnalysis': 'advanced'\r\n  };\r\n  \r\n  if (specificMappings[agentKey]) {\r\n    return specificMappings[agentKey];\r\n  }\r\n  \r\n  const key = agentKey.toLowerCase();\r\n  if (key.includes('template') || key.includes('selection')) return 'quickstart';\r\n  if (key.includes('blueprint') || key.includes('architect')) return 'quickstart';\r\n  if (key.includes('conversation') || key.includes('chat') || key.includes('response')) return 'quickstart';\r\n  if (key.includes('project') && key.includes('setup')) return 'planning';\r\n  if (key.includes('suggestion') && key.includes('process')) return 'planning';\r\n  if (key.includes('planning') || key.includes('plan')) return 'planning';\r\n  if (key.includes('implementation') || key.includes('implement')) return 'coding';\r\n  if (key.includes('regenerat') || key.includes('regen')) return 'coding';\r\n  if (key.includes('code') && key.includes('gen')) return 'coding';\r\n  if (key.includes('fixer') || key.includes('fix')) return 'debugging';\r\n  if (key.includes('debug') || key.includes('review')) return 'debugging';\r\n  if (key.includes('lint') || key.includes('check')) return 'debugging';\r\n  if (key.includes('screenshot') || key.includes('image') || key.includes('vision')) return 'advanced';\r\n  if (key.includes('analysis') || key.includes('analyz')) return 'advanced';\r\n  \r\n  return 'advanced';\r\n};\r\n\r\n// Helper to get model display name\r\nconst getModelDisplayName = (modelValue?: string) => {\r\n  if (!modelValue) return 'Default';\r\n  return modelValue.split('/').pop() || modelValue;\r\n};\r\n\r\n// Helper to get provider info\r\nconst getProviderInfo = (modelValue?: string) => {\r\n  if (!modelValue) return { name: 'Default', color: 'bg-bg-3 text-text-tertiary' };\r\n  \r\n  if (modelValue.includes('cerebras/')) {\r\n    return { name: 'Cerebras', color: 'bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400' };\r\n  }\r\n  if (modelValue.includes('[openrouter]')) {\r\n    return { name: 'OpenRouter', color: 'bg-pink-100 text-pink-800 dark:bg-pink-900/20 dark:text-pink-400' };\r\n  }\r\n  if (modelValue.includes('openai/') || modelValue.includes('gpt') || modelValue.includes('o3') || modelValue.includes('o4')) {\r\n    return { name: 'OpenAI', color: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400' };\r\n  }\r\n  if (modelValue.includes('anthropic/') || modelValue.includes('claude')) {\r\n    return { name: 'Anthropic', color: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-400' };\r\n  }\r\n  if (modelValue.includes('google-ai-studio/') || modelValue.includes('gemini')) {\r\n    return { name: 'Google', color: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400' };\r\n  }\r\n  \r\n  return { name: 'Custom', color: 'bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400' };\r\n};\r\n\r\n// Simplified config card for read-only display\r\nfunction ConfigInfoCard({ \r\n  agent, \r\n  userConfig, \r\n  defaultConfig \r\n}: { \r\n  agent: AgentDisplayConfig; \r\n  userConfig?: UserModelConfigWithMetadata; \r\n  defaultConfig?: ModelConfig; \r\n}) {\r\n  const isCustomized = userConfig?.isUserOverride || false;\r\n  const currentModel = userConfig?.name || defaultConfig?.name;\r\n  const modelDisplayName = getModelDisplayName(currentModel);\r\n  const providerInfo = getProviderInfo(currentModel);\r\n  \r\n  const temperature = userConfig?.temperature ?? defaultConfig?.temperature;\r\n  const maxTokens = userConfig?.max_tokens ?? defaultConfig?.max_tokens;\r\n  const reasoningEffort = userConfig?.reasoning_effort ?? defaultConfig?.reasoning_effort;\r\n\r\n  return (\r\n    <div className=\"p-4 border rounded-lg bg-bg-3/50 space-y-3\">\r\n      <div className=\"flex items-start justify-between gap-2\">\r\n        <div className=\"flex items-start gap-2 min-w-0 flex-1\">\r\n          <div className=\"p-1 rounded-sm bg-bg-3\">\r\n            <Settings className=\"h-3 w-3\" />\r\n          </div>\r\n          <div className=\"min-w-0 flex-1\">\r\n            <h6 className=\"font-medium text-sm mb-1 text-text-secondary\" title={agent.name}>\r\n              {agent.name}\r\n            </h6>\r\n            <p className=\"text-xs text-text-tertiary line-clamp-2\" title={agent.description}>\r\n              {agent.description}\r\n            </p>\r\n          </div>\r\n        </div>\r\n        \r\n        <Badge variant={isCustomized ? \"default\" : \"outline\"} className=\"text-xs shrink-0\">\r\n          {isCustomized ? \"Custom\" : \"Default\"}\r\n        </Badge>\r\n      </div>\r\n      \r\n      <div className=\"space-y-2\">\r\n        <div className=\"flex items-center justify-between gap-2\">\r\n          <span className=\"text-sm font-medium text-text-secondary\" title={modelDisplayName}>\r\n            {modelDisplayName}\r\n          </span>\r\n          <Badge variant=\"secondary\" className={`text-xs shrink-0 ${providerInfo.color}`}>\r\n            {providerInfo.name}\r\n          </Badge>\r\n        </div>\r\n        \r\n        <div className=\"flex flex-wrap gap-1\">\r\n          {temperature !== null && temperature !== undefined && (\r\n            <Badge variant=\"outline\" className=\"text-xs\">\r\n              T: {temperature}\r\n            </Badge>\r\n          )}\r\n          {maxTokens && (\r\n            <Badge variant=\"outline\" className=\"text-xs\">\r\n              {Math.round(maxTokens / 1000)}K tokens\r\n            </Badge>\r\n          )}\r\n          {reasoningEffort && (\r\n            <Badge variant=\"outline\" className=\"text-xs\">\r\n              {reasoningEffort.charAt(0).toUpperCase()}{reasoningEffort.slice(1)}\r\n            </Badge>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\ninterface ModelConfigInfoProps {\r\n  configs?: {\r\n    agents: AgentDisplayConfig[];\r\n    userConfigs: Record<string, UserModelConfigWithMetadata>;\r\n    defaultConfigs: Record<string, ModelConfig>;\r\n  };\r\n  onRequestConfigs: () => void;\r\n  loading?: boolean;\r\n}\r\n\r\nexport function ModelConfigInfo({ configs, onRequestConfigs, loading }: ModelConfigInfoProps) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [activeTab, setActiveTab] = useState('quickstart');\r\n\r\n  const handleOpen = () => {\r\n    setIsOpen(true);\r\n    if (!configs) {\r\n      onRequestConfigs();\r\n    }\r\n  };\r\n\r\n  // Get agents for a specific tab\r\n  const getAgentsForTab = (tabId: string) => {\r\n    if (!configs) return [];\r\n    return configs.agents.filter(agent => categorizeAgent(agent.key) === tabId);\r\n  };\r\n\r\n  // Count customized configs per tab\r\n  const getCustomizedCountForTab = (tabId: string) => {\r\n    const agents = getAgentsForTab(tabId);\r\n    return agents.filter(agent => configs?.userConfigs[agent.key]?.isUserOverride).length;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Button\r\n        variant=\"outline\"\r\n        size=\"sm\"\r\n        onClick={handleOpen}\r\n        className=\"gap-2 text-xs\"\r\n        title=\"View current model configurations\"\r\n      >\r\n        <Info className=\"size-3\" />\r\n        <span className=\"hidden sm:inline\">Model Info</span>\r\n      </Button>\r\n\r\n      <Dialog open={isOpen} onOpenChange={setIsOpen}>\r\n        <DialogContent className=\"max-w-4xl w-[90vw] max-h-[90vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <Info className=\"h-5 w-5\" />\r\n              Current Model Configurations\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              View the AI model settings currently being used for app generation (defaults + your overrides).\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          {loading ? (\r\n            <div className=\"flex items-center gap-3 p-8\">\r\n              <Settings className=\"h-5 w-5 animate-spin text-text-tertiary\" />\r\n              <span className=\"text-sm text-text-tertiary\">Loading model configurations...</span>\r\n            </div>\r\n          ) : !configs ? (\r\n            <div className=\"text-center py-8 text-text-tertiary\">\r\n              <p>No configuration data available.</p>\r\n              <Button \r\n                variant=\"outline\" \r\n                size=\"sm\" \r\n                onClick={onRequestConfigs}\r\n                className=\"mt-4\"\r\n              >\r\n                Retry\r\n              </Button>\r\n            </div>\r\n          ) : (\r\n            <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n              <TabsList className=\"grid w-full grid-cols-5 h-12\">\r\n                {Object.values(WORKFLOW_TABS).map((tab) => {\r\n                  const customizedCount = getCustomizedCountForTab(tab.id);\r\n                  \r\n                  return (\r\n                    <TabsTrigger \r\n                      key={tab.id} \r\n                      value={tab.id}\r\n                      className=\"flex flex-col gap-1 py-2 relative justify-center\"\r\n                    >\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"hidden sm:inline text-xs\">{tab.label}</span>\r\n                        <span className=\"sm:hidden text-xs\">{tab.label.split(' ')[0]}</span>\r\n                      </div>\r\n                      {customizedCount > 0 && (\r\n                        <Badge variant=\"secondary\" className=\"text-xs absolute -top-1 -right-1 h-4 w-4 rounded-full p-0 flex items-center justify-center text-[10px]\">\r\n                          {customizedCount}\r\n                        </Badge>\r\n                      )}\r\n                    </TabsTrigger>\r\n                  );\r\n                })}\r\n              </TabsList>\r\n\r\n              {Object.values(WORKFLOW_TABS).map((tab) => {\r\n                const agents = getAgentsForTab(tab.id);\r\n                \r\n                return (\r\n                  <TabsContent key={tab.id} value={tab.id} className=\"mt-6\">\r\n                    <div className=\"space-y-4\">\r\n                      <div className=\"text-sm text-text-tertiary\">\r\n                        {tab.description}  {agents.length} agent{agents.length !== 1 ? 's' : ''}\r\n                        {getCustomizedCountForTab(tab.id) > 0 && (\r\n                          <span className=\"ml-2 text-text-primary font-medium\">\r\n                            ({getCustomizedCountForTab(tab.id)} customized)\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n\r\n                      {agents.length === 0 ? (\r\n                        <div className=\"text-center py-8 text-text-tertiary\">\r\n                          No agents in this category.\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\r\n                          {agents.map((agent) => (\r\n                            <ConfigInfoCard\r\n                              key={agent.key}\r\n                              agent={agent}\r\n                              userConfig={configs.userConfigs[agent.key]}\r\n                              defaultConfig={configs.defaultConfigs[agent.key]}\r\n                            />\r\n                          ))}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </TabsContent>\r\n                );\r\n              })}\r\n            </Tabs>\r\n          )}\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n}","import { RefObject, useCallback, useEffect, useRef } from 'react';\r\n\r\ntype AutoScrollOptions = {\r\n  enabled?: boolean;\r\n  behavior?: ScrollBehavior;\r\n  bottomThreshold?: number; // px distance considered \"at bottom\"\r\n  watch?: ReadonlyArray<unknown>;\r\n};\r\n\r\nexport function useAutoScroll<T extends HTMLElement>(\r\n  containerRef: RefObject<T | null>,\r\n  { enabled = true, behavior = 'auto', bottomThreshold = 128, watch }: AutoScrollOptions = {}\r\n): { scrollToBottom: () => void } {\r\n  const isAtBottomRef = useRef(true);\r\n\r\n  const scrollToBottom = useCallback(() => {\r\n    const el = containerRef.current;\r\n    if (!el) return;\r\n    el.scrollTo({ top: el.scrollHeight, behavior });\r\n  }, [behavior, containerRef]);\r\n\r\n  useEffect(() => {\r\n    const el = containerRef.current;\r\n    if (!el || !enabled) return;\r\n\r\n    const onScroll = () => {\r\n      const distance = el.scrollHeight - el.scrollTop - el.clientHeight;\r\n      isAtBottomRef.current = distance <= bottomThreshold;\r\n    };\r\n\r\n    // initial stick\r\n    isAtBottomRef.current = true;\r\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n    // setTimeout(scrollToBottom, 0);\r\n    Promise.resolve().then(scrollToBottom);\r\n\r\n    el.addEventListener('scroll', onScroll, { passive: true });\r\n\r\n    const ro = new ResizeObserver(() => {\r\n      if (isAtBottomRef.current) scrollToBottom();\r\n    });\r\n    ro.observe(el);\r\n\r\n    return () => {\r\n      el.removeEventListener('scroll', onScroll);\r\n      ro.disconnect();\r\n    };\r\n  }, [containerRef, enabled, bottomThreshold, scrollToBottom]);\r\n\r\n  // Trigger scroll when watched values change, but only if user is near bottom\r\n  useEffect(() => {\r\n    if (!enabled) return;\r\n    if (watch === undefined) return;\r\n    if (isAtBottomRef.current) scrollToBottom();\r\n  }, [enabled, watch, scrollToBottom]);\r\n\r\n  return { scrollToBottom };\r\n}\r\n","import {\r\n\tuseCallback,\r\n\tuseEffect,\r\n\tuseMemo,\r\n\tuseRef,\r\n\tuseState,\r\n\ttype FormEvent,\r\n} from 'react';\r\nimport { ArrowRight, Image as ImageIcon } from 'react-feather';\r\nimport { useParams, useSearchParams, useNavigate } from 'react-router';\r\nimport { MonacoEditor } from '../../components/monaco-editor/monaco-editor';\r\nimport { AnimatePresence, motion } from 'framer-motion';\r\nimport { Expand, Github, LoaderCircle, RefreshCw } from 'lucide-react';\r\nimport { Blueprint } from './components/blueprint';\r\nimport { FileExplorer } from './components/file-explorer';\r\nimport { UserMessage, AIMessage } from './components/messages';\r\nimport { PhaseTimeline } from './components/phase-timeline';\r\nimport { PreviewIframe } from './components/preview-iframe';\r\nimport { ViewModeSwitch } from './components/view-mode-switch';\r\nimport { DebugPanel, type DebugMessage } from './components/debug-panel';\r\nimport { DeploymentControls } from './components/deployment-controls';\r\nimport { useChat, type FileType } from './hooks/use-chat';\r\nimport { type ModelConfigsData, type BlueprintType, SUPPORTED_IMAGE_MIME_TYPES } from '@/api-types';\r\nimport { Copy } from './components/copy';\r\nimport { useFileContentStream } from './hooks/use-file-content-stream';\r\nimport { logger } from '@/utils/logger';\r\nimport { useApp } from '@/hooks/use-app';\r\nimport { AgentModeDisplay } from '@/components/agent-mode-display';\r\nimport { useGitHubExport } from '@/hooks/use-github-export';\r\nimport { GitHubExportModal } from '@/components/github-export-modal';\r\nimport { ModelConfigInfo } from './components/model-config-info';\r\nimport { useAutoScroll } from '@/hooks/use-auto-scroll';\r\nimport { useImageUpload } from '@/hooks/use-image-upload';\r\nimport { useDragDrop } from '@/hooks/use-drag-drop';\r\nimport { ImageAttachmentPreview } from '@/components/image-attachment-preview';\r\nimport { createAIMessage } from './utils/message-helpers';\r\n\r\nexport default function Chat() {\r\n\tconst { chatId: urlChatId } = useParams();\r\n\r\n\tconst [searchParams] = useSearchParams();\r\n\tconst userQuery = searchParams.get('query');\r\n\tconst agentMode = searchParams.get('agentMode') || 'deterministic';\r\n\t\r\n\t// Extract images from URL params if present\r\n\tconst userImages = useMemo(() => {\r\n\t\tconst imagesParam = searchParams.get('images');\r\n\t\tif (!imagesParam) return undefined;\r\n\t\ttry {\r\n\t\t\treturn JSON.parse(decodeURIComponent(imagesParam));\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Failed to parse images from URL:', error);\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}, [searchParams]);\r\n\r\n\t// Load existing app data if chatId is provided\r\n\tconst { app, loading: appLoading } = useApp(urlChatId);\r\n\r\n\t// If we have an existing app, use its data\r\n\tconst displayQuery = app ? app.originalPrompt || app.title : userQuery || '';\r\n\tconst appTitle = app?.title;\r\n\r\n\t// Manual refresh trigger for preview\r\n\tconst [manualRefreshTrigger, setManualRefreshTrigger] = useState(0);\r\n\r\n\t// Debug message utilities\r\n\tconst addDebugMessage = useCallback(\r\n\t\t(\r\n\t\t\ttype: DebugMessage['type'],\r\n\t\t\tmessage: string,\r\n\t\t\tdetails?: string,\r\n\t\t\tsource?: string,\r\n\t\t\tmessageType?: string,\r\n\t\t\trawMessage?: unknown,\r\n\t\t) => {\r\n\t\t\tconst debugMessage: DebugMessage = {\r\n\t\t\t\tid: `${Date.now()}-${Math.random().toString(36).substring(2, 11)}`,\r\n\t\t\t\ttimestamp: Date.now(),\r\n\t\t\t\ttype,\r\n\t\t\t\tmessage,\r\n\t\t\t\tdetails,\r\n\t\t\t\tsource,\r\n\t\t\t\tmessageType,\r\n\t\t\t\trawMessage,\r\n\t\t\t};\r\n\r\n\t\t\tsetDebugMessages((prev) => [...prev, debugMessage]);\r\n\t\t},\r\n\t\t[],\r\n\t);\r\n\r\n\tconst clearDebugMessages = useCallback(() => {\r\n\t\tsetDebugMessages([]);\r\n\t}, []);\r\n\r\n\tconst {\r\n\t\tmessages,\r\n\t\tedit,\r\n\t\tbootstrapFiles,\r\n\t\tchatId,\r\n\t\tquery,\r\n\t\tfiles,\r\n\t\tisGeneratingBlueprint,\r\n\t\tisBootstrapping,\r\n\t\ttotalFiles,\r\n\t\twebsocket,\r\n\t\tsendUserMessage,\r\n\t\tsendAiMessage,\r\n\t\tblueprint,\r\n\t\tpreviewUrl,\r\n\t\tclearEdit,\r\n\t\tprojectStages,\r\n\t\tphaseTimeline,\r\n\t\tisThinking,\r\n\t\tonCompleteBootstrap,\r\n\t\t// Deployment and generation control\r\n\t\tisDeploying,\r\n\t\tcloudflareDeploymentUrl,\r\n\t\tdeploymentError,\r\n\t\tisRedeployReady,\r\n\t\tisGenerationPaused,\r\n\t\tisGenerating,\r\n\t\thandleStopGeneration,\r\n\t\thandleResumeGeneration,\r\n\t\thandleDeployToCloudflare,\r\n\t\t// Preview refresh control\r\n\t\tshouldRefreshPreview,\r\n\t\t// Preview deployment state\r\n\t\tisPreviewDeploying,\r\n\t} = useChat({\r\n\t\tchatId: urlChatId,\r\n\t\tquery: userQuery,\r\n\t\timages: userImages,\r\n\t\tagentMode: agentMode as 'deterministic' | 'smart',\r\n\t\tonDebugMessage: addDebugMessage,\r\n\t});\r\n\r\n\t// GitHub export functionality - use urlChatId directly from URL params\r\n\tconst githubExport = useGitHubExport(websocket, urlChatId);\r\n\r\n\tconst navigate = useNavigate();\r\n\r\n\tconst [activeFilePath, setActiveFilePath] = useState<string>();\r\n\tconst [view, setView] = useState<'editor' | 'preview' | 'blueprint' | 'terminal'>(\r\n\t\t'editor',\r\n\t);\r\n\r\n\t// Terminal state\r\n\t// const [terminalLogs, setTerminalLogs] = useState<TerminalLog[]>([]);\r\n\r\n\t// Debug panel state\r\n\tconst [debugMessages, setDebugMessages] = useState<DebugMessage[]>([]);\r\n\tconst deploymentControlsRef = useRef<HTMLDivElement>(null);\r\n\r\n\t// Model config info state\r\n\tconst [modelConfigs, setModelConfigs] = useState<{\r\n\t\tagents: Array<{ key: string; name: string; description: string; }>;\r\n\t\tuserConfigs: ModelConfigsData['configs'];\r\n\t\tdefaultConfigs: ModelConfigsData['defaults'];\r\n\t} | undefined>();\r\n\tconst [loadingConfigs, setLoadingConfigs] = useState(false);\r\n\r\n\t// Handler for model config info requests\r\n\tconst handleRequestConfigs = useCallback(() => {\r\n\t\tif (!websocket) return;\r\n\r\n\t\tsetLoadingConfigs(true);\r\n\t\twebsocket.send(JSON.stringify({\r\n\t\t\ttype: 'get_model_configs'\r\n\t\t}));\r\n\t}, [websocket]);\r\n\r\n\t// Listen for model config info WebSocket messages\r\n\tuseEffect(() => {\r\n\t\tif (!websocket) return;\r\n\r\n\t\tconst handleMessage = (event: MessageEvent) => {\r\n\t\t\ttry {\r\n\t\t\t\tconst message = JSON.parse(event.data);\r\n\t\t\t\tif (message.type === 'model_configs_info') {\r\n\t\t\t\t\tsetModelConfigs(message.configs);\r\n\t\t\t\t\tsetLoadingConfigs(false);\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tlogger.error('Error parsing WebSocket message for model configs:', error);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\twebsocket.addEventListener('message', handleMessage);\r\n\r\n\t\treturn () => {\r\n\t\t\twebsocket.removeEventListener('message', handleMessage);\r\n\t\t};\r\n\t}, [websocket]);\r\n\r\n\tconst hasSeenPreview = useRef(false);\r\n\tconst hasSwitchedFile = useRef(false);\r\n\t// const wasChatDisabled = useRef(true);\r\n\t// const hasShownWelcome = useRef(false);\r\n\r\n\tconst editorRef = useRef<HTMLDivElement>(null);\r\n\tconst previewRef = useRef<HTMLIFrameElement>(null);\r\n\tconst messagesContainerRef = useRef<HTMLDivElement>(null);\r\n\r\n\tconst [newMessage, setNewMessage] = useState('');\r\n\tconst [showTooltip, setShowTooltip] = useState(false);\r\n\t\r\n\t// Word count utilities\r\n\tconst MAX_WORDS = 4000;\r\n\tconst countWords = (text: string): number => {\r\n\t\treturn text.trim().split(/\\s+/).filter(word => word.length > 0).length;\r\n\t};\r\n\r\n\tconst { images, addImages, removeImage, clearImages, isProcessing } = useImageUpload({\r\n\t\tonError: (error) => {\r\n\t\t\tconsole.error('Chat image upload error:', error);\r\n\t\t},\r\n\t});\r\n\tconst imageInputRef = useRef<HTMLInputElement>(null);\r\n\r\n\t// Fake stream bootstrap files\r\n\tconst { streamedFiles: streamedBootstrapFiles, doneStreaming } =\r\n\t\tuseFileContentStream(bootstrapFiles, {\r\n\t\t\ttps: 600,\r\n\t\t\tenabled: isBootstrapping,\r\n\t\t});\r\n\r\n\tconst handleFileClick = useCallback((file: FileType) => {\r\n\t\tlogger.debug('handleFileClick()', file);\r\n\t\tclearEdit();\r\n\t\tsetActiveFilePath(file.filePath);\r\n\t\tsetView('editor');\r\n\t\tif (!hasSwitchedFile.current) {\r\n\t\t\thasSwitchedFile.current = true;\r\n\t\t}\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\tconst handleViewModeChange = useCallback((mode: 'preview' | 'editor' | 'blueprint') => {\r\n\t\tsetView(mode);\r\n\t}, []);\r\n\r\n\t// // Terminal functions\r\n\t// const handleTerminalCommand = useCallback((command: string) => {\r\n\t// \tif (websocket && websocket.readyState === WebSocket.OPEN) {\r\n\t// \t\t// Add command to terminal logs\r\n\t// \t\tconst commandLog: TerminalLog = {\r\n\t// \t\t\tid: `cmd-${Date.now()}`,\r\n\t// \t\t\tcontent: command,\r\n\t// \t\t\ttype: 'command',\r\n\t// \t\t\ttimestamp: Date.now()\r\n\t// \t\t};\r\n\t// \t\tsetTerminalLogs(prev => [...prev, commandLog]);\r\n\r\n\t// \t\t// Send command via WebSocket\r\n\t// \t\twebsocket.send(JSON.stringify({\r\n\t// \t\t\ttype: 'terminal_command',\r\n\t// \t\t\tcommand,\r\n\t// \t\t\ttimestamp: Date.now()\r\n\t// \t\t}));\r\n\t// \t}\r\n\t// }, [websocket, setTerminalLogs]);\r\n\r\n\tconst generatingCount = useMemo(\r\n\t\t() =>\r\n\t\t\tfiles.reduce(\r\n\t\t\t\t(count, file) => (file.isGenerating ? count + 1 : count),\r\n\t\t\t\t0,\r\n\t\t\t),\r\n\t\t[files],\r\n\t);\r\n\r\n\tconst codeGenState = useMemo(() => {\r\n\t\treturn projectStages.find((stage) => stage.id === 'code')?.status;\r\n\t}, [projectStages]);\r\n\r\n\tconst generatingFile = useMemo(() => {\r\n\t\t// code gen status should be active\r\n\t\tif (codeGenState === 'active') {\r\n\t\t\tfor (let i = files.length - 1; i >= 0; i--) {\r\n\t\t\t\tif (files[i].isGenerating) return files[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}, [files, codeGenState]);\r\n\r\n\tconst activeFile = useMemo(() => {\r\n\t\tif (!hasSwitchedFile.current && generatingFile) {\r\n\t\t\treturn generatingFile;\r\n\t\t}\r\n\t\tif (!hasSwitchedFile.current && isBootstrapping) {\r\n\t\t\treturn streamedBootstrapFiles.find(\r\n\t\t\t\t(file) => file.filePath === activeFilePath,\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn (\r\n\t\t\tfiles.find((file) => file.filePath === activeFilePath) ??\r\n\t\t\tstreamedBootstrapFiles.find(\r\n\t\t\t\t(file) => file.filePath === activeFilePath,\r\n\t\t\t)\r\n\t\t);\r\n\t}, [\r\n\t\tactiveFilePath,\r\n\t\tgeneratingFile,\r\n\t\tfiles,\r\n\t\tstreamedBootstrapFiles,\r\n\t\tisBootstrapping,\r\n\t]);\r\n\r\n\tconst isPhase1Complete = useMemo(() => {\r\n\t\treturn phaseTimeline.length > 0 && phaseTimeline[0].status === 'completed';\r\n\t}, [phaseTimeline]);\r\n\r\n\tconst isGitHubExportReady = useMemo(() => {\r\n\t\treturn isPhase1Complete && !!urlChatId;\r\n\t}, [isPhase1Complete, urlChatId]);\r\n\r\n\tconst showMainView = useMemo(\r\n\t\t() =>\r\n\t\t\tstreamedBootstrapFiles.length > 0 ||\r\n\t\t\t!!blueprint ||\r\n\t\t\tfiles.length > 0,\r\n\t\t[streamedBootstrapFiles, blueprint, files.length],\r\n\t);\r\n\r\n\tconst [mainMessage, ...otherMessages] = useMemo(() => messages, [messages]);\r\n\r\n\tconst { scrollToBottom } = useAutoScroll(messagesContainerRef, { behavior: 'smooth', watch: [messages] });\r\n\r\n\tconst prevMessagesLengthRef = useRef(0);\r\n\r\n\tuseEffect(() => {\r\n\t\t// Force scroll when a new message is appended (length increase)\r\n\t\tif (messages.length > prevMessagesLengthRef.current) {\r\n\t\t\trequestAnimationFrame(() => scrollToBottom());\r\n\t\t}\r\n\t\tprevMessagesLengthRef.current = messages.length;\r\n\t}, [messages.length, scrollToBottom]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (previewUrl && !hasSeenPreview.current && isPhase1Complete) {\r\n\t\t\tsetView('preview');\r\n\t\t\tsetShowTooltip(true);\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tsetShowTooltip(false);\r\n\t\t\t}, 3000); // Auto-hide tooltip after 3 seconds\r\n\t\t}\r\n\t}, [previewUrl, isPhase1Complete]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (chatId) {\r\n\t\t\tnavigate(`/chat/${chatId}`, {\r\n\t\t\t\treplace: true,\r\n\t\t\t});\r\n\t\t}\r\n\t}, [chatId, navigate]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!edit) return;\r\n\t\tif (files.some((file) => file.filePath === edit.filePath)) {\r\n\t\t\tsetActiveFilePath(edit.filePath);\r\n\t\t\tsetView('editor');\r\n\t\t}\r\n\t}, [edit, files]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (\r\n\t\t\tisBootstrapping &&\r\n\t\t\tstreamedBootstrapFiles.length > 0 &&\r\n\t\t\t!hasSwitchedFile.current\r\n\t\t) {\r\n\t\t\tsetActiveFilePath(streamedBootstrapFiles.at(-1)!.filePath);\r\n\t\t} else if (\r\n\t\t\tview === 'editor' &&\r\n\t\t\t!activeFile &&\r\n\t\t\tfiles.length > 0 &&\r\n\t\t\t!hasSwitchedFile.current\r\n\t\t) {\r\n\t\t\tsetActiveFilePath(files.at(-1)!.filePath);\r\n\t\t}\r\n\t}, [view, activeFile, files, isBootstrapping, streamedBootstrapFiles]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (view !== 'blueprint' && isGeneratingBlueprint) {\r\n\t\t\tsetView('blueprint');\r\n\t\t} else if (\r\n\t\t\t!hasSwitchedFile.current &&\r\n\t\t\tview === 'blueprint' &&\r\n\t\t\t!isGeneratingBlueprint\r\n\t\t) {\r\n\t\t\tsetView('editor');\r\n\t\t}\r\n\t}, [isGeneratingBlueprint, view]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (doneStreaming && !isGeneratingBlueprint && !blueprint) {\r\n\t\t\tonCompleteBootstrap();\r\n\t\t\tsendAiMessage(\r\n\t\t\t\tcreateAIMessage(\r\n\t\t\t\t\t'creating-blueprint',\r\n\t\t\t\t\t'Bootstrapping complete, now creating a blueprint for you...',\r\n\t\t\t\t\ttrue,\r\n\t\t\t\t),\r\n\t\t\t);\r\n\t\t}\r\n\t}, [\r\n\t\tdoneStreaming,\r\n\t\tisGeneratingBlueprint,\r\n\t\tsendAiMessage,\r\n\t\tblueprint,\r\n\t\tonCompleteBootstrap,\r\n\t]);\r\n\r\n\tconst isRunning = useMemo(() => {\r\n\t\treturn (\r\n\t\t\tisBootstrapping || isGeneratingBlueprint // || codeGenState === 'active'\r\n\t\t);\r\n\t}, [isBootstrapping, isGeneratingBlueprint]);\r\n\r\n\t// Check if chat input should be disabled (before blueprint completion and agentId assignment)\r\n\tconst isChatDisabled = useMemo(() => {\r\n\t\tconst blueprintStage = projectStages.find(\r\n\t\t\t(stage) => stage.id === 'blueprint',\r\n\t\t);\r\n\t\tconst isBlueprintComplete = blueprintStage?.status === 'completed';\r\n\t\tconst hasAgentId = !!chatId;\r\n\r\n\t\t// Disable until both blueprint is complete AND we have an agentId\r\n\t\treturn !isBlueprintComplete || !hasAgentId;\r\n\t}, [projectStages, chatId]);\r\n\r\n\tconst chatFormRef = useRef<HTMLFormElement>(null);\r\n\tconst { isDragging: isChatDragging, dragHandlers: chatDragHandlers } = useDragDrop({\r\n\t\tonFilesDropped: addImages,\r\n\t\taccept: [...SUPPORTED_IMAGE_MIME_TYPES],\r\n\t\tdisabled: isChatDisabled,\r\n\t});\r\n\r\n\tconst onNewMessage = useCallback(\r\n\t\t(e: FormEvent) => {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\t// Don't submit if chat is disabled or message is empty\r\n\t\t\tif (isChatDisabled || !newMessage.trim()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// When generation is active, send as conversational AI suggestion\r\n\t\t\twebsocket?.send(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\ttype: 'user_suggestion',\r\n\t\t\t\t\tmessage: newMessage,\r\n\t\t\t\t\timages: images.length > 0 ? images : undefined,\r\n\t\t\t\t}),\r\n\t\t\t);\r\n\t\t\tsendUserMessage(newMessage);\r\n\t\t\tsetNewMessage('');\r\n\t\t\t// Clear images after sending\r\n\t\t\tif (images.length > 0) {\r\n\t\t\t\tclearImages();\r\n\t\t\t}\r\n\t\t\t// Ensure we scroll after sending our own message\r\n\t\t\trequestAnimationFrame(() => scrollToBottom());\r\n\t\t},\r\n\t\t[newMessage, websocket, sendUserMessage, isChatDisabled, scrollToBottom, images, clearImages],\r\n\t);\r\n\r\n\tconst [progress, total] = useMemo((): [number, number] => {\r\n\t\t// Calculate phase progress instead of file progress\r\n\t\tconst completedPhases = phaseTimeline.filter(p => p.status === 'completed').length;\r\n\r\n\t\t// Get predicted phase count from blueprint, fallback to current phase count\r\n\t\tconst predictedPhaseCount = blueprint?.implementationRoadmap?.length || 0;\r\n\t\tconst totalPhases = Math.max(predictedPhaseCount, phaseTimeline.length, 1);\r\n\r\n\t\treturn [completedPhases, totalPhases];\r\n\t}, [phaseTimeline, blueprint?.implementationRoadmap]);\r\n\r\n\tif (import.meta.env.DEV) {\r\n\t\tlogger.debug({\r\n\t\t\tmessages,\r\n\t\t\tfiles,\r\n\t\t\tblueprint,\r\n\t\t\tquery,\r\n\t\t\tuserQuery,\r\n\t\t\tchatId,\r\n\t\t\tpreviewUrl,\r\n\t\t\tgeneratingFile,\r\n\t\t\tactiveFile,\r\n\t\t\tbootstrapFiles,\r\n\t\t\tstreamedBootstrapFiles,\r\n\t\t\tisGeneratingBlueprint,\r\n\t\t\tview,\r\n\t\t\ttotalFiles,\r\n\t\t\tgeneratingCount,\r\n\t\t\tisBootstrapping,\r\n\t\t\tactiveFilePath,\r\n\t\t\tprogress,\r\n\t\t\ttotal,\r\n\t\t\tisRunning,\r\n\t\t\tprojectStages,\r\n\t\t});\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"size-full flex flex-col min-h-0 text-text-primary\">\r\n\t\t\t<div className=\"flex-1 flex min-h-0 overflow-hidden justify-center\">\r\n\t\t\t\t<motion.div\r\n\t\t\t\t\tlayout=\"position\"\r\n\t\t\t\t\tclassName=\"flex-1 shrink-0 flex flex-col basis-0 max-w-lg relative z-10 h-full min-h-0\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div className=\"flex-1 overflow-y-auto min-h-0 chat-messages-scroll\" ref={messagesContainerRef}>\r\n\t\t\t\t\t\t<div className=\"pt-5 px-4 pb-4 text-sm flex flex-col gap-5\">\r\n\t\t\t\t\t\t\t{appLoading ? (\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t<LoaderCircle className=\"size-4 animate-spin\" />\r\n\t\t\t\t\t\t\t\t\tLoading app...\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{appTitle && (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"text-lg font-semibold mb-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t{appTitle}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t<UserMessage\r\n\t\t\t\t\t\t\t\t\t\tmessage={query ?? displayQuery}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{import.meta.env\r\n\t\t\t\t\t\t\t\t\t\t.VITE_AGENT_MODE_ENABLED && (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between items-center py-2 border-b border-border-primary/50 mb-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t<AgentModeDisplay\r\n\t\t\t\t\t\t\t\t\t\t\t\tmode={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tagentMode as\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t| 'deterministic'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t| 'smart'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{mainMessage && (\r\n\t\t\t\t\t\t\t\t<AIMessage\r\n\t\t\t\t\t\t\t\t\tmessage={mainMessage.content}\r\n\t\t\t\t\t\t\t\t\tisThinking={mainMessage.ui?.isThinking}\r\n\t\t\t\t\t\t\t\t\ttoolEvents={mainMessage.ui?.toolEvents}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t<PhaseTimeline\r\n\t\t\t\t\t\t\t\tprojectStages={projectStages}\r\n\t\t\t\t\t\t\t\tphaseTimeline={phaseTimeline}\r\n\t\t\t\t\t\t\t\tfiles={files}\r\n\t\t\t\t\t\t\t\tview={view}\r\n\t\t\t\t\t\t\t\tactiveFile={activeFile}\r\n\t\t\t\t\t\t\t\tonFileClick={handleFileClick}\r\n\t\t\t\t\t\t\t\tisThinkingNext={isThinking}\r\n\t\t\t\t\t\t\t\tisPreviewDeploying={isPreviewDeploying}\r\n\t\t\t\t\t\t\t\tprogress={progress}\r\n\t\t\t\t\t\t\t\ttotal={total}\r\n\t\t\t\t\t\t\t\tparentScrollRef={messagesContainerRef}\r\n\t\t\t\t\t\t\t\tonViewChange={(viewMode) => {\r\n\t\t\t\t\t\t\t\t\tsetView(viewMode);\r\n\t\t\t\t\t\t\t\t\thasSwitchedFile.current = true;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tchatId={chatId}\r\n\t\t\t\t\t\t\t\tisDeploying={isDeploying}\r\n\t\t\t\t\t\t\t\thandleDeployToCloudflare={handleDeployToCloudflare}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t{/* Deployment and Generation Controls */}\r\n\t\t\t\t\t\t\t{chatId && (\r\n\t\t\t\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\t\t\t\tref={deploymentControlsRef}\r\n\t\t\t\t\t\t\t\t\tinitial={{ opacity: 0, y: 20 }}\r\n\t\t\t\t\t\t\t\t\tanimate={{ opacity: 1, y: 0 }}\r\n\t\t\t\t\t\t\t\t\ttransition={{ duration: 0.3, delay: 0.2 }}\r\n\t\t\t\t\t\t\t\t\tclassName=\"px-4 mb-6\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<DeploymentControls\r\n\t\t\t\t\t\t\t\t\t\tisPhase1Complete={isPhase1Complete}\r\n\t\t\t\t\t\t\t\t\t\tisDeploying={isDeploying}\r\n\t\t\t\t\t\t\t\t\t\tdeploymentUrl={cloudflareDeploymentUrl}\r\n\t\t\t\t\t\t\t\t\t\tinstanceId={chatId || ''}\r\n\t\t\t\t\t\t\t\t\t\tisRedeployReady={isRedeployReady}\r\n\t\t\t\t\t\t\t\t\t\tdeploymentError={deploymentError}\r\n\t\t\t\t\t\t\t\t\t\tappId={app?.id || chatId}\r\n\t\t\t\t\t\t\t\t\t\tappVisibility={app?.visibility}\r\n\t\t\t\t\t\t\t\t\t\tisGenerating={\r\n\t\t\t\t\t\t\t\t\t\t\tisGenerating ||\r\n\t\t\t\t\t\t\t\t\t\t\tisGeneratingBlueprint\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tisPaused={isGenerationPaused}\r\n\t\t\t\t\t\t\t\t\t\tonDeploy={handleDeployToCloudflare}\r\n\t\t\t\t\t\t\t\t\t\tonStopGeneration={handleStopGeneration}\r\n\t\t\t\t\t\t\t\t\t\tonResumeGeneration={\r\n\t\t\t\t\t\t\t\t\t\t\thandleResumeGeneration\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tonVisibilityUpdate={(newVisibility) => {\r\n\t\t\t\t\t\t\t\t\t\t\t// Update app state if needed\r\n\t\t\t\t\t\t\t\t\t\t\tif (app) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tapp.visibility = newVisibility;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</motion.div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{otherMessages.map((message) => {\r\n\t\t\t\t\t\t\t\tif (message.role === 'assistant') {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<AIMessage\r\n\t\t\t\t\t\t\t\t\t\t\tkey={message.conversationId}\r\n\t\t\t\t\t\t\t\t\t\t\tmessage={message.content}\r\n\t\t\t\t\t\t\t\t\t\t\tisThinking={message.ui?.isThinking}\r\n\t\t\t\t\t\t\t\t\t\t\ttoolEvents={message.ui?.toolEvents}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<UserMessage\r\n\t\t\t\t\t\t\t\t\t\tkey={message.conversationId}\r\n\t\t\t\t\t\t\t\t\t\tmessage={message.content}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<form\r\n                        ref={chatFormRef}\r\n                        onSubmit={onNewMessage}\r\n                        className=\"shrink-0 p-4 pb-5 bg-transparent\"\r\n                        {...chatDragHandlers}\r\n                    >\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tref={imageInputRef}\r\n\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\taccept={SUPPORTED_IMAGE_MIME_TYPES.join(',')}\r\n\t\t\t\t\t\tmultiple\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tconst files = Array.from(e.target.files || []);\r\n\t\t\t\t\t\t\tif (files.length > 0) {\r\n\t\t\t\t\t\t\t\taddImages(files);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\te.target.value = '';\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tclassName=\"hidden\"\r\n\t\t\t\t\t\tdisabled={isChatDisabled}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t{isChatDragging && (\r\n\t\t\t\t\t\t\t<div className=\"absolute inset-0 flex items-center justify-center bg-accent/10 backdrop-blur-sm rounded-xl z-50 pointer-events-none\">\r\n\t\t\t\t\t\t\t\t<p className=\"text-accent font-medium\">Drop images here</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{images.length > 0 && (\r\n\t\t\t\t\t\t\t<div className=\"mb-2\">\r\n\t\t\t\t\t\t\t\t<ImageAttachmentPreview\r\n\t\t\t\t\t\t\t\t\timages={images}\r\n\t\t\t\t\t\t\t\t\tonRemove={removeImage}\r\n\t\t\t\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\tvalue={newMessage}\r\n\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\tconst newValue = e.target.value;\r\n\t\t\t\t\t\t\t\tconst newWordCount = countWords(newValue);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// Only update if within word limit\r\n\t\t\t\t\t\t\t\tif (newWordCount <= MAX_WORDS) {\r\n\t\t\t\t\t\t\t\t\tsetNewMessage(newValue);\r\n\t\t\t\t\t\t\t\t\tconst ta = e.currentTarget;\r\n\t\t\t\t\t\t\t\t\tta.style.height = 'auto';\r\n\t\t\t\t\t\t\t\t\tta.style.height = Math.min(ta.scrollHeight, 120) + 'px';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonKeyDown={(e) => {\r\n\t\t\t\t\t\t\t\t\tif (e.key === 'Enter') {\r\n\t\t\t\t\t\t\t\t\t\tif (!e.shiftKey) {\r\n\t\t\t\t\t\t\t\t\t\t\t// Submit on Enter without Shift\r\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\tonNewMessage(e);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t// Shift+Enter will create a new line (default textarea behavior)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tdisabled={isChatDisabled}\r\n\t\t\t\t\t\t\t\tplaceholder={\r\n\t\t\t\t\t\t\t\t\tisChatDisabled\r\n\t\t\t\t\t\t\t\t\t\t? 'Please wait for blueprint completion...'\r\n\t\t\t\t\t\t\t\t\t\t: isRunning\r\n\t\t\t\t\t\t\t\t\t\t\t? 'Chat with AI while generating...'\r\n\t\t\t\t\t\t\t\t\t\t\t: 'Ask a follow up...'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\trows={1}\r\n\t\t\t\t\t\t\t\tclassName=\"w-full bg-bg-2 border border-text-primary/10 rounded-xl px-3 pr-20 py-2 text-sm outline-none focus:border-white/20 drop-shadow-2xl text-text-primary placeholder:!text-text-primary/50 disabled:opacity-50 disabled:cursor-not-allowed resize-none overflow-y-auto no-scrollbar min-h-[36px] max-h-[120px]\"\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t// Auto-resize based on content\r\n\t\t\t\t\t\t\t\t\theight: 'auto',\r\n\t\t\t\t\t\t\t\t\tminHeight: '36px'\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tref={(textarea) => {\r\n\t\t\t\t\t\t\t\t\tif (textarea) {\r\n\t\t\t\t\t\t\t\t\t\t// Auto-resize textarea based on content\r\n\t\t\t\t\t\t\t\t\t\ttextarea.style.height = 'auto';\r\n\t\t\t\t\t\t\t\t\t\ttextarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<div className=\"absolute right-1.5 bottom-2.5 flex items-center gap-1\">\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => imageInputRef.current?.click()}\r\n\t\t\t\t\t\t\t\t\tdisabled={isChatDisabled || isProcessing}\r\n\t\t\t\t\t\t\t\t\tclassName=\"p-1.5 rounded-md hover:bg-bg-3 text-text-secondary hover:text-text-primary transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\t\t\t\t\t\taria-label=\"Upload image\"\r\n\t\t\t\t\t\t\t\t\ttitle=\"Upload image\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<ImageIcon className=\"size-4\" strokeWidth={1.5} />\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\t\tdisabled={!newMessage.trim() || isChatDisabled}\r\n\t\t\t\t\t\t\t\t\tclassName=\"p-1.5 rounded-md bg-accent/90 hover:bg-accent/80 disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-transparent text-white disabled:text-text-primary transition-colors\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<ArrowRight className=\"size-4\" />\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</motion.div>\r\n\r\n\t\t\t\t<AnimatePresence>\r\n\t\t\t\t\t{showMainView && (\r\n\t\t\t\t\t<motion.div\r\n\t\t\t\t\t\tlayout=\"position\"\r\n\t\t\t\t\t\tclassName=\"flex-1 flex shrink-0 basis-0 p-4 pl-0 ml-2 z-30 min-h-0\"\r\n\t\t\t\t\t\tinitial={{ opacity: 0, scale: 0.84 }}\r\n\t\t\t\t\t\tanimate={{ opacity: 1, scale: 1 }}\r\n\t\t\t\t\t\ttransition={{ duration: 0.3, ease: 'easeInOut' }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{view === 'preview' && previewUrl && (\r\n\t\t\t\t\t\t\t\t<div className=\"flex-1 flex flex-col bg-bg-3 rounded-xl shadow-md shadow-bg-2 overflow-hidden border border-border-primary\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-3 px-2 h-10 border-b bg-bg-2\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<ViewModeSwitch\r\n\t\t\t\t\t\t\t\t\t\t\t\tview={view}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={handleViewModeChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\tpreviewAvailable={!!previewUrl}\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowTooltip={showTooltip}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-mono text-text-50/70\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{blueprint?.title ??\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Preview'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Copy text={previewUrl} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"p-1 hover:bg-bg-2 rounded transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetManualRefreshTrigger(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDate.now(),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Refresh preview\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<RefreshCw className=\"size-4 text-text-primary/50\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-end gap-1.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t{/* <button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center gap-1.5 px-2 py-1 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white rounded-md transition-all duration-200 text-xs font-medium shadow-sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleDeployToCloudflare(chatId!)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={isDeploying}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Save & Deploy\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{isDeploying ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<LoaderCircle className=\"size-3 animate-spin\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Save className=\"size-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{isDeploying ? 'Deploying...' : 'Save'}\r\n\t\t\t\t\t\t\t\t\t\t\t</button> */}\r\n\t\t\t\t\t\t\t\t\t\t\t<ModelConfigInfo\r\n\t\t\t\t\t\t\t\t\t\t\t\tconfigs={modelConfigs}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonRequestConfigs={handleRequestConfigs}\r\n\t\t\t\t\t\t\t\t\t\t\t\tloading={loadingConfigs}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={`flex items-center gap-1.5 px-2 py-1 rounded-md transition-all duration-200 text-xs font-medium shadow-sm ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tisGitHubExportReady\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-gray-800 hover:bg-gray-900 text-white'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-gray-600 text-gray-400 cursor-not-allowed'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={isGitHubExportReady ? githubExport.openModal : undefined}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={!isGitHubExportReady}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tisGitHubExportReady\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"Export to GitHub\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: !isPhase1Complete\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"Complete Phase 1 to enable GitHub export\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"Waiting for chat session to initialize...\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\taria-label={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tisGitHubExportReady\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"Export to GitHub\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: !isPhase1Complete\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"GitHub export disabled - complete Phase 1 first\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"GitHub export disabled - waiting for chat session\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Github className=\"size-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\tGitHub\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"p-1 hover:bg-bg-2 rounded transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpreviewRef.current?.requestFullscreen();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Fullscreen\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Expand className=\"size-4 text-text-primary/50\" />\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<PreviewIframe\r\n\t\t\t\t\t\t\t\t\t\tsrc={previewUrl}\r\n\t\t\t\t\t\t\t\t\t\tref={previewRef}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex-1 w-full h-full border-0\"\r\n\t\t\t\t\t\t\t\t\t\ttitle=\"Preview\"\r\n\t\t\t\t\t\t\t\t\t\tshouldRefreshPreview={\r\n\t\t\t\t\t\t\t\t\t\t\tshouldRefreshPreview\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tmanualRefreshTrigger={\r\n\t\t\t\t\t\t\t\t\t\t\tmanualRefreshTrigger\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\twebSocket={websocket}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{view === 'blueprint' && (\r\n\t\t\t\t\t\t\t\t<div className=\"flex-1 flex flex-col bg-bg-3 rounded-xl shadow-md shadow-bg-2 overflow-hidden border border-border-primary\">\r\n\t\t\t\t\t\t\t\t\t{/* Toolbar */}\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center px-2 h-10 bg-bg-2 border-b\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-text-50/70 font-mono\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tBlueprint.md\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t{previewUrl && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Copy text={previewUrl} />\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-1 overflow-y-auto bg-bg-3\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"py-12 mx-auto\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Blueprint\r\n\t\t\t\t\t\t\t\t\t\t\t\tblueprint={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tblueprint ??\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t({} as BlueprintType)\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full max-w-2xl mx-auto\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\r\n                            {/* Disabled terminal for now */}\r\n\t\t\t\t\t\t\t{/* {view === 'terminal' && (\r\n\t\t\t\t\t\t\t\t<div className=\"flex-1 flex flex-col bg-bg-3 rounded-xl shadow-md shadow-bg-2 overflow-hidden border border-border-primary\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-3 px-2 h-10 bg-bg-2 border-b\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<ViewModeSwitch\r\n\t\t\t\t\t\t\t\t\t\t\t\tview={view}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={handleViewModeChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\tpreviewAvailable={!!previewUrl}\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowTooltip={showTooltip}\r\n\t\t\t\t\t\t\t\t\t\t\t\tterminalAvailable={true}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-mono text-text-50/70\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tTerminal\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className={clsx(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'flex items-center gap-1.5 px-2 py-1 rounded-full text-xs font-medium',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twebsocket && websocket.readyState === WebSocket.OPEN\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300'\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className={clsx(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'size-1.5 rounded-full',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twebsocket && websocket.readyState === WebSocket.OPEN ? 'bg-green-500' : 'bg-red-500'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{websocket && websocket.readyState === WebSocket.OPEN ? 'Connected' : 'Disconnected'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-end gap-1.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst logText = terminalLogs\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map(log => `[${new Date(log.timestamp).toLocaleTimeString()}] ${log.content}`)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.join('\\n');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.clipboard.writeText(logText);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"h-7 w-7 p-0 rounded-md transition-all duration-200\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"text-gray-500 hover:text-gray-700\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"dark:text-gray-400 dark:hover:text-gray-200\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"hover:bg-gray-100 dark:hover:bg-gray-700\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Copy all logs\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Copy text=\"\" />\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t<ModelConfigInfo\r\n\t\t\t\t\t\t\t\t\t\t\t\tconfigs={modelConfigs}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonRequestConfigs={handleRequestConfigs}\r\n\t\t\t\t\t\t\t\t\t\t\t\tloading={loadingConfigs}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t\t\t\t\t\t<Terminal\r\n\t\t\t\t\t\t\t\t\t\t\tlogs={terminalLogs}\r\n\t\t\t\t\t\t\t\t\t\t\tonCommand={handleTerminalCommand}\r\n\t\t\t\t\t\t\t\t\t\t\tisConnected={!!websocket && websocket.readyState === WebSocket.OPEN}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-full\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)} */}\r\n\r\n\t\t\t\t\t\t\t{view === 'editor' && (\r\n\t\t\t\t\t\t\t\t<div className=\"flex-1 flex flex-col bg-bg-3 rounded-xl shadow-md shadow-bg-2 overflow-hidden border border-border-primary\">\r\n\t\t\t\t\t\t\t\t\t{activeFile && (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-3 px-2 h-10 bg-bg-2 border-b\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ViewModeSwitch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tview={view}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleViewModeChange\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpreviewAvailable={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t!!previewUrl\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowTooltip={showTooltip}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-mono text-text-50/70\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeFile.filePath}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{previewUrl && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Copy\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext={previewUrl}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-end gap-1.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{/* <button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center gap-1.5 px-2 py-1 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white rounded-md transition-all duration-200 text-xs font-medium shadow-sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleDeployToCloudflare(chatId!)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={isDeploying}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Save & Deploy\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{isDeploying ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<LoaderCircle className=\"size-3 animate-spin\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Save className=\"size-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{isDeploying ? 'Deploying...' : 'Save'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`flex items-center gap-1.5 px-2 py-1 rounded-md transition-all duration-200 text-xs font-medium shadow-sm ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisPhase1Complete\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-gray-800 hover:bg-gray-900 text-white'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-gray-600 text-gray-400 cursor-not-allowed'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={isPhase1Complete ? githubExport.openModal : undefined}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={!isPhase1Complete}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={isPhase1Complete ? \"Export to GitHub\" : \"Complete Phase 1 to enable GitHub export\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-label={isPhase1Complete ? \"Export to GitHub\" : \"GitHub export disabled - complete Phase 1 first\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Github className=\"size-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tGitHub\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button> */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ModelConfigInfo\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconfigs={modelConfigs}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonRequestConfigs={handleRequestConfigs}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tloading={loadingConfigs}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"p-1 hover:bg-bg-2 rounded transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\teditorRef.current?.requestFullscreen();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Fullscreen\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Expand className=\"size-4 text-text-primary/50\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex-1 relative\">\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute inset-0 flex\"\r\n\t\t\t\t\t\t\t\t\t\t\tref={editorRef}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<FileExplorer\r\n\t\t\t\t\t\t\t\t\t\t\t\tfiles={files}\r\n\t\t\t\t\t\t\t\t\t\t\t\tbootstrapFiles={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstreamedBootstrapFiles\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcurrentFile={activeFile}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonFileClick={handleFileClick}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<MonacoEditor\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-full\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcreateOptions={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactiveFile?.fileContents ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlanguage:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactiveFile?.language ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'plaintext',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treadOnly: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tminimap: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tenabled: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlineNumbers: 'on',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tscrollBeyondLastLine: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: 13,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttheme: 'v1-dev',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tautomaticLayout: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfind={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tedit &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tedit.filePath ===\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactiveFile?.filePath\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? edit.search\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treplace={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tedit &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tedit.filePath ===\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactiveFile?.filePath\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? edit.replacement\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</motion.div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</AnimatePresence>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Debug Panel */}\r\n\t\t\t<DebugPanel\r\n\t\t\t\tmessages={debugMessages}\r\n\t\t\t\tonClear={clearDebugMessages}\r\n\t\t\t\tchatSessionId={chatId}\r\n\t\t\t/>\r\n\r\n\t\t\t{/* GitHub Export Modal */}\r\n\t\t\t<GitHubExportModal\r\n\t\t\t\tisOpen={githubExport.isModalOpen}\r\n\t\t\t\tonClose={githubExport.closeModal}\r\n\t\t\t\tonExport={githubExport.startExport}\r\n\t\t\t\tisExporting={githubExport.isExporting}\r\n\t\t\t\texportProgress={githubExport.progress}\r\n\t\t\t\texportResult={githubExport.result}\r\n\t\t\t\tonRetry={githubExport.retry}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n}","import * as React from \"react\"\r\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Label({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\r\n  return (\r\n    <LabelPrimitive.Root\r\n      data-slot=\"label\"\r\n      className={cn(\r\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Label }\r\n","import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\r\n  return (\r\n    <textarea\r\n      data-slot=\"textarea\"\r\n      className={cn(\r\n        \"border-input placeholder:text-text-tertiary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Textarea }\r\n","import { useState, useEffect, useCallback } from 'react';\r\nimport { useAuth } from '@/contexts/auth-context';\r\nimport { apiClient } from '@/lib/api-client';\r\nimport type { UserStats, UserActivity } from '@/api-types';\r\n\r\nexport function useUserStats() {\r\n  const { isAuthenticated } = useAuth();\r\n  const [stats, setStats] = useState<UserStats | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const fetchStats = useCallback(async () => {\r\n    if (!isAuthenticated) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await apiClient.getUserStats();\r\n      setStats(response.data || null);\r\n    } catch (err) {\r\n      console.error('Error fetching stats:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to fetch stats');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [isAuthenticated]);\r\n\r\n  useEffect(() => {\r\n    fetchStats();\r\n  }, [fetchStats]);\r\n\r\n  return { stats, loading, error, refetch: fetchStats };\r\n}\r\n\r\nexport function useUserActivity() {\r\n  const { isAuthenticated } = useAuth();\r\n  const [activities, setActivities] = useState<UserActivity[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const fetchActivity = useCallback(async () => {\r\n    if (!isAuthenticated) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await apiClient.getUserActivity();\r\n      setActivities(response.data?.activities || []);\r\n    } catch (err) {\r\n      console.error('Error fetching activity:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to fetch activity');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [isAuthenticated]);\r\n\r\n  useEffect(() => {\r\n    fetchActivity();\r\n  }, [fetchActivity]);\r\n\r\n  return { activities, loading, error, refetch: fetchActivity };\r\n}","import React from 'react';\r\nimport { useAuth } from '@/contexts/auth-context';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { \r\n  Mail, \r\n  Calendar,\r\n  Shield,\r\n  Activity,\r\n  Code2,\r\n  Star,\r\n  Trophy,\r\n  Settings,\r\n  Edit3,\r\n  Save,\r\n  X,\r\n  Globe,\r\n  Zap,\r\n} from 'lucide-react';\r\nimport { useNavigate } from 'react-router';\r\nimport { capitalizeFirstLetter, cn } from '@/lib/utils';\r\nimport { format } from 'date-fns';\r\nimport { toast } from 'sonner';\r\nimport { useUserStats, useUserActivity } from '@/hooks/use-stats';\r\nimport { apiClient } from '@/lib/api-client';\r\nimport { useApps } from '@/hooks/use-apps';\r\n\r\nexport default function Profile() {\r\n  const { user, refreshUser } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [isEditing, setIsEditing] = React.useState(false);\r\n  const [profileData, setProfileData] = React.useState({\r\n    displayName: user?.displayName || '',\r\n    username: user?.username || '',\r\n    bio: user?.bio || '',\r\n    timezone: user?.timezone || 'UTC'\r\n  });\r\n  const [isSaving, setIsSaving] = React.useState(false);\r\n\r\n  // Update profile data when user changes\r\n  React.useEffect(() => {\r\n    if (user) {\r\n      setProfileData({\r\n        displayName: user.displayName || '',\r\n        username: user.username || '',\r\n        bio: user.bio || '',\r\n        timezone: user.timezone || 'UTC'\r\n      });\r\n    }\r\n  }, [user]);\r\n\r\n  const { stats, loading: statsLoading } = useUserStats();\r\n  const { activities = [], loading: activityLoading } = useUserActivity();\r\n  const { apps: recentApps, loading: appsLoading } = useApps();\r\n\r\n  // Transform achievements from stats\r\n  const achievements = stats?.achievements || [];\r\n\r\n  const handleSave = async () => {\r\n    if (isSaving) return;\r\n    \r\n    try {\r\n      setIsSaving(true);\r\n      \r\n      const response = await apiClient.updateProfile({\r\n        displayName: profileData.displayName,\r\n        username: profileData.username,\r\n        bio: profileData.bio,\r\n        timezone: profileData.timezone\r\n      });\r\n      \r\n      if (response.success) {\r\n        toast.success('Profile updated successfully');\r\n        // Refresh user data in auth context\r\n        await refreshUser();\r\n        setIsEditing(false);\r\n      }\r\n    } catch (error) {\r\n      console.error('Profile update error:', error);\r\n      toast.error('Failed to update profile');\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setProfileData({\r\n      displayName: user?.displayName || '',\r\n      username: user?.username || '',\r\n      bio: user?.bio || '',\r\n      timezone: user?.timezone || 'UTC'\r\n    });\r\n    setIsEditing(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-bg-3\">\r\n      {/* Profile Header */}\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <div className=\"pb-8\">\r\n          <div className=\"flex flex-col md:flex-row items-center gap-6\">\r\n            <Avatar className=\"h-24 w-24 ring-4 ring-background shadow-xl\">\r\n              <AvatarImage src={user?.avatarUrl} />\r\n              <AvatarFallback className=\"text-2xl bg-gradient-to-br from-[#f48120] to-[#faae42] text-white\">\r\n                {user?.displayName?.charAt(0).toUpperCase() || user?.email?.charAt(0).toUpperCase() || '?'}\r\n              </AvatarFallback>\r\n            </Avatar>\r\n            \r\n            <div className=\"flex-1 text-center md:text-left\">\r\n              <div className=\"flex flex-col md:flex-row items-center gap-4 mb-2\">\r\n                <h1 className=\"text-3xl font-bold\">{user?.displayName}</h1>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Badge variant=\"secondary\" className=\"gap-1\">\r\n                    {user?.provider === 'github' ? <svg className=\"h-3 w-3\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\"/></svg> : <Globe className=\"h-3 w-3\" />}\r\n                    {capitalizeFirstLetter(user?.provider ?? '')}\r\n                  </Badge>\r\n                  {user?.emailVerified && (\r\n                    <Badge variant=\"secondary\" className=\"gap-1\">\r\n                      <Shield className=\"h-3 w-3\" />\r\n                      Verified\r\n                    </Badge>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <p className=\"text-text-tertiary mb-1\">{user?.email}</p>\r\n              {user?.bio && <p className=\"text-sm max-w-2xl\">{user.bio}</p>}\r\n            </div>\r\n\r\n            <div className=\"flex gap-2\">\r\n              {isEditing ? (\r\n                <>\r\n                  <Button onClick={handleSave} size=\"sm\" disabled={isSaving}>\r\n                    <Save className=\"mr-2 h-4 w-4\" />\r\n                    {isSaving ? 'Saving...' : 'Save Changes'}\r\n                  </Button>\r\n                  <Button variant=\"outline\" onClick={handleCancel} size=\"sm\">\r\n                    <X className=\"mr-2 h-4 w-4\" />\r\n                    Cancel\r\n                  </Button>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Button variant=\"outline\" onClick={() => setIsEditing(true)} size=\"sm\">\r\n                    <Edit3 className=\"mr-2 h-4 w-4\" />\r\n                    Edit Profile\r\n                  </Button>\r\n                  <Button variant=\"outline\" onClick={() => navigate('/settings')} size=\"sm\">\r\n                    <Settings className=\"mr-2 h-4 w-4\" />\r\n                    Settings\r\n                  </Button>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        {/* Stats Overview */}\r\n        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8\">\r\n          <Card className=\"text-center hover:shadow-lg hover:scale-[1.02] transition-all dark:bg-bg-4/50\">\r\n            <CardContent className=\"pt-6 relative overflow-hidden\">\r\n              <Code2 className=\"h-32 w-32 text-blue-500 absolute -top-10 -left-6 opacity-10\" />\r\n              <p className=\"text-6xl font-semibold text-gray-700\">{statsLoading ? '-' : stats?.appCount}</p>\r\n              <p className=\"text-md text-gray-500\">Total Apps</p>\r\n            </CardContent>\r\n          </Card>\r\n          \r\n          <Card className=\"text-center hover:shadow-lg hover:scale-[1.02] transition-all dark:bg-bg-4/50\">\r\n            <CardContent className=\"pt-6 relative overflow-hidden\">\r\n              <Globe className=\"h-32 w-32 text-green-500 absolute -top-10 -left-6 opacity-20\" />\r\n              <p className=\"text-6xl font-semibold text-gray-700\">{statsLoading ? '-' : stats?.publicAppCount}</p>\r\n              <p className=\"text-md text-gray-500\">Public Apps</p>\r\n            </CardContent>\r\n          </Card>\r\n          \r\n          <Card className=\"text-center hover:shadow-lg hover:scale-[1.02] transition-all dark:bg-bg-4/50\">\r\n            <CardContent className=\"pt-6 relative overflow-hidden\">\r\n              <Activity className=\"h-32 w-32 text-purple-500 absolute -top-10 -left-6 opacity-10\" />\r\n              <p className=\"text-6xl font-semibold text-gray-700\">{statsLoading ? '-' : stats?.totalViewsReceived}</p>\r\n              <p className=\"text-md text-gray-500\">Total Views</p>\r\n            </CardContent>\r\n          </Card>\r\n          \r\n          <Card className=\"text-center hover:shadow-lg hover:scale-[1.02] transition-all dark:bg-bg-4/50\">\r\n            <CardContent className=\"pt-6 relative overflow-hidden\">\r\n              <Star className=\"h-32 w-32 text-yellow-500 absolute -top-10 -left-6 opacity-20\" />\r\n              <p className=\"text-6xl font-semibold text-gray-700\">{statsLoading ? '-' : stats?.totalLikesReceived}</p>\r\n              <p className=\"text-md text-gray-500\">Total Likes</p>\r\n            </CardContent>\r\n          </Card>\r\n          \r\n        </div>\r\n\r\n        <Tabs defaultValue=\"about\" className=\"space-y-6\">\r\n          <TabsList className=\"grid w-full max-w-md grid-cols-4\">\r\n            <TabsTrigger value=\"about\">About</TabsTrigger>\r\n            <TabsTrigger value=\"apps\">Apps</TabsTrigger>\r\n            <TabsTrigger value=\"achievements\">Achievements</TabsTrigger>\r\n            <TabsTrigger value=\"activity\">Activity</TabsTrigger>\r\n          </TabsList>\r\n\r\n          <TabsContent value=\"about\" className=\"space-y-6\">\r\n            <Card className=\"dark:bg-bg-4/50 max-w-xl\">\r\n              <CardHeader className='border-b'>\r\n                <CardTitle>Profile Information</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-6\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"displayName\">Display Name</Label>\r\n                    {isEditing ? (\r\n                      <Input\r\n                        id=\"displayName\"\r\n                        value={profileData.displayName}\r\n                        onChange={(e) => setProfileData({ ...profileData, displayName: e.target.value })}\r\n                      />\r\n                    ) : (\r\n                      <p className=\"text-sm text-text-tertiary\">{user?.displayName}</p>\r\n                    )}\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"username\">Username</Label>\r\n                    {isEditing ? (\r\n                      <Input\r\n                        id=\"username\"\r\n                        value={profileData.username}\r\n                        onChange={(e) => setProfileData({ ...profileData, username: e.target.value })}\r\n                        placeholder=\"@username\"\r\n                      />\r\n                    ) : (\r\n                      <p className=\"text-sm text-text-tertiary\">{user?.username || 'Not set'}</p>\r\n                    )}\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"email\">Email</Label>\r\n                    <p className=\"text-sm text-text-tertiary flex items-center gap-2\">\r\n                      <Mail className=\"h-4 w-4\" />\r\n                      {user?.email}\r\n                    </p>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"joined\">Member Since</Label>\r\n                    <p className=\"text-sm text-text-tertiary flex items-center gap-2\">\r\n                      <Calendar className=\"h-4 w-4\" />\r\n                      {user?.createdAt ? format(new Date(user.createdAt), 'MMMM d, yyyy') : 'Unknown'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"bio\">Bio</Label>\r\n                  {isEditing ? (\r\n                    <Textarea\r\n                      id=\"bio\"\r\n                      value={profileData.bio}\r\n                      onChange={(e) => setProfileData({ ...profileData, bio: e.target.value })}\r\n                      placeholder=\"Tell us about yourself...\"\r\n                      rows={4}\r\n                    />\r\n                  ) : (\r\n                    <p className=\"text-sm text-text-tertiary\">\r\n                      {user?.bio || 'No bio provided'}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"apps\">\r\n            <Card className=\"dark:bg-bg-4/50 max-w-xl\">\r\n              <CardHeader className='border-b'>\r\n                <CardTitle>Recent Applications</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                {appsLoading ? (\r\n                  <div className=\"flex items-center justify-center py-8\">\r\n                    <div className=\"text-center\">\r\n                      <Activity className=\"h-8 w-8 mx-auto mb-2 text-text-tertiary animate-pulse\" />\r\n                      <p className=\"text-sm text-text-tertiary\">Loading apps...</p>\r\n                    </div>\r\n                  </div>\r\n                ) : recentApps && recentApps.length > 0 ? (\r\n                  <div className=\"space-y-4\">\r\n                    {recentApps.slice(0, 5).map((app) => (\r\n                      <div \r\n                        key={app.id}\r\n                        className=\"flex items-center justify-between p-4 rounded-lg border hover:bg-bg-3/50 transition-colors cursor-pointer\"\r\n                        onClick={() => navigate(`/app/${app.id}`)}\r\n                      >\r\n                        <div className=\"flex items-center gap-4\">\r\n                          <div className=\"h-12 w-12 rounded-lg bg-bg-3 flex items-center justify-center\">\r\n                            <Code2 className=\"h-6 w-6\" />\r\n                          </div>\r\n                          <div>\r\n                            <h4 className=\"font-medium\">{app.title}</h4>\r\n                            <div className=\"flex items-center gap-3 mt-1 text-xs text-text-tertiary\">\r\n                              <Badge variant=\"secondary\" className=\"text-xs\">\r\n                                {app.framework}\r\n                              </Badge>\r\n                              <span className=\"text-xs\">\r\n                                {app.createdAt ? format(new Date(app.createdAt), 'MMM d, yyyy') : 'Recently'}\r\n                              </span>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <Badge variant={app.visibility === 'public' ? 'default' : 'secondary'}>\r\n                          {app.visibility}\r\n                        </Badge>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"flex flex-col items-center justify-center py-8\">\r\n                    <Code2 className=\"h-12 w-12 text-text-tertiary mb-4\" />\r\n                    <p className=\"text-text-tertiary\">No apps created yet</p>\r\n                    <Button className=\"mt-4\" onClick={() => navigate('/chat')}>\r\n                      Create Your First App\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"achievements\">\r\n            <Card className=\"dark:bg-bg-4/50 max-w-xl\">\r\n              <CardHeader>\r\n                <CardTitle>Achievements</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                {statsLoading ? (\r\n                  <div className=\"flex items-center justify-center py-8\">\r\n                    <div className=\"text-center\">\r\n                      <Trophy className=\"h-8 w-8 mx-auto mb-2 text-text-tertiary animate-pulse\" />\r\n                      <p className=\"text-sm text-text-tertiary\">Loading achievements...</p>\r\n                    </div>\r\n                  </div>\r\n                ) : achievements && achievements.length > 0 ? (\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                    {achievements.map((achievement, index) => {\r\n                      return (\r\n                        <div key={index} className=\"p-4 rounded-lg border hover:shadow-md transition-shadow\">\r\n                          <div className=\"flex items-start gap-4\">\r\n                            <div className=\"p-3 rounded-lg bg-bg-3 text-text-tertiary\">\r\n                              <Trophy className=\"h-6 w-6\" />\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                              <h4 className=\"font-medium\">{achievement}</h4>\r\n                              <p className=\"text-sm text-text-tertiary mt-1\">\r\n                                Achievement unlocked!\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"flex flex-col items-center justify-center py-8\">\r\n                    <Trophy className=\"h-12 w-12 text-text-tertiary mb-4\" />\r\n                    <p className=\"text-text-tertiary\">No achievements yet</p>\r\n                    <p className=\"text-sm text-text-tertiary mt-2\">Start creating apps to unlock achievements!</p>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"activity\">\r\n            <Card className=\"dark:bg-bg-4/50 max-w-xl\">\r\n              <CardHeader>\r\n                <CardTitle>Activity Timeline</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                {activityLoading ? (\r\n                  <div className=\"flex items-center justify-center py-8\">\r\n                    <div className=\"text-center\">\r\n                      <Activity className=\"h-8 w-8 mx-auto mb-2 text-text-tertiary animate-pulse\" />\r\n                      <p className=\"text-sm text-text-tertiary\">Loading activity...</p>\r\n                    </div>\r\n                  </div>\r\n                ) : activities && activities.length > 0 ? (\r\n                  <div className=\"space-y-4\">\r\n                    {activities.map((activity, index) => (\r\n                      <div key={index} className=\"flex items-start gap-4 pb-4 border-b last:border-0\">\r\n                        <div className={cn(\r\n                          \"p-2 rounded-lg\",\r\n                          activity.type === 'created' && \"bg-green-500/10 text-green-600\",\r\n                          activity.type === 'updated' && \"bg-blue-500/10 text-blue-600\",\r\n                          activity.type === 'favorited' && \"bg-yellow-500/10 text-yellow-600\"\r\n                        )}>\r\n                          {activity.type === 'created' && <Zap className=\"h-4 w-4\" />}\r\n                          {activity.type === 'updated' && <Edit3 className=\"h-4 w-4\" />}\r\n                          {activity.type === 'favorited' && <Star className=\"h-4 w-4\" />}\r\n                        </div>\r\n                        <div className=\"flex-1\">\r\n                          <p className=\"text-sm\">\r\n                            <span className=\"font-medium\">\r\n                              {activity.type === 'created' && 'Created'}\r\n                              {activity.type === 'updated' && 'Updated'}\r\n                              {activity.type === 'favorited' && 'Favorited'}\r\n                            </span>\r\n                            {' '}\r\n                            <span className=\"text-text-tertiary\">{activity.title}</span>\r\n                          </p>\r\n                          <p className=\"text-xs text-text-tertiary mt-1\">\r\n                            {activity.timestamp ? format(new Date(activity.timestamp), 'MMM d, yyyy h:mm a') : 'Recently'}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"flex flex-col items-center justify-center py-8\">\r\n                    <Activity className=\"h-12 w-12 text-text-tertiary mb-4\" />\r\n                    <p className=\"text-text-tertiary\">No recent activity</p>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n        </Tabs>\r\n      </div>\r\n    </div>\r\n  );\r\n}","import { Settings, Play, RotateCcw, Zap, Brain, Code2 } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Card, CardContent, CardHeader } from '@/components/ui/card';\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\r\nimport type { ModelConfig, UserModelConfigWithMetadata } from '@/api-types';\r\nimport type { AgentDisplayConfig } from './model-config-tabs';\r\n\r\ninterface ConfigCardProps {\r\n  agent: AgentDisplayConfig;\r\n  userConfig?: UserModelConfigWithMetadata;\r\n  defaultConfig?: ModelConfig;\r\n  onConfigure: () => void;\r\n  onTest: () => void;\r\n  onReset: () => void;\r\n  isTesting: boolean;\r\n}\r\n\r\n// Helper function to get model display name\r\nconst getModelDisplayName = (modelValue?: string) => {\r\n  if (!modelValue) return 'Default';\r\n  \r\n  return modelValue.split('/').pop() || modelValue;\r\n};\r\n\r\n// Helper function to get provider badge info\r\nconst getProviderInfo = (modelValue?: string) => {\r\n  if (!modelValue) return { name: 'Default', color: 'bg-bg-3 text-text-tertiary' };\r\n  \r\n  // Check specific prefixes first to avoid incorrect matches\r\n  if (modelValue.includes('cerebras/')) {\r\n    return { name: 'Cerebras', color: 'bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400' };\r\n  }\r\n  if (modelValue.includes('[openrouter]')) {\r\n    return { name: 'OpenRouter', color: 'bg-pink-100 text-pink-800 dark:bg-pink-900/20 dark:text-pink-400' };\r\n  }\r\n  if (modelValue.includes('openai/') || modelValue.includes('gpt') || modelValue.includes('o3') || modelValue.includes('o4')) {\r\n    return { name: 'OpenAI', color: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400' };\r\n  }\r\n  if (modelValue.includes('anthropic/') || modelValue.includes('claude')) {\r\n    return { name: 'Anthropic', color: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-400' };\r\n  }\r\n  if (modelValue.includes('google-ai-studio/') || modelValue.includes('gemini')) {\r\n    return { name: 'Google', color: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400' };\r\n  }\r\n  \r\n  return { name: 'Custom', color: 'bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400' };\r\n};\r\n\r\n// Helper function to get agent icon based on type\r\nconst getAgentIcon = (agentKey: string) => {\r\n  if (agentKey.includes('Code') || agentKey.includes('phase') || agentKey.includes('file')) return Code2;\r\n  if (agentKey.includes('fast') || agentKey.includes('template')) return Zap;\r\n  if (agentKey.includes('blueprint') || agentKey.includes('suggestion') || agentKey.includes('review')) return Brain;\r\n  return Settings;\r\n};\r\n\r\n// Helper function to format parameter values for display\r\nconst formatParameterValue = (value: unknown, type: string): string | null => {\r\n  if (value === null || value === undefined) return null;\r\n  \r\n  switch (type) {\r\n    case 'temperature':\r\n      return `T: ${value}`;\r\n    case 'maxTokens':\r\n      return typeof value === 'number' ? `${Math.round(value / 1000)}K tokens` : String(value);\r\n    case 'reasoningEffort':\r\n      return typeof value === 'string' ? `${value.charAt(0).toUpperCase()}${value.slice(1)}` : String(value);\r\n    default:\r\n      return String(value);\r\n  }\r\n};\r\n\r\nexport function ConfigCard({\r\n  agent,\r\n  userConfig,\r\n  defaultConfig,\r\n  onConfigure,\r\n  onTest,\r\n  onReset,\r\n  isTesting\r\n}: ConfigCardProps) {\r\n  const isCustomized = userConfig?.isUserOverride || false;\r\n  const currentModel = userConfig?.name || defaultConfig?.name;\r\n  const modelDisplayName = getModelDisplayName(currentModel);\r\n  const providerInfo = getProviderInfo(currentModel);\r\n  const AgentIcon = getAgentIcon(agent.key);\r\n\r\n  // Get current parameter values\r\n  const temperature = userConfig?.temperature ?? defaultConfig?.temperature;\r\n  const maxTokens = userConfig?.max_tokens ?? defaultConfig?.max_tokens;\r\n  const reasoningEffort = userConfig?.reasoning_effort ?? defaultConfig?.reasoning_effort;\r\n\r\n  return (\r\n    <Card className={`h-full min-h-[280px] min-w-[280px] flex flex-col overflow-hidden transition-all dark:!bg-bg-3 !bg-bg-3 hover:shadow-md !border-bg-1/40`}>\r\n      <CardHeader className=\"pb- flex-shrink-0\">\r\n        <div className=\"flex items-start justify-between gap-2\">\r\n          <div className=\"flex items-start gap-2 min-w-0 flex-1 overflow-hidden\">\r\n            <div className=\"p-1.5 rounded-md bg-bg-3 shrink-0\">\r\n              <AgentIcon className=\"h-4 w-4\" />\r\n            </div>\r\n            <div className=\"min-w-0 flex-1 overflow-hidden\">\r\n              <h5 className=\"font-medium text-md leading-tight mb-1 break-words\" title={agent.name}>\r\n                {agent.name}\r\n              </h5>\r\n              <p className=\"text-xs text-text-tertiary line-clamp-3 leading-tight overflow-hidden break-words\" title={agent.description}>\r\n                {agent.description}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"shrink-0\">\r\n            <Badge \r\n              variant={isCustomized ? \"default\" : \"outline\"} \r\n              className=\"text-xs px-1.5 py-0.5 whitespace-nowrap dark:!bg-bg-1\"\r\n            >\r\n              {isCustomized ? \"Custom\" : \"Default\"}\r\n            </Badge>\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n      \r\n      <CardContent className=\"pt-0 flex-1 flex flex-col justify-between overflow-hidden\">\r\n        <div className=\"space-y-3 overflow-hidden\">\r\n          {/* Current Model */}\r\n          <div className=\"space-y-2 pl-7 mt-2\">\r\n            <div className=\"flex items-start justify-between gap-2 min-w-0\">\r\n              <span className=\"text-sm font-medium flex-1 min-w-0 break-words leading-tight\" title={modelDisplayName}>\r\n                {modelDisplayName}\r\n              </span>\r\n              <Badge \r\n                variant=\"secondary\" \r\n                className={`text-xs shrink-0 px-1.5 py-0.5 mt-0.5 dark:contrast-50 ${providerInfo.color}`}\r\n              >\r\n                {providerInfo.name}\r\n              </Badge>\r\n            </div>\r\n            \r\n            {/* Parameter Summary - Contained within card bounds */}\r\n            <div className=\"flex flex-wrap gap-1 overflow-hidden\">\r\n              {temperature !== null && temperature !== undefined ? (\r\n                <TooltipProvider>\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Badge variant=\"outline\" className=\"text-xs px-1.5 py-0.5 shrink-0 dark:bg-accent/20\">\r\n                        {formatParameterValue(temperature, 'temperature')}\r\n                      </Badge>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p>Temperature: {temperature}</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                </TooltipProvider>\r\n              ) : null}\r\n              \r\n              {maxTokens ? (\r\n                <TooltipProvider>\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Badge variant=\"outline\" className=\"text-xs px-1.5 py-0.5 shrink-0 dark:bg-accent/20\">\r\n                        {formatParameterValue(maxTokens, 'maxTokens')}\r\n                      </Badge>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p>Max Tokens: {maxTokens?.toLocaleString()}</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                </TooltipProvider>\r\n              ) : null}\r\n              \r\n              {reasoningEffort ? (\r\n                <TooltipProvider>\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Badge variant=\"outline\" className=\"text-xs px-1.5 py-0.5 shrink-0 dark:bg-accent/20\">\r\n                        {formatParameterValue(reasoningEffort, 'reasoningEffort')}\r\n                      </Badge>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p>Reasoning Effort: {reasoningEffort}</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                </TooltipProvider>\r\n              ) : null}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Action Buttons - Fixed at bottom with proper containment */}\r\n        <div className=\"flex gap-2 mt-3 shrink-0\">\r\n          <Button\r\n            size=\"sm\"\r\n            variant=\"outline\"\r\n            onClick={onConfigure}\r\n            className=\"flex-1 h-8 text-xs font-medium min-w-0 dark:bg-bg-2\"\r\n          >\r\n            <Settings className=\"h-3 w-3 mr-1\" />\r\n            <span className=\"truncate\">Configure</span>\r\n          </Button>\r\n          \r\n          <TooltipProvider>\r\n            <Tooltip>\r\n              <TooltipTrigger asChild>\r\n                <Button\r\n                  size=\"sm\"\r\n                  variant=\"ghost\"\r\n                  onClick={onTest}\r\n                  disabled={isTesting}\r\n                  className=\"h-8 w-8 p-0 shrink-0\"\r\n                >\r\n                  {isTesting ? (\r\n                    <Settings className=\"h-3 w-3 animate-spin\" />\r\n                  ) : (\r\n                    <Play className=\"h-3 w-3\" />\r\n                  )}\r\n                </Button>\r\n              </TooltipTrigger>\r\n              <TooltipContent>\r\n                <p>{isTesting ? 'Testing...' : 'Test Config'}</p>\r\n              </TooltipContent>\r\n            </Tooltip>\r\n          </TooltipProvider>\r\n          \r\n          {isCustomized && (\r\n            <TooltipProvider>\r\n              <Tooltip>\r\n                <TooltipTrigger asChild>\r\n                  <Button\r\n                    size=\"sm\"\r\n                    variant=\"ghost\"\r\n                    onClick={onReset}\r\n                    className=\"h-8 w-8 p-0 text-text-tertiary shrink-0\"\r\n                  >\r\n                    <RotateCcw className=\"h-3 w-3\" />\r\n                  </Button>\r\n                </TooltipTrigger>\r\n                <TooltipContent>\r\n                  <p>Reset to Default</p>\r\n                </TooltipContent>\r\n              </Tooltip>\r\n            </TooltipProvider>\r\n          )}\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}","import * as React from \"react\"\r\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\r\nimport { CheckIcon, ChevronDownIcon, ChevronUpIcon } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Select({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Root>) {\r\n  return <SelectPrimitive.Root data-slot=\"select\" {...props} />\r\n}\r\n\r\nfunction SelectGroup({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Group>) {\r\n  return <SelectPrimitive.Group data-slot=\"select-group\" {...props} />\r\n}\r\n\r\nfunction SelectValue({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Value>) {\r\n  return <SelectPrimitive.Value data-slot=\"select-value\" {...props} />\r\n}\r\n\r\nfunction SelectTrigger({\r\n  className,\r\n  size = \"default\",\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {\r\n  size?: \"sm\" | \"default\"\r\n}) {\r\n  return (\r\n    <SelectPrimitive.Trigger\r\n      data-slot=\"select-trigger\"\r\n      data-size={size}\r\n      className={cn(\r\n        \"border-input data-[placeholder]:text-text-tertiary [&_svg:not([class*='text-'])]:text-text-tertiary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      {children}\r\n      <SelectPrimitive.Icon asChild>\r\n        <ChevronDownIcon className=\"size-4 opacity-50\" />\r\n      </SelectPrimitive.Icon>\r\n    </SelectPrimitive.Trigger>\r\n  )\r\n}\r\n\r\nfunction SelectContent({\r\n  className,\r\n  children,\r\n  position = \"popper\",\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Content>) {\r\n  return (\r\n    <SelectPrimitive.Portal>\r\n      <SelectPrimitive.Content\r\n        data-slot=\"select-content\"\r\n        className={cn(\r\n          \"bg-bg-4 text-text-primary data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md\",\r\n          position === \"popper\" &&\r\n            \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\r\n          className\r\n        )}\r\n        position={position}\r\n        {...props}\r\n      >\r\n        <SelectScrollUpButton />\r\n        <SelectPrimitive.Viewport\r\n          className={cn(\r\n            \"p-1\",\r\n            position === \"popper\" &&\r\n              \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1\"\r\n          )}\r\n        >\r\n          {children}\r\n        </SelectPrimitive.Viewport>\r\n        <SelectScrollDownButton />\r\n      </SelectPrimitive.Content>\r\n    </SelectPrimitive.Portal>\r\n  )\r\n}\r\n\r\nfunction SelectLabel({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Label>) {\r\n  return (\r\n    <SelectPrimitive.Label\r\n      data-slot=\"select-label\"\r\n      className={cn(\"text-text-tertiary px-2 py-1.5 text-xs\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SelectItem({\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Item>) {\r\n  return (\r\n    <SelectPrimitive.Item\r\n      data-slot=\"select-item\"\r\n      className={cn(\r\n        \"focus:bg-accent focus:text-text-secondary [&_svg:not([class*='text-'])]:text-text-tertiary relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <span className=\"absolute right-2 flex size-3.5 items-center justify-center\">\r\n        <SelectPrimitive.ItemIndicator>\r\n          <CheckIcon className=\"size-4\" />\r\n        </SelectPrimitive.ItemIndicator>\r\n      </span>\r\n      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\r\n    </SelectPrimitive.Item>\r\n  )\r\n}\r\n\r\nfunction SelectSeparator({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Separator>) {\r\n  return (\r\n    <SelectPrimitive.Separator\r\n      data-slot=\"select-separator\"\r\n      className={cn(\"bg-border pointer-events-none -mx-1 my-1 h-px\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SelectScrollUpButton({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {\r\n  return (\r\n    <SelectPrimitive.ScrollUpButton\r\n      data-slot=\"select-scroll-up-button\"\r\n      className={cn(\r\n        \"flex cursor-default items-center justify-center py-1\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <ChevronUpIcon className=\"size-4\" />\r\n    </SelectPrimitive.ScrollUpButton>\r\n  )\r\n}\r\n\r\nfunction SelectScrollDownButton({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {\r\n  return (\r\n    <SelectPrimitive.ScrollDownButton\r\n      data-slot=\"select-scroll-down-button\"\r\n      className={cn(\r\n        \"flex cursor-default items-center justify-center py-1\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <ChevronDownIcon className=\"size-4\" />\r\n    </SelectPrimitive.ScrollDownButton>\r\n  )\r\n}\r\n\r\nexport {\r\n  Select,\r\n  SelectContent,\r\n  SelectGroup,\r\n  SelectItem,\r\n  SelectLabel,\r\n  SelectScrollDownButton,\r\n  SelectScrollUpButton,\r\n  SelectSeparator,\r\n  SelectTrigger,\r\n  SelectValue,\r\n}\r\n","\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Popover({\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Root>) {\r\n  return <PopoverPrimitive.Root data-slot=\"popover\" {...props} />\r\n}\r\n\r\nfunction PopoverTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Trigger>) {\r\n  return <PopoverPrimitive.Trigger data-slot=\"popover-trigger\" {...props} />\r\n}\r\n\r\nfunction PopoverContent({\r\n  className,\r\n  align = \"center\",\r\n  sideOffset = 4,\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Content>) {\r\n  return (\r\n    <PopoverPrimitive.Portal>\r\n      <PopoverPrimitive.Content\r\n        data-slot=\"popover-content\"\r\n        align={align}\r\n        sideOffset={sideOffset}\r\n        className={cn(\r\n          \"bg-bg-4 text-text-primary data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden\",\r\n          className\r\n        )}\r\n        {...props}\r\n      />\r\n    </PopoverPrimitive.Portal>\r\n  )\r\n}\r\n\r\nfunction PopoverAnchor({\r\n  ...props\r\n}: React.ComponentProps<typeof PopoverPrimitive.Anchor>) {\r\n  return <PopoverPrimitive.Anchor data-slot=\"popover-anchor\" {...props} />\r\n}\r\n\r\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\r\n","/**\r\n * Shared Model Selector Component\r\n * Provides consistent model selection UI with search, badges, and proper scrolling\r\n */\r\n\r\nimport { useState, useRef, useMemo } from 'react';\r\nimport { Check, ChevronDown, Search } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface ModelOption {\r\n  value: string;\r\n  label: string;\r\n  provider: string;\r\n  hasUserKey: boolean;\r\n  byokAvailable: boolean;\r\n}\r\n\r\ninterface ModelSelectorProps {\r\n  value: string;\r\n  onValueChange: (value: string) => void;\r\n  availableModels: ModelOption[];\r\n  placeholder: string;\r\n  label: string;\r\n  systemDefault?: string;\r\n  includeDefaultOption?: boolean;\r\n  disabled?: boolean;\r\n  className?: string;\r\n}\r\n\r\n// Helper to get clean model display name\r\nconst getModelDisplayName = (model: string): string => {\r\n  return model || '';\r\n};\r\n\r\nexport function ModelSelector({\r\n  value,\r\n  onValueChange,\r\n  availableModels,\r\n  placeholder,\r\n  label,\r\n  systemDefault,\r\n  includeDefaultOption = false,\r\n  disabled = false,\r\n  className,\r\n}: ModelSelectorProps) {\r\n  const [open, setOpen] = useState(false);\r\n  const [search, setSearch] = useState('');\r\n  const listRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Filter models based on search\r\n  const filteredModels = useMemo(() => {\r\n    if (!search) return availableModels;\r\n    return availableModels.filter(model => \r\n      model.label.toLowerCase().includes(search.toLowerCase())\r\n    );\r\n  }, [availableModels, search]);\r\n\r\n  // Get display name for selected value\r\n  const getSelectedDisplay = () => {\r\n    if (value === 'default' && includeDefaultOption) {\r\n      return 'Use default';\r\n    }\r\n    if (value && value !== 'default') {\r\n      const selectedModel = availableModels.find((model) => model.value === value);\r\n      return selectedModel?.label || value;\r\n    }\r\n    return '';\r\n  };\r\n\r\n  // Enhanced model classification for badges\r\n  const getModelBadge = (model: ModelOption) => {\r\n    // If model has a specific provider (not platform-only)\r\n    if (model.provider && model.provider !== '') {\r\n      if (model.hasUserKey) {\r\n        return (\r\n          <Badge variant=\"default\" className=\"text-xs\">\r\n            BYOK\r\n          </Badge>\r\n        );\r\n      } else {\r\n        return (\r\n          <Badge variant=\"outline\" className=\"text-xs\">\r\n            Key needed\r\n          </Badge>\r\n        );\r\n      }\r\n    } else {\r\n      // Platform model\r\n      return (\r\n        <Badge variant=\"secondary\" className=\"text-xs\">\r\n          Platform\r\n        </Badge>\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={cn('space-y-2', className)}>\r\n      <Label className=\"text-sm font-medium\">{label}</Label>\r\n      <Popover open={open} onOpenChange={setOpen}>\r\n        <PopoverTrigger asChild>\r\n          <Button\r\n            variant=\"outline\"\r\n            role=\"combobox\"\r\n            aria-expanded={open}\r\n            className=\"w-full justify-between\"\r\n            disabled={disabled}\r\n          >\r\n            {getSelectedDisplay() || placeholder}\r\n            <ChevronDown className=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\r\n          </Button>\r\n        </PopoverTrigger>\r\n        <PopoverContent className=\"w-full p-0\" style={{ width: 'var(--radix-popover-trigger-width)' }}>\r\n          {/* Search Input */}\r\n          <div className=\"flex items-center border-b border-border-primary px-3 py-2\">\r\n            <Search className=\"mr-2 h-4 w-4 shrink-0 text-text-tertiary\" />\r\n            <Input\r\n              placeholder=\"Search models...\"\r\n              value={search}\r\n              onChange={(e) => setSearch(e.target.value)}\r\n              className=\"h-8 border-0 bg-transparent p-0 placeholder:text-text-tertiary focus-visible:outline-none focus-visible:ring-0 focus-visible:ring-offset-0\"\r\n            />\r\n          </div>\r\n          \r\n          {/* Scrollable List */}\r\n          <div \r\n            ref={listRef}\r\n            className=\"max-h-[300px] overflow-y-auto p-1 scroll-smooth\"\r\n            onWheel={(e) => {\r\n              // Ensure wheel events are properly handled\r\n              e.stopPropagation();\r\n            }}\r\n          >\r\n            {/* No results */}\r\n            {filteredModels.length === 0 && !includeDefaultOption && (\r\n              <div className=\"py-6 text-center text-sm text-text-tertiary\">\r\n                No models found.\r\n              </div>\r\n            )}\r\n            \r\n            {/* Default option if requested */}\r\n            {includeDefaultOption && (\r\n              <div\r\n                key=\"default\"\r\n                onClick={() => {\r\n                  onValueChange('default');\r\n                  setOpen(false);\r\n                  setSearch('');\r\n                }}\r\n                className={cn(\r\n                  \"relative flex cursor-pointer select-none items-center justify-between rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-text-secondary focus:bg-accent focus:text-text-secondary\",\r\n                  value === 'default' && \"bg-accent text-text-secondary\"\r\n                )}\r\n              >\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Check\r\n                    className={cn(\r\n                      \"h-4 w-4 text-text-primary\",\r\n                      value === 'default' ? \"opacity-100\" : \"opacity-0\"\r\n                    )}\r\n                  />\r\n                  <span className=\"font-medium\">Use default</span>\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            {/* Available models */}\r\n            {filteredModels.map((model) => (\r\n              <div\r\n                key={model.value}\r\n                onClick={() => {\r\n                  onValueChange(model.value);\r\n                  setOpen(false);\r\n                  setSearch('');\r\n                }}\r\n                className={cn(\r\n                  \"relative flex cursor-pointer select-none items-center justify-between rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-text-secondary focus:bg-accent focus:text-text-secondary\",\r\n                  value === model.value && \"bg-accent text-text-secondary\"\r\n                )}\r\n              >\r\n                <div className=\"flex items-center gap-2 min-w-0 flex-1\">\r\n                  <Check\r\n                    className={cn(\r\n                      \"h-4 w-4 text-text-primary shrink-0\",\r\n                      value === model.value ? \"opacity-100\" : \"opacity-0\"\r\n                    )}\r\n                  />\r\n                  <span className=\"truncate\">{model.label}</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-1 ml-2 shrink-0\">\r\n                  {getModelBadge(model)}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </PopoverContent>\r\n      </Popover>\r\n      \r\n      {/* System default display */}\r\n      {systemDefault && (\r\n        <p className=\"text-xs text-text-tertiary\">\r\n           System default: {getModelDisplayName(systemDefault)}\r\n        </p>\r\n      )}\r\n    </div>\r\n  );\r\n}","import * as React from \"react\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst alertVariants = cva(\r\n  \"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"bg-bg-4 text-text-primary\",\r\n        destructive:\r\n          \"text-destructive bg-bg-4 [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nfunction Alert({\r\n  className,\r\n  variant,\r\n  ...props\r\n}: React.ComponentProps<\"div\"> & VariantProps<typeof alertVariants>) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert\"\r\n      role=\"alert\"\r\n      className={cn(alertVariants({ variant }), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertTitle({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert-title\"\r\n      className={cn(\r\n        \"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction AlertDescription({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert-description\"\r\n      className={cn(\r\n        \"text-text-tertiary col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Alert, AlertTitle, AlertDescription }\r\n","\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as SwitchPrimitive from \"@radix-ui/react-switch\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Switch({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SwitchPrimitive.Root>) {\r\n  return (\r\n    <SwitchPrimitive.Root\r\n      data-slot=\"switch\"\r\n      className={cn(\r\n        \"peer data-[state=checked]:bg-text-secondary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <SwitchPrimitive.Thumb\r\n        data-slot=\"switch-thumb\"\r\n        className={cn(\r\n          \"bg-bg-3 dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-text-text-secondary pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0\"\r\n        )}\r\n      />\r\n    </SwitchPrimitive.Root>\r\n  )\r\n}\r\n\r\nexport { Switch }\r\n","import * as React from \"react\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nconst SvgOpenai = (props) => /* @__PURE__ */ _jsx(\"svg\", {\n\txmlns: \"http://www.w3.org/2000/svg\",\n\twidth: 256,\n\theight: 260,\n\tpreserveAspectRatio: \"xMidYMid\",\n\tviewBox: \"0 0 256 260\",\n\t...props,\n\tchildren: /* @__PURE__ */ _jsx(\"path\", { d: \"M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z\" })\n});\nexport default SvgOpenai;\n","import * as React from \"react\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nconst SvgAnthropic = (props) => /* @__PURE__ */ _jsxs(\"svg\", {\n\txmlns: \"http://www.w3.org/2000/svg\",\n\tshapeRendering: \"geometricPrecision\",\n\ttextRendering: \"geometricPrecision\",\n\timageRendering: \"optimizeQuality\",\n\tfillRule: \"evenodd\",\n\tclipRule: \"evenodd\",\n\tviewBox: \"0 0 512 512\",\n\t...props,\n\tchildren: [/* @__PURE__ */ _jsx(\"rect\", {\n\t\tfill: \"#CC9B7A\",\n\t\twidth: 512,\n\t\theight: 512,\n\t\trx: 104.187,\n\t\try: 105.042\n\t}), /* @__PURE__ */ _jsx(\"path\", {\n\t\tfill: \"#1F1F1E\",\n\t\tfillRule: \"nonzero\",\n\t\td: \"M318.663 149.787h-43.368l78.952 212.423 43.368.004-78.952-212.427zm-125.326 0l-78.952 212.427h44.255l15.932-44.608 82.846-.004 16.107 44.612h44.255l-79.126-212.427h-45.317zm-4.251 128.341l26.91-74.701 27.083 74.701h-53.993z\"\n\t})]\n});\nexport default SvgAnthropic;\n","import * as React from \"react\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nconst SvgGoogle = (props) => /* @__PURE__ */ _jsxs(\"svg\", {\n\tfill: \"none\",\n\txmlns: \"http://www.w3.org/2000/svg\",\n\tviewBox: \"0 0 16 16\",\n\t...props,\n\tchildren: [/* @__PURE__ */ _jsx(\"path\", {\n\t\td: \"M16 8.016A8.522 8.522 0 008.016 16h-.032A8.521 8.521 0 000 8.016v-.032A8.521 8.521 0 007.984 0h.032A8.522 8.522 0 0016 7.984v.032z\",\n\t\tfill: \"url(#prefix__paint0_radial_980_20147)\"\n\t}), /* @__PURE__ */ _jsx(\"defs\", { children: /* @__PURE__ */ _jsxs(\"radialGradient\", {\n\t\tid: \"prefix__paint0_radial_980_20147\",\n\t\tcx: 0,\n\t\tcy: 0,\n\t\tr: 1,\n\t\tgradientUnits: \"userSpaceOnUse\",\n\t\tgradientTransform: \"matrix(16.1326 5.4553 -43.70045 129.2322 1.588 6.503)\",\n\t\tchildren: [\n\t\t\t/* @__PURE__ */ _jsx(\"stop\", {\n\t\t\t\toffset: .067,\n\t\t\t\tstopColor: \"#9168C0\"\n\t\t\t}),\n\t\t\t/* @__PURE__ */ _jsx(\"stop\", {\n\t\t\t\toffset: .343,\n\t\t\t\tstopColor: \"#5684D1\"\n\t\t\t}),\n\t\t\t/* @__PURE__ */ _jsx(\"stop\", {\n\t\t\t\toffset: .672,\n\t\t\t\tstopColor: \"#1BA1E3\"\n\t\t\t})\n\t\t]\n\t}) })]\n});\nexport default SvgGoogle;\n","import * as React from \"react\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nconst SvgCerebras = (props) => /* @__PURE__ */ _jsx(\"svg\", {\n\tviewBox: \"0 0 1124.6 495.25\",\n\txmlns: \"http://www.w3.org/2000/svg\",\n\t...props,\n\tchildren: /* @__PURE__ */ _jsxs(\"g\", {\n\t\ttransform: \"translate(-2.2762e-5 -.00037576)\",\n\t\tchildren: [\n\t\t\t/* @__PURE__ */ _jsx(\"path\", {\n\t\t\t\td: \"m247.63 479.03c-127.8 0-231.4-103.6-231.4-231.4 0-127.8 103.6-231.4 231.4-231.4m-119.21 374.41c-78.853-66.16-89.133-183.71-22.973-262.56 66.16-78.853 183.71-89.133 262.56-22.973m-187 267.59c-69.027-36.44-95.453-121.95-59.013-190.97 36.44-69.04 121.93-95.453 190.97-59.013m-65.333 221.23c-53.187 0-96.307-43.12-96.307-96.307s43.12-96.307 96.307-96.307\",\n\t\t\t\tfill: \"none\",\n\t\t\t\tstroke: \"#f15a29\",\n\t\t\t\tstrokeMiterlimit: 10,\n\t\t\t\tstrokeWidth: 32.453\n\t\t\t}),\n\t\t\t/* @__PURE__ */ _jsx(\"path\", { d: \"m277.37 220.7c-3.76-3.96-7.6933-7.12-11.8-9.4667-4.1067-2.3467-8.3067-3.52-12.6-3.52-5.8933 0-11.173 1.08-15.813 3.24-4.6533 2.1733-8.6267 5.0533-11.933 8.6667-3.32 3.6-5.8133 7.7467-7.52 12.44-1.6933 4.6933-2.5467 9.56-2.5467 14.6 0 5.0533 0.85334 9.9333 2.5467 14.613 1.7067 4.6933 4.2 8.84 7.52 12.44 3.3067 3.6133 7.28 6.4933 11.933 8.6667 4.64 2.16 9.92 3.24 15.813 3.24 5 0 9.6533-1.04 13.947-3.1067 4.2933-2.08 7.9467-5.0933 10.987-9.0667l21.453 23.267c-3.2133 3.24-6.9333 6.04-11.133 8.3867-4.2 2.3467-8.44 4.24-12.733 5.68-4.28 1.44-8.4 2.4667-12.333 3.1067-3.9333 0.62666-7.3333 0.94666-10.187 0.94666-9.6533 0-18.773-1.6267-27.347-4.8667-8.5867-3.2533-16-7.84-22.253-13.8-6.2667-5.9467-11.227-13.12-14.88-21.507-3.6667-8.3867-5.5067-17.707-5.5067-28 0-10.267 1.84-19.6 5.5067-27.987 3.6533-8.3867 8.6133-15.56 14.88-21.507 6.2533-5.9467 13.667-10.547 22.253-13.8 8.5733-3.24 17.693-4.8667 27.347-4.8667 8.2133 0 16.493 1.5867 24.8 4.7333 8.32 3.16 15.6 8.16 21.853 15.013z\" }),\n\t\t\t/* @__PURE__ */ _jsx(\"path\", { d: \"m394.28 233.68c-0.17333-9.56-3.1333-17.08-8.8533-22.587-5.72-5.4933-13.667-8.2533-23.853-8.2533-9.6533 0-17.307 2.8-22.933 8.3867-5.6267 5.6-9.0667 13.08-10.32 22.453zm-65.96 24.347c1.0667 9.7333 4.8267 17.307 11.267 22.72 6.4267 5.4133 14.2 8.12 23.32 8.12 8.04 0 14.787-1.6667 20.24-5.0133 5.4533-3.3333 10.24-7.52 14.347-12.573l23.067 17.587c-7.5067 9.3733-15.92 16.053-25.213 20.013-9.2933 3.96-19.027 5.9467-29.227 5.9467-9.64 0-18.76-1.6267-27.347-4.8667-8.5733-3.24-16-7.84-22.253-13.8-6.2533-5.9467-11.213-13.107-14.88-21.493-3.6667-8.3867-5.4933-17.72-5.4933-28 0-10.28 1.8267-19.613 5.4933-28 3.6667-8.3867 8.6267-15.56 14.88-21.507 6.2533-5.9467 13.68-10.547 22.253-13.8 8.5867-3.24 17.707-4.8667 27.347-4.8667 8.9467 0 17.12 1.5867 24.533 4.7333 7.4267 3.16 13.773 7.72 19.04 13.667 5.28 5.9467 9.3867 13.293 12.333 22.04 2.96 8.76 4.4267 18.8 4.4267 30.16v8.9333z\" }),\n\t\t\t/* @__PURE__ */ _jsx(\"path\", { d: \"m440.39 181.74h32.173v20.56h0.53333c3.5733-7.5733 8.68-13.427 15.293-17.587 6.6-4.1467 14.213-6.2133 22.787-6.2133 1.96 0 3.8933 0.17333 5.76 0.53333 1.88 0.36 3.8 0.81334 5.7733 1.36v31.373c-2.68-0.72-5.32-1.3067-7.92-1.76-2.5867-0.45333-5.1333-0.68-7.64-0.68-7.5067 0-13.533 1.4-18.093 4.2s-8.04 6-10.453 9.6c-2.4133 3.6133-4.0267 7.2133-4.8267 10.827-0.81333 3.6-1.2133 6.3067-1.2133 8.1067v69.52h-32.173z\" }),\n\t\t\t/* @__PURE__ */ _jsx(\"path\", { d: \"m620.85 233.68c-0.18667-9.56-3.1333-17.08-8.8533-22.587-5.72-5.4933-13.667-8.2533-23.853-8.2533-9.6533 0-17.307 2.8-22.933 8.3867-5.6267 5.6-9.0667 13.08-10.32 22.453zm-65.96 24.347c1.0667 9.7333 4.8267 17.307 11.267 22.72 6.4267 5.4133 14.2 8.12 23.32 8.12 8.04 0 14.787-1.6667 20.24-5.0133 5.4533-3.3333 10.24-7.52 14.347-12.573l23.067 17.587c-7.5067 9.3733-15.92 16.053-25.213 20.013-9.2933 3.96-19.027 5.9467-29.227 5.9467-9.6533 0-18.76-1.6267-27.347-4.8667-8.5733-3.24-16-7.84-22.253-13.8-6.2533-5.9467-11.213-13.107-14.88-21.493-3.6667-8.3867-5.4933-17.72-5.4933-28 0-10.28 1.8267-19.613 5.4933-28 3.6667-8.3867 8.6267-15.56 14.88-21.507 6.2533-5.9467 13.68-10.547 22.253-13.8 8.5867-3.24 17.693-4.8667 27.347-4.8667 8.9467 0 17.12 1.5867 24.533 4.7333 7.4267 3.16 13.773 7.72 19.04 13.667 5.2667 5.9467 9.3867 13.293 12.333 22.04 2.96 8.76 4.4267 18.8 4.4267 30.16v8.9333z\" }),\n\t\t\t/* @__PURE__ */ _jsx(\"path\", { d: \"m768.32 246.66c0-5.04-0.85333-9.92-2.5467-14.6-1.7067-4.6933-4.2-8.84-7.5067-12.453-3.32-3.6-7.2933-6.4933-11.933-8.6533-4.6533-2.16-9.92-3.24-15.827-3.24-5.8933 0-11.16 1.08-15.813 3.24s-8.6267 5.0533-11.933 8.6533c-3.3067 3.6133-5.8133 7.76-7.5067 12.453-1.7067 4.68-2.5467 9.56-2.5467 14.6 0 5.0533 0.84 9.92 2.5467 14.613 1.6933 4.68 4.2 8.84 7.5067 12.44 3.3067 3.6133 7.28 6.4933 11.933 8.6533s9.92 3.2533 15.813 3.2533c5.9067 0 11.173-1.0933 15.827-3.2533 4.64-2.16 8.6133-5.04 11.933-8.6533 3.3067-3.6 5.8-7.76 7.5067-12.44 1.6933-4.6933 2.5467-9.56 2.5467-14.613m-106.72-139.57h32.173v91.147h0.81333c1.6-2.16 3.6533-4.36 6.16-6.6133 2.5067-2.2533 5.5467-4.3733 9.12-6.36 3.5733-1.9867 7.68-3.6133 12.333-4.8667 4.64-1.2667 10.013-1.8933 16.093-1.8933 9.1067 0 17.507 1.7467 25.2 5.2667 7.68 3.52 14.253 8.3467 19.707 14.467 5.4533 6.1333 9.6933 13.36 12.733 21.653s4.56 17.213 4.56 26.773-1.4267 18.493-4.2933 26.787c-2.8533 8.2933-7.0533 15.507-12.6 21.64-5.5333 6.1333-12.24 10.947-20.107 14.467-7.8667 3.52-16.72 5.28-26.547 5.28-9.12 0-17.6-1.8133-25.467-5.4133-7.88-3.6133-14.133-9.3733-18.773-17.32h-0.53333v19.48h-30.573z\" }),\n\t\t\t/* @__PURE__ */ _jsx(\"path\", { d: \"m814.43 181.74h32.173v20.56h0.53333c3.5733-7.5733 8.68-13.427 15.293-17.587 6.6-4.1467 14.213-6.2133 22.787-6.2133 1.96 0 3.8933 0.17333 5.76 0.53333 1.88 0.36 3.8 0.81334 5.7733 1.36v31.373c-2.68-0.72-5.32-1.3067-7.92-1.76-2.5867-0.45333-5.1333-0.68-7.64-0.68-7.5067 0-13.533 1.4-18.093 4.2s-8.04 6-10.453 9.6c-2.4133 3.6133-4.0267 7.2133-4.8267 10.827-0.81333 3.6-1.2133 6.3067-1.2133 8.1067v69.52h-32.173z\" }),\n\t\t\t/* @__PURE__ */ _jsx(\"path\", { d: \"m981.21 253.43h-6.7067c-4.4667 0-9.4667 0.18667-15.013 0.54667-5.5467 0.36-10.773 1.2133-15.68 2.56-4.92 1.36-9.08 3.3467-12.467 5.96-3.4 2.6133-5.1067 6.2667-5.1067 10.947 0 3.0667 0.68 5.64 2.0133 7.7067 1.3467 2.08 3.0933 3.84 5.2267 5.28 2.1467 1.44 4.56 2.48 7.24 3.1067 2.6933 0.64 5.3733 0.94667 8.0533 0.94667 11.08 0 19.253-2.6533 24.533-7.9733 5.2667-5.32 7.9067-12.587 7.9067-21.773zm1.88 40.307h-0.81333c-4.64 7.4-10.547 12.76-17.693 16.093-7.1467 3.3333-15.013 5-23.587 5-5.9067 0-11.667-0.81333-17.307-2.4267-5.6267-1.6267-10.627-4.0667-15.013-7.3067-4.3867-3.2533-7.9067-7.3067-10.587-12.173s-4.0267-10.547-4.0267-17.04c0-7.04 1.2533-13.027 3.76-17.987 2.4933-4.96 5.8533-9.1067 10.053-12.453 4.2-3.3333 9.0667-5.9867 14.613-7.9733 5.5333-1.9867 11.307-3.4667 17.293-4.4667 5.9867-0.98667 12.027-1.6267 18.093-1.8933 6.08-0.26666 11.8-0.4 17.173-0.4h8.04v-3.52c0-8.12-2.7733-14.2-8.32-18.253-5.5333-4.0667-12.6-6.0933-21.173-6.0933-6.8 0-13.147 1.2133-19.04 3.6533-5.9067 2.44-11 5.72-15.28 9.88l-16.893-17.053c7.1467-7.3867 15.507-12.707 25.067-15.96 9.56-3.24 19.44-4.8667 29.627-4.8667 9.12 0 16.8 1.04 23.067 3.1067 6.2533 2.08 11.427 4.7467 15.547 7.9867 4.1067 3.24 7.28 6.9867 9.52 11.227 2.2267 4.24 3.84 8.52 4.8267 12.853 0.9733 4.32 1.56 8.52 1.7333 12.573 0.1867 4.0533 0.28 7.6267 0.28 10.68v74.667h-28.96z\" }),\n\t\t\t/* @__PURE__ */ _jsx(\"path\", { d: \"m1099.2 217.72c-6.2533-8.84-14.667-13.253-25.2-13.253-4.2933 0-8.4933 1.08-12.6 3.24-4.12 2.1733-6.1733 5.68-6.1733 10.547 0 3.9733 1.6933 6.8667 5.0933 8.6667s7.68 3.3333 12.867 4.6c5.1866 1.2533 10.773 2.56 16.76 3.92 5.9866 1.3467 11.573 3.4267 16.76 6.2133 5.1866 2.8 9.48 6.6267 12.867 11.507 3.4 4.8667 5.0934 11.533 5.0934 20.013 0 7.76-1.6534 14.293-4.96 19.613-3.3067 5.32-7.6 9.6-12.867 12.853-5.2667 3.24-11.213 5.5867-17.827 7.0267-6.6133 1.44-13.227 2.16-19.84 2.16-10.013 0-19.227-1.44-27.627-4.32-8.4-2.8933-15.907-8.12-22.52-15.693l21.453-20.293c4.1067 4.6933 8.5333 8.52 13.267 11.507 4.7333 2.9733 10.507 4.4533 17.293 4.4533 2.3333 0 4.7467-0.26666 7.24-0.81333 2.5067-0.53333 4.8267-1.44 6.9733-2.7067 2.1467-1.2533 3.8934-2.8267 5.2267-4.72 1.3467-1.8933 2.0133-4.1067 2.0133-6.64 0-4.4933-1.6933-7.84-5.0933-10-3.4-2.16-7.68-3.92-12.867-5.28-5.1866-1.3467-10.773-2.6133-16.76-3.7867-5.9866-1.1733-11.573-3.0667-16.76-5.68-5.1866-2.6133-9.48-6.2667-12.867-10.947-3.4-4.6933-5.0934-11.187-5.0934-19.48 0-7.2133 1.4667-13.48 4.4134-18.8 2.96-5.32 6.84-9.6933 11.667-13.12 4.8267-3.4267 10.373-5.96 16.627-7.5733 6.2533-1.6267 12.6-2.44 19.04-2.44 8.5733 0 17.067 1.4933 25.467 4.4667 8.4 2.9733 15.2 8.0667 20.387 15.28z\" })\n\t\t]\n\t})\n});\nexport default SvgCerebras;\n","import * as React from \"react\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nconst SvgCloudflare = (props) => /* @__PURE__ */ _jsxs(\"svg\", {\n\txmlns: \"http://www.w3.org/2000/svg\",\n\tviewBox: \"0 0 32 32\",\n\twidth: 64,\n\theight: 64,\n\t...props,\n\tchildren: [\n\t\t/* @__PURE__ */ _jsx(\"path\", {\n\t\t\td: \"M8.16 23h21.177v-5.86l-4.023-2.307-.694-.3-16.46.113z\",\n\t\t\tfill: \"#fff\"\n\t\t}),\n\t\t/* @__PURE__ */ _jsx(\"path\", {\n\t\t\td: \"M22.012 22.222c.197-.675.122-1.294-.206-1.754-.3-.422-.807-.666-1.416-.694l-11.545-.15c-.075 0-.14-.038-.178-.094s-.047-.13-.028-.206c.038-.113.15-.197.272-.206l11.648-.15c1.38-.066 2.88-1.182 3.404-2.55l.666-1.735a.38.38 0 0 0 .02-.225c-.75-3.395-3.78-5.927-7.4-5.927-3.34 0-6.17 2.157-7.184 5.15-.657-.488-1.5-.75-2.392-.666-1.604.16-2.9 1.444-3.048 3.048a3.58 3.58 0 0 0 .084 1.191A4.84 4.84 0 0 0 0 22.1c0 .234.02.47.047.703.02.113.113.197.225.197H21.58a.29.29 0 0 0 .272-.206l.16-.572z\",\n\t\t\tfill: \"#f38020\"\n\t\t}),\n\t\t/* @__PURE__ */ _jsx(\"path\", {\n\t\t\td: \"M25.688 14.803l-.32.01c-.075 0-.14.056-.17.13l-.45 1.566c-.197.675-.122 1.294.206 1.754.3.422.807.666 1.416.694l2.457.15c.075 0 .14.038.178.094s.047.14.028.206c-.038.113-.15.197-.272.206l-2.56.15c-1.388.066-2.88 1.182-3.404 2.55l-.188.478c-.038.094.028.188.13.188h8.797a.23.23 0 0 0 .225-.169A6.41 6.41 0 0 0 32 21.106a6.32 6.32 0 0 0-6.312-6.302\",\n\t\t\tfill: \"#faae40\"\n\t\t})\n\t]\n});\nexport default SvgCloudflare;\n","/**\r\n * Enhanced BYOK API Keys Modal with Two-Tab Layout\r\n * Tab 1: Add new keys\r\n * Tab 2: Manage existing keys with toggle/delete functionality\r\n */\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { Key, Check, AlertCircle, Loader2, Plus, Settings, Trash2, Eye } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Separator } from '@/components/ui/separator';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from '@/components/ui/alert-dialog';\r\nimport { apiClient } from '@/lib/api-client';\r\nimport { toast } from 'sonner';\r\nimport type { SecretTemplate } from '@/api-types';\r\n\r\n// Import provider logos\r\nimport OpenAILogo from '@/assets/provider-logos/openai.svg?react';\r\nimport AnthropicLogo from '@/assets/provider-logos/anthropic.svg?react';\r\nimport GoogleLogo from '@/assets/provider-logos/google.svg?react';\r\nimport CerebrasLogo from '@/assets/provider-logos/cerebras.svg?react';\r\nimport CloudflareLogo from '@/assets/provider-logos/cloudflare.svg?react';\r\n\r\ninterface ByokApiKeysModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onKeyAdded?: () => void;\r\n}\r\n\r\ninterface ManagedSecret {\r\n  id: string;\r\n  name: string;\r\n  provider: string;\r\n  keyPreview: string;\r\n  isActive: boolean;\r\n  lastUsed: string | null;\r\n  createdAt: string;\r\n  logo: React.ComponentType<{ className?: string }>;\r\n}\r\n\r\n// Logo mapping for dynamic provider support\r\nconst PROVIDER_LOGOS: Record<string, React.ComponentType<{ className?: string }>> = {\r\n  openai: OpenAILogo,\r\n  anthropic: AnthropicLogo,\r\n  'google-ai-studio': GoogleLogo,\r\n  cerebras: CerebrasLogo,\r\n};\r\n\r\ninterface BYOKProvider {\r\n  id: string;\r\n  name: string;\r\n  provider: string;\r\n  logo: React.ComponentType<{ className?: string }>;\r\n  placeholder: string;\r\n  validation: RegExp;\r\n}\r\n\r\n/**\r\n * Convert BYOK template to provider configuration\r\n */\r\nfunction templateToBYOKProvider(template: SecretTemplate): BYOKProvider {\r\n  const logo = PROVIDER_LOGOS[template.provider] || (() => <div className=\"w-4 h-4 bg-gray-300 rounded\" />);\r\n  \r\n  return {\r\n    id: template.id,\r\n    name: template.displayName.replace(' (BYOK)', ''),\r\n    provider: template.provider,\r\n    logo,\r\n    placeholder: template.placeholder,\r\n    validation: new RegExp(template.validation),\r\n  };\r\n}\r\n\r\nexport function ByokApiKeysModal({ isOpen, onClose, onKeyAdded }: ByokApiKeysModalProps) {\r\n  // Tab management\r\n  const [activeTab, setActiveTab] = useState<'add' | 'manage'>('add');\r\n  \r\n  // Add keys tab state\r\n  const [selectedProvider, setSelectedProvider] = useState<string | null>(null);\r\n  const [apiKey, setApiKey] = useState('');\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [byokProviders, setBYOKProviders] = useState<BYOKProvider[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  \r\n  // Manage keys tab state\r\n  const [managedSecrets, setManagedSecrets] = useState<ManagedSecret[]>([]);\r\n  const [loadingSecrets, setLoadingSecrets] = useState(false);\r\n  const [toggleLoadingId, setToggleLoadingId] = useState<string | null>(null);\r\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\r\n  const [secretToDelete, setSecretToDelete] = useState<ManagedSecret | null>(null);\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n\r\n  // Get selected provider details\r\n  const provider = byokProviders.find(p => p.id === selectedProvider);\r\n\r\n  // Load BYOK templates and existing secrets when modal opens\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      // Reset add keys tab\r\n      setSelectedProvider(null);\r\n      setApiKey('');\r\n      setIsSaving(false);\r\n      \r\n      // Reset manage keys tab\r\n      setToggleLoadingId(null);\r\n      setDeleteDialogOpen(false);\r\n      setSecretToDelete(null);\r\n      setIsDeleting(false);\r\n      \r\n      // Load data\r\n      loadBYOKProviders();\r\n      loadManagedSecrets();\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const loadBYOKProviders = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const response = await apiClient.getBYOKTemplates();\r\n      \r\n      if (response.success && response.data) {\r\n        const providers = response.data.templates.map(templateToBYOKProvider);\r\n        setBYOKProviders(providers);\r\n      } else {\r\n        toast.error('Failed to load BYOK providers');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading BYOK templates:', error);\r\n      toast.error('Failed to load BYOK providers');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadManagedSecrets = async () => {\r\n    try {\r\n      setLoadingSecrets(true);\r\n      const response = await apiClient.getAllSecrets(); // Use getAllSecrets for toggle functionality\r\n      \r\n      if (response.success && response.data) {\r\n        // Filter BYOK secrets only (show both active and inactive for management)\r\n        const byokSecrets = response.data.secrets.filter(secret => \r\n          secret.secretType.endsWith('_BYOK')\r\n        );\r\n        \r\n        // Convert to ManagedSecret format with logos\r\n        const managedSecrets: ManagedSecret[] = byokSecrets.map(secret => {\r\n          const logo = PROVIDER_LOGOS[secret.provider] || (() => <div className=\"w-4 h-4 bg-gray-300 rounded\" />);\r\n          \r\n          return {\r\n            id: secret.id,\r\n            name: secret.name,\r\n            provider: secret.provider,\r\n            keyPreview: secret.keyPreview,\r\n            isActive: secret.isActive ?? false,\r\n            lastUsed: secret.lastUsed ? secret.lastUsed.toString() : null,\r\n            createdAt: secret.createdAt?.toString() ?? '',\r\n            logo\r\n          };\r\n        });\r\n        \r\n        setManagedSecrets(managedSecrets);\r\n      } else {\r\n        toast.error('Failed to load managed secrets');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading managed secrets:', error);\r\n      toast.error('Failed to load managed secrets');\r\n    } finally {\r\n      setLoadingSecrets(false);\r\n    }\r\n  };\r\n\r\n  // Handle provider selection\r\n  const handleProviderSelect = (providerId: string) => {\r\n    setSelectedProvider(providerId);\r\n    setApiKey('');\r\n  };\r\n\r\n  // Validate key format\r\n  const isKeyFormatValid = provider && apiKey && provider.validation.test(apiKey);\r\n\r\n  // Save API key\r\n  const handleSaveKey = async () => {\r\n    if (!provider || !apiKey || !isKeyFormatValid) return;\r\n\r\n    setIsSaving(true);\r\n\r\n    try {\r\n      await apiClient.storeSecret({\r\n        templateId: provider.id,\r\n        value: apiKey.trim(),\r\n        environment: 'production'\r\n      });\r\n\r\n      toast.success(`${provider.name} API key added successfully!`);\r\n      onKeyAdded?.();\r\n      \r\n      // Reload managed secrets and switch to manage tab\r\n      await loadManagedSecrets();\r\n      setActiveTab('manage');\r\n      \r\n      // Reset add form\r\n      setSelectedProvider(null);\r\n      setApiKey('');\r\n    } catch (error) {\r\n      console.error('Failed to save API key:', error);\r\n      toast.error('Failed to save API key. Please try again.');\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n  \r\n  // Toggle secret active status\r\n  const handleToggleSecret = async (secretId: string) => {\r\n    setToggleLoadingId(secretId);\r\n    \r\n    try {\r\n      const response = await apiClient.toggleSecret(secretId);\r\n      \r\n      if (response.success && response.data) {\r\n        const updatedSecret = response.data.secret;\r\n        toast.success(response.data.message);\r\n        \r\n        // Update local state\r\n        setManagedSecrets(prev => \r\n          prev.map(secret => \r\n            secret.id === secretId \r\n              ? { ...secret, isActive: updatedSecret.isActive ?? false }\r\n              : secret\r\n          )\r\n        );\r\n        \r\n        // Notify parent about key changes\r\n        onKeyAdded?.();\r\n      } else {\r\n        toast.error('Failed to toggle secret status');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error toggling secret:', error);\r\n      toast.error('Failed to toggle secret status');\r\n    } finally {\r\n      setToggleLoadingId(null);\r\n    }\r\n  };\r\n  \r\n  // Delete secret\r\n  const handleDeleteSecret = async () => {\r\n    if (!secretToDelete) return;\r\n    \r\n    setIsDeleting(true);\r\n    \r\n    try {\r\n      await apiClient.deleteSecret(secretToDelete.id);\r\n      toast.success(`${secretToDelete.name} API key deleted successfully`);\r\n      \r\n      // Remove from local state\r\n      setManagedSecrets(prev => \r\n        prev.filter(secret => secret.id !== secretToDelete.id)\r\n      );\r\n      \r\n      // Notify parent about key changes\r\n      onKeyAdded?.();\r\n      \r\n      // Close dialog\r\n      setDeleteDialogOpen(false);\r\n      setSecretToDelete(null);\r\n    } catch (error) {\r\n      console.error('Error deleting secret:', error);\r\n      toast.error('Failed to delete API key');\r\n    } finally {\r\n      setIsDeleting(false);\r\n    }\r\n  };\r\n  \r\n  const openDeleteDialog = (secret: ManagedSecret) => {\r\n    setSecretToDelete(secret);\r\n    setDeleteDialogOpen(true);\r\n  };\r\n  \r\n  const formatDate = (dateString: string) => {\r\n    const date = new Date(dateString);\r\n    return date.toLocaleDateString('en-US', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric'\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Dialog open={isOpen} onOpenChange={onClose}>\r\n        <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <Key className=\"h-5 w-5\" />\r\n              Bring Your Own Key\r\n              <span className=\"flex items-center gap-1 text-xs text-text-tertiary font-normal\">\r\n                via <CloudflareLogo className=\"h-3 w-3\" /> AI Gateway\r\n              </span>\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              Add your API keys to use your own provider accounts for billing, or manage existing keys\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <Tabs value={activeTab} onValueChange={(value) => setActiveTab(value as 'add' | 'manage')} className=\"space-y-6\">\r\n            <TabsList className=\"grid w-full grid-cols-2\">\r\n              <TabsTrigger value=\"add\" className=\"flex items-center gap-2\">\r\n                <Plus className=\"h-4 w-4\" />\r\n                Add Keys\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"manage\" className=\"flex items-center gap-2\">\r\n                <Settings className=\"h-4 w-4\" />\r\n                Manage Keys\r\n              </TabsTrigger>\r\n            </TabsList>\r\n\r\n            {/* Add Keys Tab */}\r\n            <TabsContent value=\"add\" className=\"space-y-6\">\r\n              {/* Provider Selection - Clean List */}\r\n              <div className=\"space-y-3\">\r\n                <Label className=\"text-sm font-medium\">Select Provider</Label>\r\n                {isLoading ? (\r\n                  <div className=\"space-y-2\">\r\n                    {[1, 2, 3, 4].map((i) => (\r\n                      <div key={i} className=\"w-full flex items-center gap-3 p-3 rounded-lg border-2 border-gray-200\">\r\n                        <div className=\"w-8 h-8 bg-gray-200 rounded-md animate-pulse\" />\r\n                        <div className=\"h-4 bg-gray-200 rounded animate-pulse flex-1\" />\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-2\">\r\n                    {byokProviders.map((providerOption) => {\r\n                      const LogoComponent = providerOption.logo;\r\n                      const isSelected = selectedProvider === providerOption.id;\r\n                      return (\r\n                        <button\r\n                          key={providerOption.id}\r\n                          onClick={() => handleProviderSelect(providerOption.id)}\r\n                          className={`w-full flex items-center gap-3 p-3 rounded-lg border-2 transition-all duration-200 text-left ${\r\n                            isSelected\r\n                              ? 'border-blue-500 bg-blue-50'\r\n                              : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'\r\n                          }`}\r\n                        >\r\n                          <div className=\"flex items-center justify-center w-8 h-8 bg-white rounded-md border shadow-sm\">\r\n                            <LogoComponent className=\"h-5 w-5\" />\r\n                          </div>\r\n                          <span className=\"font-medium\">{providerOption.name}</span>\r\n                        </button>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* API Key Input - Smooth Expansion */}\r\n              {selectedProvider && provider && (\r\n                <div className=\"space-y-3 animate-in slide-in-from-top-2 duration-300\">\r\n                  <Label htmlFor=\"apiKey\" className=\"text-sm font-medium\">\r\n                    Enter your {provider.name} API key\r\n                  </Label>\r\n                  <div className=\"relative\">\r\n                    <Input\r\n                      id=\"apiKey\"\r\n                      type=\"password\"\r\n                      value={apiKey}\r\n                      onChange={(e) => setApiKey(e.target.value)}\r\n                      placeholder={provider.placeholder}\r\n                      className={`pr-10 ${\r\n                        apiKey \r\n                          ? isKeyFormatValid \r\n                            ? 'border-green-500 focus:border-green-500' \r\n                            : 'border-red-500 focus:border-red-500'\r\n                          : ''\r\n                      }`}\r\n                    />\r\n                    {apiKey && (\r\n                      <div className=\"absolute right-3 top-1/2 -translate-y-1/2\">\r\n                        {isKeyFormatValid ? (\r\n                          <Check className=\"h-4 w-4 text-green-500\" />\r\n                        ) : (\r\n                          <AlertCircle className=\"h-4 w-4 text-red-500\" />\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  {apiKey && !isKeyFormatValid && (\r\n                    <p className=\"text-xs text-red-600\">\r\n                      Invalid format. Expected: {provider.placeholder}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </TabsContent>\r\n\r\n            {/* Manage Keys Tab */}\r\n            <TabsContent value=\"manage\" className=\"space-y-4\">\r\n              {loadingSecrets ? (\r\n                <div className=\"space-y-4\">\r\n                  {[1, 2, 3].map((i) => (\r\n                    <div key={i} className=\"flex items-center gap-4 p-4 rounded-lg border\">\r\n                      <div className=\"w-8 h-8 bg-gray-200 rounded-md animate-pulse\" />\r\n                      <div className=\"flex-1 space-y-2\">\r\n                        <div className=\"h-4 bg-gray-200 rounded animate-pulse w-1/3\" />\r\n                        <div className=\"h-3 bg-gray-200 rounded animate-pulse w-1/2\" />\r\n                      </div>\r\n                      <div className=\"w-12 h-6 bg-gray-200 rounded animate-pulse\" />\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : managedSecrets.length === 0 ? (\r\n                <div className=\"text-center py-8 text-text-tertiary\">\r\n                  <Key className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\r\n                  <p className=\"text-lg font-medium mb-2\">No API keys configured</p>\r\n                  <p className=\"text-sm\">Add your first API key using the \"Add Keys\" tab</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <Label className=\"text-sm font-medium\">Your API Keys</Label>\r\n                    <Badge variant=\"secondary\">\r\n                      {managedSecrets.filter(s => s.isActive).length} active, {managedSecrets.length} total\r\n                    </Badge>\r\n                  </div>\r\n                  \r\n                  <div className=\"space-y-3\">\r\n                    {managedSecrets.map((secret) => {\r\n                      const LogoComponent = secret.logo;\r\n                      const isTogglingThis = toggleLoadingId === secret.id;\r\n                      \r\n                      return (\r\n                        <div key={secret.id} className={`flex items-center gap-4 p-4 rounded-lg border transition-colors ${\r\n                          secret.isActive \r\n                            ? 'hover:bg-bg-3/50' \r\n                            : 'bg-bg-3/20 border-dashed hover:bg-bg-3/30'\r\n                        }`}>\r\n                          {/* Provider Logo */}\r\n                          <div className={`flex items-center justify-center w-8 h-8 rounded-md border shadow-sm ${\r\n                            secret.isActive \r\n                              ? 'bg-white' \r\n                              : 'bg-bg-3 border-dashed opacity-60'\r\n                          }`}>\r\n                            <LogoComponent className={`h-5 w-5 ${secret.isActive ? '' : 'opacity-60'}`} />\r\n                          </div>\r\n                          \r\n                          {/* Key Info */}\r\n                          <div className=\"flex-1 space-y-1\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <span className={`font-medium capitalize ${\r\n                                secret.isActive ? '' : 'opacity-60'\r\n                              }`}>\r\n                                {secret.name.replace(' (BYOK)', '')}\r\n                              </span>\r\n                              <Badge \r\n                                variant={secret.isActive ? \"default\" : \"outline\"}\r\n                                className={`text-xs ${secret.isActive ? '' : 'opacity-60'}`}\r\n                              >\r\n                                {secret.isActive ? \"Active\" : \"Inactive\"}\r\n                              </Badge>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-3 text-xs text-text-tertiary\">\r\n                              <div className=\"flex items-center gap-1\">\r\n                                <Eye className=\"h-3 w-3\" />\r\n                                <span>{secret.keyPreview}</span>\r\n                              </div>\r\n                              <Separator orientation=\"vertical\" className=\"h-3\" />\r\n                              <span>Added {formatDate(secret.createdAt)}</span>\r\n                              {secret.lastUsed && (\r\n                                <>\r\n                                  <Separator orientation=\"vertical\" className=\"h-3\" />\r\n                                  <span>Last used {formatDate(secret.lastUsed)}</span>\r\n                                </>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                          \r\n                          {/* Controls */}\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <Switch \r\n                                checked={secret.isActive}\r\n                                onCheckedChange={() => handleToggleSecret(secret.id)}\r\n                                disabled={isTogglingThis}\r\n                              />\r\n                              {isTogglingThis && (\r\n                                <Loader2 className=\"h-4 w-4 animate-spin text-text-tertiary\" />\r\n                              )}\r\n                            </div>\r\n                            \r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => openDeleteDialog(secret)}\r\n                              className=\"text-red-600 hover:text-red-700 hover:bg-red-50\"\r\n                            >\r\n                              <Trash2 className=\"h-4 w-4\" />\r\n                            </Button>\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </TabsContent>\r\n          </Tabs>\r\n\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={onClose}>\r\n              Close\r\n            </Button>\r\n            {activeTab === 'add' && selectedProvider && (\r\n              <Button \r\n                onClick={handleSaveKey}\r\n                disabled={!apiKey || !isKeyFormatValid || isSaving}\r\n                className=\"gap-2\"\r\n              >\r\n                {isSaving ? (\r\n                  <>\r\n                    <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                    Adding...\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <Plus className=\"h-4 w-4\" />\r\n                    Add Key\r\n                  </>\r\n                )}\r\n              </Button>\r\n            )}\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Delete Confirmation Dialog */}\r\n      <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Delete API Key</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Are you sure you want to delete the {secretToDelete?.name} API key? This action cannot be undone.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n            <AlertDialogAction \r\n              onClick={handleDeleteSecret}\r\n              disabled={isDeleting}\r\n              className=\"bg-red-600 hover:bg-red-700\"\r\n            >\r\n              {isDeleting ? (\r\n                <>\r\n                  <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\r\n                  Deleting...\r\n                </>\r\n              ) : (\r\n                'Delete Key'\r\n              )}\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </>\r\n  );\r\n}","/**\r\n * Redesigned Model Configuration Modal\r\n * Three-mode interface: Platform Models, BYOK (Bring Your Own Key), Custom Providers\r\n */\r\n\r\nimport { useState, useEffect, useMemo } from 'react';\r\nimport { Settings, Play, RotateCcw, Info, Key } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Separator } from '@/components/ui/separator';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { ModelSelector } from '@/components/ui/model-selector';\r\nimport { Check } from 'lucide-react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { apiClient } from '@/lib/api-client';\r\nimport { ByokApiKeysModal } from './byok-api-keys-modal';\r\nimport type { \r\n  ModelConfig, \r\n  UserModelConfigWithMetadata, \r\n  ModelConfigUpdate, \r\n  AIModels,\r\n  ByokProvidersData\r\n} from '@/api-types';\r\nimport type { AgentDisplayConfig } from './model-config-tabs';\r\n\r\ninterface ConfigModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  agentConfig: AgentDisplayConfig;\r\n  userConfig?: UserModelConfigWithMetadata;\r\n  defaultConfig?: ModelConfig;\r\n  onSave: (config: ModelConfigUpdate) => Promise<void>;\r\n  onTest: (tempConfig?: ModelConfigUpdate) => Promise<void>;\r\n  onReset: () => Promise<void>;\r\n  isTesting: boolean;\r\n}\r\n\r\n\r\n// Helper to extract provider from model name (e.g., \"openai/gpt-4\" -> \"openai\")\r\nconst getProviderFromModel = (modelName: string): string => {\r\n  if (!modelName || modelName === 'default') return '';\r\n  return modelName.split('/')[0] || '';\r\n};\r\n\r\n// Helper to check if user has BYOK key for a model's provider\r\nconst hasUserKeyForModel = (modelName: string, byokProviders: Array<{ provider: string; hasValidKey: boolean }>): boolean => {\r\n  const provider = getProviderFromModel(modelName);\r\n  if (!provider) return false;\r\n  \r\n  return byokProviders.some(p => p.provider === provider && p.hasValidKey);\r\n};\r\n\r\n// Helper to get clean model display name\r\nconst getModelDisplayName = (model: AIModels | string): string => {\r\n  return typeof model === 'string' ? model : model;\r\n};\r\n\r\n// Model recommendations by agent\r\nconst getModelRecommendation = (agentAction: string) => {\r\n  const recommendations: Record<string, string> = {\r\n    templateSelection: ' Recommended: Fast models for quick template selection',\r\n    blueprint: ' Recommended: Creative models for architecture design',\r\n    projectSetup: ' Recommended: Reliable models for precise setup',\r\n    phaseGeneration: ' Recommended: Large context models for comprehensive planning',\r\n    firstPhaseImplementation: ' Recommended: High-capability models for foundation development',\r\n    phaseImplementation: ' Recommended: Strong coding models for implementation',\r\n    realtimeCodeFixer: ' Recommended: Fast debugging models',\r\n    fastCodeFixer: ' Recommended: Ultra-fast models for quick fixes',\r\n    conversationalResponse: ' Recommended: Balanced models for natural conversation',\r\n    codeReview: ' Recommended: Analytical models with large context',\r\n    fileRegeneration: ' Recommended: Pure coding models',\r\n    screenshotAnalysis: ' Recommended: Vision-capable models for image analysis'\r\n  };\r\n  return recommendations[agentAction] || '';\r\n};\r\n\r\nexport function ConfigModal({\r\n  isOpen,\r\n  onClose,\r\n  agentConfig,\r\n  userConfig,\r\n  defaultConfig,\r\n  onSave,\r\n  onTest,\r\n  onReset,\r\n  isTesting\r\n}: ConfigModalProps) {\r\n  // Form state\r\n  const [formData, setFormData] = useState({\r\n    modelName: userConfig?.name || 'default',\r\n    maxTokens: userConfig?.max_tokens?.toString() || '',\r\n    temperature: userConfig?.temperature?.toString() || '',\r\n    reasoningEffort: userConfig?.reasoning_effort || 'default',\r\n    fallbackModel: userConfig?.fallbackModel || 'default'\r\n  });\r\n\r\n  // UI state\r\n  const [hasChanges, setHasChanges] = useState(false);\r\n  const [byokModalOpen, setByokModalOpen] = useState(false);\r\n  \r\n  // Modal lifecycle tracking\r\n  const [isInitialOpen, setIsInitialOpen] = useState(false);\r\n\r\n  // BYOK data state\r\n  const [byokData, setByokData] = useState<ByokProvidersData | null>(null);\r\n  const [loadingByok, setLoadingByok] = useState(false);\r\n\r\n  // Load BYOK data\r\n  const loadByokData = async () => {\r\n    try {\r\n      setLoadingByok(true);\r\n      const response = await apiClient.getByokProviders();\r\n      if (response.success && response.data) {\r\n        setByokData(response.data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load BYOK data:', error);\r\n    } finally {\r\n      setLoadingByok(false);\r\n    }\r\n  };\r\n\r\n  // Handle modal open/close lifecycle\r\n  useEffect(() => {\r\n    if (isOpen && !isInitialOpen) {\r\n      // First time opening - reset everything and load data\r\n      setFormData({\r\n        modelName: userConfig?.name || 'default',\r\n        maxTokens: userConfig?.max_tokens?.toString() || '',\r\n        temperature: userConfig?.temperature?.toString() || '',\r\n        reasoningEffort: userConfig?.reasoning_effort || 'default',\r\n        fallbackModel: userConfig?.fallbackModel || 'default'\r\n      });\r\n      setHasChanges(false);\r\n      setByokModalOpen(false);\r\n      setIsInitialOpen(true);\r\n      loadByokData();\r\n    } else if (!isOpen && isInitialOpen) {\r\n      // Modal closed - reset for next time\r\n      setIsInitialOpen(false);\r\n    }\r\n  }, [isOpen, isInitialOpen, userConfig]);\r\n\r\n  // Load BYOK data when modal opens\r\n  useEffect(() => {\r\n    if (byokData && isInitialOpen) {\r\n      // BYOK data is loaded, ready for model selection\r\n    }\r\n  }, [byokData, isInitialOpen, userConfig?.name]);\r\n\r\n  // Check for changes\r\n  useEffect(() => {\r\n    const originalFormData = {\r\n      modelName: userConfig?.name || 'default',\r\n      maxTokens: userConfig?.max_tokens?.toString() || '',\r\n      temperature: userConfig?.temperature?.toString() || '',\r\n      reasoningEffort: userConfig?.reasoning_effort || 'default',\r\n      fallbackModel: userConfig?.fallbackModel || 'default'\r\n    };\r\n    \r\n    setHasChanges(JSON.stringify(formData) !== JSON.stringify(originalFormData));\r\n  }, [formData, userConfig]);\r\n\r\n  // Get unified model list with BYOK status info\r\n  const availableModels = useMemo(() => {\r\n    if (!byokData) return [];\r\n\r\n    const models: { value: string; label: string; provider: string; hasUserKey: boolean; byokAvailable: boolean }[] = [];\r\n    const processedModels = new Set<string>();\r\n    \r\n    // First, add all BYOK models (they have BYOK capability)\r\n    Object.values(byokData.modelsByProvider).forEach(providerModels => {\r\n      providerModels.forEach(model => {\r\n        const modelStr = model as string;\r\n        if (!processedModels.has(modelStr)) {\r\n          const provider = getProviderFromModel(modelStr);\r\n          const hasUserKey = hasUserKeyForModel(modelStr, byokData.providers);\r\n          \r\n          models.push({\r\n            value: modelStr,\r\n            label: getModelDisplayName(modelStr),\r\n            provider,\r\n            hasUserKey,\r\n            byokAvailable: true\r\n          });\r\n          processedModels.add(modelStr);\r\n        }\r\n      });\r\n    });\r\n    \r\n    // Then, add platform-only models (no BYOK capability)\r\n    byokData.platformModels.forEach(model => {\r\n      const modelStr = model as string;\r\n      if (!processedModels.has(modelStr)) {\r\n        models.push({\r\n          value: modelStr,\r\n          label: getModelDisplayName(modelStr),\r\n          provider: '',\r\n          hasUserKey: false,\r\n          byokAvailable: false\r\n        });\r\n        processedModels.add(modelStr);\r\n      }\r\n    });\r\n    \r\n    return models.sort((a, b) => a.label.localeCompare(b.label));\r\n  }, [byokData]);\r\n\r\n  // Get current model's BYOK status\r\n  const selectedModelInfo = useMemo(() => {\r\n    const currentModel = formData.modelName && formData.modelName !== 'default' \r\n      ? formData.modelName \r\n      : '';\r\n      \r\n    if (!currentModel || !byokData) {\r\n      return { hasUserKey: false, provider: '', requiresBYOK: false, isPlatformModel: true };\r\n    }\r\n    \r\n    // Check if this is a BYOK-capable model\r\n    const isByokModel = Object.values(byokData.modelsByProvider).some(providerModels => \r\n      providerModels.some(model => model === currentModel)\r\n    );\r\n    \r\n    const provider = getProviderFromModel(currentModel);\r\n    const hasUserKey = hasUserKeyForModel(currentModel, byokData.providers);\r\n    \r\n    return {\r\n      hasUserKey,\r\n      provider,\r\n      requiresBYOK: isByokModel && !hasUserKey, // Only BYOK-capable models can require keys\r\n      isPlatformModel: !isByokModel\r\n    };\r\n  }, [formData.modelName, byokData]);\r\n\r\n  // Create config object from current form state\r\n  const buildCurrentConfig = (): ModelConfigUpdate => {\r\n    return {\r\n      ...(formData.modelName !== 'default' && { modelName: formData.modelName }),\r\n      ...(formData.maxTokens && { maxTokens: parseInt(formData.maxTokens) }),\r\n      ...(formData.temperature && { temperature: parseFloat(formData.temperature) }),\r\n      ...(formData.reasoningEffort !== 'default' && { reasoningEffort: formData.reasoningEffort }),\r\n      ...(formData.fallbackModel !== 'default' && { fallbackModel: formData.fallbackModel }),\r\n      isUserOverride: true\r\n    };\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    const config = buildCurrentConfig();\r\n    await onSave(config);\r\n  };\r\n\r\n  const handleTestWithCurrentConfig = async () => {\r\n    const currentConfig = buildCurrentConfig();\r\n    // We'll need to update the parent component to handle testing with temporary config\r\n    await onTest(currentConfig);\r\n  };\r\n\r\n  const handleReset = async () => {\r\n    await onReset();\r\n    onClose();\r\n  };\r\n\r\n  const openByokModal = () => {\r\n    setByokModalOpen(true);\r\n  };\r\n\r\n  const handleByokKeyAdded = () => {\r\n    // Refresh BYOK data after a key is added\r\n    loadByokData();\r\n  };\r\n\r\n  const isUserOverride = userConfig?.isUserOverride || false;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={onClose}>\r\n      <DialogContent className=\"overflow-y-auto max-w-3xl w-[90vw] max-h-[90vh] sm:max-w-4xl\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <Settings className=\"h-5 w-5\" />\r\n            Configure {agentConfig.name}\r\n          </DialogTitle>\r\n          <DialogDescription className=\"space-y-2\">\r\n            <p>{agentConfig.description}</p>\r\n            {getModelRecommendation(agentConfig.key) && (\r\n              <Alert>\r\n                <Info className=\"h-4 w-4\" />\r\n                <AlertDescription className=\"text-sm\">\r\n                  {getModelRecommendation(agentConfig.key)}\r\n                </AlertDescription>\r\n              </Alert>\r\n            )}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-6\">\r\n          {/* Current Status */}\r\n          <div className=\"flex items-center justify-between p-3 bg-bg-3/50 rounded-lg\">\r\n            <div>\r\n              <p className=\"font-medium text-sm\">Configuration Status</p>\r\n              <p className=\"text-xs text-text-tertiary\">\r\n                {isUserOverride ? 'Using custom configuration' : 'Using system defaults'}\r\n              </p>\r\n            </div>\r\n            <Badge variant={isUserOverride ? \"default\" : \"outline\"}>\r\n              {isUserOverride ? \"Custom\" : \"Default\"}\r\n            </Badge>\r\n          </div>\r\n\r\n\r\n          {/* Model Selection Section */}\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <Label className=\"text-sm font-medium\">Model Configuration</Label>\r\n                <p className=\"text-xs text-text-tertiary mt-1\">\r\n                  Select primary and fallback models - we'll use your API keys if available\r\n                </p>\r\n              </div>\r\n              <Button variant=\"outline\" size=\"sm\" \r\n              onClick={openByokModal}\r\n              disabled // DISABLED: BYOK Disabled for security reasons\r\n              className=\"gap-2\">\r\n                <Key className=\"h-4 w-4\" />\r\n                {/* Manage Keys */}\r\n                Coming Soon\r\n              </Button>\r\n            </div>\r\n            \r\n            {/* Two-Column Model Layout */}\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n              {/* Primary AI Model */}\r\n              <div className=\"space-y-2\">\r\n                <ModelSelector\r\n                  value={formData.modelName}\r\n                  onValueChange={(value) => setFormData({...formData, modelName: value})}\r\n                  availableModels={availableModels}\r\n                  placeholder=\"Select model...\"\r\n                  label=\"AI Model\"\r\n                  systemDefault={defaultConfig?.name}\r\n                  disabled={loadingByok}\r\n                />\r\n                \r\n                {/* Model Status Messages */}\r\n                {selectedModelInfo.requiresBYOK && (\r\n                  <div className=\"flex items-center gap-2 text-sm text-amber-600 bg-amber-50 dark:bg-amber-950/20 px-3 py-2 rounded-md border border-amber-200 dark:border-amber-800\">\r\n                    <Key className=\"h-4 w-4\" />\r\n                    <span>API key needed for {selectedModelInfo.provider}</span>\r\n                    <Button variant=\"link\" size=\"sm\" onClick={openByokModal} className=\"p-0 h-auto text-amber-600 hover:text-amber-700\">\r\n                      Setup now\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n                \r\n                {selectedModelInfo.isPlatformModel && formData.modelName && formData.modelName !== 'default' && (\r\n                  <div className=\"flex items-center gap-2 text-sm text-blue-600 bg-blue-50 dark:bg-blue-950/20 px-3 py-2 rounded-md border border-blue-200 dark:border-blue-800\">\r\n                    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                    </svg>\r\n                    <span>Platform model with usage limits. Consider BYOK for higher usage.</span>\r\n                  </div>\r\n                )}\r\n                \r\n                {formData.modelName && formData.modelName !== 'default' && selectedModelInfo.hasUserKey && (\r\n                  <div className=\"flex items-center gap-2 text-sm text-green-600 bg-green-50 dark:bg-green-950/20 px-3 py-2 rounded-md border border-green-200 dark:border-green-800\">\r\n                    <Check className=\"h-4 w-4\" />\r\n                    <span>Using your {selectedModelInfo.provider} API key</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Fallback Model */}\r\n              <div className=\"space-y-2\">\r\n                <ModelSelector\r\n                  value={formData.fallbackModel}\r\n                  onValueChange={(value) => setFormData({...formData, fallbackModel: value})}\r\n                  availableModels={availableModels}\r\n                  placeholder=\"Select fallback model...\"\r\n                  label=\"Fallback Model\"\r\n                  systemDefault={defaultConfig?.fallbackModel}\r\n                  includeDefaultOption={true}\r\n                  disabled={loadingByok}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n\r\n          <Separator />\r\n\r\n          {/* BYOK Information */}\r\n          <div className=\"space-y-3\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"p-4 rounded-lg border bg-blue-50/50 border-blue-200\">\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                  <div className=\"h-2 w-2 rounded-full bg-blue-500\"></div>\r\n                  <h4 className=\"font-medium text-sm text-blue-900\">Platform Models</h4>\r\n                </div>\r\n                <p className=\"text-xs text-blue-700\">\r\n                  Models served through our platform with limited quota. No API keys required.\r\n                </p>\r\n              </div>\r\n              \r\n              <div className=\"p-4 rounded-lg border bg-green-50/50 border-green-200\">\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                  <div className=\"h-2 w-2 rounded-full bg-green-500\"></div>\r\n                  <h4 className=\"font-medium text-sm text-green-900\">BYOK (Your Keys)</h4>\r\n                </div>\r\n                <p className=\"text-xs text-green-700\">\r\n                  Your API keys are used for direct billing with providers. Unlimited usage based on your provider account.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* Parameters */}\r\n          <div className=\"space-y-4\">\r\n            <h4 className=\"font-medium text-sm\">Parameters</h4>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n              {/* Temperature */}\r\n              <div className=\"space-y-2\">\r\n                <Label className=\"text-sm font-medium\">Temperature</Label>\r\n                <Input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  max=\"2\"\r\n                  step=\"0.1\"\r\n                  value={formData.temperature}\r\n                  placeholder={defaultConfig?.temperature ? `${defaultConfig.temperature}` : '0.7'}\r\n                  onChange={(e) => setFormData({...formData, temperature: e.target.value})}\r\n                  className=\"h-10\"\r\n                />\r\n                {defaultConfig?.temperature && (\r\n                  <p className=\"text-xs text-text-tertiary\">\r\n                     Default: {defaultConfig.temperature}\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Max Tokens */}\r\n              <div className=\"space-y-2\">\r\n                <Label className=\"text-sm font-medium\">Max Tokens</Label>\r\n                <Input\r\n                  type=\"number\"\r\n                  min=\"1\"\r\n                  max=\"200000\"\r\n                  value={formData.maxTokens}\r\n                  placeholder={defaultConfig?.max_tokens ? `${defaultConfig.max_tokens}` : '4000'}\r\n                  onChange={(e) => setFormData({...formData, maxTokens: e.target.value})}\r\n                  className=\"h-10\"\r\n                />\r\n                {defaultConfig?.max_tokens && (\r\n                  <p className=\"text-xs text-text-tertiary\">\r\n                     Default: {defaultConfig.max_tokens?.toLocaleString()}\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Reasoning Effort */}\r\n              <div className=\"space-y-2\">\r\n                <Label className=\"text-sm font-medium\">Reasoning Effort</Label>\r\n                <Select value={formData.reasoningEffort} onValueChange={(value) => setFormData({...formData, reasoningEffort: value})}>\r\n                  <SelectTrigger className=\"h-10\">\r\n                    <SelectValue placeholder=\"Select effort...\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"default\">Use default</SelectItem>\r\n                    <SelectItem value=\"low\">Low (Fast)</SelectItem>\r\n                    <SelectItem value=\"medium\">Medium (Balanced)</SelectItem>\r\n                    <SelectItem value=\"high\">High (Deep)</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n                {defaultConfig?.reasoning_effort && (\r\n                  <p className=\"text-xs text-text-tertiary\">\r\n                     Default: {defaultConfig.reasoning_effort}\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <DialogFooter className=\"gap-3 flex-col sm:flex-row sm:justify-between\">\r\n          <div className=\"flex gap-2 flex-wrap\">\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={handleTestWithCurrentConfig}\r\n              disabled={isTesting}\r\n              className=\"gap-2\"\r\n            >\r\n              {isTesting ? (\r\n                <>\r\n                  <Settings className=\"h-4 w-4 animate-spin\" />\r\n                  Testing...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Play className=\"h-4 w-4\" />\r\n                  Test Config\r\n                </>\r\n              )}\r\n            </Button>\r\n            \r\n            {isUserOverride && (\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={handleReset}\r\n                className=\"gap-2 text-text-tertiary\"\r\n              >\r\n                <RotateCcw className=\"h-4 w-4\" />\r\n                Reset to Default\r\n              </Button>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 flex-wrap sm:justify-end\">\r\n            <Button variant=\"outline\" onClick={onClose}>\r\n              Cancel\r\n            </Button>\r\n            <Button \r\n              onClick={handleSave}\r\n              disabled={!hasChanges}\r\n            >\r\n              Save Changes\r\n            </Button>\r\n          </div>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n\r\n      {/* BYOK API Keys Modal */}\r\n      <ByokApiKeysModal\r\n        isOpen={byokModalOpen}\r\n        onClose={() => setByokModalOpen(false)}\r\n        onKeyAdded={handleByokKeyAdded}\r\n      />\r\n    </Dialog>\r\n  );\r\n}","import { useState, useCallback } from 'react';\r\nimport { \r\n  Settings, \r\n  Rocket, \r\n  Wrench, \r\n  Code, \r\n  Bug,\r\n  Brain,\r\n  Search,\r\n  RotateCcw,\r\n  Play\r\n} from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { toast } from 'sonner';\r\nimport { ConfigCard } from './config-card';\r\nimport { ConfigModal } from './config-modal';\r\nimport type { ModelConfig, UserModelConfigWithMetadata, ModelConfigUpdate } from '@/api-types';\r\n\r\n// Define workflow-based tab structure with dynamic agent categorization\r\nexport const WORKFLOW_TABS = {\r\n  quickstart: {\r\n    id: 'quickstart',\r\n    label: 'Quick Start',\r\n    icon: Rocket,\r\n    description: 'Most commonly customized settings',\r\n    patterns: ['template', 'blueprint', 'conversational']\r\n  },\r\n  planning: {\r\n    id: 'planning', \r\n    label: 'Planning',\r\n    icon: Brain,\r\n    description: 'Project planning and setup',\r\n    patterns: ['phase', 'project', 'suggestion', 'generation']\r\n  },\r\n  coding: {\r\n    id: 'coding',\r\n    label: 'Coding', \r\n    icon: Code,\r\n    description: 'Development and implementation',\r\n    patterns: ['implementation', 'file', 'regeneration']\r\n  },\r\n  debugging: {\r\n    id: 'debugging',\r\n    label: 'Debugging',\r\n    icon: Bug, \r\n    description: 'Code fixing and review',\r\n    patterns: ['fixer', 'fix', 'review', 'debug']\r\n  },\r\n  advanced: {\r\n    id: 'advanced',\r\n    label: 'Advanced',\r\n    icon: Wrench,\r\n    description: 'Specialized operations',\r\n    patterns: ['screenshot', 'analysis', 'image', 'vision']\r\n  }\r\n} as const;\r\n\r\n// Helper function to categorize agents dynamically with specific mappings\r\nconst categorizeAgent = (agentKey: string): string => {\r\n  // Specific agent mappings first (highest priority)\r\n  const specificMappings: Record<string, string> = {\r\n    // Quick Start - Most commonly used\r\n    'templateSelection': 'quickstart',\r\n    'blueprint': 'quickstart', \r\n    'conversationalResponse': 'quickstart',\r\n    \r\n    // Planning - Project planning and setup\r\n    'phaseGeneration': 'planning',\r\n    'projectSetup': 'planning',\r\n    \r\n    // Coding - Development and implementation \r\n    'phaseImplementation': 'coding',        // Fix: was going to planning due to \"phase\"\r\n    'firstPhaseImplementation': 'coding',   // Fix: was going to planning due to \"phase\"\r\n    'fileRegeneration': 'coding',           // Fix: was going to planning due to \"generation\"\r\n    \r\n    // Debugging - Code fixing and review\r\n    'realtimeCodeFixer': 'debugging',\r\n    'fastCodeFixer': 'debugging',\r\n    'codeReview': 'debugging',\r\n    \r\n    // Advanced - Specialized operations\r\n    'screenshotAnalysis': 'advanced'\r\n  };\r\n  \r\n  // Check specific mappings first\r\n  if (specificMappings[agentKey]) {\r\n    return specificMappings[agentKey];\r\n  }\r\n  \r\n  // Fallback to pattern matching for unknown agents (future-proofing)\r\n  const key = agentKey.toLowerCase();\r\n  \r\n  // More targeted pattern matching to avoid conflicts\r\n  if (key.includes('template') || key.includes('selection')) return 'quickstart';\r\n  if (key.includes('blueprint') || key.includes('architect')) return 'quickstart';\r\n  if (key.includes('conversation') || key.includes('chat') || key.includes('response')) return 'quickstart';\r\n  \r\n  if (key.includes('project') && key.includes('setup')) return 'planning';\r\n  if (key.includes('suggestion') && key.includes('process')) return 'planning';\r\n  if (key.includes('planning') || key.includes('plan')) return 'planning';\r\n  \r\n  if (key.includes('implementation') || key.includes('implement')) return 'coding';\r\n  if (key.includes('regenerat') || key.includes('regen')) return 'coding';\r\n  if (key.includes('code') && key.includes('gen')) return 'coding';\r\n  \r\n  if (key.includes('fixer') || key.includes('fix')) return 'debugging';\r\n  if (key.includes('debug') || key.includes('review')) return 'debugging';\r\n  if (key.includes('lint') || key.includes('check')) return 'debugging';\r\n  \r\n  if (key.includes('screenshot') || key.includes('image') || key.includes('vision')) return 'advanced';\r\n  if (key.includes('analysis') || key.includes('analyz')) return 'advanced';\r\n  \r\n  // Default to advanced for completely unknown agents\r\n  return 'advanced';\r\n};\r\n\r\n// Frontend-specific agent display interface \r\nexport interface AgentDisplayConfig {\r\n  key: string;\r\n  name: string;\r\n  description: string;\r\n}\r\n\r\ninterface ModelConfigTabsProps {\r\n  agentConfigs: AgentDisplayConfig[];\r\n  modelConfigs: Record<string, UserModelConfigWithMetadata>;\r\n  defaultConfigs: Record<string, ModelConfig>;\r\n  loadingConfigs: boolean;\r\n  onSaveConfig: (agentAction: string, config: ModelConfigUpdate) => Promise<void>;\r\n  onTestConfig: (agentAction: string, tempConfig?: ModelConfigUpdate) => Promise<void>;\r\n  onResetConfig: (agentAction: string) => Promise<void>;\r\n  onResetAllConfigs: () => Promise<void>;\r\n  testingConfig: string | null;\r\n  savingConfigs: boolean;\r\n}\r\n\r\nexport function ModelConfigTabs({\r\n  agentConfigs,\r\n  modelConfigs,\r\n  defaultConfigs,\r\n  loadingConfigs,\r\n  onSaveConfig,\r\n  onTestConfig, \r\n  onResetConfig,\r\n  onResetAllConfigs,\r\n  testingConfig,\r\n  savingConfigs\r\n}: ModelConfigTabsProps) {\r\n  const [activeTab, setActiveTab] = useState('quickstart');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedConfigKey, setSelectedConfigKey] = useState<string | null>(null);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n  // Filter agent configs by search term\r\n  const filteredAgentConfigs = agentConfigs.filter(config =>\r\n    config.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    config.description.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  // Get agents for a specific tab using dynamic categorization\r\n  const getAgentsForTab = useCallback((tabId: string) => {\r\n    return filteredAgentConfigs.filter(config => \r\n      categorizeAgent(config.key) === tabId\r\n    );\r\n  }, [filteredAgentConfigs]);\r\n\r\n  // Count customized configs per tab\r\n  const getCustomizedCountForTab = useCallback((tabId: string) => {\r\n    const agents = getAgentsForTab(tabId);\r\n    return agents.filter(agent => modelConfigs[agent.key]?.isUserOverride).length;\r\n  }, [getAgentsForTab, modelConfigs]);\r\n\r\n  // Handle opening config modal\r\n  const handleConfigureAgent = (agentKey: string) => {\r\n    setSelectedConfigKey(agentKey);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  // Handle closing config modal\r\n  const handleCloseModal = () => {\r\n    setSelectedConfigKey(null);\r\n    setIsModalOpen(false);\r\n  };\r\n\r\n  // Handle bulk test all configured agents\r\n  const handleTestAllConfigured = async () => {\r\n    const customizedConfigs = agentConfigs.filter(config => \r\n      modelConfigs[config.key]?.isUserOverride\r\n    );\r\n    \r\n    if (customizedConfigs.length === 0) {\r\n      toast.info('No customized configurations to test');\r\n      return;\r\n    }\r\n\r\n    let successCount = 0;\r\n    let errorCount = 0;\r\n\r\n    for (const config of customizedConfigs) {\r\n      try {\r\n        await onTestConfig(config.key);\r\n        successCount++;\r\n      } catch (error) {\r\n        errorCount++;\r\n      }\r\n    }\r\n\r\n    toast.success(`Tested ${customizedConfigs.length} configs: ${successCount} passed, ${errorCount} failed`);\r\n  };\r\n\r\n  if (loadingConfigs) {\r\n    return (\r\n      <div className=\"flex items-center gap-3 p-8\">\r\n        <Settings className=\"h-5 w-5 animate-spin text-text-tertiary\" />\r\n        <span className=\"text-sm text-text-tertiary\">Loading model configurations...</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header with controls */}\r\n      <div className=\"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center\">\r\n        <div className=\"flex-1\">\r\n          <h4 className=\"font-medium\">Model Configuration Overrides</h4>\r\n          <p className=\"text-sm text-text-tertiary\">\r\n            Customize AI model settings for different operations. Organized by workflow stage.\r\n          </p>\r\n        </div>\r\n        \r\n        <div className=\"flex flex-col sm:flex-row gap-2 w-full sm:w-auto\">\r\n          {/* Search */}\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-tertiary\" />\r\n            <Input\r\n              placeholder=\"Search configurations...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"pl-9 w-full sm:w-64 dark:bg-bg-1 bg-bg-4\"\r\n            />\r\n          </div>\r\n          \r\n          {/* Action buttons */}\r\n          <div className=\"flex gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={handleTestAllConfigured}\r\n              className=\"gap-2\"\r\n            >\r\n              <Play className=\"h-4 w-4\" />\r\n              Test All\r\n            </Button>\r\n            \r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={onResetAllConfigs}\r\n              disabled={savingConfigs}\r\n              className=\"gap-2\"\r\n            >\r\n              <RotateCcw className=\"h-4 w-4\" />\r\n              {savingConfigs ? 'Resetting...' : 'Reset All'}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabbed interface */}\r\n      <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n        <TabsList className=\"grid w-full grid-cols-5 h-12 items-center border-2 border-bg-2 dark:border-bg-4\">\r\n          {Object.values(WORKFLOW_TABS).map((tab) => {\r\n            const Icon = tab.icon;\r\n            const customizedCount = getCustomizedCountForTab(tab.id);\r\n            \r\n            return (\r\n              <TabsTrigger \r\n                key={tab.id} \r\n                value={tab.id}\r\n                className=\"flex flex-col gap-1 py-1 relative h-[calc(100%-4px)] min-h-[calc(100%-4px)] justify-center\"\r\n              >\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Icon className=\"h-4 w-4\" />\r\n                  <span className=\"hidden sm:inline\">{tab.label}</span>\r\n                </div>\r\n                {customizedCount > 0 && (\r\n                  <Badge variant=\"secondary\" className=\"text-xs absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 flex items-center justify-center\">\r\n                    {customizedCount}\r\n                  </Badge>\r\n                )}\r\n              </TabsTrigger>\r\n            );\r\n          })}\r\n        </TabsList>\r\n\r\n        {Object.values(WORKFLOW_TABS).map((tab) => {\r\n          const agents = getAgentsForTab(tab.id);\r\n          \r\n          return (\r\n            <TabsContent key={tab.id} value={tab.id} className=\"mt-6\">\r\n              <div className=\"space-y-4\">\r\n                {/* Tab description */}\r\n                <div className=\"text-sm text-text-tertiary\">\r\n                  {tab.description}  {agents.length} agent{agents.length !== 1 ? 's' : ''}\r\n                  {getCustomizedCountForTab(tab.id) > 0 && (\r\n                    <span className=\"ml-2 text-text-primary font-medium\">\r\n                      ({getCustomizedCountForTab(tab.id)} customized)\r\n                    </span>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Agent config cards */}\r\n                {agents.length === 0 ? (\r\n                  <div className=\"text-center py-8 text-text-tertiary\">\r\n                    {searchTerm ? 'No configurations match your search.' : 'No configurations in this category.'}\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-8 auto-rows-fr\">\r\n                    {agents.map((agent) => (\r\n                      <ConfigCard\r\n                        key={agent.key}\r\n                        agent={agent}\r\n                        userConfig={modelConfigs[agent.key]}\r\n                        defaultConfig={defaultConfigs[agent.key]}\r\n                        onConfigure={() => handleConfigureAgent(agent.key)}\r\n                        onTest={() => onTestConfig(agent.key)}\r\n                        onReset={() => onResetConfig(agent.key)}\r\n                        isTesting={testingConfig === agent.key}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </TabsContent>\r\n          );\r\n        })}\r\n      </Tabs>\r\n\r\n      {/* Configuration Modal */}\r\n      {selectedConfigKey && (\r\n        <ConfigModal\r\n          isOpen={isModalOpen}\r\n          onClose={handleCloseModal}\r\n          agentConfig={agentConfigs.find(a => a.key === selectedConfigKey)!}\r\n          userConfig={modelConfigs[selectedConfigKey]}\r\n          defaultConfig={defaultConfigs[selectedConfigKey]}\r\n          onSave={(config) => onSaveConfig(selectedConfigKey, config)}\r\n          onTest={(tempConfig) => onTestConfig(selectedConfigKey, tempConfig)}\r\n          onReset={() => onResetConfig(selectedConfigKey)}\r\n          isTesting={testingConfig === selectedConfigKey}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}","import React, { useState } from 'react';\r\n// import { useNavigate } from 'react-router';\r\nimport {\r\n\tEye,\r\n\tEyeOff,\r\n\tGithub,\r\n    Smartphone,\r\n\tTrash2,\r\n\tKey,\r\n\tLock,\r\n    Settings,\r\n} from 'lucide-react';\r\nimport { ModelConfigTabs } from '@/components/model-config-tabs';\r\nimport type {\r\n\tModelConfigsData,\r\n\tModelConfigUpdate,\r\n\tEncryptedSecret,\r\n\tActiveSessionsData,\r\n\tSecretTemplate,\r\n} from '@/api-types';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Separator } from '@/components/ui/separator';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { useAuth } from '@/contexts/auth-context';\r\n// import { useTheme } from '@/contexts/theme-context';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n\tAlertDialog,\r\n\tAlertDialogAction,\r\n\tAlertDialogCancel,\r\n\tAlertDialogContent,\r\n\tAlertDialogDescription,\r\n\tAlertDialogFooter,\r\n\tAlertDialogHeader,\r\n\tAlertDialogTitle,\r\n\tAlertDialogTrigger,\r\n} from '@/components/ui/alert-dialog';\r\nimport {\r\n\tDialog,\r\n\tDialogContent,\r\n\tDialogDescription,\r\n\tDialogFooter,\r\n\tDialogHeader,\r\n\tDialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n\tSelect,\r\n\tSelectContent,\r\n\tSelectItem,\r\n\tSelectTrigger,\r\n\tSelectValue,\r\n} from '@/components/ui/select';\r\nimport { toast } from 'sonner';\r\nimport { apiClient } from '@/lib/api-client';\r\nimport { ByokApiKeysModal } from '@/components/byok-api-keys-modal';\r\n\r\n// Import provider logos (reusing existing pattern from BYOK modal)\r\nimport OpenAILogo from '@/assets/provider-logos/openai.svg?react';\r\nimport AnthropicLogo from '@/assets/provider-logos/anthropic.svg?react';\r\nimport GoogleLogo from '@/assets/provider-logos/google.svg?react';\r\nimport CerebrasLogo from '@/assets/provider-logos/cerebras.svg?react';\r\nimport CloudflareLogo from '@/assets/provider-logos/cloudflare.svg?react';\r\n\r\nexport default function SettingsPage() {\r\n\tconst { user } = useAuth();\r\n\t// Active sessions state\r\n\tconst [activeSessions, setActiveSessions] = useState<\r\n\t\tActiveSessionsData & { loading: boolean }\r\n\t>({ sessions: [], loading: true });\r\n\r\n\t// API Keys state - commented out since not used\r\n\t// const [apiKeys, setApiKeys] = useState<ApiKeysData & { loading: boolean }>({ keys: [], loading: true });\r\n\r\n\t// User Secrets state\r\n\tconst [userSecrets, setUserSecrets] = useState<{\r\n\t\tsecrets: EncryptedSecret[];\r\n\t\tloading: boolean;\r\n\t}>({ secrets: [], loading: true });\r\n\r\n\t// Templates state\r\n\tconst [secretTemplates, setSecretTemplates] = useState<SecretTemplate[]>(\r\n\t\t[],\r\n\t);\r\n\r\n\tconst [secretDialog, setSecretDialog] = useState(false);\r\n\tconst [selectedTemplate, setSelectedTemplate] = useState<string | null>(\r\n\t\tnull,\r\n\t);\r\n\tconst [isCustomSecret, setIsCustomSecret] = useState(false);\r\n\tconst [newSecret, setNewSecret] = useState({\r\n\t\ttemplateId: '',\r\n\t\tname: '',\r\n\t\tenvVarName: '',\r\n\t\tvalue: '',\r\n\t\tenvironment: 'production',\r\n\t\tdescription: '',\r\n\t});\r\n\tconst [showSecretValue, setShowSecretValue] = useState(false);\r\n\tconst [isSavingSecret, setIsSavingSecret] = useState(false);\r\n\r\n\t// Model configurations state\r\n\tconst [agentConfigs, setAgentConfigs] = useState<\r\n\t\tArray<{ key: string; name: string; description: string }>\r\n\t>([]);\r\n\tconst [modelConfigs, setModelConfigs] = useState<\r\n\t\tModelConfigsData['configs']\r\n\t>({} as ModelConfigsData['configs']);\r\n\tconst [defaultConfigs, setDefaultConfigs] = useState<\r\n\t\tModelConfigsData['defaults']\r\n\t>({} as ModelConfigsData['defaults']);\r\n\tconst [loadingConfigs, setLoadingConfigs] = useState(true);\r\n\tconst [savingConfigs, setSavingConfigs] = useState(false);\r\n\tconst [testingConfig, setTestingConfig] = useState<string | null>(null);\r\n\r\n\t// BYOK modal state\r\n\tconst [byokModalOpen, setByokModalOpen] = useState(false);\r\n\r\n\t// Handle BYOK key added/removed - refresh both secrets and model configs\r\n\tconst handleByokKeyAdded = () => {\r\n\t\tloadUserSecrets();\r\n\t\tloadModelConfigs(); // Refresh model configs since BYOK provider availability changed\r\n\t};\r\n\r\n\t// const handleSaveProfile = async () => {\r\n\t// \tif (isSaving) return;\r\n\r\n\t// \ttry {\r\n\t// \t\tsetIsSaving(true);\r\n\r\n\t// \t\tconst response = await fetch('/api/auth/profile', {\r\n\t// \t\t\tmethod: 'PUT',\r\n\t// \t\t\tcredentials: 'include',\r\n\t// \t\t\theaders: {\r\n\t// \t\t\t\t'Content-Type': 'application/json',\r\n\t// \t\t\t},\r\n\t// \t\t\tbody: JSON.stringify({\r\n\t// \t\t\t\t...profileData,\r\n\t// \t\t\t\ttheme: currentTheme,\r\n\t// \t\t\t}),\r\n\t// \t\t});\r\n\r\n\t// \t\tconst data = await response.json();\r\n\r\n\t// \t\tif (response.ok && data.success) {\r\n\t// \t\t\ttoast.success('Profile settings saved');\r\n\t// \t\t\t// Theme context is already updated by handleThemeChange\r\n\t// \t\t\t// Refresh user data in auth context\r\n\t// \t\t\tawait refreshUser();\r\n\t// \t\t} else {\r\n\t// \t\t\ttoast.error(\r\n\t// \t\t\t\tdata.error?.message || 'Failed to save profile settings',\r\n\t// \t\t\t);\r\n\t// \t\t}\r\n\t// \t} catch (error) {\r\n\t// \t\tconsole.error('Profile save error:', error);\r\n\t// \t\ttoast.error('Failed to save profile settings');\r\n\t// \t} finally {\r\n\t// \t\tsetIsSaving(false);\r\n\t// \t}\r\n\t// };\r\n\r\n\t// Helper function to format camelCase to human readable\r\n\tconst formatAgentConfigName = React.useCallback((key: string) => {\r\n\t\treturn key\r\n\t\t\t.replace(/([A-Z])/g, ' $1')\r\n\t\t\t.replace(/^./, (str) => str.toUpperCase())\r\n\t\t\t.trim();\r\n\t}, []);\r\n\r\n\t// Helper function to provide descriptions based on key patterns\r\n\tconst getAgentConfigDescription = React.useCallback(\r\n\t\t(key: string) => {\r\n\t\t\tconst descriptions: Record<string, string> = {\r\n\t\t\t\ttemplateSelection:\r\n\t\t\t\t\t'Quick template selection - Needs to be extremely fast with low latency. Intelligence level is less important than speed for rapid project bootstrapping.',\r\n\t\t\t\tblueprint:\r\n\t\t\t\t\t'Project architecture & UI design - Requires strong design thinking, UI/UX understanding, and architectural planning skills. Speed is important but coding ability is not critical.',\r\n\t\t\t\tprojectSetup:\r\n\t\t\t\t\t'Technical scaffolding setup - Must excel at following technical instructions precisely and setting up proper project structure. Reliability and instruction-following are key.',\r\n\t\t\t\tphaseGeneration:\r\n\t\t\t\t\t'Development phase planning - Needs rapid planning abilities with large context windows for understanding project scope. Quick thinking is essential, coding skills are not required.',\r\n\t\t\t\tfirstPhaseImplementation:\r\n\t\t\t\t\t'Initial development phase - Requires large context windows and excellent coding skills for implementing the foundation. Deep thinking is less critical than execution.',\r\n\t\t\t\tphaseImplementation:\r\n\t\t\t\t\t'Subsequent development phases - Needs large context windows and superior coding abilities for complex feature implementation. Focus is on execution rather than reasoning.',\r\n\t\t\t\trealtimeCodeFixer:\r\n\t\t\t\t\t'Real-time bug detection - Must be extremely fast at identifying and fixing code issues with strong debugging skills. Large context windows are not needed, speed is crucial.',\r\n\t\t\t\tfastCodeFixer:\r\n\t\t\t\t\t'Ultra-fast code fixes - Optimized for maximum speed with decent coding ability. No deep thinking or large context required, pure speed and basic bug fixing.',\r\n\t\t\t\tconversationalResponse:\r\n\t\t\t\t\t'User chat interactions - Handles natural conversation flow and user communication. Balanced capabilities for engaging dialogue and helpful responses.',\r\n\t\t\t\tuserSuggestionProcessor:\r\n\t\t\t\t\t'User feedback processing - Analyzes and implements user suggestions and feedback. Requires understanding user intent and translating to actionable changes.',\r\n\t\t\t\tcodeReview:\r\n\t\t\t\t\t'Code quality analysis - Needs large context windows, strong analytical thinking, and good speed for thorough code review. Must identify issues and suggest improvements.',\r\n\t\t\t\tfileRegeneration:\r\n\t\t\t\t\t'File recreation - Focused on pure coding ability to regenerate or rewrite files. No context window or deep thinking required, just excellent code generation.',\r\n\t\t\t\tscreenshotAnalysis:\r\n\t\t\t\t\t'UI/design analysis - Analyzes visual designs and screenshots to understand UI requirements. Requires visual understanding and design interpretation skills.',\r\n\t\t\t};\r\n\t\t\treturn (\r\n\t\t\t\tdescriptions[key] ||\r\n\t\t\t\t`AI model configuration for ${formatAgentConfigName(key)}`\r\n\t\t\t);\r\n\t\t},\r\n\t\t[formatAgentConfigName],\r\n\t);\r\n\r\n\t// Load model configurations\r\n\tconst loadModelConfigs = async () => {\r\n\t\ttry {\r\n\t\t\tsetLoadingConfigs(true);\r\n\t\t\tconst response = await apiClient.getModelConfigs();\r\n\r\n\t\t\tif (response.success && response.data) {\r\n\t\t\t\tsetModelConfigs(response.data.configs || {});\r\n\t\t\t\tsetDefaultConfigs(response.data.defaults || {});\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\tresponse.error?.message || 'Failed to load model configurations',\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error loading model configurations:', error);\r\n\t\t\ttoast.error('Failed to load model configurations');\r\n\t\t} finally {\r\n\t\t\tsetLoadingConfigs(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Save model configuration\r\n\tconst saveModelConfig = async (\r\n\t\tagentAction: string,\r\n\t\tconfig: ModelConfigUpdate,\r\n\t) => {\r\n\t\ttry {\r\n\t\t\tconst response = await apiClient.updateModelConfig(\r\n\t\t\t\tagentAction,\r\n\t\t\t\tconfig,\r\n\t\t\t);\r\n\r\n\t\t\tif (response.success) {\r\n\t\t\t\ttoast.success('Configuration saved successfully');\r\n\t\t\t\tawait loadModelConfigs(); // Reload to get updated data\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error saving model configuration:', error);\r\n\t\t\ttoast.error('Failed to save configuration');\r\n\t\t}\r\n\t};\r\n\r\n\t// Test model configuration\r\n\tconst testModelConfig = async (\r\n\t\tagentAction: string,\r\n\t\ttempConfig?: ModelConfigUpdate,\r\n\t) => {\r\n\t\ttry {\r\n\t\t\tsetTestingConfig(agentAction);\r\n\t\t\tconst response = await apiClient.testModelConfig(\r\n\t\t\t\tagentAction,\r\n\t\t\t\ttempConfig,\r\n\t\t\t);\r\n\r\n\t\t\tif (response.success && response.data) {\r\n\t\t\t\tconst result = response.data.testResult;\r\n\t\t\t\tif (result.success) {\r\n\t\t\t\t\ttoast.success(\r\n\t\t\t\t\t\t`Test successful! Model: ${result.modelUsed}, Response time: ${result.latencyMs}ms`,\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttoast.error(`Test failed: ${result.error}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error testing configuration:', error);\r\n\t\t\ttoast.error('Failed to test configuration');\r\n\t\t} finally {\r\n\t\t\tsetTestingConfig(null);\r\n\t\t}\r\n\t};\r\n\r\n\t// Reset configuration to default\r\n\tconst resetConfigToDefault = async (agentAction: string) => {\r\n\t\ttry {\r\n\t\t\tawait apiClient.resetModelConfig(agentAction);\r\n\t\t\ttoast.success('Configuration reset to default');\r\n\t\t\tawait loadModelConfigs();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error resetting configuration:', error);\r\n\t\t\ttoast.error('Failed to reset configuration');\r\n\t\t}\r\n\t};\r\n\r\n\t// Reset all configurations\r\n\tconst resetAllConfigs = async () => {\r\n\t\ttry {\r\n\t\t\tsetSavingConfigs(true);\r\n\t\t\tconst response = await apiClient.resetAllModelConfigs();\r\n\t\t\ttoast.success(\r\n\t\t\t\t`${response.data?.resetCount} configurations reset to defaults`,\r\n\t\t\t);\r\n\t\t\tawait loadModelConfigs();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error resetting all configurations:', error);\r\n\t\t\ttoast.error('Failed to reset all configurations');\r\n\t\t} finally {\r\n\t\t\tsetSavingConfigs(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleDeleteAccount = async () => {\r\n\t\ttoast.error('Account deletion is not yet implemented');\r\n\t};\r\n\r\n\t// Load active sessions\r\n\tconst loadActiveSessions = async () => {\r\n\t\ttry {\r\n\t\t\tconst response = await apiClient.getActiveSessions();\r\n\t\t\tsetActiveSessions({\r\n\t\t\t\tsessions: response.data?.sessions || [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 'current',\r\n\t\t\t\t\t\tuserAgent: navigator.userAgent,\r\n\t\t\t\t\t\tipAddress: 'Current location',\r\n\t\t\t\t\t\tlastActivity: new Date(),\r\n\t\t\t\t\t\tcreatedAt: new Date(),\r\n\t\t\t\t\t\tisCurrent: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tloading: false,\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error loading active sessions:', error);\r\n\t\t\tsetActiveSessions({\r\n\t\t\t\tsessions: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 'current',\r\n\t\t\t\t\t\tuserAgent: navigator.userAgent,\r\n\t\t\t\t\t\tipAddress: 'Current location',\r\n\t\t\t\t\t\tlastActivity: new Date(),\r\n\t\t\t\t\t\tcreatedAt: new Date(),\r\n\t\t\t\t\t\tisCurrent: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tloading: false,\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleRevokeSession = async (sessionId: string) => {\r\n\t\ttry {\r\n\t\t\tawait apiClient.revokeSession(sessionId);\r\n\t\t\ttoast.success('Session revoked successfully');\r\n\t\t\tloadActiveSessions();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error revoking session:', error);\r\n\t\t\ttoast.error('Failed to revoke session');\r\n\t\t}\r\n\t};\r\n\r\n\t// Load user secrets\r\n\tconst loadUserSecrets = async () => {\r\n\t\ttry {\r\n\t\t\tconst response = await apiClient.getAllSecrets();\r\n\t\t\tsetUserSecrets({\r\n\t\t\t\tsecrets: response.data?.secrets || [],\r\n\t\t\t\tloading: false,\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error loading user secrets:', error);\r\n\t\t\tsetUserSecrets({\r\n\t\t\t\tsecrets: [],\r\n\t\t\t\tloading: false,\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t// Load secret templates\r\n\tconst loadSecretTemplates = async () => {\r\n\t\ttry {\r\n\t\t\tconst response = await apiClient.getSecretTemplates();\r\n\t\t\tsetSecretTemplates(response.data?.templates || []);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error loading secret templates:', error);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleSaveSecret = async () => {\r\n\t\tif (isSavingSecret) return;\r\n\r\n\t\ttry {\r\n\t\t\tsetIsSavingSecret(true);\r\n\r\n\t\t\tconst payload = isCustomSecret\r\n\t\t\t\t? {\r\n\t\t\t\t\t\tname: newSecret.name,\r\n\t\t\t\t\t\tenvVarName: newSecret.envVarName,\r\n\t\t\t\t\t\tvalue: newSecret.value,\r\n\t\t\t\t\t\tenvironment: newSecret.environment,\r\n\t\t\t\t\t\tdescription: newSecret.description,\r\n\t\t\t\t\t}\r\n\t\t\t\t: {\r\n\t\t\t\t\t\ttemplateId: selectedTemplate || undefined,\r\n\t\t\t\t\t\tvalue: newSecret.value,\r\n\t\t\t\t\t\tenvironment: newSecret.environment,\r\n\t\t\t\t\t};\r\n\r\n\t\t\tawait apiClient.storeSecret(payload);\r\n\t\t\ttoast.success('Secret saved successfully');\r\n\t\t\tresetSecretDialog();\r\n\t\t\tloadUserSecrets();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error saving secret:', error);\r\n\t\t\ttoast.error('Failed to save secret');\r\n\t\t} finally {\r\n\t\t\tsetIsSavingSecret(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst resetSecretDialog = () => {\r\n\t\tsetSecretDialog(false);\r\n\t\tsetSelectedTemplate(null);\r\n\t\tsetIsCustomSecret(false);\r\n\t\tsetNewSecret({\r\n\t\t\ttemplateId: '',\r\n\t\t\tname: '',\r\n\t\t\tenvVarName: '',\r\n\t\t\tvalue: '',\r\n\t\t\tenvironment: 'production',\r\n\t\t\tdescription: '',\r\n\t\t});\r\n\t\tsetShowSecretValue(false);\r\n\t};\r\n\r\n\tconst handleDeleteSecret = async (secretId: string) => {\r\n\t\ttry {\r\n\t\t\tawait apiClient.deleteSecret(secretId);\r\n\t\t\ttoast.success('Secret deleted successfully');\r\n\t\t\tloadUserSecrets();\r\n\t\t\t// Also refresh model configs since BYOK provider availability may have changed\r\n\t\t\tloadModelConfigs();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error deleting secret:', error);\r\n\t\t\ttoast.error('Failed to delete secret');\r\n\t\t}\r\n\t};\r\n\r\n\t// Provider logo mapping (following existing BYOK modal pattern)\r\n\tconst PROVIDER_LOGOS: Record<\r\n\t\tstring,\r\n\t\tReact.ComponentType<{ className?: string }>\r\n\t> = {\r\n\t\topenai: OpenAILogo,\r\n\t\tanthropic: AnthropicLogo,\r\n\t\t'google-ai-studio': GoogleLogo,\r\n\t\tgoogle: GoogleLogo,\r\n\t\tcerebras: CerebrasLogo,\r\n\t\tcloudflare: CloudflareLogo,\r\n\t};\r\n\r\n\tconst getProviderLogo = (\r\n\t\tprovider: string,\r\n\t\tclassName: string = 'h-5 w-5',\r\n\t) => {\r\n\t\tconst LogoComponent = PROVIDER_LOGOS[provider];\r\n\t\tif (LogoComponent) {\r\n\t\t\treturn <LogoComponent className={className} />;\r\n\t\t}\r\n\r\n\t\t// Fallback to emoji for unknown providers\r\n\t\tconst emojiMap: Record<string, string> = {\r\n\t\t\tstripe: '',\r\n\t\t\tgithub: '',\r\n\t\t\tvercel: '',\r\n\t\t\tsupabase: '',\r\n\t\t\tcustom: '',\r\n\t\t};\r\n\r\n\t\treturn <span className=\"text-lg\">{emojiMap[provider] || ''}</span>;\r\n\t};\r\n\r\n\t// Load agent configurations dynamically from API\r\n\tReact.useEffect(() => {\r\n\t\tapiClient\r\n\t\t\t.getModelDefaults()\r\n\t\t\t.then((response) => {\r\n\t\t\t\tif (response.success && response.data?.defaults) {\r\n\t\t\t\t\tconst configs = Object.keys(response.data.defaults).map(\r\n\t\t\t\t\t\t(key) => ({\r\n\t\t\t\t\t\t\tkey,\r\n\t\t\t\t\t\t\tname: formatAgentConfigName(key),\r\n\t\t\t\t\t\t\tdescription: getAgentConfigDescription(key),\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t);\r\n\t\t\t\t\tsetAgentConfigs(configs);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch((error) => {\r\n\t\t\t\tconsole.error('Failed to load agent configurations:', error);\r\n\t\t\t});\r\n\t}, [formatAgentConfigName, getAgentConfigDescription]);\r\n\r\n\t// Load GitHub integration, sessions, API keys, user secrets, and model configs on component mount\r\n\tReact.useEffect(() => {\r\n\t\tif (user) {\r\n\t\t\tloadActiveSessions();\r\n\t\t\tloadModelConfigs();\r\n            loadSecretTemplates();\r\n\t\t}\r\n\t}, [user]);\r\n\r\n\treturn (\r\n\t\t<div className=\"min-h-screen bg-bg-3 relative\">\r\n\t\t\t<main className=\"container mx-auto px-4 py-8 max-w-4xl\">\r\n\t\t\t\t<div className=\"space-y-8\">\r\n\t\t\t\t\t{/* Page Header */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h1 className=\"text-4xl font-bold font-[departureMono] text-red-500\">\r\n\t\t\t\t\t\t\tSETTINGS\r\n\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t\t<p className=\"text-text-tertiary mt-2\">\r\n\t\t\t\t\t\t\tManage your account settings and preferences\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Integrations Section */}\r\n\t\t\t\t\t{/* <Card id=\"integrations\">\r\n\t\t\t\t\t\t<CardHeader variant=\"minimal\">\r\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 border-b w-full py-3 text-text-primary\">\r\n\t\t\t\t\t\t\t\t<Link className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<CardTitle>Integrations</CardTitle>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</CardHeader>\r\n\t\t\t\t\t\t<CardContent className=\"space-y-4 px-6 mt-6\">\r\n\t\t\t\t\t\t\t{githubIntegration.loading ? (\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t<Settings className=\"h-5 w-5 animate-spin text-text-tertiary\" />\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\tLoading GitHub integration status...\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t) : githubIntegration.hasIntegration ? (\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"h-10 w-10 rounded-full bg-[#24292e] flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Github className=\"h-5 w-5 text-white\" />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tGitHub Connected\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t@\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tgithubIntegration.githubUsername\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t<Badge\r\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"bg-green-100 text-green-800\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\tConnected\r\n\t\t\t\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={handleDisconnectGithub}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<Unlink className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\tDisconnect\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"h-10 w-10 rounded-full bg-bg-2 border-bg-1 dark:border-bg-4 border flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Github className=\"h-5 w-5 text-text-tertiary\" />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tGitHub App for Exports\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-text-primary text-xs\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tConnect your GitHub account to export generated code directly to\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trepositories\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{githubIntegration.loading && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<RefreshCw className=\"w-3 h-3 text-text-primary/60 animate-spin\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\tonClick={handleConnectGithub}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2 bg-text-primary hover:bg-[#1a1e22] text-bg-1\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Github className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\tInstall GitHub App\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t</Card> */}\r\n\r\n\t\t\t\t\t{/* Model Configuration Section */}\r\n\t\t\t\t\t<Card id=\"model-configs\">\r\n\t\t\t\t\t\t<CardHeader variant=\"minimal\">\r\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 border-b w-full py-3 text-text-primary\">\r\n\t\t\t\t\t\t\t\t{' '}\r\n\t\t\t\t\t\t\t\t<Settings className=\"h-5 w-5\" />\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<CardTitle>\r\n\t\t\t\t\t\t\t\t\t\tAI Model Configurations\r\n\t\t\t\t\t\t\t\t\t</CardTitle>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</CardHeader>\r\n\t\t\t\t\t\t<CardContent className=\"space-y-6 px-6\">\r\n\t\t\t\t\t\t\t{/* Provider API Keys Integration */}\r\n\t\t\t\t\t\t\t<div className=\"space-y-2 mt-6\">\r\n\t\t\t\t\t\t\t\t<h4 className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\tProvider API Keys\r\n\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\tAI provider API keys are managed in the \"API\r\n\t\t\t\t\t\t\t\t\tKeys & Secrets\" section below. Configure\r\n\t\t\t\t\t\t\t\t\tyour OpenAI, Anthropic, Google AI, and\r\n\t\t\t\t\t\t\t\t\tOpenRouter keys there.\r\n\t\t\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tconst secretsSection =\r\n\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('secrets');\r\n\t\t\t\t\t\t\t\t\t\tif (secretsSection) {\r\n\t\t\t\t\t\t\t\t\t\t\tsecretsSection.scrollIntoView({\r\n\t\t\t\t\t\t\t\t\t\t\t\tbehavior: 'smooth',\r\n\t\t\t\t\t\t\t\t\t\t\t\tblock: 'start',\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\tclassName=\"gap-2 shrink-0\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Key className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\tManage Keys\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<Separator />\r\n\r\n\t\t\t\t\t\t\t{/* Model Configuration Tabs */}\r\n\t\t\t\t\t\t\t<ModelConfigTabs\r\n\t\t\t\t\t\t\t\tagentConfigs={agentConfigs}\r\n\t\t\t\t\t\t\t\tmodelConfigs={modelConfigs}\r\n\t\t\t\t\t\t\t\tdefaultConfigs={defaultConfigs}\r\n\t\t\t\t\t\t\t\tloadingConfigs={loadingConfigs}\r\n\t\t\t\t\t\t\t\tonSaveConfig={saveModelConfig}\r\n\t\t\t\t\t\t\t\tonTestConfig={testModelConfig}\r\n\t\t\t\t\t\t\t\tonResetConfig={resetConfigToDefault}\r\n\t\t\t\t\t\t\t\tonResetAllConfigs={resetAllConfigs}\r\n\t\t\t\t\t\t\t\ttestingConfig={testingConfig}\r\n\t\t\t\t\t\t\t\tsavingConfigs={savingConfigs}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t</Card>\r\n\r\n\t\t\t\t\t{/* User Secrets Section */}\r\n\t\t\t\t\t<Card id=\"secrets\">\r\n\t\t\t\t\t\t<CardHeader variant=\"minimal\">\r\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 border-b w-full py-3 text-text-primary\">\r\n\t\t\t\t\t\t\t\t<Key className=\"h-5 w-5\" />\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<CardTitle>API Keys & Secrets</CardTitle>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</CardHeader>\r\n\t\t\t\t\t\t<CardContent className=\"space-y-3 mt-4 px-6\">\r\n\t\t\t\t\t\t\t{/* App Environment Variables Section */}\r\n\t\t\t\t\t\t\t{/* <div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<h4 className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\tEnvironment Variables for the\r\n\t\t\t\t\t\t\t\t\t\t\tgenerated apps\r\n\t\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<Dialog\r\n\t\t\t\t\t\t\t\t\t\topen={secretDialog}\r\n\t\t\t\t\t\t\t\t\t\tonOpenChange={(open) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (open) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetSelectedTemplate(null);\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetIsCustomSecret(false);\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetNewSecret({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttemplateId: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tenvVarName: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tenvironment: 'production',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdescription: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tsetSecretDialog(open);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<DialogTrigger asChild>\r\n\t\t\t\t\t\t\t\t\t\t\t<Button size=\"sm\" className=\"gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Plus className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\tAdd Env Vars\r\n\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t</DialogTrigger>\r\n\t\t\t\t\t\t\t\t\t</Dialog>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t{userSecrets.loading ? (\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t<Settings className=\"h-5 w-5 animate-spin text-text-tertiary\" />\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\tLoading secrets...\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t) : userSecrets.secrets.length === 0 ? (\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-center py-8 border-2 border-dashed dark:border-bg-4 rounded-lg\">\r\n\t\t\t\t\t\t\t\t\t\t<Key className=\"h-8 w-8 text-text-tertiary mx-auto mb-2\" />\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\tAdd API keys and secrets that your\r\n\t\t\t\t\t\t\t\t\t\t\tgenerated apps can use\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-3\">\r\n\t\t\t\t\t\t\t\t\t\t{userSecrets.secrets\r\n\t\t\t\t\t\t\t\t\t\t\t.filter(\r\n\t\t\t\t\t\t\t\t\t\t\t\t(secret) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t!secret.secretType.endsWith(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'_BYOK',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t.map((secret) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={secret.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`flex items-center justify-between p-4 border rounded-lg transition-colors ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.isActive\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-bg-4'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-bg-3/20 border-dashed opacity-70'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`flex items-center justify-center w-8 h-8 rounded-md border shadow-sm ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.isActive\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-white'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-bg-3 border-dashed opacity-60'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{getProviderLogo(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.provider,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`h-5 w-5 ${secret.isActive ? '' : 'opacity-60'}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`font-medium ${secret.isActive ? '' : 'opacity-60'}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{secret.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.isActive\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'default'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'outline'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`text-xs ${secret.isActive ? '' : 'opacity-60'}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{secret.isActive\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'Active'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'Inactive'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`text-xs ${secret.isActive ? '' : 'opacity-60'}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.provider\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`text-xs ${secret.isActive ? '' : 'opacity-60'}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{secret.secretType.replace(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'_',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t' ',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.keyPreview\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{secret.description && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-text-tertiary mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.description\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialog>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogTrigger\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tasChild\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-destructive hover:text-destructive\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Trash2 className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogTrigger>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogContent>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogHeader>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogTitle>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDelete\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tSecret\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogTitle>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogDescription>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAre you\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsure you\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twant to\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdelete \"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"? This\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taction\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcannot\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbe\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tundone.\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogDescription>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogHeader>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogFooter>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogCancel>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogCancel>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogAction\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleDeleteSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDelete\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogAction>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogFooter>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogContent>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialog>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div> */}\r\n\r\n\t\t\t\t\t\t\t{/* <Separator /> */}\r\n\r\n\t\t\t\t\t\t\t{/* BYOK API Keys Section */}\r\n\t\t\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t\t\t\t\t\t<h4 className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\tBYOK Provider Keys\r\n\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => setByokModalOpen(true)}\r\n                                        disabled // DISABLED: BYOK Disabled for security reasons\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Key className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t{/* Manage BYOK Keys */}\r\n                                        Coming Soon\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t{/* BYOK Status Display */}\r\n\t\t\t\t\t\t\t\t{(() => {\r\n\t\t\t\t\t\t\t\t\tconst byokSecrets =\r\n\t\t\t\t\t\t\t\t\t\tuserSecrets.secrets.filter((secret) =>\r\n\t\t\t\t\t\t\t\t\t\t\tsecret.secretType.endsWith('_BYOK'),\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\t\tif (byokSecrets.length === 0) {\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-center py-6 border-2 border-dashed dark:border-bg-4 border-muted rounded-lg\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Key className=\"h-8 w-8 text-text-tertiary mx-auto mb-2\" />\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Add your LLM keys to use\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tyour own billing */}\r\n                                                    Coming Soon: You would be able to add your own LLM keys to bypass rate limits from here.\r\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"rounded-lg bg-bg-3/50 p-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between mb-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{byokSecrets.length}{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprovider\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{byokSecrets.length !==\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 's'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconfigured\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{byokSecrets.map((secret) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst providerName =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.secretType\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.replace(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'_API_KEY_BYOK',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.replace('_', ' ')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.toLowerCase()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.replace(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/\\b\\w/g,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(l) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tl.toUpperCase(),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={secret.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`flex items-center justify-between p-3 border rounded-lg transition-colors ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.isActive\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-white/50 dark:bg-gray-800/50'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-bg-3/20 border-dashed opacity-70'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`flex items-center justify-center w-8 h-8 rounded-md border shadow-sm ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.isActive\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-white'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-bg-3 border-dashed opacity-60'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{getProviderLogo(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.provider,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`h-5 w-5 ${secret.isActive ? '' : 'opacity-60'}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`font-medium text-sm ${secret.isActive ? '' : 'opacity-60'}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tproviderName\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`text-xs text-text-tertiary ${secret.isActive ? '' : 'opacity-60'}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.keyPreview\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.isActive\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'default'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'outline'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`text-xs ${secret.isActive ? '' : 'opacity-60'}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{secret.isActive\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'Active'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'Inactive'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialog>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogTrigger\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tasChild\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-destructive hover:text-destructive h-8 w-8 p-0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Trash2 className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogTrigger>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogContent>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogHeader>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogTitle>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tRemove{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tproviderName\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tKey\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogTitle>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogDescription>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAre\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tyou\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsure\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tyou\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twant\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tto\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tremove\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tyour{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tproviderName\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAPI\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey?\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tYou'll\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tneed\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tto\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tadd\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tit\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tagain\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tto\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tuse\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBYOK\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmode\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twith\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprovider.\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogDescription>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogHeader>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogFooter>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogCancel>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogCancel>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertDialogAction\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleDeleteSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tRemove\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tKey\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogAction>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogFooter>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialogContent>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AlertDialog>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-text-tertiary mt-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tThese keys are used\r\n\t\t\t\t\t\t\t\t\t\t\t\tautomatically when you select\r\n\t\t\t\t\t\t\t\t\t\t\t\tBYOK mode in model\r\n\t\t\t\t\t\t\t\t\t\t\t\tconfigurations.\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"link\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-xs p-0 h-auto ml-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst modelConfigsSection =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'model-configs',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmodelConfigsSection\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmodelConfigsSection.scrollIntoView(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbehavior:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'smooth',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tblock: 'start',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tConfigure models \r\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Add Secret Dialog */}\r\n\t\t\t\t\t\t\t<Dialog\r\n\t\t\t\t\t\t\t\topen={secretDialog}\r\n\t\t\t\t\t\t\t\tonOpenChange={resetSecretDialog}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<DialogContent className=\"max-w-lg\">\r\n\t\t\t\t\t\t\t\t\t<DialogHeader>\r\n\t\t\t\t\t\t\t\t\t\t<DialogTitle>\r\n\t\t\t\t\t\t\t\t\t\t\tAdd API Key or Secret\r\n\t\t\t\t\t\t\t\t\t\t</DialogTitle>\r\n\t\t\t\t\t\t\t\t\t\t<DialogDescription>\r\n\t\t\t\t\t\t\t\t\t\t\tChoose a predefined template or add\r\n\t\t\t\t\t\t\t\t\t\t\ta custom environment variable\r\n\t\t\t\t\t\t\t\t\t\t</DialogDescription>\r\n\t\t\t\t\t\t\t\t\t</DialogHeader>\r\n\r\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-6\">\r\n\t\t\t\t\t\t\t\t\t\t{/* Step 1: Template Selection */}\r\n\t\t\t\t\t\t\t\t\t\t{!selectedTemplate &&\r\n\t\t\t\t\t\t\t\t\t\t\t!isCustomSecret && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h4 className=\"font-medium mb-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tQuick Setup\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(Recommended)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-1 gap-2 max-h-60 overflow-y-auto\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{secretTemplates\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.sort(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(a, b) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(b.required\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 0) -\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(a.required\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 0),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"justify-start h-auto p-3 text-left\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelectedTemplate(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetNewSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplateId:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tenvironment:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'production',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-start\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-lg\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate.icon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-start\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Github className=\"w-5 h-5 text-yellow-400 dark:text-yellow-200 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ul className=\"space-y-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<strong>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tMore\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecure:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</strong>{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tUses\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshort-lived\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttokens\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thour\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\texpiry)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<strong>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tFine-grained\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpermissions:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</strong>{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tOnly\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taccesses\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trepositories\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tyou\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchoose\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<strong>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tOne-time\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetup:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</strong>{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tInstall\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonce,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\texport\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tanytime\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<strong>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tGitHub\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trecommended:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</strong>{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tApps\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tare\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthe\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpreferred\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tintegration\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmethod\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"absolute inset-0 flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"w-full border-t\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative flex justify-center text-xs uppercase\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"bg-bg-3 px-2 text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tOr\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full justify-start h-auto p-3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetIsCustomSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrue,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-lg\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-left\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCustom\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEnvironment\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tVariable\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAdd any\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcustom API\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey or\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecret with\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tyour own\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariable\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t{/* Step 2: Template Form */}\r\n\t\t\t\t\t\t\t\t\t\t{selectedTemplate && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst template =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecretTemplates.find(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(t) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tt.id ===\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedTemplate,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (!template) return null;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 p-3 bg-bg-3/50 rounded-lg\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xl\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate.icon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h4 className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate.displayName\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate.description\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelectedTemplate(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnull,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetNewSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplateId:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tChange\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEnvironment\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tVariable\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tName\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate.envVarName\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"bg-bg-3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-text-tertiary mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tThis\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twill be\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tavailable\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tas{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<code className=\"bg-bg-3 px-1 rounded text-xs\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate.envVarName\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</code>{' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tin your\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgenerated\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tapps\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Label htmlFor=\"templateValue\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tValue\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"templateValue\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowSecretValue\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'text'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'password'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate.placeholder\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnewSecret.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetNewSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.target\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"pr-10\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetShowSecretValue(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!showSecretValue,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{showSecretValue ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<EyeOff className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Eye className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"rounded-lg bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 p-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h5 className=\"font-medium text-blue-900 dark:text-blue-100 text-sm mb-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tHow to\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tget\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h5>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-blue-700 dark:text-blue-300\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate.instructions\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t{/* Step 3: Custom Secret Form */}\r\n\t\t\t\t\t\t\t\t\t\t{isCustomSecret && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<h4 className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCustom Environment\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tVariable\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetIsCustomSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfalse,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetNewSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(prev) => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tenvVarName:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: '',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBack\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label htmlFor=\"customName\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tDisplay Name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"customName\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"e.g., My Custom API Key\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={newSecret.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetNewSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(prev) => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.target\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label htmlFor=\"customEnvVar\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tEnvironment Variable\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tName\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"customEnvVar\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"e.g., MY_API_KEY\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnewSecret.envVarName\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetNewSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(prev) => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tenvVarName:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.target.value.toUpperCase(),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-text-tertiary mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tMust be uppercase\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tletters, numbers, and\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tunderscores only\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label htmlFor=\"customValue\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tValue\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Input\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"customValue\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowSecretValue\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'text'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'password'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Enter your API key or secret\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnewSecret.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetNewSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(prev) => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.target\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"pr-10\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetShowSecretValue(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!showSecretValue,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{showSecretValue ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<EyeOff className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Eye className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label htmlFor=\"customDescription\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tDescription (Optional)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Textarea\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"customDescription\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Brief description of this secret\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnewSecret.description\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetNewSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(prev) => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdescription:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.target\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trows={2}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t{/* Environment Selection (for both template and custom) */}\r\n\t\t\t\t\t\t\t\t\t\t{(selectedTemplate ||\r\n\t\t\t\t\t\t\t\t\t\t\tisCustomSecret) && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Label htmlFor=\"environment\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tEnvironment\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnewSecret.environment\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonValueChange={(value) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetNewSecret(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(prev) => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tenvironment:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<SelectTrigger>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SelectValue />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</SelectTrigger>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<SelectContent>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SelectItem value=\"production\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tProduction\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</SelectItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SelectItem value=\"sandbox\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tSandbox\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</SelectItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SelectItem value=\"test\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTest\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</SelectItem>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</SelectContent>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<DialogFooter>\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={resetSecretDialog}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t{(selectedTemplate ||\r\n\t\t\t\t\t\t\t\t\t\t\tisCustomSecret) && (\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={handleSaveSecret}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t!newSecret.value ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t(isCustomSecret &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(!newSecret.name ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!newSecret.envVarName)) ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tisSavingSecret\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{isSavingSecret\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'Saving...'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'Save Secret'}\r\n\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</DialogFooter>\r\n\t\t\t\t\t\t\t\t</DialogContent>\r\n\t\t\t\t\t\t\t</Dialog>\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t</Card>\r\n\r\n\t\t\t\t\t{/* Security Section */}\r\n\t\t\t\t\t<Card id=\"security\">\r\n\t\t\t\t\t\t<CardHeader variant=\"minimal\">\r\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 border-b w-full py-3 text-text-primary\">\r\n\t\t\t\t\t\t\t\t<Lock className=\"h-5 w-5\" />\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<CardTitle className=\"text-lg\">\r\n\t\t\t\t\t\t\t\t\t\tSecurity\r\n\t\t\t\t\t\t\t\t\t</CardTitle>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</CardHeader>\r\n\t\t\t\t\t\t<CardContent className=\"space-y-3 mt-2 px-6\">\r\n\t\t\t\t\t\t\t{/* Connected Accounts */}\r\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t\t\t\t\t<h4 className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\tConnected Accounts\r\n\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"h-5 w-5 rounded-full bg-bg-3 flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t{user?.provider === 'google'\r\n\t\t\t\t\t\t\t\t\t\t\t\t? ''\r\n\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm font-medium capitalize\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{user?.provider}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{user?.email}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<Badge variant=\"secondary\">Connected</Badge>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<Separator />\r\n\r\n\t\t\t\t\t\t\t{/* Active Sessions */}\r\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t\t\t\t\t<h4 className=\"font-medium\">Active Sessions</h4>\r\n\t\t\t\t\t\t\t\t{activeSessions.loading ? (\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t<Settings className=\"h-5 w-5 animate-spin text-text-tertiary\" />\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\tLoading active sessions...\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\tactiveSessions.sessions.map((session) => (\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tkey={session.id}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center justify-between\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Smartphone className=\"h-5 w-5 text-text-tertiary\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium text-sm\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{session.isCurrent\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'Current Session'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'Other Session'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{session.ipAddress} {' '}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{new Date(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsession.lastActivity,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t).toLocaleDateString()}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{session.isCurrent ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"bg-green-400 size-3 rounded-full ring-green-200 ring-2 animate-pulse\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleRevokeSession(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsession.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-destructive hover:text-destructive\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tRevoke\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t</Card>\r\n\r\n\t\t\t\t\t<div className=\"space-y-4 p-3\">\r\n\t\t\t\t\t\t<h4 className=\"font-medium text-destructive\">\r\n\t\t\t\t\t\t\tDanger Zone\r\n\t\t\t\t\t\t</h4>\r\n\r\n\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<p className=\"font-medium text-text-primary\">Delete Account</p>\r\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\tPermanently delete your account and all data\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<AlertDialog>\r\n\t\t\t\t\t\t\t\t<AlertDialogTrigger asChild>\r\n\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\tvariant=\"destructive\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Trash2 className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\tDelete Account\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</AlertDialogTrigger>\r\n\t\t\t\t\t\t\t\t<AlertDialogContent>\r\n\t\t\t\t\t\t\t\t\t<AlertDialogHeader>\r\n\t\t\t\t\t\t\t\t\t\t<AlertDialogTitle>\r\n\t\t\t\t\t\t\t\t\t\t\tAre you absolutely sure?\r\n\t\t\t\t\t\t\t\t\t\t</AlertDialogTitle>\r\n\t\t\t\t\t\t\t\t\t\t<AlertDialogDescription>\r\n\t\t\t\t\t\t\t\t\t\t\tThis action cannot be undone. This\r\n\t\t\t\t\t\t\t\t\t\t\twill permanently delete your account\r\n\t\t\t\t\t\t\t\t\t\t\tand remove all your data from our\r\n\t\t\t\t\t\t\t\t\t\t\tservers.\r\n\t\t\t\t\t\t\t\t\t\t</AlertDialogDescription>\r\n\t\t\t\t\t\t\t\t\t</AlertDialogHeader>\r\n\t\t\t\t\t\t\t\t\t<AlertDialogFooter>\r\n\t\t\t\t\t\t\t\t\t\t<AlertDialogCancel>\r\n\t\t\t\t\t\t\t\t\t\t\tCancel\r\n\t\t\t\t\t\t\t\t\t\t</AlertDialogCancel>\r\n\t\t\t\t\t\t\t\t\t\t<AlertDialogAction\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={handleDeleteAccount}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\tDelete Account\r\n\t\t\t\t\t\t\t\t\t\t</AlertDialogAction>\r\n\t\t\t\t\t\t\t\t\t</AlertDialogFooter>\r\n\t\t\t\t\t\t\t\t</AlertDialogContent>\r\n\t\t\t\t\t\t\t</AlertDialog>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</main>\r\n\r\n\t\t\t{/* BYOK API Keys Modal */}\r\n\t\t\t<ByokApiKeysModal\r\n\t\t\t\tisOpen={byokModalOpen}\r\n\t\t\t\tonClose={() => setByokModalOpen(false)}\r\n\t\t\t\tonKeyAdded={handleByokKeyAdded}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { useEffect, useRef } from 'react';\r\n\r\ninterface UseInfiniteScrollOptions {\r\n  threshold?: number;\r\n  enabled?: boolean;\r\n  onLoadMore?: () => void;\r\n}\r\n\r\ninterface UseInfiniteScrollResult {\r\n  triggerRef: React.RefObject<HTMLDivElement | null>;\r\n}\r\n\r\nexport function useInfiniteScroll({\r\n  threshold = 400,\r\n  enabled = true,\r\n  onLoadMore\r\n}: UseInfiniteScrollOptions = {}): UseInfiniteScrollResult {\r\n  const triggerRef = useRef<HTMLDivElement | null>(null);\r\n  const isLoadingRef = useRef(false);\r\n\r\n  useEffect(() => {\r\n    if (!triggerRef.current || !enabled || !onLoadMore) return;\r\n\r\n    const observer = new IntersectionObserver(\r\n      (entries) => {\r\n        const [entry] = entries;\r\n        if (entry.isIntersecting && !isLoadingRef.current) {\r\n          isLoadingRef.current = true;\r\n          onLoadMore();\r\n          \r\n          // Reset after a brief delay to prevent duplicate calls\r\n          setTimeout(() => {\r\n            isLoadingRef.current = false;\r\n          }, 300);\r\n        }\r\n      },\r\n      {\r\n        rootMargin: `${threshold}px`,\r\n        threshold: 0\r\n      }\r\n    );\r\n\r\n    observer.observe(triggerRef.current);\r\n    return () => observer.disconnect();\r\n  }, [threshold, enabled, onLoadMore]);\r\n\r\n  // Reset loading state when enabled changes to prevent stuck state\r\n  useEffect(() => {\r\n    if (!enabled) {\r\n      isLoadingRef.current = false;\r\n    }\r\n  }, [enabled]);\r\n\r\n  return { triggerRef };\r\n}","import React from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { Loader2, RefreshCw, X, Code2 } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { AppCard } from './AppCard';\r\nimport type { AppListData } from '@/hooks/use-paginated-apps';\r\nimport type { AppSortOption } from '@/api-types';\r\nimport { useInfiniteScroll } from '@/hooks/use-infinite-scroll';\r\n\r\ninterface AppListContainerProps {\r\n  apps: AppListData[];\r\n  loading: boolean;\r\n  loadingMore: boolean;\r\n  error: string | null;\r\n  hasMore: boolean;\r\n  totalCount: number;\r\n  sortBy: AppSortOption;\r\n  onAppClick: (appId: string) => void;\r\n  onToggleFavorite?: (appId: string) => void;\r\n  onLoadMore: () => void;\r\n  onRetry: () => void;\r\n  showUser?: boolean;\r\n  showStats?: boolean;\r\n  showActions?: boolean;\r\n  infiniteScroll?: boolean;\r\n  emptyState?: {\r\n    title?: string;\r\n    description?: string;\r\n    action?: React.ReactNode;\r\n  };\r\n  className?: string;\r\n}\r\n\r\nconst containerVariants = {\r\n  hidden: { opacity: 0 },\r\n  visible: {\r\n    opacity: 1,\r\n    transition: {\r\n      staggerChildren: 0.05 // Reduced from 0.1 for faster animation\r\n    }\r\n  }\r\n};\r\n\r\nconst getEmptyStateDefaults = (sortBy: AppSortOption, totalCount: number) => {\r\n  if (totalCount === 0) {\r\n    // No apps at all\r\n    return {\r\n      title: 'No apps yet',\r\n      description: 'Start building your first app with AI assistance.'\r\n    };\r\n  }\r\n\r\n  // Apps exist but current filter/sort shows none\r\n  switch (sortBy) {\r\n    case 'popular':\r\n      return {\r\n        title: 'No popular apps yet',\r\n        description: 'Apps will appear here once they start getting views, stars, or forks.'\r\n      };\r\n    case 'starred':\r\n      return {\r\n        title: 'No bookmarked apps yet',\r\n        description: 'Apps you bookmark will appear here. Click the bookmark icon on any app to add it.'\r\n      };\r\n    case 'trending':\r\n      return {\r\n        title: 'No trending apps yet',\r\n        description: 'Apps will appear here based on recent activity and engagement.'\r\n      };\r\n    case 'recent':\r\n    default:\r\n      return {\r\n        title: 'No apps match your filters',\r\n        description: 'Try adjusting your search or filters to find what you\\'re looking for.'\r\n      };\r\n  }\r\n};\r\n\r\nexport const AppListContainer: React.FC<AppListContainerProps> = ({\r\n  apps,\r\n  loading,\r\n  loadingMore,\r\n  error,\r\n  hasMore,\r\n  totalCount,\r\n  sortBy,\r\n  onAppClick,\r\n  onToggleFavorite,\r\n  onLoadMore,\r\n  onRetry,\r\n  showUser = false,\r\n  showStats = true,\r\n  showActions = false,\r\n  infiniteScroll = true,\r\n  emptyState,\r\n  className = \"\"\r\n}) => {\r\n  const defaultEmptyState = getEmptyStateDefaults(sortBy, totalCount);\r\n  \r\n  const { triggerRef } = useInfiniteScroll({\r\n    threshold: 200,\r\n    enabled: infiniteScroll && hasMore && !loadingMore,\r\n    onLoadMore: onLoadMore\r\n  });\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center py-20\">\r\n        <div className=\"text-center\">\r\n          <Loader2 className=\"h-8 w-8 animate-spin mx-auto mb-4 text-text-tertiary\" />\r\n          <p className=\"text-neutral-50\">Loading apps...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"text-center py-20\">\r\n        <div className=\"rounded-full bg-destructive/10 p-3 mb-4 inline-flex\">\r\n          <X className=\"h-6 w-6 text-destructive\" />\r\n        </div>\r\n        <h3 className=\"text-xl text-text-secondary font-semibold mb-2\">Failed to load apps</h3>\r\n        <p className=\"text-text-tertiary mb-6\">{error}</p>\r\n        <Button onClick={onRetry} variant=\"outline\">\r\n          <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n          Retry\r\n        </Button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (apps.length === 0) {\r\n    const emptyStateContent = emptyState || defaultEmptyState;\r\n    \r\n    return (\r\n      <div className=\"text-center py-20\">\r\n        <Code2 className=\"h-16 w-16 mx-auto mb-4 text-text-tertiary\" />\r\n        <h3 className=\"text-xl font-semibold mb-2 text-text-secondary\">\r\n          {emptyStateContent.title}\r\n        </h3>\r\n        <p className=\"text-text-tertiary mb-6\">\r\n          {emptyStateContent.description}\r\n        </p>\r\n        {'action' in emptyStateContent && emptyStateContent.action}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={className}>\r\n      <motion.div\r\n        variants={containerVariants}\r\n        initial=\"hidden\"\r\n        animate=\"visible\"\r\n        className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\"\r\n      >\r\n        <AnimatePresence mode=\"popLayout\">\r\n          {apps.map(app => (\r\n            <AppCard \r\n              key={app.id} \r\n              app={app}\r\n              onClick={onAppClick}\r\n              onToggleFavorite={onToggleFavorite}\r\n              showStats={showStats}\r\n              showUser={showUser}\r\n              showActions={showActions}\r\n            />\r\n          ))}\r\n        </AnimatePresence>\r\n      </motion.div>\r\n\r\n      {infiniteScroll && hasMore && (\r\n        <div \r\n          ref={triggerRef} \r\n          className=\"relative mt-8\"\r\n          style={{ height: loadingMore ? 'auto' : '80px' }}\r\n        >\r\n          {loadingMore && (\r\n            <motion.div \r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              transition={{ duration: 0.3 }}\r\n              className=\"space-y-4\"\r\n            >\r\n              {/* Subtle loading indicator */}\r\n              <div className=\"flex items-center justify-center py-4\">\r\n                <div className=\"flex items-center gap-3 px-4 py-2 rounded-full bg-surface-elevated/60 backdrop-blur-sm border border-border/30\">\r\n                  <Loader2 className=\"h-4 w-4 animate-spin text-accent\" />\r\n                  <span className=\"text-sm text-text-tertiary\">Loading more amazing apps...</span>\r\n                </div>\r\n              </div>\r\n              \r\n              {/* Optional: Skeleton placeholders for smoother experience */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n                {[...Array(4)].map((_, i) => (\r\n                  <div key={`skeleton-${i}`} className=\"animate-pulse\">\r\n                    <div className=\"bg-surface-elevated/30 rounded-2xl p-6 h-[200px]\">\r\n                      <div className=\"h-4 bg-surface-elevated/50 rounded w-3/4 mb-3\"></div>\r\n                      <div className=\"h-3 bg-surface-elevated/40 rounded w-full mb-2\"></div>\r\n                      <div className=\"h-3 bg-surface-elevated/40 rounded w-5/6\"></div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </motion.div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {!infiniteScroll && loadingMore && (\r\n        <div className=\"flex justify-center mt-8\">\r\n          <div className=\"flex items-center gap-2 text-text-tertiary\">\r\n            <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n            <span className=\"text-sm\">Loading more apps...</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {!infiniteScroll && hasMore && (\r\n        <div className=\"flex justify-center mt-8\">\r\n          <Button\r\n            onClick={onLoadMore}\r\n            disabled={loadingMore}\r\n            variant=\"outline\"\r\n            className=\"gap-2\"\r\n          >\r\n            {loadingMore ? (\r\n              <>\r\n                <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                Loading more...\r\n              </>\r\n            ) : (\r\n              <>\r\n                Load more apps\r\n              </>\r\n            )}\r\n          </Button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Show total count */}\r\n      {totalCount > 0 && (\r\n        <div className=\"text-center mt-6 text-sm text-text-tertiary\">\r\n          Showing {apps.length} of {totalCount} apps\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};","import React from 'react';\r\nimport { Search } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport type { TimePeriod, AppSortOption } from '@/api-types';\r\n\r\ninterface AppFiltersFormProps {\r\n  // Search props\r\n  searchQuery: string;\r\n  onSearchChange: (query: string) => void;\r\n  onSearchSubmit: (e: React.FormEvent) => void;\r\n  searchPlaceholder?: string;\r\n  showSearchButton?: boolean;\r\n\r\n  // Framework filter props\r\n  filterFramework: string;\r\n  onFrameworkChange: (framework: string) => void;\r\n\r\n  // Visibility filter props (optional - only for user apps)\r\n  filterVisibility?: string;\r\n  onVisibilityChange?: (visibility: string) => void;\r\n  showVisibility?: boolean;\r\n\r\n  // Time period props (conditional)\r\n  period?: TimePeriod;\r\n  onPeriodChange?: (period: TimePeriod) => void;\r\n  sortBy?: AppSortOption;\r\n\r\n  // Layout props\r\n  className?: string;\r\n}\r\n\r\n\r\nexport const AppFiltersForm: React.FC<AppFiltersFormProps> = ({\r\n  searchQuery,\r\n  onSearchChange,\r\n  onSearchSubmit,\r\n  searchPlaceholder = 'Search apps...',\r\n  showSearchButton = false,\r\n  className = ''\r\n}) => {\r\n\r\n  return (\r\n    <div className={`max-w-4xl mb-8 ${className}`}>\r\n      <form onSubmit={onSearchSubmit} className=\"flex gap-2 mb-4\">\r\n        <div className=\"relative\">\r\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-tertiary\" />\r\n          <Input\r\n            type=\"text\"\r\n            placeholder={searchPlaceholder}\r\n            value={searchQuery}\r\n            onChange={(e) => onSearchChange(e.target.value)}\r\n            className=\"pl-10 bg-bg-4 w-90\"\r\n          />\r\n        </div>\r\n        \r\n\r\n        {showSearchButton && (\r\n          <Button type=\"submit\">\r\n            Search\r\n          </Button>\r\n        )}\r\n      </form>\r\n    </div>\r\n  );\r\n};","import React from 'react';\r\nimport { Clock, TrendingUp, ChevronDownIcon, Star } from 'lucide-react';\r\nimport type { AppSortOption } from '@/api-types';\r\n\r\ninterface SortOption {\r\n  value: AppSortOption;\r\n  label: string;\r\n  icon: React.ComponentType<{ className?: string }>;\r\n}\r\n\r\ninterface AppSortTabsProps {\r\n  value: AppSortOption;\r\n  onValueChange: (value: AppSortOption) => void;\r\n  availableSorts?: AppSortOption[];\r\n  className?: string;\r\n}\r\n\r\n// Define all possible sort options with their display properties\r\nconst SORT_CONFIGURATIONS: Record<AppSortOption, SortOption> = {\r\n  recent: {\r\n    value: 'recent',\r\n    label: 'Recent',\r\n    icon: Clock\r\n  },\r\n  popular: {\r\n    value: 'popular',\r\n    label: 'Popular',\r\n    icon: TrendingUp\r\n  },\r\n  trending: {\r\n    value: 'trending',\r\n    label: 'Trending',\r\n    icon: TrendingUp\r\n  },\r\n  starred: {\r\n    value: 'starred',\r\n    label: 'Starred',\r\n    icon: Star\r\n  },\r\n};\r\n\r\nexport const AppSortTabs: React.FC<AppSortTabsProps> = ({\r\n  value,\r\n  onValueChange,\r\n  availableSorts = ['recent', 'popular', 'trending'],\r\n}) => {\r\n  const sortOptions = availableSorts.map((sortKey) => SORT_CONFIGURATIONS[sortKey]);\r\n\r\n  return (<div className=\"grid grid-cols-1\">\r\n        <select\r\n          id=\"location\"\r\n          name=\"location\"\r\n          value={value}\r\n          onChange={(e) => onValueChange(e.target.value as AppSortOption)}\r\n          className=\"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pl-3 pr-8 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 focus-visible:outline focus-visible:-outline-offset-2 focus-visible:outline-indigo-600 sm:text-sm/6 dark:bg-white/5 dark:text-white dark:outline-white/10 dark:*:bg-gray-800 dark:focus-visible:outline-indigo-500\"\r\n        >\r\n          {sortOptions.map((e) => (<option key={e.value} value={e.value}>{e.label}</option>))}\r\n        </select>\r\n        <ChevronDownIcon\r\n          aria-hidden=\"true\"\r\n          className=\"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4 dark:text-gray-400\"\r\n        />\r\n      </div>);\r\n};","import React from 'react';\r\nimport { Globe, Lock, Sparkles } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport { motion } from 'framer-motion';\r\n\r\ninterface VisibilityFilterProps {\r\n  value: string;\r\n  onChange: (value: string) => void;\r\n  className?: string;\r\n}\r\n\r\nconst visibilityOptions = [\r\n  { \r\n    value: 'all', \r\n    label: 'All', \r\n    icon: Sparkles,\r\n    color: 'from-violet-500/20 to-purple-500/20',\r\n    activeColor: 'from-violet-500/10 to-purple-500/10'\r\n  },\r\n  { \r\n    value: 'public', \r\n    label: 'Public', \r\n    icon: Globe,\r\n    color: 'from-green-500/20 to-emerald-500/20',\r\n    activeColor: 'from-green-500/10 to-emerald-500/10'\r\n  },\r\n  { \r\n    value: 'private', \r\n    label: 'Private', \r\n    icon: Lock,\r\n    color: 'from-orange-500/20 to-red-500/20',\r\n    activeColor: 'from-orange-500/10 to-red-500/10'\r\n  },\r\n];\r\n\r\nexport const VisibilityFilter: React.FC<VisibilityFilterProps> = ({\r\n  value,\r\n  onChange,\r\n  className\r\n}) => {\r\n  return (\r\n    <div className={cn(\r\n      \"inline-flex items-center rounded-lg bg-bg-4 p-0.5\",\r\n      className\r\n    )}>\r\n      {visibilityOptions.map((option) => {\r\n        const Icon = option.icon;\r\n        const isActive = value === option.value;\r\n        \r\n        return (\r\n          <motion.button\r\n            key={option.value}\r\n            onClick={() => onChange(option.value)}\r\n            className={cn(\r\n              \"relative inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-xs font-medium transition-all duration-200\",\r\n              \"outline-none focus-visible:ring-1 focus-visible:ring-accent/30\",\r\n              isActive\r\n                ? \"text-text-primary\"\r\n                : \"text-text-tertiary hover:text-text-secondary\",\r\n              !isActive && \"hover:bg-bg-3/30\"\r\n            )}\r\n            whileHover={{ scale: isActive ? 1 : 1.01 }}\r\n            whileTap={{ scale: 0.99 }}\r\n          >\r\n            {isActive && (\r\n              <motion.div\r\n                className={cn(\r\n                  \"absolute inset-0 rounded-md bg-bg-1 shadow-sm\"\r\n                )}\r\n                layoutId=\"activeBackground\"\r\n                transition={{\r\n                  type: \"spring\",\r\n                  stiffness: 500,\r\n                  damping: 35\r\n                }}\r\n              />\r\n            )}\r\n            <span className=\"relative flex items-center gap-1.5\">\r\n              <Icon className={cn(\r\n                \"h-3 w-3 transition-colors duration-200\",\r\n                isActive && \"text-accent\"\r\n              )} />\r\n              <span>{option.label}</span>\r\n            </span>\r\n          </motion.button>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n","import { useNavigate, useSearchParams } from 'react-router';\r\nimport { motion } from 'framer-motion';\r\nimport { toggleFavorite } from '@/hooks/use-apps';\r\nimport { usePaginatedApps } from '@/hooks/use-paginated-apps';\r\nimport { AppListContainer } from '@/components/shared/AppListContainer';\r\nimport { AppFiltersForm } from '@/components/shared/AppFiltersForm';\r\nimport { AppSortTabs } from '@/components/shared/AppSortTabs';\r\nimport { VisibilityFilter } from '@/components/shared/VisibilityFilter';\r\nimport type { AppSortOption } from '@/api-types';\r\n\r\nexport default function AppsPage() {\r\n\tconst navigate = useNavigate();\r\n\tconst [searchParams, setSearchParams] = useSearchParams();\r\n\r\n\t// Derive initial sort from URL or localStorage, fallback to 'recent'\r\n\tconst allowedSorts: AppSortOption[] = ['recent', 'popular', 'trending', 'starred'];\r\n\tconst sortParam = searchParams.get('sort') as AppSortOption | null;\r\n\tconst savedSort = (typeof localStorage !== 'undefined' ? localStorage.getItem('apps.sort') : null) as AppSortOption | null;\r\n\tconst initialSort: AppSortOption = (sortParam && allowedSorts.includes(sortParam))\r\n\t\t? sortParam\r\n\t\t: (savedSort && allowedSorts.includes(savedSort) ? savedSort : 'recent');\r\n\r\n\tconst {\r\n\t\t// Filter state\r\n\t\tsearchQuery,\r\n\t\tsetSearchQuery,\r\n\t\tfilterFramework,\r\n\t\tfilterVisibility,\r\n\t\tsortBy,\r\n\t\tperiod,\r\n\r\n\t\t// Data state\r\n\t\tapps,\r\n\t\tloading,\r\n\t\tloadingMore,\r\n\t\terror,\r\n\t\ttotalCount,\r\n\t\thasMore,\r\n\r\n\t\t// Form handlers\r\n\t\thandleSearchSubmit,\r\n\t\thandleSortChange,\r\n\t\thandlePeriodChange,\r\n\t\thandleFrameworkChange,\r\n\t\thandleVisibilityChange,\r\n\r\n\t\t// Pagination handlers\r\n\t\trefetch,\r\n\t\tloadMore,\r\n\t} = usePaginatedApps({\r\n\t\ttype: 'user',\r\n\t\tdefaultSort: initialSort,\r\n\t\tincludeVisibility: true,\r\n\t\tlimit: 20,\r\n\t});\r\n\r\n\tconst handleToggleFavorite = async (appId: string) => {\r\n\t\ttry {\r\n\t\t\tawait toggleFavorite(appId);\r\n\t\t\trefetch();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Failed to toggle favorite:', error);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"min-h-screen bg-bg-3\">\r\n\t\t\t<div className=\"container mx-auto px-4 py-8\">\r\n\t\t\t\t<motion.div\r\n\t\t\t\t\tinitial={{ opacity: 0, y: -20 }}\r\n\t\t\t\t\tanimate={{ opacity: 1, y: 0 }}\r\n\t\t\t\t\ttransition={{ duration: 0.5 }}\r\n\t\t\t\t>\r\n\t\t\t\t\t{/* Header */}\r\n\t\t\t\t\t<div className=\"mb-8\">\r\n\t\t\t\t\t\t<h1 className=\"text-6xl font-bold mb-3 font-[departureMono] text-accent\">\r\n\t\t\t\t\t\t\tMY APPS\r\n\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t\t<p className=\"text-text-tertiary text-lg\">\r\n\t\t\t\t\t\t\t{loading\r\n\t\t\t\t\t\t\t\t? 'Loading...'\r\n\t\t\t\t\t\t\t\t: `${totalCount} app${totalCount !== 1 ? 's' : ''} in your workspace`}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"flex flex-col gap-4\">\r\n\t\t\t\t\t\t<div className=\"flex items-center gap-4\">\r\n\t\t\t\t\t\t\t<VisibilityFilter\r\n\t\t\t\t\t\t\t\tvalue={filterVisibility}\r\n\t\t\t\t\t\t\t\tonChange={handleVisibilityChange}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div className=\"flex items-start gap-4 justify-between\">\r\n\t\t\t\t\t\t\t{/* Search and Filters */}\r\n\t\t\t\t\t\t\t<AppFiltersForm\r\n\t\t\t\t\t\t\t\tsearchQuery={searchQuery}\r\n\t\t\t\t\t\t\t\tonSearchChange={setSearchQuery}\r\n\t\t\t\t\t\t\t\tonSearchSubmit={handleSearchSubmit}\r\n\t\t\t\t\t\t\t\tsearchPlaceholder=\"Search your apps...\"\r\n\t\t\t\t\t\t\t\tfilterFramework={filterFramework}\r\n\t\t\t\t\t\t\t\tonFrameworkChange={handleFrameworkChange}\r\n\t\t\t\t\t\t\t\tfilterVisibility={filterVisibility}\r\n\t\t\t\t\t\t\t\tonVisibilityChange={handleVisibilityChange}\r\n\t\t\t\t\t\t\t\tshowVisibility={false}\r\n\t\t\t\t\t\t\t\tperiod={period}\r\n\t\t\t\t\t\t\t\tonPeriodChange={handlePeriodChange}\r\n\t\t\t\t\t\t\t\tsortBy={sortBy}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t<AppSortTabs\r\n\t\t\t\t\t\t\t\tvalue={sortBy}\r\n\t\t\t\t\t\t\t\tonValueChange={(v) => {\r\n\t\t\t\t\t\t\t\t\thandleSortChange(v);\r\n\t\t\t\t\t\t\t\t\t// Persist to URL and localStorage\r\n\t\t\t\t\t\t\t\t\ttry { localStorage.setItem('apps.sort', v); } catch {}\r\n\t\t\t\t\t\t\t\t\tconst next = new URLSearchParams(searchParams);\r\n\t\t\t\t\t\t\t\t\tnext.set('sort', v);\r\n\t\t\t\t\t\t\t\t\tsetSearchParams(next, { replace: true });\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tavailableSorts={['recent', 'popular', 'trending', 'starred']}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Unified App List */}\r\n\t\t\t\t\t<AppListContainer\r\n\t\t\t\t\t\tapps={apps}\r\n\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\tloadingMore={loadingMore}\r\n\t\t\t\t\t\terror={error}\r\n\t\t\t\t\t\thasMore={hasMore}\r\n\t\t\t\t\t\ttotalCount={totalCount}\r\n\t\t\t\t\t\tsortBy={sortBy}\r\n\t\t\t\t\t\tonAppClick={(appId) => navigate(`/app/${appId}`)}\r\n\t\t\t\t\t\tonToggleFavorite={handleToggleFavorite}\r\n\t\t\t\t\t\tonLoadMore={loadMore}\r\n\t\t\t\t\t\tonRetry={refetch}\r\n\t\t\t\t\t\tshowUser={false}\r\n\t\t\t\t\t\tshowStats={true}\r\n\t\t\t\t\t\tshowActions={true}\r\n\t\t\t\t\t\tinfiniteScroll={true}\r\n\t\t\t\t\t\temptyState={\r\n\t\t\t\t\t\t\t!searchQuery &&\r\n\t\t\t\t\t\t\tfilterFramework === 'all' &&\r\n\t\t\t\t\t\t\tfilterVisibility === 'all' &&\r\n\t\t\t\t\t\t\tsortBy === 'recent' &&\r\n\t\t\t\t\t\t\ttotalCount === 0\r\n\t\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'No apps yet',\r\n\t\t\t\t\t\t\t\t\t\tdescription:\r\n\t\t\t\t\t\t\t\t\t\t\t'Start building your first app with AI assistance.',\r\n\t\t\t\t\t\t\t\t\t\taction: <div></div>,\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</motion.div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { useState, useEffect, useRef, useCallback, useMemo } from 'react';\r\nimport { useParams, useNavigate, useSearchParams } from 'react-router';\r\nimport type { AppDetailsData, FileType } from '@/api-types';\r\nimport { apiClient, ApiError } from '@/lib/api-client';\r\nimport { appEvents } from '@/lib/app-events';\r\nimport {\r\n\tStar,\r\n\tEye,\r\n\tCode2,\r\n\tChevronLeft,\r\n\tExternalLink,\r\n\tCopy,\r\n\tCheck,\r\n\tLoader2,\r\n\tMessageSquare,\r\n\tCalendar,\r\n\tUser,\r\n\tPlay,\r\n\tLock,\r\n\tUnlock,\r\n\tBookmark,\r\n\tGlobe,\r\n\tTrash2,\r\n\tGithub,\r\n} from 'lucide-react';\r\nimport { MonacoEditor } from '@/components/monaco-editor/monaco-editor';\r\nimport { getFileType } from '@/utils/string';\r\nimport { Button } from '@/components/ui/button';\r\nimport {\r\n\tCard,\r\n\tCardContent,\r\n\tCardDescription,\r\n\tCardHeader,\r\n\tCardTitle,\r\n} from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { useAuth } from '@/contexts/auth-context';\r\nimport { toggleFavorite } from '@/hooks/use-apps';\r\nimport { formatDistanceToNow, isValid } from 'date-fns';\r\nimport { toast } from 'sonner';\r\nimport { capitalizeFirstLetter, cn, getPreviewUrl } from '@/lib/utils';\r\nimport { ConfirmDeleteDialog } from '@/components/shared/ConfirmDeleteDialog';\r\nimport { useAuthGuard } from '@/hooks/useAuthGuard';\r\nimport { PreviewIframe } from '../chat/components/preview-iframe';\r\n\r\n// Use proper types from API types\r\ntype AppDetails = AppDetailsData;\r\n\r\n// Define supported actions for OAuth redirect\r\ntype PendingAction = 'favorite' | 'bookmark' | 'star' | 'fork' | 'remix';\r\n\r\n// Supported actions constant for validation\r\nconst SUPPORTED_ACTIONS: PendingAction[] = [\r\n\t'favorite',\r\n\t'bookmark',\r\n\t'star',\r\n\t'fork',\r\n\t'remix',\r\n];\r\n\r\n// Action configuration type for reusability\r\ninterface ActionConfig {\r\n\taction: PendingAction;\r\n\tcontext: string;\r\n\thandler: () => Promise<void>;\r\n\terrorMessage: string;\r\n}\r\n\r\n// Action mapping for aliases (bookmark -> favorite, remix -> fork)\r\nconst ACTION_MAP: Record<PendingAction, string> = {\r\n\tfavorite: 'favorite',\r\n\tbookmark: 'favorite',\r\n\tstar: 'star',\r\n\tfork: 'fork',\r\n\tremix: 'fork',\r\n};\r\nexport default function AppView() {\r\n\tconst { id } = useParams();\r\n\tconst navigate = useNavigate();\r\n\tconst [searchParams, setSearchParams] = useSearchParams();\r\n\tconst { user } = useAuth();\r\n\tconst { requireAuth } = useAuthGuard();\r\n\tconst [app, setApp] = useState<AppDetails | null>(null);\r\n\tconst [loading, setLoading] = useState(true);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [isFavorited, setIsFavorited] = useState(false);\r\n\tconst [isStarred, setIsStarred] = useState(false);\r\n\tconst [copySuccess, setCopySuccess] = useState(false);\r\n\tconst [activeTab, setActiveTab] = useState('preview');\r\n\tconst [isDeploying, setIsDeploying] = useState(false);\r\n\tconst [deploymentProgress, setDeploymentProgress] = useState<string>('');\r\n\tconst [isUpdatingVisibility, setIsUpdatingVisibility] = useState(false);\r\n\tconst [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\r\n\tconst [isDeleting, setIsDeleting] = useState(false);\r\n\tconst [activeFilePath, setActiveFilePath] = useState<string>();\r\n\tconst previewIframeRef = useRef<HTMLIFrameElement>(null);\r\n\r\n\tconst fetchAppDetails = useCallback(async () => {\r\n\t\tif (!id) return;\r\n\r\n\t\ttry {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\t// Fetch app details using API client\r\n\t\t\tconst appResponse = await apiClient.getAppDetails(id);\r\n\r\n\t\t\tif (appResponse.success && appResponse.data) {\r\n\t\t\t\tconst appData = appResponse.data;\r\n\t\t\t\tsetApp(appData);\r\n\t\t\t\tsetIsFavorited(appData.userFavorited || false);\r\n\t\t\t\tsetIsStarred(appData.userStarred || false);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\tappResponse.error?.message || 'Failed to fetch app details',\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('Error fetching app:', err);\r\n\t\t\tif (err instanceof ApiError) {\r\n\t\t\t\tif (err.status === 404) {\r\n\t\t\t\t\tsetError('App not found');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetError(`Failed to load app: ${err.message}`);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsetError(\r\n\t\t\t\t\terr instanceof Error ? err.message : 'Failed to load app',\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, [id]);\r\n\r\n\tuseEffect(() => {\r\n\t\tfetchAppDetails();\r\n\t}, [id, fetchAppDetails]);\r\n\r\n\r\n\t// Convert agent files to chat FileType format\r\n\tconst files = useMemo<FileType[]>(() => {\r\n\t\tif (!app?.agentSummary?.generatedCode) return [];\r\n\t\treturn app.agentSummary.generatedCode\r\n\t\t\t.filter((file) => file && file.filePath && typeof file.filePath === 'string')\r\n\t\t\t.map((file) => ({\r\n\t\t\t\tfilePath: file.filePath,\r\n\t\t\t\tfileContents: file.fileContents || '',\r\n\t\t\t\texplanation: file.filePurpose,\r\n\t\t\t\tlanguage: getFileType(file.filePath),\r\n\t\t\t\tisGenerating: false,\r\n\t\t\t\tneedsFixing: false,\r\n\t\t\t\thasErrors: false,\r\n\t\t\t}));\r\n\t}, [app?.agentSummary?.generatedCode]);\r\n\r\n\t// Get active file\r\n\tconst activeFile = useMemo(() => {\r\n\t\treturn files.find((file) => file.filePath === activeFilePath);\r\n\t}, [files, activeFilePath]);\r\n\r\n\t// Auto-select first file when files are loaded\r\n\tuseEffect(() => {\r\n\t\tif (files.length > 0 && !activeFilePath) {\r\n\t\t\tsetActiveFilePath(files[0].filePath);\r\n\t\t}\r\n\t}, [files, activeFilePath]);\r\n\r\n\t// File click handler\r\n\tconst handleFileClick = useCallback((file: FileType) => {\r\n\t\tsetActiveFilePath(file.filePath);\r\n\t}, []);\r\n\r\n\t// Action configuration for reusability\r\n\tconst actionConfigs: Record<string, ActionConfig> = useMemo(\r\n\t\t() => ({\r\n\t\t\tfavorite: {\r\n\t\t\t\taction: 'favorite',\r\n\t\t\t\tcontext: 'to bookmark apps',\r\n\t\t\t\thandler: async () => {\r\n\t\t\t\t\tif (!app) return;\r\n\t\t\t\t\tconst newState = await toggleFavorite(app.id);\r\n\t\t\t\t\tsetIsFavorited(newState);\r\n\t\t\t\t\ttoast.success(\r\n\t\t\t\t\t\tnewState\r\n\t\t\t\t\t\t\t? 'Added to bookmarks'\r\n\t\t\t\t\t\t\t: 'Removed from bookmarks',\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\terrorMessage: 'Failed to update bookmarks',\r\n\t\t\t},\r\n\t\t\tstar: {\r\n\t\t\t\taction: 'star',\r\n\t\t\t\tcontext: 'to star apps',\r\n\t\t\t\thandler: async () => {\r\n\t\t\t\t\tif (!app) return;\r\n\t\t\t\t\tconst response = await apiClient.toggleAppStar(app.id);\r\n\r\n\t\t\t\t\tif (response.success && response.data) {\r\n\t\t\t\t\t\tsetIsStarred(response.data.isStarred);\r\n\t\t\t\t\t\tsetApp((prev) =>\r\n\t\t\t\t\t\t\tprev\r\n\t\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\t\t\t\tstarCount: response.data?.starCount || 0,\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t: null,\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\ttoast.success(\r\n\t\t\t\t\t\t\tresponse.data.isStarred ? 'Starred!' : 'Unstarred',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(response.error?.message || 'Failed to star app');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terrorMessage: 'Failed to update star',\r\n\t\t\t},\r\n\t\t\t// fork: {\r\n\t\t\t// \taction: 'fork',\r\n\t\t\t// \tcontext: 'to remix this app',\r\n\t\t\t// \thandler: async () => {\r\n\t\t\t// \t\tif (!app) return;\r\n\t\t\t// \t\tconst response = await apiClient.forkApp(app.id);\r\n\r\n\t\t\t// \t\tif (response.success && response.data) {\r\n\t\t\t// \t\t\ttoast.success(\r\n\t\t\t// \t\t\t\tresponse.data.message ||\r\n\t\t\t// \t\t\t\t\t'App remixed successfully!',\r\n\t\t\t// \t\t\t);\r\n\r\n\t\t\t// \t\t\t// Emit app-created event for sidebar updates\r\n\t\t\t// \t\t\tappEvents.emitAppCreated(response.data.forkedAppId, {\r\n\t\t\t// \t\t\t\ttitle: `${app.title} (Remix)`,\r\n\t\t\t// \t\t\t\tdescription: app.description || undefined,\r\n\t\t\t// \t\t\t\tisForked: true,\r\n\t\t\t// \t\t\t});\r\n\r\n\t\t\t// \t\t\tnavigate(`/chat/${response.data.forkedAppId}`);\r\n\t\t\t// \t\t} else {\r\n\t\t\t// \t\t\tthrow new Error(\r\n\t\t\t// \t\t\t\tresponse.error?.message || 'Failed to remix app',\r\n\t\t\t// \t\t\t);\r\n\t\t\t// \t\t}\r\n\t\t\t// \t},\r\n\t\t\t// \terrorMessage: 'Failed to remix app',\r\n\t\t\t// },\r\n\t\t}),\r\n\t\t[app],\r\n\t);\r\n\r\n\t// Reusable authenticated action handler\r\n\tconst createAuthenticatedHandler = useCallback(\r\n\t\t(configKey: string) => {\r\n\t\t\treturn async () => {\r\n\t\t\t\tif (!app) return;\r\n\r\n\t\t\t\tconst config = actionConfigs[configKey];\r\n\t\t\t\tif (!config) return;\r\n\r\n\t\t\t\tconst currentUrl = `/app/${app.id}?action=${config.action}`;\r\n\r\n\t\t\t\t// Use auth guard with action parameter in intended URL\r\n\t\t\t\tif (\r\n\t\t\t\t\t!requireAuth({\r\n\t\t\t\t\t\trequireFullAuth: true,\r\n\t\t\t\t\t\tactionContext: config.context,\r\n\t\t\t\t\t\tintendedUrl: currentUrl,\r\n\t\t\t\t\t})\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// User is authenticated, execute immediately\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait config.handler();\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error(`${config.action} error:`, error);\r\n\t\t\t\t\ttoast.error(\r\n\t\t\t\t\t\terror instanceof ApiError\r\n\t\t\t\t\t\t\t? error.message\r\n\t\t\t\t\t\t\t: config.errorMessage,\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\t[actionConfigs, app, requireAuth],\r\n\t);\r\n\r\n\t// Create action handlers using the reusable pattern\r\n\tconst handleFavorite = useMemo(\r\n\t\t() => createAuthenticatedHandler('favorite'),\r\n\t\t[createAuthenticatedHandler],\r\n\t);\r\n\tconst handleStar = useMemo(\r\n\t\t() => createAuthenticatedHandler('star'),\r\n\t\t[createAuthenticatedHandler],\r\n\t);\r\n\t// const handleFork = useMemo(\r\n\t// \t() => createAuthenticatedHandler('fork'),\r\n\t// \t[createAuthenticatedHandler],\r\n\t// );\r\n\r\n\t// Handle pending actions after OAuth redirect\r\n\tconst executePendingAction = useCallback(\r\n\t\tasync (action: PendingAction) => {\r\n\t\t\tif (!app) return;\r\n\r\n\t\t\tconst configKey = ACTION_MAP[action];\r\n\t\t\tif (!configKey) {\r\n\t\t\t\tconsole.warn('Unknown pending action:', action);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst config = actionConfigs[configKey];\r\n\t\t\tif (!config) {\r\n\t\t\t\tconsole.warn('No config found for action:', action);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait config.handler();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\r\n\t\t\t\t\t'Failed to execute pending action:',\r\n\t\t\t\t\taction,\r\n\t\t\t\t\terror,\r\n\t\t\t\t);\r\n\t\t\t\ttoast.error(\r\n\t\t\t\t\terror instanceof ApiError\r\n\t\t\t\t\t\t? error.message\r\n\t\t\t\t\t\t: config.errorMessage,\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[actionConfigs, app],\r\n\t);\r\n\r\n\t// Effect to handle pending actions after OAuth redirect\r\n\tuseEffect(() => {\r\n\t\tif (!user || !app || loading) return;\r\n\r\n\t\tconst actionParam = searchParams.get('action');\r\n\t\tif (!actionParam) return;\r\n\r\n\t\t// Validate action parameter against our supported types\r\n\t\tconst action = SUPPORTED_ACTIONS.find((a) => a === actionParam);\r\n\r\n\t\tif (!action) {\r\n\t\t\tconsole.warn('Unsupported action parameter:', actionParam);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Clear the action parameter from URL first\r\n\t\tconst newSearchParams = new URLSearchParams(searchParams);\r\n\t\tnewSearchParams.delete('action');\r\n\t\tsetSearchParams(newSearchParams, { replace: true });\r\n\r\n\t\t// Execute the pending action\r\n\t\texecutePendingAction(action);\r\n\t}, [\r\n\t\tuser,\r\n\t\tapp,\r\n\t\tloading,\r\n\t\tsearchParams,\r\n\t\tsetSearchParams,\r\n\t\texecutePendingAction,\r\n\t]);\r\n\r\n\tconst handleCopyUrl = () => {\r\n\t\tif (!appUrl) return;\r\n\r\n\t\tnavigator.clipboard.writeText(appUrl);\r\n\t\tsetCopySuccess(true);\r\n\t\tsetTimeout(() => setCopySuccess(false), 2000);\r\n\t};\r\n\r\n\tconst getAppUrl = () => {\r\n\t\treturn app?.cloudflareUrl || app?.previewUrl || '';\r\n\t};\r\n\r\n\tconst handlePreviewDeploy = async () => {\r\n\t\tif (!app || isDeploying) return;\r\n\r\n\t\ttry {\r\n\t\t\tsetIsDeploying(true);\r\n\t\t\tsetDeploymentProgress('Connecting to agent...');\r\n            const response = await apiClient.deployPreview(app.id);\r\n            if (response.success && response.data) {\r\n                const data = response.data;\r\n                if (data.previewURL || data.tunnelURL) {\r\n                    const newUrl = getPreviewUrl(\r\n                        data.previewURL,\r\n                        data.tunnelURL,\r\n                    );\r\n                    setApp((prev) =>\r\n                        prev\r\n                            ? {\r\n                                    ...prev,\r\n                                    cloudflareUrl: newUrl,\r\n                                    previewUrl: newUrl,\r\n                                }\r\n                            : null,\r\n                    );\r\n                    setDeploymentProgress('Deployment complete!');\r\n                }\r\n            }\r\n            setIsDeploying(false);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error starting deployment:', error);\r\n\t\t\tsetDeploymentProgress('Failed to start deployment');\r\n\t\t\tsetIsDeploying(false);\r\n\t\t\ttoast.error('Failed to start deployment');\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleToggleVisibility = async () => {\r\n\t\tif (!app || !user || !isOwner) {\r\n\t\t\ttoast.error('You can only change visibility of your own apps');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tsetIsUpdatingVisibility(true);\r\n\t\t\tconst newVisibility =\r\n\t\t\t\tapp.visibility === 'private' ? 'public' : 'private';\r\n\r\n\t\t\tconst response = await apiClient.updateAppVisibility(\r\n\t\t\t\tapp.id,\r\n\t\t\t\tnewVisibility,\r\n\t\t\t);\r\n\r\n\t\t\tif (response.success && response.data) {\r\n\t\t\t\t// Update the app state with new visibility\r\n\t\t\t\tsetApp((prev) =>\r\n\t\t\t\t\tprev ? { ...prev, visibility: newVisibility } : null,\r\n\t\t\t\t);\r\n\r\n\t\t\t\ttoast.success(\r\n\t\t\t\t\tresponse.data.message ||\r\n\t\t\t\t\t\t`App is now ${newVisibility === 'private' ? 'private' : 'public'}`,\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\tresponse.error?.message || 'Failed to update visibility',\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error updating app visibility:', error);\r\n\t\t\ttoast.error(\r\n\t\t\t\terror instanceof ApiError\r\n\t\t\t\t\t? error.message\r\n\t\t\t\t\t: 'Failed to update visibility',\r\n\t\t\t);\r\n\t\t} finally {\r\n\t\t\tsetIsUpdatingVisibility(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleDeleteApp = async () => {\r\n\t\tif (!app) return;\r\n\r\n\t\ttry {\r\n\t\t\tsetIsDeleting(true);\r\n\t\t\tconst response = await apiClient.deleteApp(app.id);\r\n\r\n\t\t\tif (response.success) {\r\n\t\t\t\ttoast.success('App deleted successfully');\r\n\t\t\t\tsetIsDeleteDialogOpen(false);\r\n\r\n\t\t\t\t// Emit global app deleted event\r\n\t\t\t\tappEvents.emitAppDeleted(app.id);\r\n\r\n\t\t\t\t// Smart navigation after deletion\r\n\t\t\t\t// Use window.history to go back if possible, otherwise navigate to apps page\r\n\t\t\t\tif (window.history.length > 1) {\r\n\t\t\t\t\t// Try to go back to previous page\r\n\t\t\t\t\twindow.history.back();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// No history available, go to apps page\r\n\t\t\t\t\tnavigate('/apps');\r\n\t\t\t\t}\r\n            }\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error deleting app:', error);\r\n\t\t\ttoast.error('An unexpected error occurred while deleting the app');\r\n\t\t} finally {\r\n\t\t\tsetIsDeleting(false);\r\n\t\t}\r\n\t};\r\n\r\n\tif (loading) {\r\n\t\treturn (\r\n\t\t\t<div className=\"min-h-screen bg-bg-3 flex items-center justify-center\">\r\n\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t<Loader2 className=\"h-8 w-8 animate-spin mx-auto mb-4 text-text-tertiary\" />\r\n\t\t\t\t\t<p className=\"text-text-tertiary\">Loading app...</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tif (error || !app) {\r\n\t\treturn (\r\n\t\t\t<div className=\"min-h-screen bg-bg-3 flex items-center justify-center\">\r\n\t\t\t\t<Card className=\"max-w-md\">\r\n\t\t\t\t\t<CardContent className=\"pt-6\">\r\n\t\t\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t\t\t<h2 className=\"text-xl font-semibold mb-2\">\r\n\t\t\t\t\t\t\t\tApp not found\r\n\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t<p className=\"text-text-tertiary mb-4\">\r\n\t\t\t\t\t\t\t\t{error ||\r\n\t\t\t\t\t\t\t\t\t\"The app you're looking for doesn't exist.\"}\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t<Button onClick={() => navigate('/apps')}>\r\n\t\t\t\t\t\t\t\t<ChevronLeft className=\"mr-2 h-4 w-4\" />\r\n\t\t\t\t\t\t\t\tBack to Apps\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</CardContent>\r\n\t\t\t\t</Card>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tconst isOwner = app.userId === user?.id;\r\n\tconst appUrl = getAppUrl();\r\n\tconst createdDate = app.createdAt ? new Date(app.createdAt) : new Date();\r\n\r\n\treturn (\r\n\t\t<div className=\"min-h-screen bg-bg-3 flex flex-col\">\r\n\t\t\t<div className=\"container mx-auto px-4 pb-6 space-y-6 flex flex-col flex-1\">\r\n\t\t\t\t{/* Back button */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => history.back()}\r\n\t\t\t\t\tclassName=\"gap-2 flex items-center text-text-primary/80\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<ChevronLeft className=\"h-4 w-4\" />\r\n\t\t\t\t\tBack\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t{/* App Info Section */}\r\n\t\t\t\t<div className=\"flex flex-col items-start justify-between gap-4 text-bg-4 w-fit rounded-lg p-5\">\r\n\t\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t\t<div className=\"flex rounded w-fit pb-3 pt-2 flex-col mb-6\">\r\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 mb-2\">\r\n\t\t\t\t\t\t\t\t<h1 className=\"text-4xl font-semibold tracking-tight text-text-primary\">\r\n\t\t\t\t\t\t\t\t\t{app.title}\r\n\t\t\t\t\t\t\t\t</h1>\r\n\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 border rounded-xl\">\r\n\t\t\t\t\t\t\t\t\t<Badge variant={'default'}>\r\n\t\t\t\t\t\t\t\t\t\t<Globe />\r\n\t\t\t\t\t\t\t\t\t\t{capitalizeFirstLetter(app.visibility)}\r\n\t\t\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t\t\t\t{isOwner && (\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={handleToggleVisibility}\r\n\t\t\t\t\t\t\t\t\t\t\tdisabled={isUpdatingVisibility}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-6 w-6 p-0 hover:bg-bg-3/50 -ml-1.5 !mr-1.5\"\r\n\t\t\t\t\t\t\t\t\t\t\ttitle={`Make ${app.visibility === 'private' ? 'public' : 'private'}`}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{isUpdatingVisibility ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Loader2 className=\"h-3 w-3 animate-spin text-text-primary\" />\r\n\t\t\t\t\t\t\t\t\t\t\t) : app.visibility === 'private' ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Unlock className=\"h-3 w-3 text-text-primary\" />\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Lock className=\"h-3 w-3 text-text-primary\" />\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"flex flex-wrap gap-2\">\r\n\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tonClick={handleFavorite}\r\n\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\t'gap-2 text-text-primary',\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Bookmark\r\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\t\t'h-4 w-4',\r\n\t\t\t\t\t\t\t\t\t\t\tisFavorited && 'fill-current',\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{isFavorited ? 'Bookmarked' : 'Bookmark'}\r\n\t\t\t\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\tonClick={handleStar}\r\n\t\t\t\t\t\t\t\t\tclassName={cn('gap-2 text-text-primary')}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Star\r\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\t\t'h-4 w-4',\r\n\t\t\t\t\t\t\t\t\t\t\tisStarred && 'fill-current',\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{isStarred ? 'Starred' : 'Star'}\r\n\t\t\t\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t\t\t\t{/* GitHub Repository Button */}\r\n\t\t\t\t\t\t\t\t{app.githubRepositoryUrl && (\r\n\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (app.githubRepositoryUrl) {\r\n\t\t\t\t\t\t\t\t\t\t\t\twindow.open(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tapp.githubRepositoryUrl,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'_blank',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'noopener,noreferrer',\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tclassName={cn('gap-2 text-text-primary')}\r\n\t\t\t\t\t\t\t\t\t\ttitle={`View on GitHub (${app.githubRepositoryVisibility || 'public'})`}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Github className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\tView on GitHub\r\n\t\t\t\t\t\t\t\t\t\t{app.githubRepositoryVisibility ===\r\n\t\t\t\t\t\t\t\t\t\t\t'private' && (\r\n\t\t\t\t\t\t\t\t\t\t\t<Lock className=\"h-3 w-3 opacity-70\" />\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{isOwner ? (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\tnavigate(`/chat/${app.id}`)\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2 bg-text-primary text-bg-4 border-bg-4 border\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<Code2 className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\tContinue Editing\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetIsDeleteDialogOpen(true)\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2 text-text-on-brand !border-0 bg-destructive hover:opacity-90 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<Trash2 className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\tDelete App\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t) \r\n                                : (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t{/*\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={handleFork}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2 bg-text-primary text-bg-1\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<Shuffle className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\tRemix\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t*/}\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t)\r\n                                }\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{app.description && (\r\n\t\t\t\t\t\t\t<p className=\"text-text-primary my-3 max-w-4xl\">\r\n\t\t\t\t\t\t\t\t{app.description}\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t<div className=\"flex flex-wrap items-center gap-4 text-sm text-text-secondary\">\r\n\t\t\t\t\t\t\t{app.user && (\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t\t<User className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t<span>{app.user.displayName}</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t<Calendar className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t{isValid(createdDate)\r\n\t\t\t\t\t\t\t\t\t\t? formatDistanceToNow(createdDate, {\r\n\t\t\t\t\t\t\t\t\t\t\t\taddSuffix: true,\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t: 'recently'}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t<Eye className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t<span>{app.viewCount || 0}</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t<Star className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t<span>{app.starCount || 0}</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<Tabs\r\n\t\t\t\t\tvalue={activeTab}\r\n\t\t\t\t\tonValueChange={setActiveTab}\r\n\t\t\t\t\tclassName=\"flex flex-col flex-1 gap-2\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{/* Using proper TabsList and TabsTrigger components */}\r\n\t\t\t\t\t<TabsList className=\"inline-flex h-auto w-fit items-center gap-0.5 bg-bg-2 dark:bg-bg-1 rounded-md p-0.5 border border-border-primary/30 ml-0\">\r\n\t\t\t\t\t\t<TabsTrigger \r\n\t\t\t\t\t\t\tvalue=\"preview\" \r\n\t\t\t\t\t\t\tclassName=\"px-3 py-1.5 rounded text-xs font-medium data-[state=active]:bg-bg-4 dark:data-[state=active]:bg-bg-3 data-[state=active]:text-text-primary data-[state=active]:shadow-sm\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Eye className={cn(\r\n\t\t\t\t\t\t\t\t\"h-3.5 w-3.5 mr-1.5\",\r\n\t\t\t\t\t\t\t\tactiveTab === 'preview' ? 'text-accent' : 'text-accent/60'\r\n\t\t\t\t\t\t\t)} />\r\n\t\t\t\t\t\t\tPreview\r\n\t\t\t\t\t\t</TabsTrigger>\r\n\t\t\t\t\t\t<TabsTrigger \r\n\t\t\t\t\t\t\tvalue=\"code\" \r\n\t\t\t\t\t\t\tclassName=\"px-3 py-1.5 rounded text-xs font-medium data-[state=active]:bg-bg-4 dark:data-[state=active]:bg-bg-3 data-[state=active]:text-text-primary data-[state=active]:shadow-sm\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Code2 className={cn(\r\n\t\t\t\t\t\t\t\t\"h-3.5 w-3.5 mr-1.5\",\r\n\t\t\t\t\t\t\t\tactiveTab === 'code' ? 'text-accent' : 'text-accent/60'\r\n\t\t\t\t\t\t\t)} />\r\n\t\t\t\t\t\t\tCode\r\n\t\t\t\t\t\t</TabsTrigger>\r\n\t\t\t\t\t\t<TabsTrigger \r\n\t\t\t\t\t\t\tvalue=\"prompt\" \r\n\t\t\t\t\t\t\tclassName=\"px-3 py-1.5 rounded text-xs font-medium data-[state=active]:bg-bg-4 dark:data-[state=active]:bg-bg-3 data-[state=active]:text-text-primary data-[state=active]:shadow-sm\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<MessageSquare className={cn(\r\n\t\t\t\t\t\t\t\t\"h-3.5 w-3.5 mr-1.5\",\r\n\t\t\t\t\t\t\t\tactiveTab === 'prompt' ? 'text-accent' : 'text-accent/60'\r\n\t\t\t\t\t\t\t)} />\r\n\t\t\t\t\t\t\tPrompt\r\n\t\t\t\t\t\t</TabsTrigger>\r\n\t\t\t\t\t</TabsList>\r\n\r\n\t\t\t\t\t<TabsContent value=\"preview\" className=\"flex-1\">\r\n\t\t\t\t\t\t<Card className=\"px-2\">\r\n\t\t\t\t\t\t\t<CardHeader className=\"overflow-hidden rounded-t\">\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t\t\t\t\t\t<CardTitle className=\"text-base\">\r\n\t\t\t\t\t\t\t\t\t\tLive Preview\r\n\t\t\t\t\t\t\t\t\t</CardTitle>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-0\">\r\n\t\t\t\t\t\t\t\t\t\t{appUrl && (\r\n\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={handleCopyUrl}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{copySuccess ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Check className=\"h-3 w-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCopied!\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Copy className=\"h-3 w-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twindow.open(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tappUrl,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'_blank',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ExternalLink className=\"h-3 w-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</CardHeader>\r\n\t\t\t\t\t\t\t<CardContent className=\"p-0\">\r\n\t\t\t\t\t\t\t\t<div className=\"border-t relative\">\r\n\t\t\t\t\t\t\t\t\t{appUrl ? (\r\n\t\t\t\t\t\t\t\t\t\t<PreviewIframe\r\n\t\t\t\t\t\t\t\t\t\t\tref={previewIframeRef}\r\n\t\t\t\t\t\t\t\t\t\t\tsrc={appUrl}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-[600px] lg:h-[800px]\"\r\n\t\t\t\t\t\t\t\t\t\t\ttitle={`${app.title} Preview`}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"relative w-full h-[400px] bg-gray-50 flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Frosted glass overlay */}\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"absolute inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center z-10\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-center p-8\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"text-xl font-semibold mb-2 text-gray-700\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tRun App\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-gray-500 mb-6 max-w-md\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tRun the app to see a\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlive preview.\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{deploymentProgress && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-800 mb-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{deploymentProgress}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex gap-3 justify-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandlePreviewDeploy\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisDeploying\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{isDeploying ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Loader2 className=\"h-4 w-4 animate-spin\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDeploying...\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Play className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDeploy for\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tPreview\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Background pattern */}\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"absolute inset-0 opacity-10\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundImage: `url(\"data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23000' fill-opacity='0.1'%3E%3Cpath d='M20 20c0 11.046-8.954 20-20 20V0c11.046 0 20 8.954 20 20z'/%3E%3C/g%3E%3C/svg%3E\")`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundSize:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'40px 40px',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t</TabsContent>\r\n\r\n\t\t\t\t\t<TabsContent value=\"code\" className=\"flex-1\">\r\n\t\t\t\t\t\t<Card className=\"flex flex-col\" style={{ maxHeight: '600px' }}>\r\n\t\t\t\t\t\t\t<CardHeader>\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<CardTitle>Generated Code</CardTitle>\r\n\t\t\t\t\t\t\t\t\t\t{app?.agentSummary && (\r\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{files.length} files generated\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{activeFile && (\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\r\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tnavigator.clipboard.writeText(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tactiveFile.fileContents,\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\ttoast.success(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'Code copied to clipboard',\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<Copy className=\"h-3 w-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\tCopy File\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</CardHeader>\r\n\t\t\t\t\t\t\t<CardContent className=\"p-0 flex-1 flex flex-col overflow-hidden\">\r\n\t\t\t\t\t\t\t\t{files.length > 0 ? (\r\n\t\t\t\t\t\t\t\t\t<div className=\"h-[450px] relative bg-bg-3 overflow-hidden\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"h-full flex\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-full max-w-[250px] bg-bg-3 border-r border-text/10 h-full overflow-y-auto\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"p-2 px-3 text-sm flex items-center gap-1 text-text-primary/50 font-medium border-b bg-bg-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Code2 className=\"size-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tFiles\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{files.map((file) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={file.filePath}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleFileClick(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfile,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'flex items-center w-full gap-2 py-2 px-3 text-left text-sm transition-colors',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactiveFile?.filePath ===\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfile.filePath\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-blue-100 text-blue-900 border-r-2 border-blue-500'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'hover:bg-bg-3 text-text-tertiary hover:text-text-primary',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Code2 className=\"h-4 w-4 flex-shrink-0\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"truncate font-mono text-xs\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{file.filePath}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{activeFile ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between p-3 border-b bg-bg-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 flex-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Code2 className=\"h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-mono\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactiveFile.filePath\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{activeFile.explanation && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-text-tertiary ml-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactiveFile.explanation\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-h-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<MonacoEditor\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-full\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcreateOptions={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: activeFile.fileContents,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlanguage:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactiveFile.language ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'plaintext',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treadOnly: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tminimap: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tenabled: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlineNumbers:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'on',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tscrollBeyondLastLine: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: 13,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttheme: 'v1-dev',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tautomaticLayout: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tSelect a file to\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tview\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center h-[400px]\">\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-muted-foreground\">\r\n\t\t\t\t\t\t\t\t\t\t\t{app?.agentSummary === null \r\n\t\t\t\t\t\t\t\t\t\t\t\t? 'Loading code...' \r\n\t\t\t\t\t\t\t\t\t\t\t\t: 'No code has been generated yet.'\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t</TabsContent>\r\n\r\n\t\t\t\t\t<TabsContent\r\n\t\t\t\t\t\tvalue=\"prompt\"\r\n\t\t\t\t\t\tclassName=\"flex-1\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Card>\r\n\t\t\t\t\t\t\t<CardHeader>\r\n\t\t\t\t\t\t\t\t<CardTitle>Original Prompt</CardTitle>\r\n\t\t\t\t\t\t\t\t<CardDescription>\r\n\t\t\t\t\t\t\t\t\tThe initial prompt used to create this app\r\n\t\t\t\t\t\t\t\t</CardDescription>\r\n\t\t\t\t\t\t\t</CardHeader>\r\n\t\t\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t\t\t{app?.agentSummary?.query || app?.originalPrompt ? (\r\n\t\t\t\t\t\t\t\t\t<div className=\"bg-bg-2 rounded-lg p-6 border border-border-primary\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-start gap-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0 mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"rounded-full bg-accent/10 p-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<MessageSquare className=\"h-4 w-4 text-accent\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-text-secondary mb-2 font-medium\">Prompt</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-text-primary whitespace-pre-wrap\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{app?.agentSummary?.query || app?.originalPrompt}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t{/* Copy button */}\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"mt-4 flex justify-end\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst prompt = app?.agentSummary?.query || app?.originalPrompt;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (prompt) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.clipboard.writeText(prompt);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.success('Prompt copied to clipboard');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"gap-2\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Copy className=\"h-3 w-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\tCopy Prompt\r\n\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center py-12 text-text-tertiary\">\r\n\t\t\t\t\t\t\t\t\t\t<MessageSquare className=\"h-8 w-8 mr-3\" />\r\n\t\t\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t\t\t{app?.agentSummary === null \r\n\t\t\t\t\t\t\t\t\t\t\t\t? 'Loading prompt...' \r\n\t\t\t\t\t\t\t\t\t\t\t\t: 'No prompt available'\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t</TabsContent>\r\n\t\t\t\t</Tabs>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Delete Confirmation Dialog */}\r\n\t\t\t<ConfirmDeleteDialog\r\n\t\t\t\topen={isDeleteDialogOpen}\r\n\t\t\t\tonOpenChange={setIsDeleteDialogOpen}\r\n\t\t\t\tonConfirm={handleDeleteApp}\r\n\t\t\t\tisLoading={isDeleting}\r\n\t\t\t\tappTitle={app?.title}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { useNavigate, useSearchParams } from 'react-router';\r\nimport { motion } from 'framer-motion';\r\nimport { usePaginatedApps } from '@/hooks/use-paginated-apps';\r\nimport { AppListContainer } from '@/components/shared/AppListContainer';\r\nimport { AppFiltersForm } from '@/components/shared/AppFiltersForm';\r\nimport { AppSortTabs } from '@/components/shared/AppSortTabs';\r\nimport type { AppSortOption } from '@/api-types';\r\n\r\nexport default function DiscoverPage() {\r\n\tconst navigate = useNavigate();\r\n\tconst [searchParams, setSearchParams] = useSearchParams();\r\n\r\n\t// Derive initial sort from URL or localStorage, fallback to 'popular'\r\n\tconst allowedSorts: AppSortOption[] = ['recent', 'popular', 'trending', 'starred'];\r\n\tconst sortParam = searchParams.get('sort') as AppSortOption | null;\r\n\tconst savedSort = (typeof localStorage !== 'undefined' ? localStorage.getItem('discover.sort') : null) as AppSortOption | null;\r\n\tconst initialSort: AppSortOption = (sortParam && allowedSorts.includes(sortParam))\r\n\t\t? sortParam\r\n\t\t: (savedSort && allowedSorts.includes(savedSort) ? savedSort : 'popular');\r\n\r\n\tconst {\r\n\t\t// Filter state\r\n\t\tsearchQuery,\r\n\t\tsetSearchQuery,\r\n\t\tfilterFramework,\r\n\t\tsortBy,\r\n\t\tperiod,\r\n\r\n\t\t// Data state\r\n\t\tapps,\r\n\t\tloading,\r\n\t\tloadingMore,\r\n\t\terror,\r\n\t\ttotalCount,\r\n\t\thasMore,\r\n\r\n\t\t// Form handlers\r\n\t\thandleSearchSubmit,\r\n\t\thandlePeriodChange,\r\n\t\thandleFrameworkChange,\r\n\r\n\t\thandleSortChange,\r\n\r\n\t\t// Pagination handlers\r\n\r\n\t\trefetch,\r\n\t\tloadMore,\r\n\t} = usePaginatedApps({\r\n\t\ttype: 'public',\r\n\t\tdefaultSort: initialSort,\r\n\t\tdefaultPeriod: 'week',\r\n\t\tlimit: 20,\r\n\t});\r\n\r\n\treturn (\r\n\t\t<div className=\"min-h-screen\">\r\n\t\t\t<div className=\"container mx-auto px-4 py-8\">\r\n\t\t\t\t<motion.div\r\n\t\t\t\t\tinitial={{ opacity: 0, y: -20 }}\r\n\t\t\t\t\tanimate={{ opacity: 1, y: 0 }}\r\n\t\t\t\t\ttransition={{ duration: 0.5 }}\r\n\t\t\t\t>\r\n\t\t\t\t\t{/* Header */}\r\n\t\t\t\t\t<div className=\"mb-8\">\r\n\t\t\t\t\t\t<h1 className=\"text-6xl font-bold mb-3 font-[departureMono] text-accent\">\r\n\t\t\t\t\t\t\tDISCOVER\r\n\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t\t<p className=\"text-text-tertiary text-lg\">\r\n\t\t\t\t\t\t\tExplore apps built by the community\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"flex items-start gap-4 justify-between\">\r\n\t\t\t\t\t\t{/* Search and Filters */}\r\n\t\t\t\t\t\t<AppFiltersForm\r\n\t\t\t\t\t\t\tsearchQuery={searchQuery}\r\n\t\t\t\t\t\t\tonSearchChange={setSearchQuery}\r\n\t\t\t\t\t\t\tonSearchSubmit={handleSearchSubmit}\r\n\t\t\t\t\t\t\tsearchPlaceholder=\"Search apps...\"\r\n\t\t\t\t\t\t\tshowSearchButton={true}\r\n\t\t\t\t\t\t\tfilterFramework={filterFramework}\r\n\t\t\t\t\t\t\tperiod={period}\r\n\t\t\t\t\t\t\tonFrameworkChange={handleFrameworkChange}\r\n\t\t\t\t\t\t\tonPeriodChange={handlePeriodChange}\r\n\t\t\t\t\t\t\tsortBy={sortBy}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t{/* Sort Tabs */}\r\n\t\t\t\t\t<AppSortTabs\r\n\t\t\t\t\t\tvalue={sortBy}\r\n\t\t\t\t\t\tonValueChange={(v) => {\r\n\t\t\t\t\t\t\thandleSortChange(v);\r\n\t\t\t\t\t\t\t// Persist to URL and localStorage\r\n\t\t\t\t\t\t\ttry { localStorage.setItem('discover.sort', v); } catch {}\r\n\t\t\t\t\t\t\tconst next = new URLSearchParams(searchParams);\r\n\t\t\t\t\t\t\tnext.set('sort', v);\r\n\t\t\t\t\t\t\tsetSearchParams(next, { replace: true });\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tavailableSorts={['recent', 'popular', 'trending', 'starred']}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Unified App List */}\r\n\t\t\t\t\t<AppListContainer\r\n\t\t\t\t\t\tapps={apps}\r\n\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\tloadingMore={loadingMore}\r\n\t\t\t\t\t\terror={error}\r\n\t\t\t\t\t\thasMore={hasMore}\r\n\t\t\t\t\t\ttotalCount={totalCount}\r\n\t\t\t\t\t\tsortBy={sortBy}\r\n\t\t\t\t\t\tonAppClick={(appId) => navigate(`/app/${appId}`)}\r\n\t\t\t\t\t\tonLoadMore={loadMore}\r\n\t\t\t\t\t\tonRetry={refetch}\r\n\t\t\t\t\t\tshowUser={true}\r\n\t\t\t\t\t\tshowStats={true}\r\n\t\t\t\t\t\tinfiniteScroll={true}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</motion.div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { Navigate } from 'react-router';\r\nimport { useAuth } from '../contexts/auth-context';\r\nimport { Skeleton } from '../components/ui/skeleton';\r\n\r\ninterface ProtectedRouteProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport function ProtectedRoute({ children }: ProtectedRouteProps) {\r\n  const { isAuthenticated, isLoading } = useAuth();\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"space-y-4\">\r\n          <Skeleton className=\"h-12 w-48\" />\r\n          <Skeleton className=\"h-4 w-32 mx-auto\" />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!isAuthenticated) {\r\n    return <Navigate to=\"/\" replace />;\r\n  }\r\n\r\n  return <>{children}</>;\r\n}","import type { RouteObject } from 'react-router';\r\nimport React from 'react';\r\n\r\nimport App from './App';\r\nimport Home from './routes/home';\r\nimport Chat from './routes/chat/chat';\r\nimport Profile from './routes/profile';\r\nimport Settings from './routes/settings/index';\r\nimport AppsPage from './routes/apps';\r\nimport AppView from './routes/app';\r\nimport DiscoverPage from './routes/discover';\r\nimport { ProtectedRoute } from './routes/protected-route';\r\n\r\nconst routes = [\r\n\t{\r\n\t\tpath: '/',\r\n\t\tComponent: App,\r\n\t\tchildren: [\r\n\t\t\t{\r\n\t\t\t\tindex: true,\r\n\t\t\t\tComponent: Home,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tpath: 'chat/:chatId',\r\n\t\t\t\tComponent: Chat,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tpath: 'profile',\r\n\t\t\t\telement: React.createElement(ProtectedRoute, { children: React.createElement(Profile) }),\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tpath: 'settings',\r\n\t\t\t\telement: React.createElement(ProtectedRoute, { children: React.createElement(Settings) }),\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tpath: 'apps',\r\n\t\t\t\telement: React.createElement(ProtectedRoute, { children: React.createElement(AppsPage) }),\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tpath: 'app/:id',\r\n\t\t\t\tComponent: AppView,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tpath: 'discover',\r\n\t\t\t\tComponent: DiscoverPage,\r\n\t\t\t},\r\n\t\t],\r\n\t},\r\n] satisfies RouteObject[];\r\n\r\nexport { routes };\r\n","import { createRoot } from 'react-dom/client';\r\nimport { createBrowserRouter } from 'react-router';\r\nimport { RouterProvider } from 'react-router/dom';\r\nimport { initSentry } from './utils/sentry';\r\n\r\nimport { routes } from './routes.ts';\r\nimport './index.css';\r\n\r\n// Initialize Sentry before rendering\r\ninitSentry();\r\n\r\n// Type for React Router hydration data  \r\nimport type { RouterState } from 'react-router';\r\n\r\ndeclare global {\r\n  interface Window {\r\n    __staticRouterHydrationData?: Partial<Pick<RouterState, 'loaderData' | 'actionData' | 'errors'>>;\r\n  }\r\n}\r\n\r\nconst router = createBrowserRouter(routes, {\r\n\thydrationData: window.__staticRouterHydrationData,\r\n});\r\n\r\ncreateRoot(document.getElementById('root')!).render(\r\n  <RouterProvider router={router} />\r\n);\r\n"],"mappings":"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"}