import{a as e}from"./rolldown-runtime-Cn8xt2Gj.js";import{B as t,G as n,H as r,K as i,L as a,R as o,U as s,V as c,W as l,X as u,_ as d,g as f,h as p,i as m,n as h,nt as g,q as _,r as v,t as y,tt as b,z as x}from"./vendor-CzeyjgAi.js";import{$ as S,$t as C,A as w,An as T,At as E,B as D,Bn as O,Bt as k,C as A,Cn as j,Ct as M,D as N,Dn as P,Dt as F,E as I,En as L,Et as R,F as ee,Fn as te,Ft as ne,G as re,Gt as ie,H as ae,Hn as oe,Ht as se,I as ce,In as le,It as ue,J as de,Jt as fe,K as pe,Kt as z,L as me,Ln as he,Lt as ge,M as _e,Mn as ve,Mt as B,N as ye,Nn as be,Nt as xe,O as Se,On as Ce,Ot as we,P as V,Pn as Te,Pt as Ee,Q as De,Qt as Oe,R as ke,Rn as Ae,Rt as je,S as Me,Sn as Ne,St as Pe,T as Fe,Tn as Ie,Tt as Le,U as Re,Un as ze,Ut as Be,V as Ve,Vn as He,Vt as Ue,W as We,Wt as Ge,X as Ke,Xt as qe,Y as Je,Yt as Ye,Z as Xe,Zt as Ze,_ as Qe,_n as $e,_t as et,a as tt,an as nt,at as rt,b as it,bn as at,bt as ot,c as st,cn as ct,ct as lt,d as ut,dn as dt,dt as ft,en as pt,et as mt,f as ht,fn as gt,ft as _t,g as vt,gn as yt,gt as bt,h as xt,hn as St,ht as Ct,i as wt,in as Tt,it as Et,j as Dt,jn as Ot,jt as kt,k as At,kn as jt,kt as Mt,l as Nt,ln as Pt,lt as Ft,m as It,mn as Lt,mt as Rt,n as zt,nn as Bt,nt as Vt,o as Ht,on as Ut,ot as Wt,p as Gt,pn as Kt,pt as qt,q as Jt,qt as Yt,r as Xt,rn as Zt,rt as Qt,s as $t,sn as en,st as tn,t as nn,tn as rn,tt as an,u as on,un as sn,ut as cn,v as ln,vn as un,vt as dn,w as fn,wn as pn,wt as mn,x as hn,xn as gn,xt as _n,y as vn,yn,yt as bn,z as xn,zn as Sn,zt as Cn}from"./vendor-react-BUZUiiCW.js";import{Bi as wn,Hi as Tn,Ii as En,Li as Dn,Ri as On,Ui as kn,Vi as An,zi as jn}from"./vendor-monaco-Jo5pHw6T.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var Mn=e(ze(),1),H=e(g(),1);function Nn(){console.warn(`Sentry DSN not configured, skipping initialization`)}function Pn(e){u({id:e.id,email:e.email,username:e.username})}function Fn(){u(null)}var In=null;function Ln(e){In=e}var Rn=class extends Error{constructor(e,t,n,r){super(n),this.status=e,this.statusText=t,this.endpoint=r,this.name=`ApiError`}};const U=new class{constructor(e={}){this.csrfTokenInfo=null,this.baseUrl=e.baseUrl||``,this.defaultHeaders={"Content-Type":`application/json`,...e.defaultHeaders}}getAuthHeaders(){let e={},t=localStorage.getItem(`anonymous_session_token`);return t&&!document.cookie.includes(`session=`)&&(e[`X-Session-Token`]=t),this.csrfTokenInfo&&!this.isCSRFTokenExpired()&&(e[`X-CSRF-Token`]=this.csrfTokenInfo.token),e}async fetchCsrfToken(){try{let e=await fetch(`${this.baseUrl}/api/auth/csrf-token`,{method:`GET`,credentials:`include`});if(e.ok){let t=await e.json();if(t.data?.token){let e=t.data.expiresIn||7200;return this.csrfTokenInfo={token:t.data.token,expiresAt:Date.now()+e*1e3},!0}}return!1}catch(e){return console.warn(`Failed to fetch CSRF token:`,e),!1}}async refreshCsrfToken(){await this.fetchCsrfToken()}isCSRFTokenExpired(){return this.csrfTokenInfo?Date.now()>=this.csrfTokenInfo.expiresAt:!0}async ensureCsrfToken(e){return[`POST`,`PUT`,`DELETE`,`PATCH`].includes(e.toUpperCase())&&(!this.csrfTokenInfo||this.isCSRFTokenExpired())?await this.fetchCsrfToken():!0}ensureSessionToken(){!localStorage.getItem(`anonymous_session_token`)&&!document.cookie.includes(`session=`)&&localStorage.setItem(`anonymous_session_token`,crypto.randomUUID())}getAuthContextForEndpoint(e){return e.includes(`/api/agent`)?`to create applications`:e.includes(`/favorite`)?`to favorite this app`:e.includes(`/star`)?`to star this app`:e.includes(`/profile`)?`to access your profile`:e.includes(`/settings`)?`to access settings`:`to continue`}shouldTriggerAuthModal(e){return!(e===`/api/auth/profile`||e===`/api/auth/providers`||e===`/api/auth/sessions`)}async request(e,t={},n=!1){let{data:r}=await this.requestRaw(e,t,!1,n);if(!r)throw new Rn(500,`Internal Error`,`Unexpected null response data`,e);return r}async requestRaw(e,t={},n=!1,r=!1){if(this.ensureSessionToken(),!await this.ensureCsrfToken(t.method||`GET`))throw new Rn(500,`Internal Error`,`Failed to obtain CSRF token`,e);let i=`${this.baseUrl}${e}`,a={method:t.method||`GET`,headers:{...this.defaultHeaders,...this.getAuthHeaders(),...t.headers},credentials:t.credentials||`include`};t.body&&(a.body=typeof t.body==`string`?t.body:JSON.stringify(t.body));try{let o=await fetch(i,a);if(t.skipJsonParsing&&o.ok)return{response:o,data:null};let s=await o.json();if(!o.ok){if(o.status===401&&In&&this.shouldTriggerAuthModal(e)){let t=this.getAuthContextForEndpoint(e);In(t)}let i=s.error;if(i&&i.type)switch(r||_.error(i.message),i.type){case SecurityErrorType.CSRF_VIOLATION:if(o.status===403&&!n)return this.csrfTokenInfo=null,this.requestRaw(e,t,!0);break;case SecurityErrorType.RATE_LIMITED:throw console.log(`Rate limited`,i),RateLimitExceededError.fromRateLimitError(i);default:throw new SecurityError(i.type,i.message)}throw console.log(`Came here`),new Rn(o.status,o.statusText,s.error?.message||s.message||`Request failed`,e)}return{response:o,data:s}}catch(t){throw console.error(t),t instanceof Rn||t instanceof RateLimitExceededError||t instanceof SecurityError?t:new Rn(0,`Network Error`,t instanceof Error?t.message:`Unknown error`,e)}}async getPlatformStatus(e=!0){return this.request(`/api/status`,void 0,e)}async getUserApps(){return this.request(`/api/apps`)}async getRecentApps(){return this.request(`/api/apps/recent`)}async getFavoriteApps(){return this.request(`/api/apps/favorites`)}async getPublicApps(e){let t=new URLSearchParams;e?.page&&t.set(`page`,e.page.toString()),e?.limit&&t.set(`limit`,e.limit.toString()),e?.sort&&t.set(`sort`,e.sort),e?.order&&t.set(`order`,e.order),e?.period&&t.set(`period`,e.period),e?.framework&&t.set(`framework`,e.framework),e?.search&&t.set(`search`,e.search),e?.boardId&&t.set(`boardId`,e.boardId);let n=`/api/apps/public${t.toString()?`?${t.toString()}`:``}`;return this.request(n)}async createApp(e){return this.request(`/api/apps`,{method:`POST`,body:e})}async toggleFavorite(e){return this.request(`/api/apps/${e}/favorite`,{method:`POST`})}async updateAppVisibility(e,t){return this.request(`/api/apps/${e}/visibility`,{method:`PUT`,body:{visibility:t}})}async deleteApp(e){return this.request(`/api/apps/${e}`,{method:`DELETE`})}async getAppDetails(e){return this.request(`/api/apps/${e}`)}async toggleAppStar(e){return this.request(`/api/apps/${e}/star`,{method:`POST`})}async getUserAppsWithPagination(e){let t=new URLSearchParams;e?.page&&t.set(`page`,e.page.toString()),e?.limit&&t.set(`limit`,e.limit.toString()),e?.sort&&t.set(`sort`,e.sort),e?.order&&t.set(`order`,e.order),e?.period&&t.set(`period`,e.period),e?.framework&&t.set(`framework`,e.framework),e?.search&&t.set(`search`,e.search),e?.visibility&&t.set(`visibility`,e.visibility),e?.status&&t.set(`status`,e.status),e?.teamId&&t.set(`teamId`,e.teamId);let n=`/api/user/apps${t.toString()?`?${t.toString()}`:``}`;return this.request(n)}async createAgentSession(e){try{let{response:t,data:n}=await this.requestRaw(`/api/agent`,{method:`POST`,body:e,skipJsonParsing:!0});if(!t.ok){let e=n?.error?.message||`Agent creation failed with status: ${t.status}`;throw Error(e)}return{success:!0,stream:t}}catch(e){let t=e instanceof Error?e.message:`Failed to create agent session`;throw _.error(t),Error(t)}}async updateProfile(e){return this.request(`/api/user/profile`,{method:`PUT`,body:e})}async getUserStats(){return this.request(`/api/stats/user`)}async getUserActivity(){return this.request(`/api/stats/activity`)}async getUserAnalytics(e,t){let n=t?`?days=${t}`:``;return this.request(`/api/user/${e}/analytics${n}`)}async getAgentAnalytics(e,t){let n=t?`?days=${t}`:``;return this.request(`/api/agent/${e}/analytics${n}`)}async getModelConfigs(){return this.request(`/api/model-configs`)}async getByokProviders(){return this.request(`/api/model-configs/byok-providers`)}async getBYOKTemplates(){return this.request(`/api/secrets/templates?category=byok`)}async resetModelConfig(e){return this.request(`/api/model-configs/${e}`,{method:`DELETE`})}async resetAllModelConfigs(){return this.request(`/api/model-configs/reset-all`,{method:`POST`})}async getModelConfig(e){return this.request(`/api/model-configs/${e}`)}async updateModelConfig(e,t){return this.request(`/api/model-configs/${e}`,{method:`PUT`,body:t})}async testModelConfig(e,t){return this.request(`/api/model-configs/test`,{method:`POST`,body:{agentActionName:e,useUserKeys:!0,...t&&{tempConfig:t}}})}async resetAllConfigs(){return this.request(`/api/model-configs/reset-all`,{method:`POST`})}async getModelDefaults(){return this.request(`/api/model-configs/defaults`)}async deleteModelConfig(e){return this.request(`/api/model-configs/${e}`,{method:`DELETE`})}async getModelProviders(){return this.request(`/api/user/providers`)}async createModelProvider(e){return this.request(`/api/user/providers`,{method:`POST`,body:e})}async updateModelProvider(e,t){return this.request(`/api/user/providers/${e}`,{method:`PUT`,body:t})}async deleteModelProvider(e){return this.request(`/api/user/providers/${e}`,{method:`DELETE`})}async testModelProvider(e){return this.request(`/api/user/providers/test`,{method:`POST`,body:e})}async getAllSecrets(){return this.request(`/api/secrets`)}async storeSecret(e){return this.request(`/api/secrets`,{method:`POST`,body:e})}async deleteSecret(e){return this.request(`/api/secrets/${e}`,{method:`DELETE`})}async toggleSecret(e){return this.request(`/api/secrets/${e}/toggle`,{method:`PATCH`})}async getSecretTemplates(){return this.request(`/api/secrets/templates`)}initiateGitHubOAuth(){let e=new URL(`/api/github-app/authorize`,window.location.origin);window.location.href=e.toString()}async initiateGitHubExport(e){return this.request(`/api/github-app/export`,{method:`POST`,body:e})}async connectToAgent(e){return this.request(`/api/agent/${e}/connect`)}async deployPreview(e){return this.request(`/api/agent/${e}/preview`)}async getActiveSessions(){return this.request(`/api/auth/sessions`)}async revokeSession(e){return this.request(`/api/auth/sessions/${e}`,{method:`DELETE`})}async getApiKeys(){return this.request(`/api/auth/api-keys`)}async createApiKey(e){return this.request(`/api/auth/api-keys`,{method:`POST`,body:e})}async revokeApiKey(e){return this.request(`/api/auth/api-keys/${e}`,{method:`DELETE`})}async loginWithEmail(e){return this.request(`/api/auth/login`,{method:`POST`,body:e})}async register(e){return this.request(`/api/auth/register`,{method:`POST`,body:e})}async verifyEmail(e){return this.request(`/api/auth/verify-email`,{method:`POST`,body:e})}async resendVerificationOtp(e){return this.request(`/api/auth/resend-verification`,{method:`POST`,body:{email:e}})}async getCsrfToken(){return this.request(`/api/auth/csrf-token`)}async getProfile(e=!1){return this.request(`/api/auth/profile`,void 0,e)}async logout(){return this.request(`/api/auth/logout`,{method:`POST`})}async getAuthProviders(){return this.request(`/api/auth/providers`)}initiateOAuth(e,t){let n=new URL(`/api/auth/oauth/${e}`,window.location.origin);t&&n.searchParams.set(`redirect_url`,t),window.location.href=n.toString()}};function zn(e){(0,H.useEffect)(()=>{e?Pn({id:e.id,email:e.email,username:e.displayName}):Fn()},[e])}var W=e(n(),1),Bn=(0,H.createContext)(void 0),Vn=3600*1e3;function Hn({children:e}){let[t,n]=(0,H.useState)(null),[r,i]=(0,H.useState)(null),[a,o]=(0,H.useState)(null),[s,c]=(0,H.useState)(!0),[l,u]=(0,H.useState)(null),[d,f]=(0,H.useState)(null),[p,m]=(0,H.useState)(!1),[h,g]=(0,H.useState)(!0),_=O();zn(t);let v=(0,H.useRef)(null),y=`auth_intended_url`,b=(0,H.useCallback)(e=>{try{sessionStorage.setItem(y,e)}catch(e){console.warn(`Failed to store intended URL:`,e)}},[]),x=(0,H.useCallback)(()=>{try{return sessionStorage.getItem(y)}catch(e){return console.warn(`Failed to retrieve intended URL:`,e),null}},[]),S=(0,H.useCallback)(()=>{try{sessionStorage.removeItem(y)}catch(e){console.warn(`Failed to clear intended URL:`,e)}},[]),C=(0,H.useCallback)(async()=>{try{let e=await U.getAuthProviders();e.success&&e.data&&(f(e.data.providers),m(e.data.hasOAuth),g(e.data.requiresEmailAuth))}catch(e){console.warn(`Failed to fetch auth providers:`,e),f({google:!1,github:!1,email:!0}),m(!1),g(!0)}},[]),w=(0,H.useCallback)(async()=>{try{let e=await U.getProfile(!0);e.success&&e.data?.user?(n({...e.data.user,isAnonymous:!1}),i(null),o({userId:e.data.user.id,email:e.data.user.email,sessionId:e.data.sessionId||e.data.user.id,expiresAt:new Date(Date.now()+1440*60*1e3)}),T()):(n(null),i(null),o(null))}catch(e){console.error(`Auth check failed:`,e),n(null),i(null),o(null)}finally{c(!1)}},[]),T=(0,H.useCallback)(()=>{v.current&&clearInterval(v.current),v.current=setInterval(async()=>{try{(await U.getProfile(!0)).success||(n(null),i(null),o(null),clearInterval(v.current))}catch(e){console.error(`Session validation failed:`,e)}},Vn)},[]);(0,H.useEffect)(()=>()=>{v.current&&clearInterval(v.current)},[]),(0,H.useEffect)(()=>{(async()=>{await C(),await w()})()},[C,w]);let E=(0,H.useCallback)((e,t)=>{let n=t||window.location.pathname+window.location.search;b(n);let r=new URL(`/api/auth/oauth/${e}`,window.location.origin);r.searchParams.set(`redirect_url`,n),window.location.href=r.toString()},[b]),D=(0,H.useCallback)(async e=>{u(null),c(!0);try{let t=await U.loginWithEmail(e);if(t.success&&t.data){n({...t.data.user,isAnonymous:!1}),i(null),o({userId:t.data.user.id,email:t.data.user.email,sessionId:t.data.sessionId,expiresAt:t.data.expiresAt}),T();let e=x();S(),_(e||`/`)}}catch(e){throw console.error(`Login error:`,e),e instanceof Rn?u(e.message):u(`Connection error. Please try again.`),e}finally{c(!1)}},[_,T,x,S]),k=(0,H.useCallback)(async e=>{u(null),c(!0);try{let t=await U.register(e);if(t.success&&t.data){n({...t.data.user,isAnonymous:!1}),i(null),o({userId:t.data.user.id,email:t.data.user.email,sessionId:t.data.sessionId,expiresAt:t.data.expiresAt}),T();let e=x();S(),_(e||`/`)}}catch(e){throw console.error(`Registration error:`,e),e instanceof Rn?u(e.message):u(`Connection error. Please try again.`),e}finally{c(!1)}},[_,T,x,S]),A=(0,H.useCallback)(async()=>{try{await U.logout()}catch(e){console.error(`Logout error:`,e)}finally{n(null),i(null),o(null),v.current&&clearInterval(v.current),_(`/`)}},[_]),j=(0,H.useCallback)(async()=>{await w()},[w]),M=(0,H.useCallback)(()=>{u(null)},[]),N={user:t,token:r,session:a,isAuthenticated:!!t,isLoading:s,error:l,authProviders:d,hasOAuth:p,requiresEmailAuth:h,login:E,loginWithEmail:D,register:k,logout:A,refreshUser:j,clearError:M,setIntendedUrl:b,getIntendedUrl:x,clearIntendedUrl:S};return(0,W.jsx)(Bn.Provider,{value:N,children:e})}function Un(){let e=(0,H.useContext)(Bn);if(e===void 0)throw Error(`useAuth must be used within an AuthProvider`);return e}var Wn=e(b(),1);function Gn({isOpen:e,onClose:t,onLogin:n,onEmailLogin:i,onOAuthLogin:a,onRegister:o,error:s,onClearError:u,actionContext:d,showCloseButton:f=!0}){let{authProviders:p,hasOAuth:m,requiresEmailAuth:h}=Un(),[g,_]=(0,H.useState)(`login`),[v,y]=(0,H.useState)(!1),[b,x]=(0,H.useState)(!1),[S,C]=(0,H.useState)(``),[w,T]=(0,H.useState)(``),[E,D]=(0,H.useState)(``),[O,k]=(0,H.useState)(``),[A,j]=(0,H.useState)({}),M=h&&!!i,N=h&&!!o,P=p?.github&&m,F=p?.google&&m,I=()=>{C(``),T(``),D(``),k(``),j({}),y(!1),u&&u()},L=()=>{I(),t()},R=e=>{_(e),I(),j({}),u&&u()},ee=()=>{let e={};return S.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(S)||(e.email=`Invalid email format`):e.email=`Email is required`,w?w.length<8&&(e.password=`Password must be at least 8 characters`):e.password=`Password is required`,g===`register`&&(E.trim()?E.trim().length<2&&(e.name=`Name must be at least 2 characters`):e.name=`Name is required`,w!==O&&(e.confirmPassword=`Passwords do not match`)),j(e),Object.keys(e).length===0},te=async e=>{if(e.preventDefault(),ee()){x(!0);try{g===`login`&&i?await i({email:S,password:w}):g===`register`&&o&&await o({email:S,password:w,name:E.trim()})}catch{}finally{x(!1)}}},ne=e=>{a?a(e,window.location.pathname+window.location.search):n(e)};return e?(0,Wn.createPortal)((0,W.jsx)(l,{children:e&&(0,W.jsxs)(`div`,{className:`fixed inset-0 z-[9999] flex items-center justify-center p-4 overflow-y-auto`,children:[(0,W.jsx)(r.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 bg-black/50 backdrop-blur-md`,onClick:L}),(0,W.jsx)(r.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:`spring`,duration:.5},className:`relative z-10 w-full max-w-md mx-auto my-8`,children:(0,W.jsxs)(`div`,{className:`bg-bg-3/95 backdrop-blur-xl text-text-primary border border-border-primary/50 rounded-2xl shadow-2xl overflow-hidden`,children:[(0,W.jsxs)(`div`,{className:`relative p-6 pb-0`,children:[f&&(0,W.jsx)(`button`,{onClick:L,className:`absolute right-4 top-4 p-2 rounded-lg hover:bg-accent transition-colors`,children:(0,W.jsx)(Ct,{className:`h-4 w-4`})}),(0,W.jsxs)(`div`,{className:`text-center space-y-2`,children:[(0,W.jsx)(`div`,{className:`mx-auto w-12 h-12 rounded-full bg-text-secondary/10 flex items-center justify-center mb-4`,children:(0,W.jsx)(`svg`,{className:`w-6 h-6 text-text-primary`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`,children:(0,W.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z`})})}),(0,W.jsx)(`h2`,{className:`text-2xl font-semibold mb-2`,children:d?`Sign in ${d}`:M&&g===`register`?`Create an account`:`Welcome back`}),(0,W.jsx)(`p`,{className:`text-text-tertiary`,children:d?`Authentication required for this action`:M&&g===`register`?`Join to start building amazing applications`:`Sign in to save your apps and access your workspace`})]})]}),s&&(0,W.jsxs)(`div`,{className:`mx-6 mt-4 p-3 rounded-lg bg-destructive/10 border border-destructive/20 flex items-start gap-2`,children:[(0,W.jsx)(at,{className:`h-4 w-4 text-destructive mt-0.5`}),(0,W.jsx)(`p`,{className:`text-sm text-destructive`,children:s})]}),(0,W.jsxs)(`div`,{className:c(`p-6 space-y-5 pt-12`),children:[P&&(0,W.jsxs)(r.button,{whileTap:{scale:.98},onClick:()=>ne(`github`),className:`w-full group relative overflow-hidden rounded-xl bg-gray-900 dark:bg-bg-1 p-4 text-white transition-all hover:bg-gray-800 dark:hover:bg-[#1a1e22] border border-gray-800 dark:border-bg-4 disabled:opacity-50 disabled:cursor-not-allowed`,children:[(0,W.jsxs)(`div`,{className:`relative z-10 flex items-center justify-center gap-3`,children:[(0,W.jsx)(`svg`,{className:`h-5 w-5`,fill:`currentColor`,viewBox:`0 0 24 24`,children:(0,W.jsx)(`path`,{fillRule:`evenodd`,clipRule:`evenodd`,d:`M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z`})}),(0,W.jsx)(`span`,{className:`font-medium`,children:`Continue with GitHub`})]}),(0,W.jsx)(`div`,{className:`absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/10 to-transparent group-hover:translate-x-full transition-transform duration-700`})]}),F&&(0,W.jsxs)(r.button,{whileTap:{scale:.98},onClick:()=>ne(`google`),className:`w-full group relative overflow-hidden rounded-xl bg-white dark:bg-bg-4 p-4 text-gray-800 dark:text-text-primary transition-all hover:bg-gray-50 dark:hover:bg-bg-4/80 border border-gray-200 dark:border-border-primary disabled:opacity-50 disabled:cursor-not-allowed`,children:[(0,W.jsxs)(`div`,{className:`relative z-10 flex items-center justify-center gap-3`,children:[(0,W.jsxs)(`svg`,{className:`h-5 w-5`,viewBox:`0 0 24 24`,children:[(0,W.jsx)(`path`,{d:`M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z`,fill:`#4285F4`}),(0,W.jsx)(`path`,{d:`M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z`,fill:`#34A853`}),(0,W.jsx)(`path`,{d:`M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z`,fill:`#FBBC05`}),(0,W.jsx)(`path`,{d:`M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z`,fill:`#EA4335`})]}),(0,W.jsx)(`span`,{className:`font-medium`,children:`Continue with Google`})]}),(0,W.jsx)(`div`,{className:`absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-gray-100 dark:via-gray-800 to-transparent group-hover:translate-x-full transition-transform duration-700`})]}),M&&m&&(0,W.jsxs)(`div`,{className:`relative`,children:[(0,W.jsx)(`div`,{className:`absolute inset-0 flex items-center`,children:(0,W.jsx)(`div`,{className:`w-full border-t border-border`})}),(0,W.jsx)(`div`,{className:`relative flex justify-center text-xs uppercase`,children:(0,W.jsx)(`span`,{className:`bg-background px-2 text-muted-foreground`,children:`Or continue with`})})]}),M&&(0,W.jsxs)(`form`,{onSubmit:te,className:`space-y-4`,children:[g===`register`&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`input`,{type:`text`,placeholder:`Full name`,value:E,onChange:e=>D(e.target.value),className:c(`w-full p-3 rounded-lg border bg-background transition-colors`,A.name?`border-destructive`:`border-border focus:border-primary`),disabled:b}),A.name&&(0,W.jsx)(`p`,{className:`mt-1 text-sm text-destructive`,children:A.name})]}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`input`,{type:`email`,placeholder:`Email address`,value:S,onChange:e=>C(e.target.value),className:c(`w-full p-3 rounded-lg border bg-background transition-colors`,A.email?`border-destructive`:`border-border focus:border-primary`),disabled:b}),A.email&&(0,W.jsx)(`p`,{className:`mt-1 text-sm text-destructive`,children:A.email})]}),(0,W.jsxs)(`div`,{className:`relative`,children:[(0,W.jsx)(`input`,{type:v?`text`:`password`,placeholder:`Password`,value:w,onChange:e=>T(e.target.value),className:c(`w-full p-3 pr-10 rounded-lg border bg-background transition-colors`,A.password?`border-destructive`:`border-border focus:border-primary`),disabled:b}),(0,W.jsx)(`button`,{type:`button`,onClick:()=>y(!v),className:`absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground`,disabled:b,children:v?(0,W.jsx)(en,{className:`h-4 w-4`}):(0,W.jsx)(Ut,{className:`h-4 w-4`})}),A.password&&(0,W.jsx)(`p`,{className:`mt-1 text-sm text-destructive`,children:A.password})]}),g===`register`&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`input`,{type:`password`,placeholder:`Confirm password`,value:O,onChange:e=>k(e.target.value),className:c(`w-full p-3 rounded-lg border bg-background transition-colors`,A.confirmPassword?`border-destructive`:`border-border focus:border-primary`),disabled:b}),A.confirmPassword&&(0,W.jsx)(`p`,{className:`mt-1 text-sm text-destructive`,children:A.confirmPassword})]}),(0,W.jsx)(r.button,{type:`submit`,whileTap:{scale:.98},disabled:b,className:`w-full bg-primary hover:bg-primary/90 text-primary-foreground p-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:b?g===`register`?`Creating account...`:`Signing in...`:g===`register`?`Create account`:`Sign in`})]})]}),(0,W.jsxs)(`div`,{className:`px-6 pb-6 space-y-4`,children:[N&&M&&(0,W.jsx)(`div`,{className:`text-center`,children:(0,W.jsx)(`button`,{type:`button`,onClick:()=>R(g===`login`?`register`:`login`),className:`text-sm text-text-tertiary hover:text-text-primary transition-colors`,children:g===`login`?`Don't have an account? Sign up`:`Already have an account? Sign in`})}),(0,W.jsxs)(`p`,{className:`text-center text-xs text-text-tertiary`,children:[`By continuing, you agree to our`,` `,(0,W.jsx)(`a`,{href:`#`,className:`underline hover:text-text-primary`,children:`Terms of Service`}),` `,`and`,` `,(0,W.jsx)(`a`,{href:`#`,className:`underline hover:text-text-primary`,children:`Privacy Policy`})]})]})]})})]})}),document.body):null}var Kn=(0,H.createContext)(void 0);function qn(){let e=(0,H.useContext)(Kn);if(e===void 0)throw Error(`useAuthModal must be used within an AuthModalProvider`);return e}function Jn({children:e}){let[t,n]=(0,H.useState)(!1),[r,i]=(0,H.useState)(),[a,o]=(0,H.useState)(),[s,c]=(0,H.useState)(),{login:l,loginWithEmail:u,register:d,error:f,clearError:p,isAuthenticated:m}=Un(),h=(0,H.useCallback)((e,t,r)=>{i(e),o(t?()=>t:void 0),c(r),n(!0)},[]),g=(0,H.useCallback)(()=>{n(!1),i(void 0),o(void 0),c(void 0),p()},[p]);(0,H.useEffect)(()=>{m&&t&&(g(),a&&setTimeout(()=>{a()},100))},[m,a,t,g]);let _=(0,H.useCallback)((e,t)=>{l(e,s||t)},[l,s]);(0,H.useEffect)(()=>{Ln(h)},[h]);let v={showAuthModal:h,hideAuthModal:g,isAuthModalOpen:t};return(0,W.jsxs)(Kn.Provider,{value:v,children:[e,(0,W.jsx)(Gn,{isOpen:t,onClose:g,onLogin:l,onOAuthLogin:_,onEmailLogin:u,onRegister:d,error:f,onClearError:p,actionContext:r})]})}var Yn=(0,H.createContext)({theme:`system`,setTheme:()=>{}});const Xn=()=>{let e=(0,H.useContext)(Yn);if(!e)throw Error(`useTheme must be used within a ThemeProvider`);return e};function Zn({children:e}){let[t,n]=(0,H.useState)(()=>localStorage.getItem(`theme`)||`system`),r=e=>{let t=window.document.documentElement;if(t.classList.remove(`light`,`dark`),e===`system`){let e=window.matchMedia(`(prefers-color-scheme: dark)`).matches?`dark`:`light`;t.classList.add(e)}else t.classList.add(e)};return(0,H.useEffect)(()=>{r(t);let e=window.matchMedia(`(prefers-color-scheme: dark)`),n=()=>{t===`system`&&r(`system`)};return e.addEventListener(`change`,n),()=>e.removeEventListener(`change`,n)},[t]),(0,W.jsx)(Yn.Provider,{value:{theme:t,setTheme:e=>{n(e),localStorage.setItem(`theme`,e),r(e)}},children:e})}var Qn=({...e})=>{let{theme:t=`system`}=x();return(0,W.jsx)(i,{theme:t,className:`toaster group`,style:{"--normal-bg":`var(--popover)`,"--normal-text":`var(--popover-foreground)`,"--normal-border":`var(--border)`},...e})},$n=768;function er(){let[e,t]=H.useState(void 0);return H.useEffect(()=>{let e=window.matchMedia(`(max-width: ${$n-1}px)`),n=()=>{t(window.innerWidth<$n)};return e.addEventListener(`change`,n),t(window.innerWidth<$n),()=>e.removeEventListener(`change`,n)},[]),!!e}function G(...e){return a(t(e))}function tr(e,t){return e||t||``}function nr(e){return typeof e!=`string`||e.length===0?e:e.charAt(0).toUpperCase()+e.slice(1)}var rr=o(`inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive cursor-pointer`,{variants:{variant:{default:`bg-text-secondary text-bg-3 shadow-xs hover:bg-text-secondary/90`,destructive:`bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60`,outline:`border bg-bg-3 dark:bg-bg-2 shadow-xs hover:bg-bg-4 hover:text-text-secondary dark:border-bg-4`,secondary:`bg-bg-2 text-text-secondary shadow-xs hover:bg-bg-2/80`,ghost:`hover:bg-accent hover:text-text-secondary dark:hover:bg-accent/50 text-text-primary`,link:`text-text-primary underline-offset-4 hover:underline`},size:{default:`h-9 px-4 py-2 has-[>svg]:px-3`,sm:`h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5`,lg:`h-10 rounded-md px-6 has-[>svg]:px-4`,icon:`size-8`}},defaultVariants:{variant:`default`,size:`default`}});function K({className:e,variant:t,size:n,asChild:r=!1,...i}){return(0,W.jsx)(r?qt:`button`,{"data-slot":`button`,className:G(rr({variant:t,size:n,className:e})),...i})}function ir({className:e,type:t,...n}){return(0,W.jsx)(`input`,{type:t,"data-slot":`input`,className:G(`file:text-text-primary placeholder:!text-gray-400 selection:bg-text-secondary selection:text-bg-3 flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,`focus-visible:border-secondary focus-visible:ring-ring/50 focus-visible:ring-[1px]`,`aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive`,e),...n})}function ar({className:e,orientation:t=`horizontal`,decorative:n=!0,...r}){return(0,W.jsx)(_t,{"data-slot":`separator`,decorative:n,orientation:t,className:G(`bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px`,e),...r})}function or({...e}){return(0,W.jsx)(cn,{"data-slot":`sheet`,...e})}function sr({...e}){return(0,W.jsx)(Ft,{"data-slot":`sheet-portal`,...e})}function cr({className:e,...t}){return(0,W.jsx)(lt,{"data-slot":`sheet-overlay`,className:G(`data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50`,e),...t})}function lr({className:e,children:t,side:n=`right`,...r}){return(0,W.jsxs)(sr,{children:[(0,W.jsx)(cr,{}),(0,W.jsxs)(Wt,{"data-slot":`sheet-content`,className:G(`bg-bg-3 data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500`,n===`right`&&`data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm`,n===`left`&&`data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm`,n===`top`&&`data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b`,n===`bottom`&&`data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t`,e),...r,children:[t,(0,W.jsxs)(rt,{className:`ring-offset-background focus:ring-ring data-[state=open]:bg-bg-2 absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none`,children:[(0,W.jsx)(Ct,{className:`size-4`}),(0,W.jsx)(`span`,{className:`sr-only`,children:`Close`})]})]})]})}function ur({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`sheet-header`,className:G(`flex flex-col gap-1.5 p-4`,e),...t})}function dr({className:e,...t}){return(0,W.jsx)(ft,{"data-slot":`sheet-title`,className:G(`text-text-primary font-semibold`,e),...t})}function fr({className:e,...t}){return(0,W.jsx)(tn,{"data-slot":`sheet-description`,className:G(`text-text-tertiary text-sm`,e),...t})}function pr({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`skeleton`,className:G(`bg-accent animate-pulse rounded-md`,e),...t})}function mr({delayDuration:e=0,...t}){return(0,W.jsx)(Vt,{"data-slot":`tooltip-provider`,delayDuration:e,...t})}function hr({...e}){return(0,W.jsx)(mr,{children:(0,W.jsx)(Qt,{"data-slot":`tooltip`,...e})})}function gr({...e}){return(0,W.jsx)(Et,{"data-slot":`tooltip-trigger`,...e})}function _r({className:e,sideOffset:t=0,children:n,...r}){return(0,W.jsx)(an,{children:(0,W.jsx)(mt,{"data-slot":`tooltip-content`,sideOffset:t,className:G(`bg-text-secondary text-bg-3 animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md -ml-2 px-3 py-1.5 text-xs text-balance`,e),...r,children:n})})}var vr=`sidebar_state`,yr=3600*24*7,br=`16rem`,xr=`18rem`,Sr=`3rem`,Cr=`b`,wr=H.createContext(null);function Tr(){let e=H.useContext(wr);if(!e)throw Error(`useSidebar must be used within a SidebarProvider.`);return e}function Er({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:i,children:a,...o}){let s=er(),[c,l]=H.useState(!1),[u,d]=H.useState(e),f=t??u,p=H.useCallback(e=>{let t=typeof e==`function`?e(f):e;n?n(t):d(t),document.cookie=`${vr}=${t}; path=/; max-age=${yr}`},[n,f]),m=H.useCallback(()=>s?l(e=>!e):p(e=>!e),[s,p,l]);H.useEffect(()=>{let e=e=>{e.key===Cr&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),m())};return window.addEventListener(`keydown`,e),()=>window.removeEventListener(`keydown`,e)},[m]);let h=f?`expanded`:`collapsed`,g=H.useMemo(()=>({state:h,open:f,setOpen:p,isMobile:s,openMobile:c,setOpenMobile:l,toggleSidebar:m}),[h,f,p,s,c,l,m]);return(0,W.jsx)(wr.Provider,{value:g,children:(0,W.jsx)(mr,{delayDuration:0,children:(0,W.jsx)(`div`,{"data-slot":`sidebar-wrapper`,style:{"--sidebar-width":br,"--sidebar-width-icon":Sr,...i},className:G(`group/sidebar-wrapper has-data-[variant=inset]:bg-bg-2 flex min-h-svh w-full`,r),...o,children:a})})})}function Dr({side:e=`left`,variant:t=`sidebar`,collapsible:n=`offcanvas`,className:r,children:i,...a}){let{isMobile:o,state:s,openMobile:c,setOpenMobile:l}=Tr();return n===`none`?(0,W.jsx)(`div`,{"data-slot":`sidebar`,className:G(`text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col`,r),...a,children:i}):o?(0,W.jsx)(or,{open:c,onOpenChange:l,...a,children:(0,W.jsxs)(lr,{"data-sidebar":`sidebar`,"data-slot":`sidebar`,"data-mobile":`true`,className:`bg-bg-2 text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden`,style:{"--sidebar-width":xr},side:e,children:[(0,W.jsxs)(ur,{className:`sr-only`,children:[(0,W.jsx)(dr,{children:`Sidebar`}),(0,W.jsx)(fr,{children:`Displays the mobile sidebar.`})]}),(0,W.jsx)(`div`,{className:`flex h-full w-full flex-col`,children:i})]})}):(0,W.jsxs)(`div`,{className:`group peer text-sidebar-foreground hidden md:block bg-bg-2`,"data-state":s,"data-collapsible":s===`collapsed`?n:``,"data-variant":t,"data-side":e,"data-slot":`sidebar`,children:[(0,W.jsx)(`div`,{"data-slot":`sidebar-gap`,className:G(`relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear`,`group-data-[collapsible=offcanvas]:w-0`,`group-data-[side=right]:rotate-180`,t===`floating`||t===`inset`?`group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]`:`group-data-[collapsible=icon]:w-(--sidebar-width-icon)`)}),(0,W.jsx)(`div`,{"data-slot":`sidebar-container`,className:G(`fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex`,e===`left`?`left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]`:`right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]`,t===`floating`||t===`inset`?`p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]`:`group-data-[collapsible=icon]:w-(--sidebar-width-icon)`,r),...a,children:(0,W.jsx)(`div`,{"data-sidebar":`sidebar`,"data-slot":`sidebar-inner`,className:`bg-bg-2 border-r-[0.5px] border-border-primary flex h-full w-full flex-col`,children:i})})]})}function Or({className:e,onClick:t,...n}){let{toggleSidebar:r}=Tr();return(0,W.jsxs)(K,{"data-sidebar":`trigger`,"data-slot":`sidebar-trigger`,variant:`ghost`,size:`icon`,className:G(`size-7`,e),onClick:e=>{t?.(e),r()},...n,children:[(0,W.jsx)(Ue,{}),(0,W.jsx)(`span`,{className:`sr-only`,children:`Toggle Sidebar`})]})}function kr({className:e,...t}){return(0,W.jsx)(`main`,{"data-slot":`sidebar-inset`,className:G(`bg-bg-3 relative flex w-full flex-1 flex-col`,`md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2`,e),...t})}function Ar({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`sidebar-footer`,"data-sidebar":`footer`,className:G(`flex flex-col gap-2 p-2`,e),...t})}function jr({className:e,...t}){return(0,W.jsx)(ar,{"data-slot":`sidebar-separator`,"data-sidebar":`separator`,className:G(`bg-bg-2-border mx-2 w-auto`,e),...t})}function Mr({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`sidebar-content`,"data-sidebar":`content`,className:G(`flex min-h-0 flex-1 flex-col gap-0 overflow-auto group-data-[collapsible=icon]:overflow-hidden`,e),...t})}function Nr({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`sidebar-group`,"data-sidebar":`group`,className:G(`relative flex w-full min-w-0 flex-col pl-2 py-0`,e),...t})}function Pr({className:e,asChild:t=!1,...n}){return(0,W.jsx)(t?qt:`div`,{"data-slot":`sidebar-group-label`,"data-sidebar":`group-label`,className:G(`text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0`,`group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0`,e),...n})}function Fr({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`sidebar-group-content`,"data-sidebar":`group-content`,className:G(`w-full text-sm`,e),...t})}function Ir({className:e,...t}){return(0,W.jsx)(`ul`,{"data-slot":`sidebar-menu`,"data-sidebar":`menu`,className:G(`flex w-full min-w-0 flex-col gap-0`,e),...t})}function Lr({className:e,...t}){return(0,W.jsx)(`li`,{"data-slot":`sidebar-menu-item`,"data-sidebar":`menu-item`,className:G(`group/menu-item relative`,e),...t})}var Rr=o(`peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-bg-2-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-bg-2-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-bg-2-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-bg-2-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0`,{variants:{variant:{default:`hover:bg-bg-2-accent hover:text-sidebar-accent-foreground`,outline:`bg-bg-3 shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-bg-2-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]`},size:{default:`text-sm`,sm:`h-7 text-xs`,lg:`h-12 text-sm group-data-[collapsible=icon]:p-0!`}},defaultVariants:{variant:`default`,size:`default`}});function zr({asChild:e=!1,isActive:t=!1,variant:n=`default`,size:r=`default`,tooltip:i,className:a,...o}){let s=e?qt:`button`,{isMobile:c,state:l}=Tr(),u=(0,W.jsx)(s,{"data-slot":`sidebar-menu-button`,"data-sidebar":`menu-button`,"data-size":r,"data-active":t,className:G(Rr({variant:n,size:r}),a),...o});return i?(typeof i==`string`&&(i={children:i}),(0,W.jsxs)(hr,{children:[(0,W.jsx)(gr,{asChild:!0,children:u}),(0,W.jsx)(_r,{side:`right`,align:`center`,hidden:l!==`collapsed`||c,...i})]})):u}function Br({className:e,asChild:t=!1,showOnHover:n=!1,...r}){return(0,W.jsx)(t?qt:`button`,{"data-slot":`sidebar-menu-action`,"data-sidebar":`menu-action`,className:G(`text-sidebar-foreground ring-sidebar-ring hover:bg-bg-2-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0`,`after:absolute after:-inset-2 md:after:hidden`,`peer-data-[size=sm]/menu-button:top-1`,`peer-data-[size=default]/menu-button:top-1.5`,`peer-data-[size=lg]/menu-button:top-2.5`,`group-data-[collapsible=icon]:hidden`,n&&`peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0`,e),...r})}function Vr(){let{isAuthenticated:e,user:t}=Un(),{showAuthModal:n}=qn();return{isAuthenticated:e,user:t,requireAuth:(0,H.useCallback)((r={})=>e?r.requireFullAuth&&t?.isAnonymous?(n(r.actionContext,r.onSuccess,r.intendedUrl),!1):(r.onSuccess&&r.onSuccess(),!0):(n(r.actionContext,r.onSuccess,r.intendedUrl),!1),[e,t?.isAnonymous,n])}}const Hr=new class{constructor(){this.listeners=new Map}on(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>{this.listeners.get(e)?.delete(t)}}emit(e){let t=this.listeners.get(e.type);t&&t.forEach(t=>{try{t(e)}catch(e){console.error(`Error in app event listener:`,e)}})}emitAppDeleted(e){this.emit({type:`app-deleted`,appId:e})}emitAppCreated(e,t){this.emit({type:`app-created`,appId:e,data:t})}emitAppUpdated(e,t){this.emit({type:`app-updated`,appId:e,data:t})}};var Ur=(0,H.createContext)(null),Wr=10;function Gr({children:e}){let{user:t}=Un(),[n,r]=(0,H.useState)({allApps:[],favoriteApps:[],recentApps:[],loading:{allApps:!0,favoriteApps:!0},error:{allApps:null,favoriteApps:null},moreRecentAvailable:!1}),i=(0,H.useCallback)(e=>{let t=[...e].sort((e,t)=>{let n=e.updatedAt?new Date(e.updatedAt).getTime():0;return(t.updatedAt?new Date(t.updatedAt).getTime():0)-n});return{recentApps:t.slice(0,Wr),moreRecentAvailable:t.length>Wr}},[]),a=(0,H.useCallback)(async()=>{if(!t){r(e=>({...e,allApps:[],...i([]),loading:{...e.loading,allApps:!1},error:{...e.error,allApps:null}}));return}try{r(e=>({...e,loading:{...e.loading,allApps:!0},error:{...e.error,allApps:null}}));let e=await U.getUserApps();if(e.success){let t=e.data?.apps||[],{recentApps:n,moreRecentAvailable:a}=i(t);r(e=>({...e,allApps:t,recentApps:n,moreRecentAvailable:a,loading:{...e.loading,allApps:!1}}))}else r(t=>({...t,loading:{...t.loading,allApps:!1},error:{...t.error,allApps:e.error?.message||`Failed to fetch apps`}}))}catch(e){console.error(`Error fetching all apps:`,e);let t=e instanceof Rn?`${e.message} (${e.status})`:e instanceof Error?e.message:`Failed to fetch apps`;r(e=>({...e,loading:{...e.loading,allApps:!1},error:{...e.error,allApps:t}}))}},[t,i]),o=(0,H.useCallback)(async()=>{if(!t){r(e=>({...e,favoriteApps:[],loading:{...e.loading,favoriteApps:!1},error:{...e.error,favoriteApps:null}}));return}try{r(e=>({...e,loading:{...e.loading,favoriteApps:!0},error:{...e.error,favoriteApps:null}}));let e=await U.getFavoriteApps();e.success?r(t=>({...t,favoriteApps:e.data?.apps||[],loading:{...t.loading,favoriteApps:!1}})):r(t=>({...t,loading:{...t.loading,favoriteApps:!1},error:{...t.error,favoriteApps:e.error?.message||`Failed to fetch favorite apps`}}))}catch(e){console.error(`Error fetching favorite apps:`,e);let t=e instanceof Rn?`${e.message} (${e.status})`:e instanceof Error?e.message:`Failed to fetch favorite apps`;r(e=>({...e,loading:{...e.loading,favoriteApps:!1},error:{...e.error,favoriteApps:t}}))}},[t]),s=(0,H.useCallback)(async()=>{t&&await Promise.all([a(),o()])},[t,a,o]);(0,H.useEffect)(()=>{s()},[s]),(0,H.useEffect)(()=>{let e=e=>{if(e.type===`app-deleted`){let t=e;r(e=>{let n=e.allApps.filter(e=>e.id!==t.appId),r=e.favoriteApps.filter(e=>e.id!==t.appId),{recentApps:a,moreRecentAvailable:o}=i(n);return{...e,allApps:n,favoriteApps:r,recentApps:a,moreRecentAvailable:o}})}},t=()=>{s()},n=e=>{if(e.type===`app-updated`){let t=e;t.data&&r(e=>{let n=e.allApps.map(e=>e.id===t.appId?{...e,...t.data,updatedAt:new Date}:e),r=e.favoriteApps.map(e=>e.id===t.appId?{...e,...t.data,updatedAt:new Date}:e),{recentApps:a,moreRecentAvailable:o}=i(n);return{...e,allApps:n,favoriteApps:r,recentApps:a,moreRecentAvailable:o}})}},a=Hr.on(`app-deleted`,e),o=Hr.on(`app-created`,t),c=Hr.on(`app-updated`,n);return()=>{a(),o(),c()}},[s,i]);let c=(0,H.useMemo)(()=>({...n,refetchAllApps:a,refetchFavoriteApps:o,refetchAll:s}),[n,a,o,s]);return(0,W.jsx)(Ur.Provider,{value:c,children:e})}function Kr(){let e=(0,H.useContext)(Ur);if(!e)throw Error(`useAppsData must be used within an AppsDataProvider`);return e}function qr(){let{allApps:e,loading:t,error:n,refetchAllApps:r}=Kr();return{apps:e,loading:t.allApps,error:n.allApps,refetch:r}}function Jr(){let{recentApps:e,moreRecentAvailable:t,loading:n,error:r,refetchAllApps:i}=Kr();return{apps:e,moreAvailable:t,loading:n.allApps,error:r.allApps,refetch:i}}function Yr(){let{favoriteApps:e,loading:t,error:n,refetchFavoriteApps:r}=Kr();return{apps:e,loading:t.favoriteApps,error:n.favoriteApps,refetch:r}}async function Xr(e){try{let t=await U.toggleFavorite(e);if(t.success&&t.data)return t.data.isFavorite;throw Error(t.error?.message||`Failed to toggle favorite`)}catch(e){throw e instanceof Rn?Error(`Failed to toggle favorite: ${e.message}`):e}}function Zr({className:e,children:t,...n}){return(0,W.jsxs)(Ke,{"data-slot":`scroll-area`,className:G(`relative`,e),...n,children:[(0,W.jsx)(S,{"data-slot":`scroll-area-viewport`,className:`focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1 [&>div]:!block [&>div]:!w-full`,children:t}),(0,W.jsx)(Qr,{}),(0,W.jsx)(Je,{})]})}function Qr({className:e,orientation:t=`vertical`,...n}){return(0,W.jsx)(Xe,{"data-slot":`scroll-area-scrollbar`,orientation:t,className:G(`flex touch-none p-px transition-colors select-none`,t===`vertical`&&`h-full w-2.5 border-l border-l-transparent`,t===`horizontal`&&`h-2.5 flex-col border-t border-t-transparent`,e),...n,children:(0,W.jsx)(De,{"data-slot":`scroll-area-thumb`,className:`bg-border relative flex-1 rounded-full`})})}function $r({...e}){return(0,W.jsx)(Jt,{"data-slot":`dropdown-menu`,...e})}function ei({...e}){return(0,W.jsx)(de,{"data-slot":`dropdown-menu-trigger`,...e})}function ti({className:e,sideOffset:t=4,...n}){return(0,W.jsx)(pe,{children:(0,W.jsx)(ae,{"data-slot":`dropdown-menu-content`,sideOffset:t,className:G(`bg-bg-4 text-text-primary data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md`,e),...n})})}function ni({...e}){return(0,W.jsx)(Re,{"data-slot":`dropdown-menu-group`,...e})}function ri({className:e,inset:t,variant:n=`default`,...r}){return(0,W.jsx)(We,{"data-slot":`dropdown-menu-item`,"data-inset":t,"data-variant":n,className:G(`focus:bg-accent focus:text-text-secondary data-[variant=destructive]:text-destructive  data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-text-tertiary relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4`,e),...r})}function ii({className:e,inset:t,...n}){return(0,W.jsx)(re,{"data-slot":`dropdown-menu-label`,"data-inset":t,className:G(`px-2 py-1.5 text-sm font-medium data-[inset]:pl-8`,e),...n})}function ai({...e}){return(0,W.jsx)(xn,{"data-slot":`alert-dialog`,...e})}function oi({...e}){return(0,W.jsx)(Ve,{"data-slot":`alert-dialog-trigger`,...e})}function si({...e}){return(0,W.jsx)(ke,{"data-slot":`alert-dialog-portal`,...e})}function ci({className:e,...t}){return(0,W.jsx)(me,{"data-slot":`alert-dialog-overlay`,className:G(`data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50`,e),...t})}function li({className:e,...t}){return(0,W.jsxs)(si,{children:[(0,W.jsx)(ci,{}),(0,W.jsx)(ee,{"data-slot":`alert-dialog-content`,className:G(`bg-bg-3 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg`,e),...t})]})}function ui({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`alert-dialog-header`,className:G(`flex flex-col gap-2 text-center sm:text-left`,e),...t})}function di({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`alert-dialog-footer`,className:G(`flex flex-col-reverse gap-2 sm:flex-row sm:justify-end`,e),...t})}function fi({className:e,...t}){return(0,W.jsx)(D,{"data-slot":`alert-dialog-title`,className:G(`text-lg font-semibold`,e),...t})}function pi({className:e,...t}){return(0,W.jsx)(ce,{"data-slot":`alert-dialog-description`,className:G(`text-text-tertiary text-sm`,e),...t})}function mi({className:e,...t}){return(0,W.jsx)(ye,{className:G(rr(),e),...t})}function hi({className:e,...t}){return(0,W.jsx)(V,{className:G(rr({variant:`outline`}),e),...t})}function gi({open:e,onOpenChange:t,onConfirm:n,title:r=`Delete App`,description:i,isLoading:a=!1,appTitle:o}){let s=o?`Are you sure you want to delete "${o}"? This action cannot be undone and all associated data will be permanently removed.`:`Are you sure you want to delete this app? This action cannot be undone and all associated data will be permanently removed.`;return(0,W.jsx)(ai,{open:e,onOpenChange:t,children:(0,W.jsxs)(li,{className:`sm:max-w-[425px]`,children:[(0,W.jsxs)(ui,{children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,W.jsx)(`div`,{className:`flex h-10 w-10 items-center justify-center rounded-full bg-destructive/10`,children:(0,W.jsx)(Pe,{className:`h-5 w-5 text-destructive`})}),(0,W.jsx)(`div`,{className:`flex-1`,children:(0,W.jsx)(fi,{className:`text-left`,children:r})})]}),(0,W.jsx)(pi,{className:`text-left pt-2`,children:i||s})]}),(0,W.jsxs)(di,{children:[(0,W.jsx)(hi,{disabled:a,children:`Cancel`}),(0,W.jsx)(mi,{onClick:async e=>{e.stopPropagation(),e.preventDefault(),await n()},disabled:a,className:`bg-destructive text-destructive-foreground hover:bg-destructive/90 focus:ring-destructive`,children:a?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(C,{className:`h-4 w-4 animate-spin mr-2`}),`Deleting...`]}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(mn,{className:`h-4 w-4 mr-2`}),`Delete App`]})})]})]})})}function _i({appId:e,appTitle:t,onAppDeleted:n,className:r=``,variant:i=`ghost`,size:a=`icon`,showOnHover:o=!1}){let[s,c]=(0,H.useState)(!1),[l,u]=(0,H.useState)(!1);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)($r,{children:[(0,W.jsx)(ei,{asChild:!0,children:(0,W.jsxs)(K,{variant:i,size:a,className:o?`opacity-0 group-hover:opacity-100 transition-all duration-200 hover:bg-bg-3/80 cursor-pointer ${r}`:`hover:bg-bg-3/80 cursor-pointer ${r}`,onClick:e=>{e.stopPropagation(),e.preventDefault()},children:[(0,W.jsx)(sn,{className:`h-4 w-4`}),(0,W.jsx)(`span`,{className:`sr-only`,children:`App actions`})]})}),(0,W.jsx)(ti,{align:`end`,className:`w-48`,children:(0,W.jsxs)(ri,{onClick:e=>{e.stopPropagation(),e.preventDefault(),c(!0)},className:`text-destructive focus:text-destructive focus:bg-destructive/10`,children:[(0,W.jsx)(mn,{className:`h-4 w-4 mr-2`}),`Delete app`]})})]}),(0,W.jsx)(gi,{open:s,onOpenChange:c,onConfirm:async()=>{try{u(!0),(await U.deleteApp(e)).success&&(_.success(`App deleted successfully`),c(!1),Hr.emitAppDeleted(e),n?.())}catch(e){console.error(`Error deleting app:`,e),_.error(`An unexpected error occurred while deleting the app`)}finally{u(!1)}},isLoading:l,appTitle:t})]})}function vi({app:e,onClick:t,variant:n=`recent`,showActions:r=!0,isCollapsed:i,getVisibilityIcon:a}){return(0,W.jsxs)(Lr,{className:`group/app-item`,children:[(0,W.jsx)(zr,{asChild:!0,tooltip:e.title,className:`cursor-pointer transition-opacity hover:opacity-75 pr-0`,children:(0,W.jsx)(`a`,{href:`/app/${e.id}`,onClick:n=>{n.preventDefault(),t(e.id)},className:`w-full no-underline`,children:(0,W.jsxs)(`div`,{className:`flex-1 min-w-0 pr-2`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2 min-w-0`,children:[n===`bookmarked`&&(0,W.jsx)(T,{className:`h-3 w-3 fill-yellow-500 text-yellow-500 flex-shrink-0`}),(0,W.jsxs)(`div`,{className:`relative flex-1 min-w-0 overflow-hidden`,children:[(0,W.jsxs)(`span`,{className:`font-medium flex justify-start  items-center  gap-2 text-text-primary/80 whitespace-nowrap`,children:[(0,W.jsxs)(`span`,{className:`text-ellipsis w-fit overflow-hidden`,children:[e.title,` `]}),(0,W.jsx)(`div`,{className:`flex-shrink-0 min-w-6`,children:a(e.visibility)})]}),(0,W.jsx)(`div`,{className:`absolute inset-y-0 right-0 w-4 bg-gradient-to-l from-bg-2 to-transparent pointer-events-none`})]})]}),(0,W.jsx)(`p`,{className:`text-xs text-text-tertiary truncate`,children:(()=>e.updatedAtFormatted?e.updatedAtFormatted:e.updatedAt&&d(e.updatedAt)?p(e.updatedAt,{addSuffix:!0}):`Recently`)()})]})})}),!i&&r&&(0,W.jsx)(Br,{asChild:!0,className:`opacity-0 -mr-2 group-hover/app-item:opacity-100 transition-opacity`,children:(0,W.jsx)(_i,{appId:e.id,appTitle:e.title,size:`sm`,className:`h-6 w-6`,showOnHover:!1})})]})}function yi(){let{user:e}=Un(),t=O(),[n,r]=H.useState(``),[i,a]=H.useState([`apps`,`boards`]),{state:o,setOpen:s}=Tr(),c=o===`collapsed`,{apps:l,moreAvailable:u}=Jr(),{apps:d}=Yr(),{apps:f,loading:p}=qr(),m=[],h=H.useMemo(()=>n.trim()?f.filter(e=>e.title.toLowerCase().includes(n.toLowerCase().trim())):[],[f,n]),g=n.trim().length>0,_=e=>{switch(e){case`private`:return(0,W.jsx)(qe,{className:`h-3 w-3`});case`team`:return(0,W.jsx)(dn,{className:`h-3 w-3`});case`board`:return(0,W.jsx)(Zt,{className:`h-3 w-3`});case`public`:return(0,W.jsx)(Zt,{className:`h-3 w-3`})}},v=e=>{a(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};if(e)return(0,W.jsx)(W.Fragment,{children:(0,W.jsxs)(Dr,{collapsible:`icon`,className:G(`bg-bg-2 transition-all duration-300 ease-in-out`),children:[(0,W.jsxs)(Mr,{className:`mt-2`,children:[(0,W.jsx)(Nr,{children:(0,W.jsx)(Fr,{children:location.pathname!==`/`&&(0,W.jsx)(`div`,{className:G(c?` pr-2`:`px-1`),children:(0,W.jsx)(mr,{delayDuration:0,children:(0,W.jsx)(hr,{children:(0,W.jsx)(gr,{asChild:!0,children:(0,W.jsxs)(`button`,{className:G(`group flex w-full border-[0.5px] border-bg-2 items-center gap-2 font-medium hover:opacity-80 hover:cursor-pointer p-2 rounded-md cursor-hand text-text-secondary hover:text-text-primary`,c?`justify-center bg-accent`:`justify-start bg-accent`),onClick:()=>{c||s(!1),t(`/`)},children:[(0,W.jsx)(je,{className:`h-4 w-4 text-neutral-50`}),!c&&(0,W.jsx)(`span`,{className:`font-medium text-neutral-50`,children:`New build`})]})})})})})})}),!c&&(0,W.jsxs)(Zr,{className:`flex-1 px-1 relative`,children:[(0,W.jsx)(`div`,{className:`absolute inset-y-0 right-0 w-8 bg-gradient-to-l from-bg-2 to-transparent pointer-events-none z-10`}),(0,W.jsx)(Nr,{children:i.includes(`apps`)&&(0,W.jsxs)(Fr,{children:[(0,W.jsxs)(`div`,{className:`relative bg-bg-3 mb-4 mt-2`,children:[(0,W.jsx)(xe,{className:`absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-text-tertiary`}),(0,W.jsx)(ir,{placeholder:`Search apps...`,value:n,onChange:e=>r(e.target.value),className:`h-10 w-full pl-8 placeholder:text-primary/40`})]}),(0,W.jsx)(Ir,{children:g?(0,W.jsx)(W.Fragment,{children:p?(0,W.jsx)(Lr,{children:(0,W.jsx)(`div`,{className:`flex items-center justify-center py-4`,children:(0,W.jsx)(`div`,{className:`text-sm text-text-tertiary`,children:`Searching...`})})}):h.length>0?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Lr,{children:(0,W.jsxs)(`div`,{className:`px-2 py-1 text-xs text-text-tertiary`,children:[`Found`,` `,h.length,` `,`app`,h.length===1?``:`s`]})}),h.map(e=>(0,W.jsx)(vi,{app:e,onClick:e=>t(`/app/${e}`),variant:`recent`,showActions:!0,isCollapsed:c,getVisibilityIcon:_},e.id))]}):(0,W.jsx)(Lr,{children:(0,W.jsx)(`div`,{className:`flex items-center justify-center py-4`,children:(0,W.jsxs)(`div`,{className:`text-sm text-text-tertiary`,children:[`No apps found for "`,n,`"`]})})})}):(0,W.jsxs)(W.Fragment,{children:[l.map(e=>(0,W.jsx)(vi,{app:e,onClick:e=>t(`/app/${e}`),variant:`recent`,showActions:!0,isCollapsed:c,getVisibilityIcon:_},e.id)),u&&(0,W.jsx)(Lr,{children:(0,W.jsxs)(zr,{onClick:()=>t(`/apps`),tooltip:`View all apps`,className:`text-text-tertiary hover:text-text-primary view-all-button`,children:[(0,W.jsx)(Ne,{className:`h-4 w-4`}),!c&&(0,W.jsx)(`span`,{className:`font-medium text-text-primary/80`,children:`View all apps `})]})})]})})]})}),d.length>0&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(jr,{}),(0,W.jsxs)(Nr,{className:`mt-4`,children:[(0,W.jsxs)(Pr,{className:G(`flex items-center gap-2 text-md text-text-primary`,c&&`justify-center px-0`),children:[!c&&`Bookmarked`,(0,W.jsx)(T,{className:`h-5 w-5 fill-yellow-500 text-yellow-500`})]}),(0,W.jsx)(Fr,{children:(0,W.jsx)(Ir,{children:d.map(e=>(0,W.jsx)(vi,{app:e,onClick:e=>t(`/app/${e}`),showActions:!0,isCollapsed:c,getVisibilityIcon:_},e.id))})})]})]}),m.length>0&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(jr,{}),(0,W.jsxs)(Nr,{children:[(0,W.jsx)(Pr,{className:G(`flex items-center cursor-pointer hover:text-text-primary transition-colors`,c?`justify-center px-0`:`justify-between`),onClick:()=>v(`boards`),children:c?(0,W.jsx)(mr,{delayDuration:0,children:(0,W.jsxs)(hr,{children:[(0,W.jsx)(gr,{children:(0,W.jsx)(et,{className:`h-4 w-4`})}),(0,W.jsx)(_r,{side:`right`,className:`ml-2`,children:`My Boards`})]})}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(et,{className:`h-4 w-4`}),(0,W.jsx)(`span`,{children:`My Boards`})]}),(0,W.jsx)(Ne,{className:G(`h-4 w-4 transition-transform`,i.includes(`boards`)&&`rotate-90`)})]})}),i.includes(`boards`)&&(0,W.jsx)(Fr,{children:(0,W.jsxs)(Ir,{children:[m.map(e=>(0,W.jsx)(Lr,{children:(0,W.jsxs)(zr,{onClick:()=>t(`/boards/${e.slug}`),tooltip:e.name,className:`board-item-button`,children:[(0,W.jsx)(`div`,{className:G(`rounded-lg flex-shrink-0 flex items-center justify-center transition-colors`,`h-8 w-8`,c?`bg-sidebar-accent`:`bg-sidebar-accent/50`),children:(0,W.jsx)(dn,{className:`h-4 w-4 text-sidebar-accent-foreground`})}),!c&&(0,W.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[(0,W.jsx)(`p`,{className:`text-sm font-medium truncate`,children:e.name}),(0,W.jsxs)(`p`,{className:`text-xs text-text-tertiary truncate`,children:[e.memberCount,` `,`members `,` `,e.appCount,` `,`apps`]})]})]})},e.id)),(0,W.jsx)(Lr,{children:(0,W.jsxs)(zr,{onClick:()=>t(`/boards`),tooltip:`Browse all boards`,className:`text-text-tertiary hover:text-text-primary view-all-button`,children:[(0,W.jsx)(je,{className:`h-4 w-4`}),!c&&(0,W.jsx)(`span`,{className:`font-medium text-text-primary/80 ml-2`,children:`Browse all boards`})]})})]})})]})]})]})]}),(0,W.jsx)(Ar,{children:e&&(0,W.jsxs)(Ir,{children:[(0,W.jsx)(Lr,{children:(0,W.jsxs)(zr,{id:`discover-link`,onClick:()=>t(`/discover`),tooltip:`Discover`,className:`group hover:opacity-80 hover:cursor-pointer hover:bg-bg-1/50 transition-all duration-200`,children:[(0,W.jsx)(Kt,{className:`h-6 w-6 text-text-primary/60 group-hover:text-primary/80 transition-colors`}),!c&&(0,W.jsx)(`span`,{className:`text-text-primary/80 font-medium group-hover:text-primary transition-colors`,children:`Discover`})]})}),(0,W.jsx)(Lr,{children:(0,W.jsxs)(zr,{onClick:()=>t(`/settings`),tooltip:`Settings`,className:`group hover:opacity-80 hover:cursor-pointer hover:bg-bg-1/50 transition-all duration-200`,children:[(0,W.jsx)(B,{className:`h-6 w-6 text-text-primary/60 group-hover:text-primary/80 transition-colors`}),!c&&(0,W.jsx)(`span`,{className:`font-medium text-text-primary/80 group-hover:text-primary transition-colors`,children:`Settings`})]})})]})})]})})}function bi({className:e,...t}){return(0,W.jsx)(_e,{"data-slot":`avatar`,className:G(`relative flex size-8 shrink-0 overflow-hidden rounded-full`,e),...t})}function xi({className:e,...t}){return(0,W.jsx)(Dt,{"data-slot":`avatar-image`,className:G(`aspect-square size-full`,e),...t})}function Si({className:e,...t}){return(0,W.jsx)(w,{"data-slot":`avatar-fallback`,className:G(`bg-bg-3 flex size-full items-center justify-center rounded-full`,e),...t})}function Ci({className:e}){let{user:t,isAuthenticated:n,isLoading:i,error:a,login:o,loginWithEmail:s,register:u,logout:d,clearError:f}=Un(),p=O(),[m,h]=(0,H.useState)(!1);if(i)return(0,W.jsx)(pr,{className:`w-10 h-10 rounded-full`});if(!n||!t)return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(K,{variant:`ghost`,size:`sm`,onClick:()=>h(!0),className:c(`gap-2`,e),children:[(0,W.jsx)(Ye,{className:`h-4 w-4`}),(0,W.jsx)(`span`,{children:`Sign In`})]}),(0,W.jsx)(Gn,{isOpen:m,onClose:()=>h(!1),onLogin:e=>{o(e),h(!1)},onEmailLogin:async e=>{await s(e),a||h(!1)},onOAuthLogin:e=>{o(e),h(!1)},onRegister:async e=>{await u(e),a||h(!1)},error:a,onClearError:f})]});let g=()=>t.displayName?t.displayName.split(` `).map(e=>e[0]).join(``).toUpperCase().slice(0,2):t.email.charAt(0).toUpperCase();return(0,W.jsxs)($r,{children:[(0,W.jsx)(ei,{asChild:!0,children:(0,W.jsxs)(K,{variant:`ghost`,size:`icon`,className:`relative rounded-full hover:ring-2 hover:ring-primary/20 transition-all`,children:[(0,W.jsxs)(bi,{className:`h-8 w-8`,children:[(0,W.jsx)(xi,{src:t.avatarUrl,alt:t.displayName||t.email}),(0,W.jsx)(Si,{className:`bg-text-secondary/10 text-text-primary font-semibold`,children:g()})]}),t.emailVerified&&(0,W.jsx)(`div`,{className:`absolute -bottom-1 -right-1 h-3 w-3 bg-green-500 rounded-full border-2 border-background`})]})}),(0,W.jsx)(l,{children:(0,W.jsx)(ti,{align:`end`,className:`w-72`,asChild:!0,children:(0,W.jsxs)(r.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:[(0,W.jsx)(ii,{className:`p-0`,children:(0,W.jsxs)(`div`,{className:`flex items-start gap-3 p-4`,children:[(0,W.jsxs)(bi,{className:`h-12 w-12`,children:[(0,W.jsx)(xi,{src:t.avatarUrl,alt:t.displayName||t.email}),(0,W.jsx)(Si,{className:`bg-text-secondary/10 text-text-primary font-semibold text-lg`,children:g()})]}),(0,W.jsxs)(`div`,{className:`flex flex-col gap-1 flex-1 text-text-primary`,children:[(0,W.jsx)(`div`,{className:`flex items-center gap-2`,children:(0,W.jsx)(`span`,{className:`text-sm font-semibold`,children:t.displayName||`User`})}),(0,W.jsx)(`span`,{className:`text-xs text-text-tertiary`,children:t.email})]})]})}),(0,W.jsx)(ni,{children:(0,W.jsxs)(ri,{onClick:()=>p(`/settings`),className:`cursor-pointer`,children:[(0,W.jsx)(B,{className:`mr-1 h-4 w-4`}),`Settings`]})}),(0,W.jsxs)(ri,{onClick:()=>d(),className:`cursor-pointer text-destructive focus:text-text-primary`,children:[(0,W.jsx)(fe,{className:`mr-1 h-4 w-4`}),`Sign Out`]})]})})})]})}function wi(){let{setTheme:e}=Xn();return(0,W.jsxs)($r,{children:[(0,W.jsx)(ei,{asChild:!0,children:(0,W.jsxs)(K,{variant:`ghost`,size:`icon`,className:`h-8 w-8 text-text-primary`,children:[(0,W.jsx)(Le,{className:`h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0`}),(0,W.jsx)(Be,{className:`absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100`}),(0,W.jsx)(`span`,{className:`sr-only`,children:`Toggle theme`})]})}),(0,W.jsxs)(ti,{align:`end`,children:[(0,W.jsxs)(ri,{onClick:()=>e(`light`),children:[(0,W.jsx)(Le,{className:`mr-2 h-4 w-4`}),(0,W.jsx)(`span`,{children:`Light`})]}),(0,W.jsxs)(ri,{onClick:()=>e(`dark`),children:[(0,W.jsx)(Be,{className:`mr-2 h-4 w-4`}),(0,W.jsx)(`span`,{children:`Dark`})]}),(0,W.jsxs)(ri,{onClick:()=>e(`system`),children:[(0,W.jsx)(`span`,{className:`mr-2 h-4 w-4`,children:``}),(0,W.jsx)(`span`,{children:`System`})]})]})]})}function Ti(e){return(0,W.jsxs)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 36 16`,fill:`none`,...e,children:[(0,W.jsx)(`path`,{fill:e.color1??`#F6821F`,d:`m24.156 15.775.181-.626c.216-.744.136-1.433-.227-1.938-.332-.466-.887-.74-1.56-.772l-12.76-.162a.253.253 0 0 1-.2-.107.258.258 0 0 1-.028-.23.34.34 0 0 1 .296-.226l12.878-.164c1.527-.07 3.181-1.31 3.76-2.82l.735-1.92a.447.447 0 0 0 .02-.253 8.386 8.386 0 0 0-16.124-.869 3.763 3.763 0 0 0-2.649-.733 3.778 3.778 0 0 0-3.27 4.688 5.366 5.366 0 0 0-5.15 6.139.25.25 0 0 0 .245.215L23.86 16h.006a.31.31 0 0 0 .291-.225Z`}),(0,W.jsx)(`path`,{fill:e.color2??`#FBAD41`,d:`M28.408 6.95c-.119 0-.236.003-.354.009A.197.197 0 0 0 28 6.97a.201.201 0 0 0-.128.135l-.502 1.733c-.216.745-.136 1.432.226 1.938.333.466.888.74 1.561.772l2.72.164a.245.245 0 0 1 .236.217c.005.04 0 .081-.013.12a.34.34 0 0 1-.296.225l-2.826.164c-1.535.07-3.188 1.31-3.767 2.82l-.204.534a.15.15 0 0 0 .015.137.151.151 0 0 0 .12.068h9.73a.259.259 0 0 0 .25-.187 6.973 6.973 0 0 0-6.714-8.861Z`})]})}const Ei=e=>(0,W.jsxs)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,width:24,height:24,fill:`none`,...e,children:[(0,W.jsx)(`rect`,{width:23.5,height:23.5,x:.25,y:.25,fill:`black`,rx:11.75}),(0,W.jsx)(`rect`,{width:23.5,height:23.5,x:.25,y:.25,stroke:`black`,strokeWidth:.5,rx:11.75}),(0,W.jsx)(`path`,{fill:`white`,fillRule:`evenodd`,d:`m.504 11.814 9.734-.123c1.765-.081 3.675-1.514 4.344-3.26l.849-2.217c.298-.46.918-.1.738.343l-.58 2.002c-.249.86-.156 1.655.262 2.24.384.539 1.025.855 1.803.892l3.143.188a.286.286 0 0 1 .257.39.394.394 0 0 1-.342.26l-3.265.19c-1.773.081-3.684 1.513-4.353 3.259l-.236.616c-.137.492-1.006.596-.98-.02l.21-.724c.248-.86.156-1.655-.262-2.24-.385-.538-1.026-.855-1.804-.891l-9.47-.121c-.025-.26-.041-.52-.048-.784Z`,clipRule:`evenodd`})]});var Di={globalUserMessage:``,changeLogs:``,hasActiveMessage:!1},Oi=null,ki=null;async function Ai(){try{let e=await U.getPlatformStatus(!0);if(e.success&&e.data){Oi=e.data;return}}catch(e){console.debug(`Failed to load platform status`,e)}Oi||=Di}function ji(){let[e,t]=(0,H.useState)(Oi??Di);return(0,H.useEffect)(()=>{let e=!1;return Oi?t(Oi):(ki||=Ai().finally(()=>{ki=null}),ki.then(()=>{!e&&Oi&&t(Oi)}).catch(()=>{e||t(Di)})),()=>{e=!0}},[]),{status:e}}function Mi({...e}){return(0,W.jsx)(cn,{"data-slot":`dialog`,...e})}function Ni({...e}){return(0,W.jsx)(Ft,{"data-slot":`dialog-portal`,...e})}function Pi({className:e,...t}){return(0,W.jsx)(lt,{"data-slot":`dialog-overlay`,className:G(`data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50`,e),...t})}function Fi({className:e,children:t,showCloseButton:n=!0,...r}){return(0,W.jsxs)(Ni,{"data-slot":`dialog-portal`,children:[(0,W.jsx)(Pi,{}),(0,W.jsxs)(Wt,{"data-slot":`dialog-content`,className:G(`bg-bg-3 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg`,e),...r,children:[t,n&&(0,W.jsxs)(rt,{"data-slot":`dialog-close`,className:`ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-text-tertiary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4`,children:[(0,W.jsx)(Ct,{}),(0,W.jsx)(`span`,{className:`sr-only`,children:`Close`})]})]})]})}function Ii({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`dialog-header`,className:G(`flex flex-col gap-2 text-center sm:text-left`,e),...t})}function Li({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`dialog-footer`,className:G(`flex flex-col-reverse gap-2 sm:flex-row sm:justify-end`,e),...t})}function Ri({className:e,...t}){return(0,W.jsx)(ft,{"data-slot":`dialog-title`,className:G(`text-lg text-text-primary leading-none font-semibold`,e),...t})}function zi({className:e,...t}){return(0,W.jsx)(tn,{"data-slot":`dialog-description`,className:G(`text-text-tertiary text-sm`,e),...t})}function Bi(){let{user:e}=Un(),{status:t}=ji(),[n,i]=(0,H.useState)(!1),a=!!(t.hasActiveMessage&&t.globalUserMessage.trim().length>0),o=!!(t.changeLogs&&t.changeLogs.trim().length>0),{pathname:s}=Sn();return(0,H.useEffect)(()=>{o||i(!1)},[o]),(0,W.jsxs)(Mi,{open:n,onOpenChange:i,children:[(0,W.jsx)(r.header,{initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{duration:.2,ease:`easeOut`},className:c(`sticky top-0 z-50`,s!==`/`&&`bg-bg-3`),children:(0,W.jsxs)(`div`,{className:`relative`,children:[(0,W.jsx)(`div`,{className:`absolute inset-0 z-0`}),(0,W.jsxs)(`div`,{className:`relative z-10 grid grid-cols-[auto_1fr_auto] items-center gap-4 px-5 py-2`,children:[e?(0,W.jsxs)(r.div,{whileTap:{scale:.95},transition:{type:`spring`,stiffness:400,damping:17},className:`flex items-center`,children:[(0,W.jsx)(Or,{className:`h-8 w-8 text-text-primary rounded-md hover:bg-orange-50/40 transition-colors duration-200`}),(0,W.jsx)(Ti,{className:`flex-shrink-0 mx-auto transition-all duration-300`,style:{width:`28px`,height:`28px`,marginLeft:`8px`}}),a&&(0,W.jsxs)(`button`,{type:`button`,onClick:o?()=>i(!0):void 0,disabled:!o,className:`flex max-w-full items-center gap-2 rounded-full border border-accent/40 bg-bg-4/80 px-3 ml-4 py-1.5 text-xs text-text-primary shadow-sm backdrop-blur transition-colors hover:bg-accent/10 focus:outline-none focus:ring-2 focus:ring-accent/40 dark:border-accent/30 dark:bg-bg-2/80 md:text-sm${o?``:` opacity-50 cursor-not-allowed pointer-events-none`}`,"aria-label":`Platform updates`,children:[(0,W.jsx)(at,{className:`h-4 w-4 text-accent`}),(0,W.jsx)(`span`,{className:`truncate max-w-[46ch] md:max-w-[60ch]`,children:t.globalUserMessage}),(0,W.jsx)(Ne,{className:`ml-1 h-4 w-4 text-accent`})]})]}):(0,W.jsx)(`div`,{}),(0,W.jsxs)(r.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},transition:{delay:.2},className:`flex flex-wrap items-center justify-end gap-3 justify-self-end`,children:[(0,W.jsx)(`div`,{className:`gap-6 flex flex-col justify-between border px-3 bg-bg-4 dark:bg-bg-2 rounded-md py-1.5 border-accent/50 dark:border-accent/50 !border-t-transparent rounded-t-none ml-2 md:ml-6 -mt-2`,children:(0,W.jsxs)(`div`,{className:`flex w-full gap-2 items-center`,children:[(0,W.jsx)(`div`,{className:`text-text-primary/80 mr-4 text-lg font-medium`,children:`Deploy your own vibe-coding platform`}),(0,W.jsxs)(`div`,{className:`flex font-semibold gap-2 items-center bg-accent dark:bg-accent text-white rounded px-2 hover:opacity-80 cursor-pointer`,onClick:()=>window.open(`https://deploy.workers.cloudflare.com/?url=https://github.com/cloudflare/vibesdk`,`_blank`),children:[`Deploy `,(0,W.jsx)(Ti,{className:`w-5 h-5`,color1:`#fff`})]}),(0,W.jsxs)(`div`,{className:`flex font-semibold items-center bg-text-primary text-bg-4 rounded gap-1 px-2 hover:opacity-80 cursor-pointer`,onClick:()=>window.open(`https://github.com/cloudflare/vibesdk`,`_blank`),children:[`Fork `,(0,W.jsx)(Tt,{className:`size-4`})]})]})}),(0,W.jsx)(wi,{}),(0,W.jsx)(Ci,{})]})]})]})}),o&&(0,W.jsxs)(Fi,{className:`max-w-xl`,children:[(0,W.jsxs)(Ii,{children:[(0,W.jsx)(Ri,{children:`Platform updates`}),t.globalUserMessage&&(0,W.jsx)(zi,{className:`text-sm text-muted-foreground`,children:t.globalUserMessage})]}),(0,W.jsx)(Zr,{className:`max-h-[60vh] pr-4`,children:(0,W.jsx)(`p`,{className:`whitespace-pre-wrap text-sm leading-relaxed text-muted-foreground`,children:t.changeLogs})})]})]})}function Vi({children:e}){let{pathname:t}=Sn();return(0,W.jsx)(Gr,{children:(0,W.jsxs)(Er,{defaultOpen:!1,style:{"--sidebar-width":`320px`,"--sidebar-width-mobile":`280px`,"--sidebar-width-icon":`52px`},children:[(0,W.jsx)(yi,{}),(0,W.jsxs)(kr,{className:c(`bg-bg-3 flex flex-col h-screen relative`,t!==`/`&&`overflow-hidden`),children:[(0,W.jsx)(Bi,{}),(0,W.jsx)(`div`,{className:c(`flex-1 bg-bg-3`,t!==`/`&&`min-h-0 overflow-auto`),children:e||(0,W.jsx)(he,{})})]})]})})}function Hi({error:e,resetError:t}){return e instanceof Error&&e.message,(0,W.jsx)(`div`,{className:`flex min-h-screen items-center justify-center p-4`,children:(0,W.jsxs)(`div`,{className:`max-w-md w-full space-y-6 text-center`,children:[(0,W.jsx)(`div`,{className:`flex justify-center`,children:(0,W.jsx)(at,{className:`h-16 w-16 text-red-500`})}),(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)(`h1`,{className:`text-2xl font-bold`,children:`Something went wrong`}),(0,W.jsx)(`p`,{className:`text-muted-foreground`,children:`An unexpected error occurred. Our team has been notified.`})]}),!1,(0,W.jsxs)(`div`,{className:`flex gap-3 justify-center`,children:[(0,W.jsx)(K,{onClick:t,variant:`default`,children:`Try Again`}),(0,W.jsx)(K,{onClick:()=>window.location.href=`/`,variant:`outline`,children:`Go Home`})]})]})})}function Ui({children:e,showDialog:t=!1}){return(0,W.jsx)(Te,{fallback:Hi,showDialog:t,children:e})}function Wi(){return(0,W.jsx)(Ui,{children:(0,W.jsx)(Zn,{children:(0,W.jsx)(Hn,{children:(0,W.jsxs)(Jn,{children:[(0,W.jsx)(Vi,{children:(0,W.jsx)(he,{})}),(0,W.jsx)(Qn,{richColors:!0,position:`top-right`})]})})})})}function Gi(e){let t=(0,H.useRef)(!1),n=(0,H.useRef)(1),r=(0,H.useRef)(!1),[i,a]=(0,H.useState)({searchQuery:``,filterFramework:e.defaultFramework||`all`,filterVisibility:e.defaultVisibility||`all`,sortBy:e.defaultSort||`recent`,period:e.defaultPeriod||`all`}),[o,s]=(0,H.useState)(``),[c,l]=(0,H.useState)([]),[u,d]=(0,H.useState)(!0),[f,p]=(0,H.useState)(!1),[m,h]=(0,H.useState)(null),[g,_]=(0,H.useState)({currentPage:1,totalCount:0,hasMore:!1}),v=e.limit||20;(0,H.useEffect)(()=>{let e=setTimeout(()=>{s(i.searchQuery)},500);return()=>clearTimeout(e)},[i.searchQuery]);let y=(0,H.useCallback)(async(t,r,i)=>{try{t?p(!0):(d(!0),h(null));let a=r??(t?n.current+1:1),o={page:a,limit:v,sort:i.sortBy,period:i.period,framework:i.filterFramework===`all`?void 0:i.filterFramework,search:i.searchQuery||void 0,visibility:e.includeVisibility&&i.filterVisibility!==`all`?i.filterVisibility:void 0},s=Object.fromEntries(Object.entries(o).filter(([,e])=>e!==void 0)),c=e.type===`user`?await U.getUserAppsWithPagination(s):await U.getPublicApps(s);if(c.success&&c.data){let e=c.data,r=e.apps,i=e.pagination;l(t?e=>[...e,...r]:r),n.current=a,_({currentPage:a,totalCount:i.total,hasMore:i.hasMore})}else throw Error(c.error?.message||`Failed to fetch apps`)}catch(e){console.error(`Error fetching apps:`,e),h(e instanceof Rn?`${e.message} (${e.status})`:e instanceof Error?e.message:`Failed to fetch apps`)}finally{d(!1),p(!1)}},[e.type,e.includeVisibility,v]),b=(0,H.useCallback)(async(e=!1,t)=>y(e,t,{...i,searchQuery:o}),[y,i,o]),x=(0,H.useCallback)(async()=>{g.hasMore&&!f&&!u&&(r.current=!0,await b(!0),r.current=!1)},[g.hasMore,f,u,b]),S=(0,H.useCallback)(async()=>{await b(!1,1)},[b]),C=(0,H.useCallback)(e=>{l(t=>t.filter(t=>t.id!==e)),_(e=>({...e,totalCount:Math.max(0,e.totalCount-1)}))},[]),w=(0,H.useCallback)(e=>{a(t=>({...t,searchQuery:e}))},[]),T=(0,H.useCallback)(e=>{e.preventDefault(),s(i.searchQuery)},[i.searchQuery]),E=(0,H.useCallback)(e=>{let t=e;a(e=>({...e,sortBy:t}))},[]),D=(0,H.useCallback)(e=>{a(t=>({...t,period:e}))},[]),O=(0,H.useCallback)(e=>{a(t=>({...t,filterFramework:e}))},[]),k=(0,H.useCallback)(e=>{a(t=>({...t,filterVisibility:e}))},[]);(0,H.useEffect)(()=>{e.autoFetch===!1&&!t.current||r.current||(n.current=1,(async()=>{await y(!1,1,{sortBy:i.sortBy,period:i.period,filterFramework:i.filterFramework,filterVisibility:i.filterVisibility,searchQuery:o})})(),t.current=!0)},[i.sortBy,i.period,i.filterFramework,i.filterVisibility,o,y,e.autoFetch]),(0,H.useEffect)(()=>Hr.on(`app-deleted`,e=>{C(e.appId)}),[C]);let A={limit:v,offset:(g.currentPage-1)*v,total:g.totalCount,hasMore:g.hasMore};return{searchQuery:i.searchQuery,filterFramework:i.filterFramework,filterVisibility:e.includeVisibility?i.filterVisibility:`all`,sortBy:i.sortBy,period:i.period,apps:c,loading:u,loadingMore:f,error:m,pagination:A,hasMore:g.hasMore,totalCount:g.totalCount,setSearchQuery:w,handleSearchSubmit:T,handleSortChange:E,handlePeriodChange:D,handleFrameworkChange:O,handleVisibilityChange:k,refetch:S,loadMore:x,removeApp:C}}function q({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`card`,className:G(`bg-bg-4 dark:bg-bg-2 text-text-primary flex flex-col rounded-md border`,e),...t})}function Ki({className:e,variant:t,...n}){return(0,W.jsx)(`div`,{"data-slot":`card-header`,className:G(`flex items-start gap-1.5 py-4 px-4`,e,t===`minimal`?`py-1`:`py-4`),...n})}var qi=H.forwardRef(({className:e,...t},n)=>(0,W.jsx)(`div`,{ref:n,className:G(`font-semibold leading-none tracking-tight`,e),...t}));qi.displayName=`CardTitle`;var Ji=H.forwardRef(({className:e,...t},n)=>(0,W.jsx)(`div`,{ref:n,className:G(`text-sm text-text-secondary`,e),...t}));Ji.displayName=`CardDescription`;var J=H.forwardRef(({className:e,...t},n)=>(0,W.jsx)(`div`,{ref:n,className:G(`p-6 pt-0`,e),...t}));J.displayName=`CardContent`;var Yi=H.forwardRef(({className:e,...t},n)=>(0,W.jsx)(`div`,{ref:n,className:G(`px-6  py-4`,e),...t}));Yi.displayName=`CardFooter`;var Xi={deployed:{icon:yt,color:`text-green-500`,bgColor:`bg-green-50 dark:bg-green-950`,text:`Deployed`},deploying:{icon:C,color:`text-green-400`,bgColor:`bg-green-50 dark:bg-green-950`,text:`Deploying`,animate:!0},failed:{icon:$e,color:`text-gray-500`,bgColor:`bg-gray-50 dark:bg-gray-950`,text:`Deploy Failed`},none:{icon:$e,color:`text-gray-500`,bgColor:`bg-gray-50 dark:bg-gray-950`,text:`Not Deployed`}},Zi={viewCount:Ut,starCount:R,forkCount:Mt};function Qi(e){return`deploymentStatus`in e||`deploymentUrl`in e}function $i(e){return Qi(e)?e.deploymentUrl?`deployed`:e.deploymentStatus||`none`:`none`}function ea(e){if(ta(e))return{viewCount:e.viewCount,starCount:e.starCount,forkCount:e.forkCount,userStarred:e.userStarred};if(na(e)||ra(e)){let t=e;return{viewCount:t.viewCount,starCount:t.starCount,forkCount:t.forkCount,userStarred:t.userStarred}}return{}}function ta(e){return`userName`in e&&`starCount`in e&&`userStarred`in e&&`updatedAtFormatted`in e}function na(e){return`isFavorite`in e&&`updatedAtFormatted`in e&&!(`userName`in e)}function ra(e){return`userFavorited`in e&&`starCount`in e&&!(`isFavorite`in e)&&!(`updatedAtFormatted`in e)}var ia=e=>{switch(e){case`private`:return(0,W.jsx)(qe,{className:`h-3 w-3`});case`team`:return(0,W.jsx)(dn,{className:`h-3 w-3`});case`board`:case`public`:return(0,W.jsx)(Zt,{className:`h-3 w-3`});default:return(0,W.jsx)(qe,{className:`h-3 w-3`})}};function aa(e){return Qi(e)?Xi[$i(e)]:null}function oa(e,t){return{layout:e?`detailed`:`compact`,showUserInfo:e,primaryMetadata:e?`social`:`deployment`,showDeploymentStatus:!e&&t}}var sa=({icon:e,value:t,highlighted:n=!1})=>(0,W.jsxs)(`div`,{className:`flex items-center gap-1 group-hover:scale-105 transition-transform duration-200`,children:[(0,W.jsx)(e,{className:G(`h-4 w-4 transition-all duration-200 text-gray-400`,n&&`fill-yellow-500 text-yellow-500 drop-shadow-sm`,!n&&`group-hover:text-bg-2`)}),(0,W.jsx)(`span`,{className:`font-medium text-xs text-text-tertiary group-hover:text-bg-2`,children:t||0})]}),ca=({stats:e})=>(0,W.jsxs)(`div`,{className:`flex items-center gap-2 text-sm text-text-tertiary/80`,children:[(0,W.jsx)(sa,{icon:Zi.starCount,value:e.starCount||0,highlighted:e.userStarred}),(0,W.jsx)(sa,{icon:Zi.viewCount,value:e.viewCount||0})]}),la=({app:e,layoutConfig:t,hasOverlayStatus:n})=>{if(t.primaryMetadata===`social`&&ta(e))return(0,W.jsxs)(`div`,{className:`flex items-center gap-3 text-sm`,children:[e.userName===`Anonymous User`?(0,W.jsx)(`div`,{className:`flex items-center gap-2 text-text-tertiary`,children:(0,W.jsx)(`div`,{className:`h-8 w-8 rounded-full bg-gradient-to-br from-gray-300 to-gray-400 flex items-center justify-center shadow-sm`,children:(0,W.jsx)(bn,{className:`h-4 w-4 text-white`})})}):(0,W.jsx)(`div`,{className:`flex items-center gap-2`,children:(0,W.jsxs)(bi,{className:`h-8 w-8`,children:[(0,W.jsx)(xi,{src:e.userAvatar||void 0}),(0,W.jsx)(Si,{className:`text-[10px] bg-gradient-to-br from-red-200 to-red-300 font-semibold`,children:e.userName?.charAt(0).toUpperCase()||`?`})]})}),(0,W.jsxs)(`div`,{className:`flex flex-col line-clamp-1 gap-1 w-full text-text-primary group-hover:text-bg-2 `,children:[(0,W.jsx)(`span`,{className:`truncate text-ellipsis max-w-60 font-medium`,children:e.title}),(0,W.jsx)(ca,{stats:ea(e)})]})]});if(t.primaryMetadata===`deployment`&&(na(e)||ra(e))){let t=aa(e);return(0,W.jsxs)(`div`,{className:`flex flex-col`,children:[(0,W.jsx)(`span`,{className:`truncate text-ellipsis max-w-60 font-medium group-hover:text-bg-2`,children:e.title}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2.5 text-sm`,children:[t&&!n&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-1.5`,children:[(0,W.jsx)(`div`,{className:G(`w-2 h-2 rounded-full transition-all duration-200`,t.color===`text-green-500`&&`bg-green-500 shadow-sm shadow-green-500/20`,t.color===`text-green-400`&&`bg-green-400 animate-pulse shadow-sm shadow-green-400/20`,t.color===`text-gray-500`&&`bg-gray-400 shadow-sm shadow-gray-400/20`,t.color===`text-gray-500 `&&`bg-gray-400`)}),(0,W.jsx)(`span`,{className:G(`text-xs font-medium transition-colors`,t.color===`text-green-500`&&`text-green-600`,t.color===`text-green-400`&&`text-green-600`,t.color===`text-gray-500`&&`text-gray-600 group-hover:text-bg-2`,t.color===`text-gray-500`&&`text-text-tertiary`),children:t.text})]}),(0,W.jsx)(`span`,{className:`text-text-tertiary/60`,children:``})]}),(0,W.jsxs)(`span`,{className:`text-xs text-text-tertiary/80 group-hover:text-bg-1 font-medium`,children:[`Updated`,` `,na(e)?e.updatedAtFormatted:ra(e)&&e.updatedAt?p(new Date(e.updatedAt),{addSuffix:!0}):`Recently`]})]})]})}return(0,W.jsx)(`div`,{className:`flex items-center gap-2 text-sm`,children:(0,W.jsx)(`span`,{className:`text-xs text-text-tertiary/80 font-medium`,children:na(e)?`Updated ${e.updatedAtFormatted}`:`Recently updated`})})};const ua=H.memo(({app:e,onClick:t,showUser:n=!1,showActions:i=!1,className:a})=>{let o=oa(n,i),s=aa(e);return(0,W.jsx)(r.div,{variants:{hidden:{y:10,opacity:0},visible:{y:0,opacity:1,transition:{type:`spring`,stiffness:200,damping:20}},exit:{y:-10,opacity:0,scale:.98,transition:{duration:.2}}},initial:`hidden`,animate:`visible`,exit:`exit`,layout:!0,className:a,children:(0,W.jsx)(`a`,{href:`/app/${e.id}`,onClick:n=>{n.preventDefault(),t(e.id)},className:`block h-full no-underline`,children:(0,W.jsxs)(q,{className:G(`h-full transition-all duration-300 ease-out cursor-pointer group relative overflow-hidden rounded-md p-2 bg-bg-1 hover:!bg-text hover:dark:!bg-text-primary`,`border border-border-primary hover:border-border-primary/60`),children:[(0,W.jsxs)(`div`,{className:`relative aspect-[16/9] rounded-lg overflow-hidden bg-gradient-to-br from-red-50 to-red-100 dark:from-red-950/20 dark:to-orange-900/20`,children:[e.screenshotUrl?(0,W.jsx)(`img`,{src:e.screenshotUrl,alt:`${e.title} preview`,className:G(`w-full h-full transition-all duration-300 ease-out`,`object-cover object-center`,`bg-gradient-to-br from-red-50/60 to-red-100/60 dark:from-red-950/15 dark:to-red-900/15`),loading:`lazy`,fetchPriority:`low`,sizes:`(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw`,srcSet:`${e.screenshotUrl} 1x, ${e.screenshotUrl} 1.5x, ${e.screenshotUrl} 2x, ${e.screenshotUrl} 3x`,decoding:`async`,onError:e=>{let t=e.target;t.style.opacity=`0`,setTimeout(()=>{t.style.display=`none`;let e=t.parentElement?.querySelector(`.screenshot-placeholder`);e&&(e.classList.remove(`hidden`),e.style.opacity=`1`)},150)},onLoad:e=>{let t=e.target;t.style.opacity=`1`,(window.devicePixelRatio||1)>=2?(t.style.imageRendering=`high-quality`,t.style.filter=`contrast(1.05) saturate(1.06) brightness(1.02) unsharp-mask(0.7px 0.7px 0px)`):(t.style.imageRendering=`auto`,t.style.filter=`contrast(1.04) saturate(1.05) brightness(1.02) unsharp-mask(0.5px 0.5px 0px)`),t.style.backfaceVisibility=`hidden`,t.style.willChange=`transform`},style:{opacity:0,transition:`opacity 0.3s ease-out`,imageRendering:`auto`,backfaceVisibility:`hidden`,transform:`translate3d(0, 0, 0)`,willChange:`transform`,contain:`layout style paint`,isolation:`isolate`,filter:`contrast(1.04) saturate(1.05) brightness(1.02)`,WebkitFontSmoothing:`subpixel-antialiased`,textRendering:`optimizeLegibility`,fontFeatureSettings:`"kern" 1`}}):null,(0,W.jsx)(`div`,{className:G(`screenshot-placeholder w-full h-full flex flex-col items-center justify-center absolute inset-0 transition-all duration-300`,e.screenshotUrl?`hidden opacity-0`:`opacity-100`,`bg-gradient-to-br from-red-50 via-red-100/80 to-red-200/60 dark:from-red-950/30 dark:via-red-900/20 dark:to-red-800/10`),children:(0,W.jsxs)(`div`,{className:`flex flex-col items-center gap-3 text-red-400/70 dark:text-red-500/50`,children:[(0,W.jsxs)(`div`,{className:`relative`,children:[(0,W.jsx)(St,{className:`h-12 w-12 drop-shadow-sm`}),(0,W.jsx)(`div`,{className:`absolute inset-0 bg-gradient-to-t from-red-200/30 to-transparent rounded blur-sm`})]}),(0,W.jsx)(`div`,{className:`text-xs font-medium text-center px-4 opacity-60`,children:`Preview Unavailable`})]})}),s?.color===`text-green-400`&&$i(e)===`deploying`&&(0,W.jsx)(`div`,{className:`absolute top-2 left-2 h-4 w-4 rounded-full bg-green-300/70 backdrop-blur-sm flex items-center justify-center shadow-sm border border-green-200/20`,title:`App is deploying`,"aria-label":`App deployment in progress`,children:(0,W.jsx)(C,{className:`w-2 h-2 text-white/90 animate-spin`})}),s?.color===`text-gray-500`&&$i(e)===`failed`&&(0,W.jsx)(`div`,{className:`absolute top-2 left-2 h-4 w-4 rounded-full bg-gray-400/70 backdrop-blur-sm flex items-center justify-center shadow-sm border border-gray-300/20`,title:`Deployment failed`,"aria-label":`App deployment failed`,children:(0,W.jsx)($e,{className:`w-2 h-2 text-white/90`})}),i&&(0,W.jsx)(`div`,{className:`absolute top-2 right-2`,children:(0,W.jsx)(_i,{appId:e.id,appTitle:e.title,showOnHover:!0,className:`h-6 w-6 text-text-tertiary hover:text-text-primary bg-bg-3/90 backdrop-blur-sm hover:bg-bg-3`,size:`sm`})}),(na(e)||ra(e))&&!s&&(0,W.jsx)(`div`,{className:`absolute bottom-2 left-2 bg-bg-3/90 dark:bg-bg-4/90 backdrop-blur-sm rounded-md p-1`,children:ia(e.visibility)}),(na(e)||ra(e))&&s&&(0,W.jsx)(`div`,{className:`absolute bottom-2 left-2 bg-bg-3/90 dark:bg-bg-4/90 backdrop-blur-sm rounded-md p-1`,children:ia(e.visibility)})]}),(0,W.jsx)(`div`,{className:`flex items-start justify-between gap-2 p-2 pb-1`,children:(0,W.jsx)(`div`,{className:`flex-1 min-w-0`,children:(0,W.jsx)(`div`,{className:`transition-all duration-200 ease-out `,children:(0,W.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,W.jsx)(`div`,{className:`flex-1`,children:(0,W.jsx)(la,{app:e,layoutConfig:o,hasOverlayStatus:!!s&&s.color!==`text-gray-500`})}),e.githubRepositoryUrl&&e.githubRepositoryVisibility!==`private`&&(0,W.jsx)(`button`,{className:`group/github flex items-center gap-1.5 px-2 py-1 rounded-full bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 transition-all duration-200`,onClick:t=>{t.stopPropagation(),e.githubRepositoryUrl&&window.open(e.githubRepositoryUrl,`_blank`,`noopener,noreferrer`)},title:`View on GitHub (${e.githubRepositoryVisibility||`public`})`,"aria-label":`View repository on GitHub`,children:(0,W.jsx)(Tt,{className:`w-4 h-4 text-gray-600 dark:text-gray-400 group-hover/github:text-gray-800 dark:group-hover/github:text-gray-200 transition-colors`})})]})})})})]})})})});ua.displayName=`AppCard`;const da=[`image/png`,`image/jpeg`,`image/webp`,`image/gif`];function fa(e){return da.includes(e)}function pa(e={}){let{maxImages:t=4,maxSizeBytes:n=10485760,onError:r}=e,[i,a]=(0,H.useState)([]),[o,s]=(0,H.useState)(!1),c=(0,H.useCallback)(async e=>{if(!fa(e.type)){let t=da.map(e=>e.replace(`image/`,``).toUpperCase()),n=`Unsupported image type: ${e.type}. Only ${t.join(`, `)} are supported.`;return _.error(n),r?.(n),null}return new Promise((t,n)=>{let r=new FileReader;r.onload=r=>{try{let i=r.target?.result;if(!i){n(Error(`Failed to read file`));return}let a=i.split(`,`)[1],o=new Image;o.onload=()=>{t({id:`img-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,filename:e.name,mimeType:e.type,base64Data:a,size:e.size,dimensions:{width:o.width,height:o.height}})},o.onerror=()=>{t({id:`img-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,filename:e.name,mimeType:e.type,base64Data:a,size:e.size})},o.src=i}catch(e){n(e)}},r.onerror=()=>{n(Error(`Failed to read file: ${e.name}`))},r.readAsDataURL(e)})},[n,r]);return{images:i,addImages:(0,H.useCallback)(async e=>{s(!0);try{if(i.length+e.length>t){let e=`Maximum ${t} images allowed per message.`;_.error(e),r?.(e);return}let n=(await Promise.all(e.map(e=>c(e)))).filter(e=>e!==null);n.length>0&&a(e=>[...e,...n])}catch(e){r?.(e instanceof Error?e.message:`Failed to process images`)}finally{s(!1)}},[i.length,t,c,r]),removeImage:(0,H.useCallback)(e=>{a(t=>t.filter(t=>t.id!==e))},[]),clearImages:(0,H.useCallback)(()=>{a([])},[]),isProcessing:o}}function ma({onFilesDropped:e,accept:t,disabled:n=!1}){let[r,i]=(0,H.useState)(!1),a=(0,H.useCallback)(e=>!t||t.length===0?!0:t.includes(e.type),[t]);return{isDragging:r,dragHandlers:{onDragEnter:(0,H.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),!n&&i(!0)},[n]),onDragOver:(0,H.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),!n&&i(!0)},[n]),onDragLeave:(0,H.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),!n&&e.currentTarget===e.target&&i(!1)},[n]),onDrop:(0,H.useCallback)(t=>{if(t.preventDefault(),t.stopPropagation(),i(!1),n)return;let r=Array.from(t.dataTransfer.files).filter(a);r.length>0&&e(r)},[n,a,e])}}}function ha({onFilesSelected:e,disabled:t=!1,multiple:n=!0,className:r=``,iconClassName:i=`size-4`}){let a=(0,H.useRef)(null);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(`input`,{ref:a,type:`file`,accept:da.join(`,`),multiple:n,onChange:t=>{let n=Array.from(t.target.files||[]);n.length>0&&e(n),a.current&&(a.current.value=``)},className:`hidden`,disabled:t}),(0,W.jsx)(`button`,{type:`button`,onClick:()=>{a.current?.click()},disabled:t,className:`p-1 rounded-md bg-transparent hover:bg-bg-3 text-text-secondary hover:text-text-primary transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed ${r}`,"aria-label":`Upload image`,title:`Upload image (PNG, JPEG, WEBP, HEIC, HEIF)`,children:(0,W.jsx)(Bt,{className:i,strokeWidth:1.5})})]})}function ga({images:e,onRemove:t,className:n=``,compact:i=!1}){return e.length===0?null:(0,W.jsx)(`div`,{className:`flex flex-wrap gap-2 ${n}`,children:(0,W.jsx)(l,{mode:`popLayout`,children:e.map(e=>(0,W.jsxs)(r.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},className:`relative group ${i?`w-12 h-12`:`w-20 h-20`} rounded-lg overflow-hidden border border-border-primary bg-bg-3`,children:[(0,W.jsx)(`img`,{src:`data:${e.mimeType};base64,${e.base64Data}`,alt:e.filename,className:`w-full h-full object-cover`}),t&&(0,W.jsx)(`button`,{type:`button`,onClick:()=>t(e.id),className:`absolute top-1 right-1 p-0.5 rounded-full bg-bg-1/90 hover:bg-bg-1 text-text-primary opacity-0 group-hover:opacity-100 transition-opacity`,"aria-label":`Remove ${e.filename}`,children:(0,W.jsx)(Ct,{className:`size-3`})}),!i&&(0,W.jsx)(`div`,{className:`absolute bottom-0 left-0 right-0 bg-gradient-to-t from-bg-1/90 to-transparent p-1`,children:(0,W.jsx)(`p`,{className:`text-[10px] text-text-secondary truncate`,children:e.filename})})]},e.id))})})}function _a(){let e=O(),{requireAuth:t}=Vr(),n=(0,H.useRef)(null),[i,a]=(0,H.useState)(`deterministic`),[o,u]=(0,H.useState)(``),{user:d}=Un(),{images:f,addImages:p,removeImage:m,clearImages:h,isProcessing:g}=pa({onError:e=>{console.error(`Image upload error:`,e)}}),{isDragging:_,dragHandlers:v}=ma({onFilesDropped:p,accept:[...da]}),y=(0,H.useMemo)(()=>[`todo list app`,`F1 fantasy game`,`personal finance tracker`],[]),[b,x]=(0,H.useState)(0),[S,C]=(0,H.useState)(``),[w,T]=(0,H.useState)(!0),{apps:E,loading:D}=Gi({type:`public`,defaultSort:`popular`,defaultPeriod:`week`,limit:6}),k=(0,H.useMemo)(()=>!D&&(E?.length??0)>5,[D,E]),A=(n,r)=>{let i=`/chat/new?query=${encodeURIComponent(n)}&agentMode=${encodeURIComponent(r)}${f.length>0?`&images=${encodeURIComponent(JSON.stringify(f))}`:``}`;t({requireFullAuth:!0,actionContext:`to create applications`,intendedUrl:i})&&(e(i),h())},j=()=>{if(n.current){n.current.style.height=`auto`;let e=n.current.scrollHeight;n.current.style.height=Math.min(e,300)+`px`}};(0,H.useEffect)(()=>{j()},[]),(0,H.useEffect)(()=>{let e=y[b];if(w)if(S.length<e.length){let t=setTimeout(()=>{C(e.slice(0,S.length+1))},100);return()=>clearTimeout(t)}else{let e=setTimeout(()=>{T(!1)},2e3);return()=>clearTimeout(e)}else if(S.length>0){let e=setTimeout(()=>{C(S.slice(0,-1))},50);return()=>clearTimeout(e)}else x(e=>(e+1)%y.length),T(!0)},[S,b,w,y]);let M=(0,H.useRef)(null);return(0,W.jsxs)(`div`,{className:`relative flex flex-col items-center size-full`,children:[(0,W.jsx)(`div`,{className:`fixed inset-0 text-accent z-0 opacity-20 pointer-events-none`,children:(0,W.jsxs)(`svg`,{width:`100%`,height:`100%`,children:[(0,W.jsx)(`defs`,{children:(0,W.jsx)(`pattern`,{id:`:S2:`,viewBox:`-6 -6 12 12`,patternUnits:`userSpaceOnUse`,width:`12`,height:`12`,children:(0,W.jsx)(`circle`,{cx:`0`,cy:`0`,r:`1`,fill:`currentColor`})})}),(0,W.jsx)(`rect`,{width:`100%`,height:`100%`,fill:`url(#:S2:)`})]})}),(0,W.jsxs)(s,{children:[(0,W.jsx)(`div`,{className:`rounded-md w-full max-w-2xl overflow-hidden`,children:(0,W.jsxs)(r.div,{layout:!0,transition:{layout:{duration:.5,ease:[.22,1,.36,1]}},className:c(`px-6 p-8 flex flex-col items-center z-10`,k?`mt-48`:`mt-[20vh] sm:mt-[24vh] md:mt-[28vh]`),children:[(0,W.jsx)(`h1`,{className:`text-shadow-sm text-shadow-red-200 dark:text-shadow-red-900 text-accent font-medium leading-[1.1] tracking-tight text-5xl w-full mb-4 bg-clip-text bg-gradient-to-r from-text-primary to-text-primary/90`,children:`What should we build today?`}),(0,W.jsxs)(`form`,{method:`POST`,onSubmit:e=>{e.preventDefault();let t=n.current.value;A(t,i)},className:`flex z-10 flex-col w-full min-h-[150px] bg-bg-4 border border-accent/30 dark:border-accent/50 dark:bg-bg-2 rounded-[18px] shadow-textarea p-5 transition-all duration-200`,children:[(0,W.jsxs)(`div`,{className:c(`flex-1 flex flex-col relative`,_&&`ring-2 ring-accent ring-offset-2 rounded-lg`),...v,children:[_&&(0,W.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center bg-accent/10 backdrop-blur-sm rounded-lg z-30 pointer-events-none`,children:(0,W.jsx)(`p`,{className:`text-accent font-medium`,children:`Drop images here`})}),(0,W.jsx)(`textarea`,{className:`w-full resize-none ring-0 z-20 outline-0 placeholder:text-text-primary/60 text-text-primary`,name:`query`,value:o,placeholder:`Create a ${S}`,ref:n,onChange:e=>{u(e.target.value),j()},onInput:j,onKeyDown:e=>{if(e.key===`Enter`&&!e.shiftKey){e.preventDefault();let t=n.current.value;A(t,i)}}}),f.length>0&&(0,W.jsx)(`div`,{className:`mt-3`,children:(0,W.jsx)(ga,{images:f,onRemove:m})})]}),(0,W.jsxs)(`div`,{className:`flex items-center justify-between mt-4 pt-1`,children:[(0,W.jsx)(`div`,{}),(0,W.jsxs)(`div`,{className:`flex items-center justify-end ml-4 gap-2`,children:[(0,W.jsx)(ha,{onFilesSelected:p,disabled:g}),(0,W.jsx)(`button`,{type:`submit`,disabled:!o.trim(),className:`bg-accent text-white p-1 rounded-md *:size-5 transition-all duration-200 hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed`,children:(0,W.jsx)(At,{})})]})]})]})]})}),(0,W.jsx)(l,{children:f.length>0&&(0,W.jsx)(r.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`w-full max-w-2xl px-6`,children:(0,W.jsxs)(`div`,{className:`flex items-start gap-2 px-4 py-3 rounded-xl bg-bg-4/50 dark:bg-bg-2/50 border border-accent/20 dark:border-accent/30 shadow-sm`,children:[(0,W.jsx)(I,{className:`size-4 text-accent flex-shrink-0 mt-0.5`}),(0,W.jsxs)(`p`,{className:`text-xs text-text-tertiary leading-relaxed`,children:[(0,W.jsx)(`span`,{className:`font-medium text-text-secondary`,children:`Images Beta:`}),` Images guide app layout and design but may not be replicated exactly. The coding agent cannot access images directly for app assets.`]})]})})}),(0,W.jsx)(l,{children:k&&(0,W.jsx)(r.section,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:`auto`},exit:{opacity:0,height:0},transition:{duration:.5,ease:[.22,1,.36,1]},className:c(`max-w-6xl mx-auto px-4 z-10`,f.length>0?`mt-10`:`mt-16 mb-8`),children:(0,W.jsxs)(`div`,{className:`flex flex-col items-start`,children:[(0,W.jsx)(`h2`,{className:`text-2xl font-medium text-text-secondary/80`,children:`Discover Apps built by the community`}),(0,W.jsx)(`div`,{ref:M,className:`text-md font-light mb-4 text-text-tertiary hover:underline underline-offset-4 select-text cursor-pointer`,onClick:()=>e(`/discover`),children:`View All`}),(0,W.jsx)(r.div,{layout:!0,transition:{duration:.4},className:`grid grid-cols-2 xl:grid-cols-3 gap-6`,children:(0,W.jsx)(l,{mode:`popLayout`,children:E.map(t=>(0,W.jsx)(ua,{app:t,onClick:()=>e(`/app/${t.id}`),showStats:!0,showUser:!0,showActions:!1},t.id))})})]})},`discover-section`)})]}),d&&(0,W.jsx)(va,{sourceRef:M,target:{x:50,y:window.innerHeight-60}})]})}const va=({sourceRef:e,target:t,curvature:n=.5,sourceOffset:r=6,hideWhenInvalid:i=!0})=>{let[a,o]=(0,H.useState)(null),[s,c]=(0,H.useState)(null),l=(0,H.useRef)(null),u=(0,H.useRef)(null),d=()=>{let n=e.current;if(!n){o(null),c(null);return}let i=n.getBoundingClientRect();if(!i||i.width===0||i.height===0){o(null),c(null);return}let a={x:t.x,y:t.y},s={right:{x:i.right,y:i.top+i.height/2},left:{x:i.left,y:i.top+i.height/2}},l=Object.fromEntries(Object.entries(s).map(([e,t])=>[e,(t.x-a.x)**2+(t.y-a.y)**2])),u=Object.entries(l).sort((e,t)=>e[1]-t[1])[0][0]||`right`;o(((e,t,n)=>{switch(t){case`right`:return{x:e.x+n,y:e.y};case`left`:return{x:e.x-n,y:e.y}}})(s[u],u,r)),c(a)},f=()=>{l.current!=null&&cancelAnimationFrame(l.current),l.current=requestAnimationFrame(d)};(0,H.useEffect)(()=>{f()},[t.x,t.y,e.current]),(0,H.useEffect)(()=>{let t=()=>f(),n=()=>f();window.addEventListener(`scroll`,t,{passive:!0}),window.addEventListener(`resize`,n);let r=e.current;return`ResizeObserver`in window&&(u.current=new ResizeObserver(()=>f()),r&&u.current.observe(r)),f(),()=>{window.removeEventListener(`scroll`,t),window.removeEventListener(`resize`,n),l.current!=null&&cancelAnimationFrame(l.current),u.current&&r&&u.current.unobserve(r)}},[]);let p=(0,H.useMemo)(()=>{if(!a||!s)return``;let e=s.x-a.x,t=s.y-a.y,r=Math.max(Math.abs(e),Math.abs(t))*n,i={x:a.x+r*(e>=0?1:-1),y:a.y},o={x:s.x-r*(e>=0?1:-1),y:s.y};return`M ${a.x},${a.y} C ${i.x},${i.y} ${o.x},${o.y} ${s.x},${s.y}`},[a,s,n]),m=i&&(!a||!s);return a&&s&&(s.y-a.y>420||a.x-s.x<100)?null:(0,W.jsxs)(`svg`,{"aria-hidden":`true`,style:{position:`fixed`,inset:0,width:`100vw`,height:`100vh`,pointerEvents:`none`,overflow:`visible`,zIndex:9999,display:m?`none`:`block`},children:[(0,W.jsxs)(`defs`,{children:[(0,W.jsxs)(`filter`,{id:`discover-squiggle`,x:`-20%`,y:`-20%`,width:`140%`,height:`140%`,children:[(0,W.jsx)(`feTurbulence`,{type:`fractalNoise`,baseFrequency:`0.8`,numOctaves:`1`,seed:`3`,result:`noise`}),(0,W.jsx)(`feDisplacementMap`,{in:`SourceGraphic`,in2:`noise`,scale:`1`,xChannelSelector:`R`,yChannelSelector:`G`})]}),(0,W.jsxs)(`marker`,{id:`discover-arrowhead`,markerWidth:`8`,markerHeight:`8`,refX:`7`,refY:`4`,orient:`auto`,markerUnits:`strokeWidth`,opacity:.2,children:[(0,W.jsx)(`path`,{d:`M 0 1.2 L 7 4`,stroke:`var(--color-text-tertiary)`,strokeWidth:`1.6`,strokeLinecap:`round`,fill:`none`}),(0,W.jsx)(`path`,{d:`M 0 6.8 L 7 4`,stroke:`var(--color-text-tertiary)`,strokeWidth:`1.2`,strokeLinecap:`round`,fill:`none`})]})]}),(0,W.jsx)(`path`,{d:p,stroke:`var(--color-text-tertiary)`,strokeOpacity:.2,strokeWidth:1.6,fill:`none`,strokeLinecap:`round`,strokeLinejoin:`round`,vectorEffect:`non-scaling-stroke`,markerEnd:`url(#discover-arrowhead)`}),(0,W.jsx)(`g`,{filter:`url(#discover-squiggle)`,children:(0,W.jsx)(`path`,{d:p,stroke:`var(--color-text-tertiary)`,strokeOpacity:.12,strokeWidth:1,fill:`none`,strokeLinecap:`round`,strokeLinejoin:`round`,strokeDasharray:`8 6 4 9 5 7`,vectorEffect:`non-scaling-stroke`})})]})};var ya=`import type { RouteObject } from 'react-router';\r
import React from 'react';\r
\r
import App from './App';\r
import Home from './routes/home';\r
import Chat from './routes/chat/chat';\r
import Profile from './routes/profile';\r
import Settings from './routes/settings/index';\r
import AppsPage from './routes/apps';\r
import AppView from './routes/app';\r
import DiscoverPage from './routes/discover';\r
import { ProtectedRoute } from './routes/protected-route';\r
\r
const routes = [\r
	{\r
		path: '/',\r
		Component: App,\r
		children: [\r
			{\r
				index: true,\r
				Component: Home,\r
			},\r
			{\r
				path: 'chat/:chatId',\r
				Component: Chat,\r
			},\r
			{\r
				path: 'profile',\r
				element: React.createElement(ProtectedRoute, { children: React.createElement(Profile) }),\r
			},\r
			{\r
				path: 'settings',\r
				element: React.createElement(ProtectedRoute, { children: React.createElement(Settings) }),\r
			},\r
			{\r
				path: 'apps',\r
				element: React.createElement(ProtectedRoute, { children: React.createElement(AppsPage) }),\r
			},\r
			{\r
				path: 'app/:id',\r
				Component: AppView,\r
			},\r
			{\r
				path: 'discover',\r
				Component: DiscoverPage,\r
			},\r
		],\r
	},\r
] satisfies RouteObject[];\r
\r
export { routes };\r
`;self.MonacoEnvironment={getWorker(e,t){return t===`json`?new jn:t===`css`||t===`scss`||t===`less`?new On:t===`html`||t===`handlebars`||t===`razor`?new Dn:t===`typescript`||t===`javascript`||t===`typescriptreact`||t===`javascriptreact`?new En:new wn}},Tn.defineTheme(`v1-dev-dark`,{base:`vs-dark`,inherit:!0,rules:[{token:``,foreground:`c9d1d9`,background:`0d1117`},{token:`comment`,foreground:`8b949e`,fontStyle:`italic`},{token:`keyword`,foreground:`ff7b72`},{token:`number`,foreground:`79c0ff`},{token:`string`,foreground:`a5d6ff`},{token:`type`,foreground:`ffa657`},{token:`class`,foreground:`d2a8ff`},{token:`interface`,foreground:`ffdf5d`},{token:`function`,foreground:`d2a8ff`},{token:`member`,foreground:`79c0ff`},{token:`variable`,foreground:`c9d1d9`},{token:`constant`,foreground:`ffab70`},{token:`operator`,foreground:`ff7b72`},{token:`namespace`,foreground:`ffab70`},{token:`predefined`,foreground:`ffa657`},{token:`invalid`,foreground:`ffffff`,background:`f85149`}],colors:{"editor.background":`#171512`,"editor.foreground":`#c9d1d9`,"editorLineNumber.foreground":`#444c56`,"editorLineNumber.activeForeground":`#8b949e`,"editorCursor.foreground":`#58a6ff`,"editorIndentGuide.background":`#21262d`,"editorIndentGuide.activeBackground":`#30363d`,"editor.selectionBackground":`#264f78`,"editor.inactiveSelectionBackground":`#1f6feb44`,"editor.lineHighlightBackground":`#161b22`,"editor.wordHighlightBackground":`#3fb95040`,"editor.wordHighlightStrongBackground":`#ff7b7240`,"editor.findMatchBackground":`#ffd33d44`,"editor.findMatchHighlightBackground":`#ffd33d22`}}),Tn.defineTheme(`v1-dev`,{base:`vs`,inherit:!0,rules:[{token:``,foreground:`000000`,background:`fbfbfc`},{token:`comment`,foreground:`6e7781`,fontStyle:`italic`},{token:`keyword`,foreground:`0092b8`},{token:`number`,foreground:`0550ae`},{token:`string`,foreground:`0a3069`},{token:`type`,foreground:`0092b8`},{token:`class`,foreground:`0092b8`},{token:`interface`,foreground:`0092b8`},{token:`function`,foreground:`953800`},{token:`member`,foreground:`0550ae`},{token:`variable`,foreground:`24292f`},{token:`constant`,foreground:`0550ae`},{token:`operator`,foreground:`0092b8`},{token:`namespace`,foreground:`0092b8`},{token:`predefined`,foreground:`0092b8`},{token:`invalid`,foreground:`ff0000`}],colors:{"editor.background":`#fbfbfc`,"editor.foreground":`#24292f`,"editorLineNumber.foreground":`#8c959f`,"editorLineNumber.activeForeground":`#24292f`,"editorCursor.foreground":`#0092b8`,"editorIndentGuide.background":`#d0d7de`,"editorIndentGuide.activeBackground":`#8c959f`,"editor.selectionBackground":`#0092b820`,"editor.inactiveSelectionBackground":`#0092b810`,"editor.lineHighlightBackground":`#0092b808`,"editor.wordHighlightBackground":`#0092b815`,"editor.wordHighlightStrongBackground":`#0092b820`,"editor.findMatchBackground":`#0092b830`,"editor.findMatchHighlightBackground":`#0092b815`}}),Tn.setTheme(`v1-dev`),kn.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!0}),kn.typescript.typescriptDefaults.setCompilerOptions({jsx:kn.typescript.JsxEmit.React,allowJs:!0,allowSyntheticDefaultImports:!0,esModuleInterop:!0,moduleResolution:kn.typescript.ModuleResolutionKind.NodeJs,module:kn.typescript.ModuleKind.ESNext,target:kn.typescript.ScriptTarget.ESNext,jsxFactory:`React.createElement`,jsxFragmentFactory:`React.Fragment`}),kn.typescript.javascriptDefaults.setCompilerOptions({allowJs:!0,allowSyntheticDefaultImports:!0,esModuleInterop:!0,jsx:kn.typescript.JsxEmit.React,moduleResolution:kn.typescript.ModuleResolutionKind.NodeJs,module:kn.typescript.ModuleKind.ESNext,target:kn.typescript.ScriptTarget.ESNext,jsxFactory:`React.createElement`,jsxFragmentFactory:`React.Fragment`});const ba=(0,H.memo)(function({createOptions:e={},find:t,replace:n,...r}){let i=(0,H.useRef)(null),a=(0,H.useRef)(void 0),o=(0,H.useRef)(e.value||``),s=(0,H.useRef)(!0),{theme:c}=Xn();return(0,H.useEffect)(()=>{let t=c;c===`system`&&(t=window.matchMedia(`(prefers-color-scheme: dark)`).matches?`dark`:`light`),a.current=Tn.create(i.current,{language:e.language||`typescript`,minimap:{enabled:!1},theme:t===`dark`?`v1-dev-dark`:`v1-dev`,automaticLayout:!0,value:ya,fontSize:13,...e});let n=a.current.getDomNode();return n&&(n.addEventListener(`wheel`,()=>{s.current&&=!1}),n.addEventListener(`keydown`,e=>{(e.key.includes(`Arrow`)||e.key.includes(`Page`))&&(s.current&&=!1)})),()=>{a.current?.dispose()}},[]),(0,H.useEffect)(()=>{if(a.current&&e.value!==o.current){let t=a.current.getModel();if(!t)return;if(a.current.setValue(e.value||``),s.current){let e=t.getLineCount();a.current.revealLine(e)}e.language&&Tn.setModelLanguage(t,e.language),o.current=e.value||``}},[e.value,e.language]),(0,H.useEffect)(()=>{if(!a.current||!t)return;let e=a.current.getModel();if(!e)return;let r=[],i=e.getValue(),o,s=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,`\\$&`),`g`);for(;(o=s.exec(i))!==null;){let t=e.getPositionAt(o.index),i=e.getPositionAt(o.index+o[0].length);r.push({range:new An(t.lineNumber,t.column,i.lineNumber,i.column),options:{inlineClassName:`diffDelete`,hoverMessage:{value:n?`Will be replaced with: ${n}`:`Will be deleted`}}}),n&&r.push({range:new An(t.lineNumber,t.column,i.lineNumber,i.column),options:{after:{content:n,inlineClassName:`diffInsert`}}})}let c=a.current.getModel()?.getAllDecorations()||[];a.current.deltaDecorations(c.map(e=>e.id),r)},[t,n]),(0,H.useEffect)(()=>{a.current&&Tn.setTheme(c===`dark`?`v1-dev-dark`:`v1-dev`)},[c]),(0,W.jsx)(`div`,{...r,ref:i})});function xa(e){return e.replace(/<system_context>[\s\S]*?<\/system_context>\n/gi,``).trim()}function Sa({message:e}){let t=xa(e);return(0,W.jsxs)(`div`,{className:`flex gap-3`,children:[(0,W.jsx)(`div`,{className:`align-text-top pl-1`,children:(0,W.jsx)(`div`,{className:`size-6 flex items-center justify-center rounded-full bg-accent text-text-on-brand`,children:(0,W.jsx)(`span`,{className:`text-xs`,children:`U`})})}),(0,W.jsxs)(`div`,{className:`flex flex-col gap-2 min-w-0`,children:[(0,W.jsx)(`div`,{className:`font-medium text-text-50`,children:`You`}),(0,W.jsx)(wa,{className:`text-text-primary/80`,children:t})]})]})}function Ca({message:e,isThinking:t,toolEvents:n}){let r=xa(e);return(0,W.jsxs)(`div`,{className:`flex gap-3`,children:[(0,W.jsx)(`div`,{className:`align-text-top pl-1`,children:(0,W.jsx)(Ei,{className:`size-6 text-orange-500`})}),(0,W.jsxs)(`div`,{className:`flex flex-col gap-2 min-w-0`,children:[(0,W.jsx)(`div`,{className:`font-mono font-medium text-text-50`,children:`Orange`}),n&&n.length>0&&(0,W.jsx)(`div`,{className:`mb-1.5 flex flex-col gap-1`,children:n.map(e=>(0,W.jsxs)(`div`,{className:`flex items-center gap-1.5 text-xs text-text-tertiary`,children:[e.status===`start`&&(0,W.jsx)(C,{className:`size-3 animate-spin`}),e.status===`success`&&(0,W.jsx)(Ie,{className:`size-3`}),e.status===`error`&&(0,W.jsx)(Pe,{className:`size-3`}),(0,W.jsxs)(`span`,{className:`font-mono tracking-tight`,children:[e.status===`start`&&`Running`,e.status===`success`&&`Completed`,e.status===`error`&&`Error`,` `,e.name]})]},`${e.name}-${e.timestamp}`))}),(0,W.jsx)(wa,{className:c(`a-tag`,t?`animate-pulse`:``),children:r})]})]})}function wa({children:e,className:t,...n}){return(0,W.jsx)(`article`,{className:c(`prose prose-sm prose-teal`,t),...n,children:(0,W.jsx)(fn,{remarkPlugins:[m],rehypePlugins:[[v,{target:`_blank`}]],children:e})})}function Ta({blueprint:e,className:t,...n}){return e?(0,W.jsxs)(`div`,{className:c(`w-full flex flex-col`,t),...n,children:[(0,W.jsx)(`div`,{className:`bg-accent p-6 rounded-t-xl flex items-center bg-graph-paper`,children:(0,W.jsxs)(`div`,{className:`flex flex-col gap-1`,children:[(0,W.jsx)(`div`,{className:`uppercase text-xs tracking-wider text-text-on-brand/90`,children:`Blueprint`}),(0,W.jsx)(`div`,{className:`text-2xl font-medium text-text-on-brand`,children:e.title})]})}),(0,W.jsxs)(`div`,{className:`flex flex-col px-6 py-4 bg-bg-2 rounded-b-xl space-y-8`,children:[(0,W.jsxs)(`div`,{className:`grid grid-cols-[120px_1fr] gap-4 text-sm`,children:[(0,W.jsx)(`div`,{className:`text-text-50/70 font-mono`,children:`Description`}),(0,W.jsx)(wa,{className:`text-text-50`,children:e.description}),Array.isArray(e.colorPalette)&&e.colorPalette.length>0&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(`div`,{className:`text-text-50/70 font-mono`,children:`Color Palette`}),(0,W.jsx)(`div`,{className:`flex items-center gap-2`,children:Array.isArray(e.colorPalette)&&e.colorPalette?.map((e,t)=>(0,W.jsx)(`div`,{className:`size-6 rounded-md border border-text/10 flex items-center justify-center`,style:{backgroundColor:e},title:e,children:(0,W.jsx)(`span`,{className:`sr-only`,children:e})},`color-${t}`))}),` `]}),(0,W.jsx)(`div`,{className:`text-text-50/70 font-mono`,children:`Dependencies`}),(0,W.jsx)(`div`,{className:`flex flex-wrap gap-2 items-center`,children:Array.isArray(e.frameworks)&&e.frameworks.map((e,t)=>{let n,r;if(e.startsWith(`@`)){let t=e.lastIndexOf(`@`);t===0?n=e:(n=e.slice(0,t),r=e.slice(t+1))}else [n,r]=e.split(`@`);return(0,W.jsxs)(`span`,{className:`flex items-center text-xs border border-text/20 rounded-full px-2 py-0.5 text-text-primary/90 hover:border-white/40 transition-colors`,children:[(0,W.jsx)(`span`,{className:`font-medium`,children:n}),r&&(0,W.jsxs)(`span`,{className:`text-text-primary/50`,children:[`@`,r]})]},`framework-${e}-${t}`)})})]}),Array.isArray(e.views)&&e.views.length>0&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h3`,{className:`text-sm font-medium mb-3 text-text-50/70 uppercase tracking-wider`,children:`Views`}),(0,W.jsx)(`div`,{className:`space-y-3`,children:e.views.map((e,t)=>(0,W.jsxs)(`div`,{className:`space-y-1`,children:[(0,W.jsx)(`h4`,{className:`text-xs font-medium text-text-50/70`,children:e.name}),(0,W.jsx)(wa,{className:`text-sm text-text-50`,children:e.description})]},`view-${t}`))})]}),e.userFlow&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h3`,{className:`text-sm font-medium mb-3 text-text-50/70 uppercase tracking-wider`,children:`User Flow`}),(0,W.jsxs)(`div`,{className:`space-y-4`,children:[e.userFlow?.uiLayout&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h4`,{className:`text-xs font-medium mb-2 text-text-50/70`,children:`UI Layout`}),(0,W.jsx)(wa,{className:`text-sm text-text-50`,children:e.userFlow.uiLayout})]}),e.userFlow?.uiDesign&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h4`,{className:`text-xs font-medium mb-2 text-text-50/70`,children:`UI Design`}),(0,W.jsx)(wa,{className:`text-sm text-text-50`,children:e.userFlow.uiDesign})]}),e.userFlow?.userJourney&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h4`,{className:`text-xs font-medium mb-2 text-text-50/70`,children:`User Journey`}),(0,W.jsx)(wa,{className:`text-sm text-text-50`,children:e.userFlow?.userJourney})]})]})]}),(e.dataFlow||e.architecture?.dataFlow)&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h3`,{className:`text-sm font-medium mb-2 text-text-50/70 uppercase tracking-wider`,children:`Data Flow`}),(0,W.jsx)(wa,{className:`text-sm text-text-50`,children:e.dataFlow||e.architecture?.dataFlow})]}),Array.isArray(e.implementationRoadmap)&&e.implementationRoadmap.length>0&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h3`,{className:`text-sm font-medium mb-2 text-text-50/70 uppercase tracking-wider`,children:`Implementation Roadmap`}),(0,W.jsx)(`div`,{className:`space-y-3`,children:e.implementationRoadmap.map((e,t)=>(0,W.jsxs)(`div`,{className:`space-y-1`,children:[(0,W.jsxs)(`h4`,{className:`text-xs font-medium text-text-50/70`,children:[`Phase `,t+1,`: `,e.phase]}),(0,W.jsx)(wa,{className:`text-sm text-text-50`,children:e.description})]},`roadmap-${t}`))})]}),e.initialPhase&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h3`,{className:`text-sm font-medium mb-2 text-text-50/70 uppercase tracking-wider`,children:`Initial Phase`}),(0,W.jsx)(`div`,{className:`space-y-3`,children:(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h4`,{className:`text-xs font-medium mb-2 text-text-50/70`,children:e.initialPhase.name}),(0,W.jsx)(wa,{className:`text-sm text-text-50 mb-3`,children:e.initialPhase.description}),Array.isArray(e.initialPhase.files)&&e.initialPhase.files.length>0&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h5`,{className:`text-xs font-medium mb-2 text-text-50/60`,children:`Files to be created:`}),(0,W.jsx)(`div`,{className:`space-y-2`,children:e.initialPhase.files.map((e,t)=>(0,W.jsxs)(`div`,{className:`border-l-2 border-text/10 pl-3`,children:[(0,W.jsx)(`div`,{className:`font-mono text-xs text-text-50/80`,children:e.path}),(0,W.jsx)(`div`,{className:`text-xs text-text-50/60`,children:e.purpose})]},`initial-phase-file-${t}`))})]})]})})]}),Array.isArray(e.pitfalls)&&e.pitfalls.length>0&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h3`,{className:`text-sm font-medium mb-2 text-text-50/70 uppercase tracking-wider`,children:`Pitfalls`}),(0,W.jsx)(`div`,{className:`prose prose-sm prose-invert`,children:(0,W.jsx)(`ul`,{className:``,children:e.pitfalls?.map((e,t)=>(0,W.jsx)(`li`,{className:``,children:e},`pitfall-${t}`))})})]})]})]}):null}function Ea({item:e,level:t=0,currentFile:n,onFileClick:r}){let[i,a]=(0,H.useState)(!0),o=n?.filePath===e.filePath;return e.type===`file`&&e.file?(0,W.jsxs)(`button`,{onClick:()=>r(e.file),className:`flex items-center w-full gap-2 py-1 px-3 transition-colors text-sm ${o?`text-brand bg-zinc-100`:`text-text-primary/80 hover:bg-accent hover:text-text-primary`}`,style:{paddingLeft:`${t*12+12}px`},children:[(0,W.jsx)(nt,{className:`size-3`}),(0,W.jsx)(`span`,{className:`flex-1 text-left truncate`,children:e.name})]}):(0,W.jsxs)(`div`,{children:[(0,W.jsxs)(`button`,{onClick:()=>a(!i),className:`flex items-center gap-2 py-1 px-3 transition-colors text-sm text-text-primary/80 hover:bg-accent hover:text-text-primary w-full`,style:{paddingLeft:`${t*12+12}px`},children:[(0,W.jsx)(Ne,{className:c(`size-3 transition-transform duration-200 ease-in-out`,i&&`rotate-90`)}),(0,W.jsx)(`span`,{className:`flex-1 text-left truncate`,children:e.name})]}),i&&e.children&&(0,W.jsx)(`div`,{children:Object.values(e.children).map(e=>(0,W.jsx)(Ea,{item:e,level:t+1,currentFile:n,onFileClick:r},e.filePath))})]})}function Da(e){let t={};return e.forEach(e=>{let n=e.filePath.split(`/`),r=t;for(let e=0;e<n.length-1;e++){let t=n[e];r[t]||(r[t]={name:t,type:`folder`,filePath:n.slice(0,e+1).join(`/`),children:{}}),r[t].children||(r[t].children={}),r=r[t].children}let i=n[n.length-1];r[i]={name:i,type:`file`,filePath:e.filePath,file:e}}),Object.values(t)}function Oa({files:e,bootstrapFiles:t,currentFile:n,onFileClick:r}){let i=Da([...t,...e]);return(0,W.jsxs)(`div`,{className:`w-full max-w-[200px] bg-bg-3 border-r border-text/10 h-full overflow-y-auto`,children:[(0,W.jsxs)(`div`,{className:`p-2 px-3 text-sm flex items-center gap-1 text-text-primary/50 font-medium`,children:[(0,W.jsx)(se,{className:`size-4`}),`Files`]}),(0,W.jsx)(`div`,{className:`flex flex-col`,children:i.map(e=>(0,W.jsx)(Ea,{item:e,currentFile:n,onFileClick:r},e.filePath))})]})}var ka=[`Thinking`,`Ideating`,`Planning`,`Designing`,`Crafting`,`Architecting`,`Conceptualizing`,`Envisioning`,`Strategizing`,`Formulating`,`Contemplating`,`Analyzing`,`Brainstorming`,`Sketching`,`Exploring`,`Imagining`,`Structuring`,`Orchestrating`,`Composing`,`Refining`];function Aa({visible:e}){let[t,n]=(0,H.useState)(0);return(0,H.useEffect)(()=>{if(!e){n(0);return}let t=setInterval(()=>{n(e=>(e+1)%ka.length)},2e3);return()=>clearInterval(t)},[e]),e?(0,W.jsx)(l,{children:e&&(0,W.jsxs)(r.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.4,ease:[.23,1,.32,1]},className:`flex items-center gap-2 mt-3`,children:[(0,W.jsx)(r.div,{animate:{rotate:[0,360],scale:[1,1.1,1]},transition:{rotate:{duration:3,repeat:1/0,ease:`linear`},scale:{duration:2,repeat:1/0,ease:`easeInOut`}},children:(0,W.jsx)(F,{className:`size-3 text-orange-400`})}),(0,W.jsx)(l,{mode:`wait`,children:(0,W.jsxs)(r.span,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.3,ease:[.23,1,.32,1]},className:`text-sm text-text-50/60 font-medium flex items-center gap-1`,children:[ka[t],`...`,(0,W.jsx)(r.span,{animate:{opacity:[1,.3,1]},transition:{duration:1.5,repeat:1/0},className:`inline-block`,children:`...`})]},t)})]})}):null}var ja={initial:{scale:.2,opacity:.4},animate:{scale:1,opacity:1},exit:{scale:.2,opacity:.4}},Ma={smooth:{duration:.3,ease:`easeOut`},premium:{duration:.4,ease:[.23,1,.32,1]},fast:{duration:.2,ease:`easeOut`},premiumShort:{duration:.3,ease:[.23,1,.32,1]},smoothInOut:{duration:.3,ease:`easeInOut`}},Na=(e,t)=>e.find(e=>e.status===t),Pa=e=>[...e].reverse().find(e=>e.status===`completed`),Fa=e=>e.filter(e=>e.status===`completed`).length,Ia=({size:e=`md`,color:t=`accent`})=>(0,W.jsx)(Oe,{className:`${e===`sm`?`size-3`:`w-4 h-4`} animate-spin ${{accent:`text-accent`,blue:`text-blue-400`,orange:`text-orange-400`,tertiary:`text-text-tertiary`,green:`text-green-500`}[t]}`}),La=({size:e=`md`,color:t=`green`})=>(0,W.jsx)(Ie,{className:`${e===`sm`?`size-3`:`w-4 h-4`} ${{accent:`text-accent`,blue:`text-blue-400`,orange:`text-orange-400`,tertiary:`text-text-tertiary`,green:`text-green-500`}[t]}`});function Ra({status:e,size:t=`md`,className:n}){let r={sm:`w-3 h-3`,md:`w-4 h-4`}[t];switch(e){case`generating`:return(0,W.jsx)(Oe,{className:c(r,`animate-spin text-accent`,n)});case`validating`:return(0,W.jsx)(Oe,{className:c(r,`animate-spin text-blue-400`,n)});case`completed`:return(0,W.jsx)(Ie,{className:c(r,`text-green-500`,n)});case`error`:return(0,W.jsx)(at,{className:c(r,`text-red-500`,n)});case`active`:return(0,W.jsx)(Oe,{className:c(r,`animate-spin text-accent`,n)});case`pending`:default:return(0,W.jsx)(`div`,{className:c(r,`bg-bg-3-foreground/40 dark:bg-bg-3-foreground/30 rounded-full`,n)})}}function za({status:e,size:t=5}){let n=`size-${t}`;return(0,W.jsx)(`div`,{className:`translate-y-px z-20`,children:(0,W.jsxs)(l,{mode:`wait`,children:[e===`pending`&&(0,W.jsx)(r.div,{variants:ja,initial:`initial`,animate:`animate`,exit:`exit`,transition:Ma.smoothInOut,className:c(n,`flex items-center justify-center`),children:(0,W.jsx)(`div`,{className:`size-2 rounded-full bg-zinc-300`})},`pending`),e===`active`&&(0,W.jsx)(r.div,{variants:ja,initial:`initial`,animate:`animate`,exit:`exit`,transition:Ma.smoothInOut,className:c(n,`bg-bg-4 dark:bg-bg-2 flex items-center justify-center`),children:(0,W.jsx)(Oe,{className:`size-3 text-accent animate-spin`})},`active`),e===`completed`&&(0,W.jsx)(r.div,{variants:ja,initial:`initial`,animate:`animate`,exit:`exit`,transition:Ma.smoothInOut,className:c(n,`flex items-center justify-center`),children:(0,W.jsx)(`div`,{className:`size-2 rounded-full bg-accent`})},`completed`),e===`error`&&(0,W.jsx)(r.div,{variants:ja,initial:`initial`,animate:`animate`,exit:`exit`,transition:Ma.smoothInOut,className:c(n,`flex items-center justify-center`),children:(0,W.jsx)(at,{className:`size-3 text-red-500`})},`error`)]})})}function Ba(e,t=30){if(e.length<=t)return e;let n=e.split(`/`),r=n[n.length-1];if(r.length>t-8){let e=r.includes(`.`)?`.`+r.split(`.`).pop():``;return`[...]/${r.replace(e,``).substring(0,Math.max(8,t-12))}[...]${e}`}let i=n.slice(0,-1).join(`/`),a=t-r.length-6;return a<=0||i.length>a?`[...]/${r}`:`${i.substring(0,a)}[...]/${r}`}function Va(e,t=40){return e.length>t?`${e.slice(0,t)}...`:e}function Ha(e,t,n,r){let i=r.find(t=>t.filePath===e);if(!i)return 0;let a=i.fileContents.split(`
`).length;for(let r=t-1;r>=0;r--){let t=n[r].files.find(t=>t.path===e);if(t&&t.contents){let e=t.contents.split(`
`).length;return Math.max(0,a-e)}}return a}function Ua({projectStages:e,phaseTimeline:t,files:n,view:i,activeFile:a,onFileClick:o,isThinkingNext:s,isPreviewDeploying:u,progress:d,total:f,parentScrollRef:p,onViewChange:m,chatId:h,isDeploying:g,handleDeployToCloudflare:_}){let[v,y]=(0,H.useState)(new Set),[b,x]=(0,H.useState)(!1),[S,C]=(0,H.useState)(!1),w=(0,H.useRef)(null),T=(0,H.useRef)(null),E=(0,H.useRef)(null);(0,H.useEffect)(()=>{let e=t.find(e=>e.status===`generating`||e.status===`validating`);e&&y(new Set([e.id]))},[t]),(0,H.useEffect)(()=>{b||C(!1)},[b]),(0,H.useEffect)(()=>{T.current&&T.current.scrollIntoView({behavior:`smooth`,block:`end`})},[t.length,s]),(0,H.useEffect)(()=>{let n=p?.current,r=E.current;if(!r||!n)return;let i=new IntersectionObserver(([n])=>{let r=n.intersectionRatio<.7,i=e.length>0||t.length>0;x(r&&i)},{root:n,rootMargin:`0px 0px 0px 0px`,threshold:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1]});return i.observe(r),()=>i.disconnect()},[p,e.length,t.length]);let D=(0,H.useMemo)(()=>{let n=Fa(t),r=t.length>0?`${n}/${t.length}`:void 0,i=Na(t,`validating`);if(i)return{text:`Reviewing: ${Va(i.name)}`,subtitle:`Running tests and fixing issues...`,icon:(0,W.jsx)(Ia,{color:`blue`}),badge:r};let a=Na(t,`generating`);if(a)return{text:`Implementing: ${Va(a.name)}`,subtitle:`${d}/${f} phases`,icon:(0,W.jsx)(Ia,{color:`accent`}),badge:r};if(u)return{text:`Deploying preview`,subtitle:`Updating preview environment...`,icon:(0,W.jsx)(Ia,{color:`orange`}),badge:r};if(s)return{text:`Planning next phase`,subtitle:`Analyzing requirements...`,icon:(0,W.jsx)(Ia,{color:`tertiary`}),badge:r};let o=Pa(t);if(o)return{text:`Completed: ${Va(o.name)}`,subtitle:`Ready for next phase`,icon:(0,W.jsx)(La,{color:`green`}),badge:r};let c=e.filter(e=>e.status===`completed`).length;return{text:`Ready to implement`,subtitle:c>0?`${c}/${e.length} stages complete`:`Waiting to begin...`,icon:(0,W.jsx)(`div`,{className:`w-4 h-4 bg-gradient-to-br from-zinc-300/30 to-zinc-400/20 dark:from-zinc-600/30 dark:to-zinc-700/20 rounded-full`}),badge:void 0}},[t,s,u,d,f,e]),O=e=>{y(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},k=(0,H.useCallback)(()=>{p?.current&&p.current.scrollTo({top:0,behavior:`smooth`})},[p]),A=(0,H.useMemo)(()=>{let e=Na(t,`generating`),n=Na(t,`validating`),r=Pa(t);return e||n||r||t[t.length-1]},[t]);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(l,{children:b&&(0,W.jsxs)(r.div,{initial:{opacity:0,y:-24,scaleY:.6,transformOrigin:`top center`},animate:{opacity:1,y:0,scaleY:1,transformOrigin:`top center`},exit:{opacity:0,y:-16,scaleY:.8,transformOrigin:`top center`},transition:{duration:.4,ease:[.16,1,.3,1],opacity:{duration:.25,ease:`easeOut`},y:{duration:.4,ease:[.16,1,.3,1]},scaleY:{duration:.35,ease:[.23,1,.32,1]}},className:`absolute -top-2 -left-2 -right-2 z-50 px-2 pt-4 pb-2`,children:[(0,W.jsx)(r.div,{className:`absolute inset-0 backdrop-blur-sm rounded-2xl bg-gradient-to-b from-white/[0.02] via-white/[0.01] to-transparent dark:from-black/[0.02] dark:via-black/[0.01] dark:to-transparent`,initial:{opacity:0,scaleY:.8,transformOrigin:`top`},animate:{opacity:1,scaleY:1,transformOrigin:`top`},exit:{opacity:0,scaleY:.9,transformOrigin:`top`},transition:{...Ma.premium,opacity:Ma.smooth,scaleY:{duration:.35,ease:[.16,1,.3,1]}}}),(0,W.jsx)(r.div,{className:`absolute bottom-0 left-0 right-0 h-px bg-border-primary/50`,initial:{opacity:0,scaleX:.8},animate:{opacity:1,scaleX:1},exit:{opacity:0,scaleX:.9},transition:Ma.smooth}),(0,W.jsxs)(r.div,{className:`relative bg-bg-4/95 dark:bg-bg-2/95 backdrop-blur-md border border-border-primary shadow-lg rounded-xl overflow-hidden mx-4 hover:bg-bg-3/95 dark:hover:bg-bg-1/95 transition-colors cursor-pointer group`,onClick:()=>C(!S),initial:{scale:.96},animate:{scale:1},exit:{scale:.96},transition:Ma.premiumShort,whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,W.jsxs)(r.div,{className:`px-4 py-3 flex items-center gap-3`,initial:{opacity:.8},animate:{opacity:1},exit:{opacity:.8},transition:Ma.fast,children:[(0,W.jsx)(`div`,{className:`flex-shrink-0`,children:D.icon}),(0,W.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[(0,W.jsx)(`div`,{className:`text-sm font-medium text-text-primary truncate`,children:D.text}),D.subtitle&&(0,W.jsx)(`div`,{className:`text-xs text-text-secondary truncate`,children:D.subtitle})]}),D.badge&&(0,W.jsx)(`div`,{className:`flex-shrink-0`,children:(0,W.jsx)(`span`,{className:`text-xs font-medium px-2 py-0.5 bg-accent/10 text-accent rounded-full`,children:D.badge})}),h&&_&&(0,W.jsxs)(`button`,{onClick:e=>{e.stopPropagation(),_(h)},disabled:!!g,className:`ml-2 flex items-center gap-1.5 px-2.5 py-1 bg-accent hover:bg-accent/90 disabled:bg-accent/50 text-white rounded-full text-xs font-medium transition-colors disabled:cursor-not-allowed`,title:g?`Deploying...`:`Deploy to Cloudflare`,"aria-label":g?`Deploying`:`Deploy to Cloudflare`,children:[g?(0,W.jsx)(Ia,{size:`sm`,color:`accent`}):(0,W.jsx)(Rt,{className:`w-3 h-3`}),(0,W.jsx)(`span`,{className:`hidden sm:inline`,children:g?`Deploying...`:`Deploy`})]})]}),(0,W.jsx)(l,{children:S&&(0,W.jsx)(r.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:`auto`},exit:{opacity:0,height:0},transition:Ma.premiumShort,className:`border-t border-border-primary/20`,children:(0,W.jsxs)(`div`,{className:`p-4 space-y-4`,children:[A&&A.files.length>0&&(0,W.jsxs)(`div`,{className:`space-y-1`,children:[(0,W.jsxs)(`div`,{className:`text-xs font-medium text-text-secondary mb-2`,children:[`Files (`,A.files.length,`):`]}),(0,W.jsxs)(`div`,{className:`max-h-32 overflow-y-auto`,children:[A.files.slice(0,5).map((e,t)=>(0,W.jsxs)(`div`,{className:`relative flex items-center gap-2 text-xs py-1`,children:[t>0&&(0,W.jsx)(`div`,{className:`absolute left-1.5 -top-1 w-px h-2 bg-accent/60`}),(0,W.jsx)(`div`,{className:`relative z-10 flex-shrink-0`,children:(0,W.jsx)(Ra,{status:e.status,size:`sm`})}),(0,W.jsx)(`span`,{className:`font-mono text-text-tertiary truncate ml-1`,children:Ba(e.path,35)}),t<Math.min(A.files.length,5)-1&&(0,W.jsx)(`div`,{className:`absolute left-1.5 bottom-0 w-px h-1 bg-accent/60`})]},e.path)),A.files.length>5&&(0,W.jsxs)(`div`,{className:`relative flex items-center gap-2 text-xs py-1`,children:[(0,W.jsx)(`div`,{className:`absolute left-1.5 -top-1 w-px h-2 bg-accent/60`}),(0,W.jsx)(`div`,{className:`relative z-10 flex-shrink-0`,children:(0,W.jsx)(`div`,{className:`w-3 h-3 rounded-full bg-accent/20 flex items-center justify-center`,children:(0,W.jsx)(`div`,{className:`w-1.5 h-1.5 rounded-full bg-accent/60`})})}),(0,W.jsxs)(`span`,{className:`text-text-tertiary ml-1`,children:[`+`,A.files.length-5,` more files...`]})]})]})]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2 pt-2`,children:[(0,W.jsxs)(`button`,{onClick:e=>{e.stopPropagation(),k()},className:`flex items-center gap-1.5 px-3 py-1.5 bg-bg-2 hover:bg-bg-1 border border-border-primary rounded-lg text-xs font-medium text-text-primary transition-colors`,children:[(0,W.jsx)(ve,{className:`w-3 h-3`}),`Scroll to Top`]}),h&&_&&(0,W.jsxs)(`button`,{onClick:e=>{e.stopPropagation(),_(h)},disabled:g,className:`flex items-center gap-1.5 px-3 py-1.5 bg-accent hover:bg-accent/90 disabled:bg-accent/50 text-white rounded-lg text-xs font-medium transition-colors disabled:cursor-not-allowed`,children:[g?(0,W.jsx)(Ia,{size:`sm`,color:`accent`}):(0,W.jsx)(Rt,{className:`w-3 h-3`}),g?`Deploying...`:`Deploy to Cloudflare`]})]})]})})})]})]})}),(0,W.jsx)(r.div,{layout:`position`,animate:{scale:b?.97:1,opacity:b?.85:1,transformOrigin:`top center`},transition:{duration:.4,ease:[.16,1,.3,1],scale:{duration:.35,ease:[.23,1,.32,1]},opacity:Ma.smooth},className:`pl-9 mb-2 relative`,ref:w,children:(0,W.jsx)(`div`,{ref:E,className:`px-2 pr-3.5 py-3 flex-1 rounded-xl border border-black/12 bg-bg-4 dark:bg-bg-2`,children:e.map((l,p)=>(0,W.jsxs)(`div`,{className:`flex relative w-full gap-2 pb-2.5 last:pb-0`,children:[(0,W.jsx)(za,{status:l.status}),(0,W.jsxs)(`div`,{className:`flex flex-col gap-2 flex-1`,children:[(0,W.jsxs)(`div`,{className:`flex`,children:[(0,W.jsx)(`span`,{className:c(`font-medium`,l.status===`pending`?`text-text-tertiary`:`text-text-secondary`),children:l.title}),l.id===`code`&&l.status!==`pending`&&(0,W.jsxs)(r.div,{initial:{x:-120},animate:{x:0},children:[(0,W.jsx)(`span`,{className:`text-zinc-300 mx-1`,children:``}),(0,W.jsxs)(`span`,{className:`text-text-tertiary`,children:[d,`/`,f,` phases`]})]})]}),l.id===`blueprint`&&l.status!==`pending`&&(0,W.jsx)(`button`,{onClick:()=>m?.(`blueprint`),className:c(`flex items-start ml-0.5 transition-colors font-mono`,i===`blueprint`?`text-brand underline decoration-dotted`:`text-text-secondary/80 hover:bg-bg-2/50 hover:text-text-secondary`),children:(0,W.jsx)(`span`,{className:`text-xs text-left truncate`,children:`Blueprint.md`})}),l.id===`code`&&(0,W.jsxs)(`div`,{className:`space-y-2 max-h-[400px] overflow-y-auto pr-2 phase-timeline-scroll`,children:[t.map((e,r)=>(0,W.jsxs)(`div`,{className:`space-y-1 relative`,ref:r===t.length-1?T:void 0,children:[(0,W.jsxs)(`button`,{onClick:()=>e.status===`completed`&&O(e.id),className:`flex items-start gap-2 relative z-0 w-full text-left hover:bg-zinc-50/5 rounded px-1 py-1 transition-colors group`,disabled:e.status!==`completed`,children:[e.status===`completed`&&(0,W.jsx)(`div`,{className:`flex-shrink-0 opacity-60 group-hover:opacity-100 transition-opacity mt-0.5`,children:v.has(e.id)?(0,W.jsx)(pn,{className:`size-3`}):(0,W.jsx)(Ne,{className:`size-3`})}),(0,W.jsx)(`div`,{className:`flex-shrink-0 mt-0.5`,children:e.status===`generating`?(0,W.jsx)(Ia,{size:`sm`,color:`accent`}):e.status===`validating`?(0,W.jsx)(Ia,{size:`sm`,color:`blue`}):(0,W.jsx)(La,{size:`sm`,color:`green`})}),(0,W.jsx)(`span`,{className:`text-sm font-medium text-text-50 flex-1 break-words`,children:e.status===`completed`?`Implemented ${e.name}`:e.status===`validating`?`Reviewing ${e.name}`:`Implementing ${e.name}`}),e.status===`completed`&&!v.has(e.id)&&(0,W.jsxs)(`span`,{className:`text-xs text-text-primary/50 bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded flex-shrink-0`,children:[e.files.length,` files`]})]}),(e.status===`generating`||e.status===`validating`||e.status===`completed`&&v.has(e.id))&&(0,W.jsx)(`div`,{className:`ml-6 space-y-0.5`,children:e.files.map(e=>{let s=n.find(t=>t.filePath===e.path),l=i===`editor`&&a?.filePath===e.path;return(0,W.jsxs)(`button`,{onClick:()=>s&&o(s),className:`flex items-start gap-2 py-1 transition-colors font-mono w-full text-left group hover:bg-zinc-50/5 rounded px-2 min-h-0`,"aria-selected":l,disabled:!s,children:[(0,W.jsx)(`span`,{className:`flex-shrink-0`,children:(0,W.jsx)(Ra,{status:e.status,size:`sm`})}),(0,W.jsx)(`div`,{className:`flex-1 min-w-0`,children:(0,W.jsx)(`span`,{className:c(`text-xs text-left block transition-colors break-all leading-tight`,l?`text-brand font-medium`:s?`text-text-primary/80 group-hover:text-text-primary`:`text-text-primary/50`),title:e.path,children:Ba(e.path)})}),s&&(()=>{let i=Ha(e.path,r,t,n),a=i>999?`${Math.floor(i/1e3)}k`:i.toString();return(0,W.jsxs)(`span`,{className:`flex-shrink-0 text-text-tertiary text-xs font-mono text-right w-12 ml-2`,title:`${i} lines added in this phase`,children:[`+`,a]})})()]},e.path)})})]},e.id)),(()=>Na(t,`validating`)?(0,W.jsxs)(`div`,{className:`space-y-1 relative bg-blue-50/5 border border-blue-200/20 rounded-lg p-3`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(Ia,{size:`sm`,color:`blue`}),(0,W.jsx)(`span`,{className:`text-sm font-medium text-blue-400`,children:`Reviewing phase...`})]}),(0,W.jsx)(`span`,{className:`text-xs text-blue-300/80 ml-5`,children:`Running tests and fixing any issues`})]}):u?(0,W.jsxs)(`div`,{className:`space-y-1 relative bg-orange-50/5 border border-orange-200/20 rounded-lg p-3`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(Ia,{size:`sm`,color:`orange`}),(0,W.jsx)(`span`,{className:`text-sm font-medium text-orange-400`,children:`Deploying preview...`})]}),(0,W.jsx)(`span`,{className:`text-xs text-orange-300/80 ml-5`,children:`Updating your preview environment`})]}):null)(),s&&(0,W.jsx)(`div`,{className:`relative z-10`,ref:T,children:(0,W.jsx)(Aa,{visible:s})}),t.length===0&&n.map(e=>{let t=i===`editor`&&a?.filePath===e.filePath;return(0,W.jsxs)(`button`,{onClick:()=>o(e),className:`flex items-start gap-2 py-1 font-mono w-full text-left group hover:bg-zinc-50/5 rounded px-2 min-h-0`,children:[(0,W.jsx)(`span`,{className:`flex-shrink-0`,children:e.isGenerating?(0,W.jsx)(Ia,{size:`sm`,color:`accent`}):(0,W.jsx)(La,{size:`sm`,color:`green`})}),(0,W.jsx)(`div`,{className:`flex-1 min-w-0`,children:(0,W.jsx)(`span`,{className:c(`text-xs block break-all leading-tight`,t?`text-brand font-medium`:`text-text-primary/80`),children:Ba(e.filePath)})}),(0,W.jsxs)(`span`,{className:`flex-shrink-0 text-text-tertiary text-xs font-mono text-right w-12 ml-2`,children:[`+`,e.fileContents.split(`
`).length]})]},e.filePath)})]}),l.metadata&&(0,W.jsx)(`span`,{className:`font-mono text-xs text-zinc-500 tracking-tighter`,children:l.metadata})]}),p!==e.length-1&&(0,W.jsx)(`div`,{className:c(`absolute left-[9.25px] w-px h-full top-2.5 z-10`,l.status===`completed`?`bg-accent`:`bg-text/5`)})]},l.id))})})]})}var Wa=10,Ga=8,Ka=0,qa=0,Ja=e=>Math.min(1e3*2**e,8e3);const Ya=(0,H.forwardRef)(({src:e,className:t=``,title:n=`Preview`,shouldRefreshPreview:r=!1,manualRefreshTrigger:i,webSocket:a},o)=>{let[s,c]=(0,H.useState)({status:`idle`,attempt:0,loadedSrc:null,errorMessage:null}),l=(0,H.useRef)(null),u=(0,H.useRef)(!1),d=(0,H.useRef)(null),f=(0,H.useCallback)(async e=>{try{let t=await fetch(e,{method:`HEAD`,mode:`cors`,cache:`no-cache`,signal:AbortSignal.timeout(8e3)});if(console.log(`Preview availability test response:`,t,t.headers.forEach((e,t)=>console.log(`Header: `,t,e))),!t.ok)return console.log(`Preview not ready (status:`,t.status,`)`),null;let n=t.headers.get(`X-Preview-Type`);return n===`sandbox-error`?(console.log(`Preview not ready (sandbox error)`),null):n===`sandbox`||n===`dispatcher`?(console.log(`Preview available, type:`,n),n):(console.log(`Preview available (type unknown, assuming sandbox)`),`sandbox`)}catch(e){return console.log(`Preview not available yet:`,e),null}},[]),p=(0,H.useCallback)(()=>{if(!a||a.readyState!==h.OPEN){console.warn(`Cannot request redeploy: WebSocket not connected`);return}if(u.current){console.log(`Redeploy already requested, skipping duplicate request`);return}console.log(`Requesting automatic preview redeployment`);try{a.send(JSON.stringify({type:`preview`})),u.current=!0}catch(e){console.error(`Failed to send redeploy request:`,e)}},[a]),m=(0,H.useCallback)(e=>{if(!a||a.readyState!==h.OPEN){console.warn(`Cannot request screenshot: WebSocket not connected`);return}console.log(`Requesting screenshot capture`);try{a.send(JSON.stringify({type:`capture_screenshot`,data:{url:e,viewport:{width:1280,height:720}}}))}catch(e){console.error(`Failed to send screenshot request:`,e)}},[a]),g=(0,H.useCallback)(async(e,t)=>{if(l.current&&=(clearTimeout(l.current),null),d.current&&=(clearTimeout(d.current),null),t>=Wa){c({status:`error`,attempt:t,loadedSrc:null,errorMessage:`Preview failed to load after multiple attempts`});return}c({status:`loading`,attempt:t+1,loadedSrc:null,errorMessage:null});let n=await f(e);if(n){console.log(`Preview available (${n}) at attempt ${t+1}`),c({status:`postload`,attempt:t+1,loadedSrc:e,errorMessage:null,previewType:n});let r=n===`dispatcher`?qa:Ka;console.log(`Waiting ${r}ms before showing preview and capturing screenshot (${n} app)`),d.current=setTimeout(()=>{c(e=>({...e,status:`loaded`})),m(e)},r)}else{let n=Ja(t),r=t+1;console.log(`Preview not ready. Retrying in ${Math.ceil(n/1e3)}s (attempt ${r}/${Wa})`),r===Ga&&p(),l.current=setTimeout(()=>{g(e,r)},n)}},[f,m,p]),_=(0,H.useCallback)(()=>{console.log(`Force reloading preview`),u.current=!1,l.current&&=(clearTimeout(l.current),null),d.current&&=(clearTimeout(d.current),null),c({status:`idle`,attempt:0,loadedSrc:null,errorMessage:null}),g(e,0)},[e,g]);if((0,H.useEffect)(()=>{if(e)return console.log(`Preview src changed, starting load:`,e),u.current=!1,l.current&&=(clearTimeout(l.current),null),d.current&&=(clearTimeout(d.current),null),c({status:`idle`,attempt:0,loadedSrc:null,errorMessage:null}),g(e,0),()=>{l.current&&=(clearTimeout(l.current),null),d.current&&=(clearTimeout(d.current),null)}},[e,g]),(0,H.useEffect)(()=>{r&&s.status===`loaded`&&s.loadedSrc&&(console.log(`Auto-refreshing preview after deployment`),_())},[r,s.status,s.loadedSrc,_]),(0,H.useEffect)(()=>{i&&i>0&&(console.log(`Manual refresh triggered`),_())},[i,_]),(0,H.useEffect)(()=>()=>{l.current&&clearTimeout(l.current),d.current&&clearTimeout(d.current)},[]),s.status===`loaded`&&s.loadedSrc)return(0,W.jsx)(`iframe`,{ref:o,src:s.loadedSrc,className:t,title:n,onError:()=>{console.error(`Iframe failed to load`),c(e=>({...e,status:`error`,errorMessage:`Preview failed to render`}))}});if(s.status===`loading`||s.status===`idle`||s.status===`postload`){let e=Ja(s.attempt-1),r=Math.ceil(e/1e3);return(0,W.jsxs)(`div`,{className:`${t} relative flex flex-col items-center justify-center bg-bg-3 border border-text/10 rounded-lg`,children:[s.status===`postload`&&s.loadedSrc&&(0,W.jsx)(`iframe`,{ref:o,src:s.loadedSrc,className:`absolute inset-0 opacity-0 pointer-events-none`,title:n,"aria-hidden":`true`,onError:()=>{console.error(`Iframe failed to load`),c(e=>({...e,status:`error`,errorMessage:`Preview failed to render`}))}}),(0,W.jsxs)(`div`,{className:`text-center p-8 max-w-md`,children:[(0,W.jsx)(ge,{className:`size-8 text-accent animate-spin mx-auto mb-4`}),(0,W.jsx)(`h3`,{className:`text-lg font-medium text-text-primary mb-2`,children:`Loading Preview`}),(0,W.jsx)(`p`,{className:`text-text-primary/70 text-sm mb-4`,children:s.attempt===0?`Checking if your deployed preview is ready...`:`Preview not ready yet. Retrying in ${r}s... (attempt ${s.attempt}/${Wa})`}),s.attempt>=Ga&&(0,W.jsx)(`p`,{className:`text-xs text-accent/70`,children:`Auto-redeployment triggered to refresh the preview`}),(0,W.jsx)(`div`,{className:`text-xs text-text-primary/50 mt-2`,children:`Preview URLs may take a moment to become available after deployment`})]})]})}return(0,W.jsx)(`div`,{className:`${t} flex flex-col items-center justify-center bg-bg-3 border border-text/10 rounded-lg`,children:(0,W.jsxs)(`div`,{className:`text-center p-8 max-w-md`,children:[(0,W.jsx)(at,{className:`size-8 text-orange-500 mx-auto mb-4`}),(0,W.jsx)(`h3`,{className:`text-lg font-medium text-text-primary mb-2`,children:`Preview Not Available`}),(0,W.jsx)(`p`,{className:`text-text-primary/70 text-sm mb-6`,children:s.errorMessage||`The preview failed to load after multiple attempts.`}),(0,W.jsxs)(`div`,{className:`space-y-3`,children:[(0,W.jsxs)(`button`,{onClick:_,className:`flex items-center justify-center gap-2 px-6 py-3 bg-accent hover:bg-accent/90 text-white rounded-lg transition-colors text-sm mx-auto font-medium w-full`,children:[(0,W.jsx)(ge,{className:`size-4`}),`Try Again`]}),(0,W.jsx)(`p`,{className:`text-xs text-text-primary/60`,children:`If the issue persists, please describe the problem in chat so I can help diagnose and fix it.`})]})]})})});Ya.displayName=`PreviewIframe`;function Xa({view:e,onChange:t,previewAvailable:n=!1,showTooltip:i=!1}){return n?(0,W.jsxs)(`div`,{className:`flex items-center gap-1 bg-bg-1 rounded-md p-0.5 relative`,children:[(0,W.jsx)(l,{children:i&&(0,W.jsx)(r.div,{initial:{opacity:0,scale:.4},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},className:`absolute z-50 top-10 left-0 bg-bg-2 text-text-primary text-xs px-2 py-1 rounded whitespace-nowrap animate-fade-in`,children:`You can view code anytime from here`})}),(0,W.jsx)(`button`,{onClick:()=>t(`preview`),className:c(`p-1 flex items-center justify-between h-full rounded-md transition-colors`,e===`preview`?`bg-bg-4 text-text-primary`:`text-text-50/70 hover:text-text-primary hover:bg-accent`),children:(0,W.jsx)(Ut,{className:`size-4`})}),(0,W.jsx)(`button`,{onClick:()=>t(`editor`),className:c(`p-1 flex items-center justify-between h-full rounded-md transition-colors`,e===`editor`?`bg-bg-4 text-text-primary`:`text-text-50/70 hover:text-text-primary hover:bg-accent`),children:(0,W.jsx)(Lt,{className:`size-4`})})]}):null}function Za({variant:e=`secondary`,children:t,className:n,...r}){return(0,W.jsx)(`button`,{className:c(`inline-flex items-center gap-1 px-2 h-8 rounded-lg text-sm font-medium`,e===`primary`&&`bg-bg-bright text-black`,e===`secondary`&&`bg-bg-darkest text-text-primary`,n),...r,children:t})}var Qa=e(y(),1);async function $a(e={}){let{quality:t=.8,format:n=`jpeg`,excludeElements:r=[],scale:i=1,width:a,height:o,element:s}=e,c=[];try{r.forEach(e=>{document.querySelectorAll(e).forEach(e=>{let t=e;c.push({element:t,originalStyle:t.style.display}),t.style.display=`none`})});let e=await(0,Qa.default)(s||document.body,{useCORS:!0,allowTaint:!1,scale:i,width:a,height:o,backgroundColor:`#ffffff`,logging:!1,ignoreElements:e=>e.classList.contains(`screenshot-exclude`)});return{dataUrl:e.toDataURL(`image/${n}`,t),blob:await new Promise(r=>{e.toBlob(e=>{r(e)},`image/${n}`,t)}),metadata:{timestamp:Date.now(),url:window.location.href,viewport:{width:window.innerWidth,height:window.innerHeight},userAgent:navigator.userAgent}}}finally{c.forEach(({element:e,originalStyle:t})=>{e.style.display=t})}}async function eo(){return $a({quality:.8,format:`jpeg`,excludeElements:[`[data-debug-panel]`,`[data-overlay]`,`.debug-panel`,`.modal-overlay`,`.toast-container`,`.notification`],scale:1})}new class{constructor(e){this.onScreenshot=e,this.enabled=!1,this.lastScreenshot=null,this.screenshotHistory=[],this.maxHistory=10}enable(){this.enabled=!0,this.setupListeners()}disable(){this.enabled=!1}setupListeners(){window.addEventListener(`popstate`,()=>{this.enabled&&this.captureAuto(`navigation`)});let e;new MutationObserver(()=>{this.enabled&&(clearTimeout(e),e=setTimeout(()=>{this.captureAuto(`dom_change`)},2e3))}).observe(document.body,{childList:!0,subtree:!0,attributes:!1})}async captureAuto(e){try{let t=await $a({quality:.6,format:`jpeg`,scale:.5,excludeElements:[`[data-debug-panel]`,`[data-overlay]`]});this.lastScreenshot=t,this.screenshotHistory.push(t),this.screenshotHistory.length>this.maxHistory&&this.screenshotHistory.shift(),this.onScreenshot?.(t),console.log(`Auto screenshot captured: ${e}`,{timestamp:t.metadata.timestamp,url:t.metadata.url})}catch(e){console.error(`Auto screenshot failed:`,e)}}getHistory(){return[...this.screenshotHistory]}getLastScreenshot(){return this.lastScreenshot}};var to=class extends H.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error(`Debug Panel Error:`,e,t)}render(){return this.state.hasError?(0,W.jsxs)(`div`,{className:`fixed bottom-6 right-6 z-50 p-4 bg-red-50 border border-red-200 rounded-lg shadow-lg max-w-sm`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2 text-red-800 mb-2`,children:[(0,W.jsx)(Ce,{className:`w-4 h-4`}),(0,W.jsx)(`span`,{className:`font-medium`,children:`Debug Panel Error`})]}),(0,W.jsx)(`p`,{className:`text-sm text-red-700 mb-3`,children:`The debug panel encountered an error but your main application is still working normally.`}),(0,W.jsx)(`button`,{onClick:()=>this.setState({hasError:!1,error:void 0}),className:`px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors`,children:`Retry Debug Panel`})]}):this.props.children}};function no({messages:e,onClear:t,chatSessionId:n}){let[r,i]=(0,H.useState)(!1),[a,o]=(0,H.useState)(!1),[s,c]=(0,H.useState)(new Set),[l,u]=(0,H.useState)(`all`),[d,f]=(0,H.useState)(`all`),[p,m]=(0,H.useState)(``),[h,g]=(0,H.useState)(!1),[_,v]=(0,H.useState)(`list`),[y,b]=(0,H.useState)(new Set),x=e=>{try{let t={phaseGeneration:[],fileGeneration:[],cfDeployment:[],runnerDeployment:[]},n=e.filter(e=>e.messageType===`phase_generating`),r=e.filter(e=>e.messageType===`phase_implemented`);n.forEach(e=>{let n=r.find(t=>t.timestamp>e.timestamp);n&&t.phaseGeneration.push(n.timestamp-e.timestamp)});let i=e.filter(e=>e.messageType===`file_generating`),a=e.filter(e=>e.messageType===`file_generated`);i.forEach(e=>{let n=a.find(t=>t.timestamp>e.timestamp);if(n){let r=n.timestamp-e.timestamp,i=0,a=0;try{let e=n.message||``,t=e.match(/(\d+)\s*lines?/i),r=e.match(/(\d+)\s*characters?/i),o=e.match(/(\d+)\s*bytes?/i);if(t)i=parseInt(t[1]);else{let t=e.match(/```[\s\S]*?```/g);t&&(i=t[0].split(`
`).length-2)}if(r)a=parseInt(r[1]);else if(o)a=parseInt(o[1]);else{let t=e.match(/```[\s\S]*?```/g);a=t?t[0].length:e.length}i===0&&a>0&&(i=Math.max(1,Math.floor(a/50))),a===0&&i>0&&(a=i*50)}catch{i=50,a=2500}t.fileGeneration.push({duration:r,lines:i,chars:a})}});let o=e.filter(e=>e.messageType===`cloudflare_deployment_started`),s=e.filter(e=>e.messageType===`cloudflare_deployment_completed`);o.forEach(e=>{let n=s.find(t=>t.timestamp>e.timestamp);n&&t.cfDeployment.push(n.timestamp-e.timestamp)});let c=e.filter(e=>e.messageType===`phase_implemented`),l=e.filter(e=>e.messageType===`deployment_completed`);c.forEach(e=>{let n=l.find(t=>t.timestamp>e.timestamp);n&&t.runnerDeployment.push(n.timestamp-e.timestamp)});let u=e=>{if(e.length===0)return{avg:0,median:0,p99:0,count:0};let t=[...e].sort((e,t)=>e-t),n=e.reduce((e,t)=>e+t,0)/e.length,r=t.length%2==0?(t[t.length/2-1]+t[t.length/2])/2:t[Math.floor(t.length/2)],i=Math.ceil(t.length*.99)-1;return{avg:n,median:r,p99:t[Math.max(0,i)],count:e.length}};return{phaseGeneration:u(t.phaseGeneration),fileGeneration:(e=>{if(e.length===0)return{duration:{avg:0,median:0,p99:0,count:0},linesPerSecond:{avg:0,median:0,p99:0},charsPerSecond:{avg:0,median:0,p99:0},totalLines:0,totalChars:0};let t=e.map(e=>e.duration),n=e.map(e=>e.duration>0?e.lines/(e.duration/1e3):0),r=e.map(e=>e.duration>0?e.chars/(e.duration/1e3):0),i=e.reduce((e,t)=>e+t.lines,0),a=e.reduce((e,t)=>e+t.chars,0),o=e=>{let t=[...e].sort((e,t)=>e-t),n=e.reduce((e,t)=>e+t,0)/e.length,r=t.length%2==0?(t[t.length/2-1]+t[t.length/2])/2:t[Math.floor(t.length/2)],i=Math.ceil(t.length*.99)-1;return{avg:n,median:r,p99:t[Math.max(0,i)]}};return{duration:{...u(t),count:e.length},linesPerSecond:o(n),charsPerSecond:o(r),totalLines:i,totalChars:a}})(t.fileGeneration),cfDeployment:u(t.cfDeployment),runnerDeployment:u(t.runnerDeployment)}}catch(e){return console.error(`Error calculating operation metrics:`,e),{phaseGeneration:{avg:0,median:0,p99:0,count:0},fileGeneration:{duration:{avg:0,median:0,p99:0,count:0},linesPerSecond:{avg:0,median:0,p99:0},charsPerSecond:{avg:0,median:0,p99:0},totalLines:0,totalChars:0},cfDeployment:{avg:0,median:0,p99:0,count:0},runnerDeployment:{avg:0,median:0,p99:0,count:0}}}},S=e=>{try{return!e||e.length===0?{events:[],lanes:[]}:{events:e.map((t,n)=>({id:t.id||`msg-${n}`,timestamp:t.timestamp||Date.now(),message:t.message||`Unknown message`,type:t.type||`info`,messageType:t.messageType,category:t.wsCategory||D(t.messageType),duration:n>0?(t.timestamp||0)-(e[n-1]?.timestamp||0):0,isBookmarked:y.has(t.id||``)})),lanes:[{id:`generation`,label:`Generation`,color:`bg-blue-100 border-blue-300`},{id:`phase`,label:`Phases`,color:`bg-green-100 border-green-300`},{id:`file`,label:`Files`,color:`bg-purple-100 border-purple-300`},{id:`deployment`,label:`Deployment`,color:`bg-orange-100 border-orange-300`},{id:`system`,label:`System`,color:`bg-red-100 border-red-300`}]}}catch(e){return console.error(`Error processing timeline data:`,e),{events:[],lanes:[]}}},C=(0,H.useMemo)(()=>{try{if(!r)return null;let t=Date.now(),n=e.filter(e=>t-e.timestamp<1440*60*1e3),i=e.filter(e=>e.type===`error`),a=e.filter(e=>e.type===`warning`),o=e.filter(e=>e.type===`websocket`),s=[];for(let t=1;t<e.length;t++)s.push(e[t].timestamp-e[t-1].timestamp);let c=[...s].sort((e,t)=>e-t),l=c.length>0?c.length%2==0?(c[c.length/2-1]+c[c.length/2])/2:c[Math.floor(c.length/2)]:0,u=Math.ceil(c.length*.99)-1,d=c.length>0?c[Math.max(0,u)]:0,f=s.length>0?s.reduce((e,t)=>e+t,0)/s.length:0,p=x(o);return{totalMessages:e.length,last24h:n.length,errorRate:e.length>0?(i.length/e.length*100).toFixed(1):`0`,warningRate:e.length>0?(a.length/e.length*100).toFixed(1):`0`,wsMessages:o.length,intervals:{avg:f>1e3?`${(f/1e3).toFixed(1)}s`:`${f.toFixed(0)}ms`,median:l>1e3?`${(l/1e3).toFixed(1)}s`:`${l.toFixed(0)}ms`,p99:d>1e3?`${(d/1e3).toFixed(1)}s`:`${d.toFixed(0)}ms`},operations:p}}catch(e){return console.error(`Error calculating analytics data:`,e),null}},[e,r,y]),w=(0,H.useMemo)(()=>{try{return!r||_!==`timeline`?null:S(e)}catch(e){return console.error(`Error processing timeline data:`,e),null}},[e,r,_,y]),E=e=>{let t=new Set(y);t.has(e)?t.delete(e):t.add(e),b(t)},D=e=>{if(e)return[`generation_started`,`generation_complete`,`generation_errors`].includes(e)?`generation`:[`phase_generating`,`phase_generated`,`phase_implementing`,`phase_implemented`].includes(e)?`phase`:[`file_generating`,`file_generated`,`file_regenerated`,`file_chunk_generated`,`file_enhanced`,`file_regenerating`].includes(e)?`file`:[`cloudflare_deployment_started`,`cloudflare_deployment_completed`,`cloudflare_deployment_error`,`deployment_completed`].includes(e)?`deployment`:([`runtime_error_found`,`command_executing`,`code_review`,`error`].includes(e),`system`)},O=(0,H.useRef)(null),k=e.filter(e=>{if(l!==`all`&&e.type!==l||l===`websocket`&&d!==`all`&&(e.wsCategory||D(e.messageType))!==d)return!1;if(p){let t=p.toLowerCase();return e.message.toLowerCase().includes(t)||e.source?.toLowerCase().includes(t)||e.messageType?.toLowerCase().includes(t)}return!0}),A=e=>{let t=new Set(s);t.has(e)?t.delete(e):t.add(e),c(t)},j=async()=>{try{return(await eo()).dataUrl}catch(e){console.error(`Screenshot capture failed:`,e);return}},M=async()=>{let t=await j();return{timestamp:Date.now(),chatSessionId:n||`unknown`,messages:e.map(e=>({...e})),appState:{url:window.location.href,userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight}},screenshot:t}},N=async()=>{g(!0);try{let e=await M(),t=new Blob([JSON.stringify(e,null,2)],{type:`application/json`}),n=URL.createObjectURL(t),r=document.createElement(`a`);r.href=n,r.download=`debug-dump-${new Date().toISOString().slice(0,19)}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}finally{g(!1)}},P=async()=>{g(!0);try{let e=await M(),t=`Debug Dump - ${n||`Unknown Session`}`,r=`Debug dump generated at ${new Date().toISOString()}\n\nDump data attached as JSON.`,i=`mailto:ashishsingh@cloudflare.com?subject=${encodeURIComponent(t)}&body=${encodeURIComponent(r+`

`+JSON.stringify(e,null,2))}`;window.open(i)}finally{g(!1)}},F=e.filter(e=>e.type===`error`).length,I=e.filter(e=>e.type===`warning`).length;return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(`button`,{onClick:()=>i(!r),className:`fixed bottom-6 right-6 z-50 p-3 rounded-full shadow-lg transition-all duration-300 hover:scale-105 ${(F>0||I>0)&&!r?`bg-red-500 text-white animate-pulse`:`bg-zinc-800 text-white hover:bg-zinc-700`}`,title:`Debug Console (${F+I} issues)`,children:[(0,W.jsx)(Ce,{className:`w-4 h-4`}),(F>0||I>0)&&(0,W.jsx)(`span`,{className:`absolute -top-2 -right-2 bg-red-500 text-white text-xs px-1.5 py-0.5 rounded-full`,children:F>0?F:I})]}),(0,W.jsxs)(`div`,{ref:O,className:`fixed right-0 top-0 h-full bg-bg-3 dark:bg-bg-4 shadow-2xl border-l border-border-primary z-[60] transform transition-all duration-300 ease-in-out flex flex-col ${a?`w-[80vw]`:`w-[600px]`} ${r?`translate-x-0`:`translate-x-full`}`,children:[(0,W.jsxs)(`div`,{className:`flex items-center justify-between p-4 border-b border-border-primary bg-gradient-to-r from-muted to-accent`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(Ce,{className:`w-5 h-5 text-text-primary`}),(0,W.jsx)(`h3`,{className:`font-semibold text-text-primary`,children:`Debug Console`}),(0,W.jsxs)(`span`,{className:`bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded-full`,children:[k.length,`/`,e.length]}),y.size>0&&(0,W.jsxs)(`span`,{className:`bg-amber-100 text-amber-700 text-xs px-2 py-1 rounded-full flex items-center gap-1`,children:[(0,W.jsx)(T,{className:`w-3 h-3`}),y.size]})]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2 flex-wrap justify-end`,children:[(0,W.jsx)(`div`,{className:`flex bg-bg-3 dark:bg-zinc-800 rounded p-0.5`,children:[{key:`list`,icon:Ce,label:`List`},{key:`analytics`,icon:L,label:`Analytics`},{key:`timeline`,icon:be,label:`Timeline`}].map(({key:e,icon:t,label:n})=>(0,W.jsxs)(`button`,{onClick:()=>v(e),className:`px-2 py-1 text-xs rounded transition-all flex items-center gap-1 ${_===e?`bg-bg-3 text-text-primary shadow-sm`:`text-text-tertiary hover:text-text-primary`}`,title:`${n} view`,children:[(0,W.jsx)(t,{className:`w-3 h-3`}),n]},e))}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2 basis-full justify-end pt-2`,children:[(0,W.jsxs)(Za,{onClick:N,disabled:h,title:`Download debug dump`,children:[(0,W.jsx)(dt,{className:`w-4 h-4`}),h?`Generating...`:`Download`]}),(0,W.jsxs)(Za,{onClick:P,disabled:h,title:`Email debug dump to developers`,children:[(0,W.jsx)(Yt,{className:`w-4 h-4`}),`Email`]})]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2 w-full sm:w-auto pt-2 sm:pt-0`,children:[(0,W.jsx)(`button`,{onClick:()=>o(!a),className:`text-text-tertiary hover:text-text-primary p-1 hover:bg-bg-3 rounded transition-colors`,title:a?`Minimize panel`:`Maximize panel`,children:a?(0,W.jsx)(Ge,{className:`w-4 h-4`}):(0,W.jsx)(z,{className:`w-4 h-4`})}),(0,W.jsx)(`button`,{onClick:t,className:`text-xs text-text-tertiary hover:text-text-primary px-2 py-1 hover:bg-bg-3 rounded transition-colors`,children:`Clear`}),(0,W.jsx)(`button`,{onClick:()=>i(!1),className:`text-text-tertiary hover:text-text-primary p-1 hover:bg-bg-3 rounded transition-colors`,children:(0,W.jsx)(Ct,{className:`w-4 h-4`})})]})]})]}),(0,W.jsxs)(`div`,{className:`p-3 border-b border-border-primary dark:border-border-primary bg-bg-3/30 dark:bg-bg-3/20`,children:[(0,W.jsx)(`div`,{className:`flex gap-2 mb-3`,children:(0,W.jsx)(`input`,{type:`text`,placeholder:`Search messages...`,value:p,onChange:e=>m(e.target.value),className:`flex-1 px-3 py-1.5 text-sm bg-input border border-border-primary rounded focus:outline-none focus:ring-2 focus:ring-ring text-text-primary`})}),(0,W.jsx)(`div`,{className:`flex gap-1 flex-wrap`,children:[{key:`all`,label:`All`,count:e.length},{key:`error`,label:`Errors`,count:F},{key:`warning`,label:`Warnings`,count:I},{key:`websocket`,label:`WebSocket`,count:e.filter(e=>e.type===`websocket`).length},{key:`info`,label:`Info`,count:e.filter(e=>e.type===`info`).length}].map(({key:e,label:t,count:n})=>(0,W.jsxs)(`button`,{onClick:()=>{u(e),e!==`websocket`&&f(`all`)},className:`px-3 py-1 text-xs rounded-full transition-all ${l===e?`bg-blue-500 text-white`:`bg-bg-3 text-text-primary hover:bg-bg-3 border border-border-primary`}`,children:[t,` (`,n,`)`]},e))}),l===`websocket`&&(0,W.jsxs)(`div`,{className:`mt-3 pt-3 border-t border-border-primary`,children:[(0,W.jsx)(`div`,{className:`text-xs text-text-tertiary mb-2 font-medium`,children:`WebSocket Message Types:`}),(0,W.jsx)(`div`,{className:`flex gap-1 flex-wrap`,children:[{key:`all`,label:`All WS`,count:e.filter(e=>e.type===`websocket`).length},{key:`generation`,label:`Generation`,count:e.filter(e=>e.type===`websocket`&&(e.wsCategory===`generation`||D(e.messageType)===`generation`)).length},{key:`phase`,label:`Phases`,count:e.filter(e=>e.type===`websocket`&&(e.wsCategory===`phase`||D(e.messageType)===`phase`)).length},{key:`file`,label:`Files`,count:e.filter(e=>e.type===`websocket`&&(e.wsCategory===`file`||D(e.messageType)===`file`)).length},{key:`deployment`,label:`Deploy`,count:e.filter(e=>e.type===`websocket`&&(e.wsCategory===`deployment`||D(e.messageType)===`deployment`)).length},{key:`system`,label:`System`,count:e.filter(e=>e.type===`websocket`&&(e.wsCategory===`system`||D(e.messageType)===`system`)).length}].map(({key:e,label:t,count:n})=>(0,W.jsxs)(`button`,{onClick:()=>f(e),className:`px-2 py-1 text-xs rounded transition-all ${d===e?`bg-purple-600 text-white dark:bg-purple-700`:`bg-purple-50 text-purple-700 hover:bg-purple-100 border border-purple-200 dark:bg-purple-900/30 dark:text-purple-200 dark:hover:bg-purple-900/40 dark:border-purple-800`}`,children:[t,` (`,n,`)`]},e))})]})]}),(0,W.jsx)(`div`,{className:`flex-1 overflow-y-auto`,children:_===`analytics`?(0,W.jsxs)(`div`,{className:`p-6 space-y-6`,children:[C?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(`div`,{className:`grid grid-cols-2 md:grid-cols-4 gap-4`,children:[(0,W.jsxs)(`div`,{className:`bg-blue-50 p-4 rounded-lg`,children:[(0,W.jsx)(`div`,{className:`text-2xl font-bold text-blue-600`,children:C.totalMessages}),(0,W.jsx)(`div`,{className:`text-sm text-blue-800`,children:`Total Messages`})]}),(0,W.jsxs)(`div`,{className:`bg-red-50 p-4 rounded-lg`,children:[(0,W.jsxs)(`div`,{className:`text-2xl font-bold text-red-600`,children:[C.errorRate,`%`]}),(0,W.jsx)(`div`,{className:`text-sm text-red-800`,children:`Error Rate`})]}),(0,W.jsxs)(`div`,{className:`bg-yellow-50 p-4 rounded-lg`,children:[(0,W.jsxs)(`div`,{className:`text-2xl font-bold text-yellow-600`,children:[C.warningRate,`%`]}),(0,W.jsx)(`div`,{className:`text-sm text-yellow-800`,children:`Warning Rate`})]}),(0,W.jsxs)(`div`,{className:`bg-green-50 p-4 rounded-lg`,children:[(0,W.jsx)(`div`,{className:`text-2xl font-bold text-green-600`,children:C.intervals.avg}),(0,W.jsx)(`div`,{className:`text-sm text-green-800`,children:`Avg Interval`})]})]}),(0,W.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-3 gap-4`,children:[(0,W.jsxs)(`div`,{className:`bg-bg-3/50 p-4 rounded-lg`,children:[(0,W.jsx)(`h4`,{className:`font-medium text-text-primary mb-2`,children:`Response Time Statistics`}),(0,W.jsxs)(`div`,{className:`space-y-1 text-sm`,children:[(0,W.jsxs)(`div`,{children:[`Average: `,(0,W.jsx)(`span`,{className:`font-mono`,children:C.intervals.avg})]}),(0,W.jsxs)(`div`,{children:[`Median: `,(0,W.jsx)(`span`,{className:`font-mono`,children:C.intervals.median})]}),(0,W.jsxs)(`div`,{children:[`P99: `,(0,W.jsx)(`span`,{className:`font-mono`,children:C.intervals.p99})]})]})]}),(0,W.jsxs)(`div`,{className:`bg-purple-50 p-4 rounded-lg`,children:[(0,W.jsxs)(`h4`,{className:`font-medium text-purple-800 mb-2 flex items-center gap-2`,children:[(0,W.jsx)(L,{className:`w-4 h-4`}),`WebSocket Activity`]}),(0,W.jsxs)(`div`,{className:`text-lg font-bold text-purple-600`,children:[C.wsMessages,` messages`]}),(0,W.jsxs)(`div`,{className:`text-sm text-purple-700`,children:[`Last 24h: `,C.last24h,` messages`]})]}),(0,W.jsxs)(`div`,{className:`bg-amber-50 p-4 rounded-lg`,children:[(0,W.jsx)(`h4`,{className:`font-medium text-amber-800 mb-2`,children:`Performance Score`}),(0,W.jsxs)(`div`,{className:`text-2xl font-bold text-amber-600`,children:[C.errorRate===`0`?`100`:(100-parseFloat(C.errorRate)).toFixed(0),`%`]}),(0,W.jsx)(`div`,{className:`text-sm text-amber-700`,children:`System Health`})]})]}),(0,W.jsxs)(`div`,{className:`space-y-6`,children:[(0,W.jsx)(`h4`,{className:`font-medium text-text-primary text-lg`,children:` Operation Performance Metrics`}),C.operations.fileGeneration.duration.count>0&&(0,W.jsxs)(`div`,{className:`bg-gradient-to-br from-purple-50 to-indigo-50 border border-purple-200 rounded-xl p-6`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-3 mb-4`,children:[(0,W.jsx)(`div`,{className:`w-3 h-3 bg-purple-500 rounded-full`}),(0,W.jsx)(`h5`,{className:`font-bold text-purple-900 text-lg`,children:` File Generation Performance`})]}),(0,W.jsxs)(`div`,{className:`grid grid-cols-2 md:grid-cols-4 gap-4 mb-6`,children:[(0,W.jsxs)(`div`,{className:`bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4 text-center`,children:[(0,W.jsx)(`div`,{className:`text-2xl font-bold text-purple-600`,children:C.operations.fileGeneration.linesPerSecond.avg.toFixed(1)}),(0,W.jsx)(`div`,{className:`text-sm text-purple-800`,children:`Lines/sec (avg)`})]}),(0,W.jsxs)(`div`,{className:`bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4 text-center`,children:[(0,W.jsxs)(`div`,{className:`text-2xl font-bold text-indigo-600`,children:[(C.operations.fileGeneration.charsPerSecond.avg/1e3).toFixed(1),`k`]}),(0,W.jsx)(`div`,{className:`text-sm text-indigo-800`,children:`Chars/sec (avg)`})]}),(0,W.jsxs)(`div`,{className:`bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4 text-center`,children:[(0,W.jsx)(`div`,{className:`text-2xl font-bold text-blue-600`,children:C.operations.fileGeneration.totalLines.toLocaleString()}),(0,W.jsx)(`div`,{className:`text-sm text-blue-800`,children:`Total Lines`})]}),(0,W.jsxs)(`div`,{className:`bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4 text-center`,children:[(0,W.jsx)(`div`,{className:`text-2xl font-bold text-teal-600`,children:C.operations.fileGeneration.duration.count}),(0,W.jsx)(`div`,{className:`text-sm text-teal-800`,children:`Files Generated`})]})]}),(0,W.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-3 gap-4`,children:[(0,W.jsxs)(`div`,{className:`bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4`,children:[(0,W.jsx)(`h6`,{className:`font-medium text-text-primary mb-2`,children:` Generation Speed`}),(0,W.jsxs)(`div`,{className:`space-y-1 text-sm`,children:[(0,W.jsxs)(`div`,{children:[`Avg: `,(0,W.jsxs)(`span`,{className:`font-mono font-medium`,children:[C.operations.fileGeneration.linesPerSecond.avg.toFixed(1),` lines/s`]})]}),(0,W.jsxs)(`div`,{children:[`Median: `,(0,W.jsxs)(`span`,{className:`font-mono font-medium`,children:[C.operations.fileGeneration.linesPerSecond.median.toFixed(1),` lines/s`]})]}),(0,W.jsxs)(`div`,{children:[`Peak (P99): `,(0,W.jsxs)(`span`,{className:`font-mono font-medium`,children:[C.operations.fileGeneration.linesPerSecond.p99.toFixed(1),` lines/s`]})]})]})]}),(0,W.jsxs)(`div`,{className:`bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4`,children:[(0,W.jsx)(`h6`,{className:`font-medium text-text-primary mb-2`,children:` Duration Stats`}),(0,W.jsxs)(`div`,{className:`space-y-1 text-sm`,children:[(0,W.jsxs)(`div`,{children:[`Avg: `,(0,W.jsx)(`span`,{className:`font-mono font-medium`,children:C.operations.fileGeneration.duration.avg>1e3?`${(C.operations.fileGeneration.duration.avg/1e3).toFixed(1)}s`:`${C.operations.fileGeneration.duration.avg.toFixed(0)}ms`})]}),(0,W.jsxs)(`div`,{children:[`Median: `,(0,W.jsx)(`span`,{className:`font-mono font-medium`,children:C.operations.fileGeneration.duration.median>1e3?`${(C.operations.fileGeneration.duration.median/1e3).toFixed(1)}s`:`${C.operations.fileGeneration.duration.median.toFixed(0)}ms`})]}),(0,W.jsxs)(`div`,{children:[`P99: `,(0,W.jsx)(`span`,{className:`font-mono font-medium`,children:C.operations.fileGeneration.duration.p99>1e3?`${(C.operations.fileGeneration.duration.p99/1e3).toFixed(1)}s`:`${C.operations.fileGeneration.duration.p99.toFixed(0)}ms`})]})]})]}),(0,W.jsxs)(`div`,{className:`bg-bg-4/70 dark:bg-bg-4/50 rounded-lg p-4`,children:[(0,W.jsx)(`h6`,{className:`font-medium text-text-primary mb-2`,children:` Content Volume`}),(0,W.jsxs)(`div`,{className:`space-y-1 text-sm`,children:[(0,W.jsxs)(`div`,{children:[`Total Characters: `,(0,W.jsx)(`span`,{className:`font-mono font-medium`,children:C.operations.fileGeneration.totalChars.toLocaleString()})]}),(0,W.jsxs)(`div`,{children:[`Avg File Size: `,(0,W.jsxs)(`span`,{className:`font-mono font-medium`,children:[Math.round(C.operations.fileGeneration.totalChars/C.operations.fileGeneration.duration.count).toLocaleString(),` chars`]})]}),(0,W.jsxs)(`div`,{children:[`Avg Lines/File: `,(0,W.jsx)(`span`,{className:`font-mono font-medium`,children:Math.round(C.operations.fileGeneration.totalLines/C.operations.fileGeneration.duration.count)})]})]})]})]})]}),(0,W.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-3 gap-4`,children:Object.entries(C.operations).filter(([e])=>e!==`fileGeneration`).map(([e,t])=>{let n=t,r={phaseGeneration:{icon:``,color:`green`,label:`Phase Generation`},cfDeployment:{icon:``,color:`orange`,label:`CF Deployment`},runnerDeployment:{icon:``,color:`blue`,label:`Runner Deployment`}}[e]||{icon:``,color:`gray`,label:e};return(0,W.jsxs)(`div`,{className:`bg-${r.color}-50 border border-${r.color}-200 rounded-lg p-4`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2 mb-3`,children:[(0,W.jsx)(`span`,{className:`text-lg`,children:r.icon}),(0,W.jsx)(`h5`,{className:`font-medium text-text-primary`,children:r.label})]}),n.count>0?(0,W.jsxs)(`div`,{className:`space-y-3`,children:[(0,W.jsxs)(`div`,{className:`text-center`,children:[(0,W.jsx)(`div`,{className:`text-2xl font-bold text-${r.color}-600`,children:n.avg>1e3?`${(n.avg/1e3).toFixed(1)}s`:`${n.avg.toFixed(0)}ms`}),(0,W.jsx)(`div`,{className:`text-sm text-${r.color}-800`,children:`Average Duration`})]}),(0,W.jsxs)(`div`,{className:`grid grid-cols-2 gap-2 text-xs`,children:[(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`div`,{className:`text-text-tertiary`,children:`Median`}),(0,W.jsx)(`div`,{className:`font-mono font-medium`,children:n.median>1e3?`${(n.median/1e3).toFixed(1)}s`:`${n.median.toFixed(0)}ms`})]}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`div`,{className:`text-text-tertiary`,children:`P99`}),(0,W.jsx)(`div`,{className:`font-mono font-medium`,children:n.p99>1e3?`${(n.p99/1e3).toFixed(1)}s`:`${n.p99.toFixed(0)}ms`})]})]}),(0,W.jsx)(`div`,{className:`pt-2 border-t border-border-primary text-center`,children:(0,W.jsxs)(`div`,{className:`text-text-tertiary text-sm`,children:[n.count,` operations`]})})]}):(0,W.jsx)(`div`,{className:`text-text-tertiary text-sm text-center py-4`,children:`No operations recorded`})]},e)})})]})]}):(0,W.jsxs)(`div`,{className:`text-center py-12 text-text-tertiary`,children:[(0,W.jsx)(L,{className:`w-12 h-12 mx-auto mb-4 opacity-30`}),(0,W.jsx)(`p`,{className:`text-sm`,children:`Analytics loading...`})]}),y.size>0&&(0,W.jsxs)(`div`,{className:`bg-amber-50 p-4 rounded-lg`,children:[(0,W.jsxs)(`h4`,{className:`font-medium text-amber-800 mb-3 flex items-center gap-2`,children:[(0,W.jsx)(T,{className:`w-4 h-4`}),`Bookmarked Messages`]}),(0,W.jsxs)(`div`,{className:`space-y-2`,children:[e.filter(e=>y.has(e.id)).slice(0,5).map(e=>(0,W.jsxs)(`div`,{className:`text-sm text-amber-700 truncate`,children:[(0,W.jsx)(un,{className:`w-3 h-3 inline mr-1`}),new Date(e.timestamp).toLocaleTimeString(),`: `,e.message]},e.id)),y.size>5&&(0,W.jsxs)(`div`,{className:`text-xs text-amber-600`,children:[`+`,y.size-5,` more...`]})]})]})]}):_===`timeline`?(0,W.jsx)(`div`,{className:`p-4`,children:w&&w.events.length>0?(0,W.jsxs)(`div`,{className:`space-y-6`,children:[(0,W.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,W.jsxs)(`h4`,{className:`font-medium text-text-primary flex items-center gap-2`,children:[(0,W.jsx)(be,{className:`w-4 h-4`}),`Message Timeline (`,w.events.length,` events)`]}),(0,W.jsxs)(`div`,{className:`text-sm text-text-tertiary`,children:[`Duration: `,(w.events[w.events.length-1]?.timestamp||0)-(w.events[0]?.timestamp||0)>1e3?`${(((w.events[w.events.length-1]?.timestamp||0)-(w.events[0]?.timestamp||0))/1e3).toFixed(1)}s`:`${((w.events[w.events.length-1]?.timestamp||0)-(w.events[0]?.timestamp||0)).toFixed(0)}ms`]})]}),(0,W.jsx)(`div`,{className:`flex flex-wrap gap-2 mb-4`,children:w.lanes.map(e=>(0,W.jsx)(`div`,{className:`px-3 py-1 rounded text-xs font-medium ${e.color}`,children:e.label},e.id))}),(0,W.jsxs)(`div`,{className:`relative`,children:[(0,W.jsx)(`div`,{className:`absolute left-4 top-0 bottom-0 w-0.5 bg-border`}),(0,W.jsx)(`div`,{className:`space-y-4`,children:w.events.map((e,t)=>{let n=w.lanes.find(t=>t.id===e.category)||w.lanes[4],r=t>0?e.timestamp-w.events[0].timestamp:0;return(0,W.jsxs)(`div`,{className:`relative flex items-start`,children:[(0,W.jsx)(`div`,{className:`relative z-10 flex items-center justify-center w-8 h-8 rounded-full border-2 ${n.color} ${e.isBookmarked?`ring-2 ring-amber-400`:``}`,children:e.type===`error`?(0,W.jsx)(`div`,{className:`w-3 h-3 bg-red-500 rounded-full`}):e.type===`warning`?(0,W.jsx)(`div`,{className:`w-3 h-3 bg-yellow-500 rounded-full`}):e.type===`websocket`?(0,W.jsx)(`div`,{className:`w-3 h-3 bg-purple-500 rounded-full`}):(0,W.jsx)(`div`,{className:`w-3 h-3 bg-blue-500 rounded-full`})}),(0,W.jsxs)(`div`,{className:`ml-4 flex-1 min-w-0`,children:[(0,W.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(`span`,{className:`px-2 py-1 text-xs font-medium rounded ${n.color}`,children:n.label}),e.messageType&&(0,W.jsx)(`span`,{className:`px-2 py-1 text-xs bg-bg-3 text-text-tertiary rounded font-mono`,children:e.messageType}),e.isBookmarked&&(0,W.jsx)(T,{className:`w-3 h-3 text-amber-500 fill-current`})]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2 text-xs text-text-tertiary`,children:[(0,W.jsxs)(`span`,{children:[`+`,r>1e3?`${(r/1e3).toFixed(1)}s`:`${r.toFixed(0)}ms`]}),(0,W.jsx)(`span`,{children:new Date(e.timestamp).toLocaleTimeString()})]})]}),(0,W.jsx)(`div`,{className:`mt-2 text-sm text-text-primary truncate`,title:e.message,children:e.message}),e.duration>0&&(0,W.jsxs)(`div`,{className:`mt-1 text-xs text-text-tertiary`,children:[`Duration: `,e.duration>1e3?`${(e.duration/1e3).toFixed(1)}s`:`${e.duration.toFixed(0)}ms`]})]})]},e.id)})})]})]}):(0,W.jsxs)(`div`,{className:`text-center py-12 text-text-tertiary`,children:[(0,W.jsx)(be,{className:`w-12 h-12 mx-auto mb-4 opacity-30`}),(0,W.jsx)(`p`,{className:`text-sm`,children:`No timeline events to display`}),(0,W.jsx)(`p`,{className:`text-xs text-text-tertiary/70 mt-2`,children:`Messages will appear here as they are logged`})]})}):(0,W.jsx)(`div`,{className:`p-4 space-y-3`,children:k.length===0?(0,W.jsxs)(`div`,{className:`text-center py-12 text-text-tertiary`,children:[(0,W.jsx)(Ce,{className:`w-12 h-12 mx-auto mb-4 opacity-30`}),(0,W.jsx)(`p`,{className:`text-sm`,children:`No messages match your filters`})]}):k.slice().reverse().map(e=>{let t=s.has(e.id);return(0,W.jsxs)(`div`,{className:`border-l-4 rounded-r-lg p-3 pr-10 transition-all relative ${e.type===`error`?`border-red-500 bg-red-50 dark:bg-red-900/20 dark:border-red-400`:e.type===`warning`?`border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-400`:e.type===`websocket`?`border-purple-500 bg-purple-50 dark:bg-purple-900/20 dark:border-purple-400`:`border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-400`} ${y.has(e.id)?`ring-2 ring-amber-300`:``}`,children:[(0,W.jsx)(`button`,{onClick:()=>E(e.id),className:`absolute top-2 right-2 p-1 rounded transition-all ${y.has(e.id)?`text-amber-500 hover:text-amber-600`:`text-text-tertiary hover:text-amber-500`}`,title:y.has(e.id)?`Remove bookmark`:`Add bookmark`,children:y.has(e.id)?(0,W.jsx)(T,{className:`w-4 h-4 fill-current`}):(0,W.jsx)(Ot,{className:`w-4 h-4`})}),(0,W.jsxs)(`div`,{className:`flex items-start justify-between gap-2 mb-2 pr-6`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(`span`,{className:`font-medium text-sm capitalize`,children:e.type}),e.messageType&&(0,W.jsx)(`span`,{className:`text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full font-mono dark:bg-purple-900/40 dark:text-purple-200 dark:border dark:border-purple-800`,children:e.messageType})]}),(0,W.jsx)(`span`,{className:`text-xs text-text-tertiary`,children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,W.jsx)(`div`,{className:`text-sm text-text-primary mb-2`,children:e.message}),e.details&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`button`,{onClick:()=>A(e.id),className:`text-xs text-blue-600 hover:text-blue-800 underline`,children:t?`Hide details`:`Show details`}),t&&(0,W.jsx)(`pre`,{className:`mt-2 text-xs bg-bg-3 dark:bg-zinc-900 p-2 rounded overflow-x-auto text-text-tertiary whitespace-pre-wrap max-h-40`,children:e.details})]})]},e.id)})})})]}),r&&(0,W.jsx)(`div`,{className:`fixed inset-0 z-30 transition-all duration-300 backdrop-blur-sm bg-black/10`,onClick:()=>i(!1),style:{backdropFilter:`blur(8px) saturate(180%)`,WebkitBackdropFilter:`blur(8px) saturate(180%)`}})]})}function ro(e){return(0,W.jsx)(to,{children:(0,W.jsx)(no,{...e})})}var Y=function(e){return e.WAITING_PHASE1=`waiting_phase1`,e.READY_TO_DEPLOY=`ready_to_deploy`,e.DEPLOYING=`deploying`,e.DEPLOYED=`deployed`,e.REDEPLOYING=`redeploying`,e.ERROR=`error`,e}(Y||{});function io({isPhase1Complete:e,isDeploying:t,deploymentUrl:n,instanceId:r,isRedeployReady:i,deploymentError:a,appId:o,appVisibility:s=`private`,onDeploy:l,onVisibilityUpdate:u}){let[d,f]=(0,H.useState)(!1),[p,m]=(0,H.useState)(`Copy`),[h,g]=(0,H.useState)(`Copy Link`),[v,y]=(0,H.useState)(!1),[b,x]=(0,H.useState)(s),S=(0,H.useRef)(null);(0,H.useEffect)(()=>{t||f(!1)},[t]),(0,H.useEffect)(()=>{x(s)},[s]);let C=(()=>a&&!t?Y.ERROR:t?n?Y.REDEPLOYING:Y.DEPLOYING:n&&!t?Y.DEPLOYED:e?Y.READY_TO_DEPLOY:Y.WAITING_PHASE1)(),w=()=>{f(!0),S.current&&S.current.scrollIntoView({behavior:`smooth`,block:`center`}),l(r)},T=async()=>{if(!o){_.error(`App ID not found`);return}try{y(!0);let e=b===`private`?`public`:`private`,t=await U.updateAppVisibility(o,e);if(t.success&&t.data)x(e),u?.(e),e===`public`?_.success(` Your app is now public! Share the link with anyone.`):_.success(`App is now private`);else throw Error(t.error?.message||`Failed to update visibility`)}catch(e){console.error(`Error updating app visibility:`,e),_.error(`Failed to update visibility`)}finally{y(!1)}},E=t=>{switch(t){case Y.WAITING_PHASE1:return{panelClass:`bg-bg-3/30 dark:bg-bg-3/20 border-border-primary/50 dark:border-border-primary/40`,iconClass:`bg-bg-3-foreground/40 dark:bg-bg-3-foreground/30 border-muted-foreground/40 dark:border-muted-foreground/30`,icon:null,titleColor:`text-text-tertiary dark:text-text-tertiary`,subtitleColor:`text-text-tertiary/80 dark:text-text-tertiary/70`,title:`Deploy to Cloudflare`,subtitle:`Deploy will be enabled after Phase 1 is implemented`,buttonDisabled:!0,buttonVariant:`secondary`,buttonClass:`bg-bg-3 dark:bg-bg-3 text-text-tertiary dark:text-text-tertiary border-muted dark:border-muted cursor-not-allowed`};case Y.READY_TO_DEPLOY:return{panelClass:`bg-accent/5 dark:bg-accent/10 border-accent/20 dark:border-accent/20`,iconClass:`bg-accent border-accent`,icon:(0,W.jsx)(Rt,{className:`w-2.5 h-2.5 text-white`}),titleColor:`text-text-primary dark:text-text-primary`,subtitleColor:`text-text-tertiary dark:text-text-tertiary`,title:`Ready to Deploy`,subtitle:`It's Free! Deploys to Cloudflare Workers for Platform`,buttonDisabled:!1,buttonVariant:`primary`,buttonClass:`bg-accent text-white border-orange-500 dark:border-orange-600 hover:scale-105`};case Y.DEPLOYING:return{panelClass:`bg-blue-50/40 dark:bg-blue-950/20 border-blue-200/60 dark:border-blue-800/30 shadow-sm dark:shadow-blue-900/20`,iconClass:`bg-blue-500 dark:bg-blue-600 border-blue-500 dark:border-blue-600 animate-pulse`,icon:(0,W.jsx)(Oe,{className:`w-2.5 h-2.5 text-white animate-spin`}),titleColor:`text-blue-900 dark:text-blue-100`,subtitleColor:`text-blue-600 dark:text-blue-300`,title:`Deploying to Cloudflare`,subtitle:`Please wait while your application is being deployed...`,buttonDisabled:!0,buttonVariant:`primary`,buttonClass:`bg-blue-500 hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700 text-white border-blue-500 dark:border-blue-600 scale-105 shadow-lg dark:shadow-blue-900/50`};case Y.REDEPLOYING:return{panelClass:`bg-blue-50/40 dark:bg-blue-950/20 border-blue-200/60 dark:border-blue-800/30 shadow-sm dark:shadow-blue-900/20`,iconClass:`bg-blue-500 dark:bg-blue-600 border-blue-500 dark:border-blue-600 animate-pulse`,icon:(0,W.jsx)(Oe,{className:`w-2.5 h-2.5 text-white animate-spin`}),titleColor:`text-blue-900 dark:text-blue-100`,subtitleColor:`text-blue-600 dark:text-blue-300`,title:`Redeploying to Cloudflare`,subtitle:`Please wait while your application is being redeployed...`,buttonDisabled:!0,buttonVariant:`primary`,buttonClass:`bg-blue-500 hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700 text-white border-blue-500 dark:border-blue-600 scale-105 shadow-lg dark:shadow-blue-900/50`};case Y.ERROR:return{panelClass:`bg-red-50/40 dark:bg-red-950/20 border-red-200/60 dark:border-red-800/30 shadow-sm dark:shadow-red-900/20`,iconClass:`bg-red-500 dark:bg-red-600 border-red-500 dark:border-red-600`,icon:(0,W.jsx)(`svg`,{className:`w-2.5 h-2.5 text-white`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,xmlns:`http://www.w3.org/2000/svg`,children:(0,W.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:`2`,d:`M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z`})}),titleColor:`text-red-900 dark:text-red-100`,subtitleColor:`text-red-600 dark:text-red-300`,title:` Deployment Failed`,subtitle:`Error in deployment, please try again`,buttonDisabled:!e,buttonVariant:`primary`,buttonClass:e?`bg-orange-500 hover:bg-orange-600 dark:bg-orange-600 dark:hover:bg-orange-700 text-white border-orange-500 dark:border-orange-600 hover:scale-105`:`bg-bg-3 dark:bg-bg-3 text-text-tertiary dark:text-text-tertiary border-muted dark:border-muted cursor-not-allowed`};default:return E(Y.WAITING_PHASE1)}},D=E(C),O=C===Y.DEPLOYING||C===Y.REDEPLOYING;return(0,W.jsxs)(`div`,{className:`space-y-3 deployment-controls`,children:[C!==Y.DEPLOYED&&(0,W.jsx)(`div`,{ref:S,className:c(`border rounded-lg p-3 transition-all duration-500 mt-2`,D.panelClass),children:(0,W.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,W.jsx)(`div`,{className:c(`flex-shrink-0 w-4 h-4 rounded border-2 flex items-center justify-center transition-all duration-500`,D.iconClass),children:D.icon}),(0,W.jsxs)(`div`,{className:`flex-1`,children:[(0,W.jsx)(`div`,{className:c(`text-sm font-medium transition-colors duration-300`,D.titleColor),children:D.title}),(0,W.jsx)(`div`,{className:c(`text-xs mt-0.5 transition-colors duration-300`,D.subtitleColor),children:D.subtitle})]}),(0,W.jsx)(Za,{onClick:w,disabled:D.buttonDisabled||O||d,className:c(`h-8 px-4 text-sm font-medium transition-all duration-300 transform`,D.buttonClass),children:O?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Oe,{className:`w-4 h-4 mr-2 animate-spin`}),C===Y.REDEPLOYING?`Redeploying...`:`Deploying...`]}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Rt,{className:`w-4 h-4 mr-2`}),`Deploy to Cloudflare`]})})]})}),C===Y.DEPLOYED&&(0,W.jsxs)(`div`,{ref:S,className:`border rounded-lg p-4 bg-gradient-to-r from-green-50/40 to-emerald-50/40 dark:from-green-950/20 dark:to-emerald-950/20 border-green-200/60 dark:border-green-800/30 transition-all duration-700 mt-2 animate-in slide-in-from-top-2 shadow-sm dark:shadow-green-900/20`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-3 mb-3`,children:[(0,W.jsx)(`div`,{className:`flex-shrink-0 w-5 h-5 bg-green-500 border-2 border-green-500 rounded-full flex items-center justify-center animate-in zoom-in-50 duration-500`,children:(0,W.jsx)(Ie,{className:`w-3 h-3 text-white`})}),(0,W.jsxs)(`div`,{className:`flex-1`,children:[(0,W.jsx)(`div`,{className:`text-sm font-semibold text-green-900 dark:text-green-100`,children:` Successfully Deployed!`}),(0,W.jsx)(`div`,{className:`text-xs text-green-700 dark:text-green-300 mt-0.5`,children:`Your application is now live on Cloudflare Workers`})]})]}),(0,W.jsxs)(`div`,{className:`bg-bg-3/60 dark:bg-bg-4/60 border border-green-200/40 dark:border-green-800/20 rounded-md p-3 mb-3`,children:[(0,W.jsx)(`div`,{className:`text-xs text-green-600 dark:text-green-400 font-medium mb-1`,children:`Live URL:`}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(`code`,{className:`flex-1 text-sm font-mono text-green-800 dark:text-green-200 bg-green-50/50 dark:bg-green-950/30 px-2 py-1 rounded text-ellipsis overflow-hidden`,children:n}),(0,W.jsx)(Za,{onClick:async()=>{n&&(await navigator.clipboard.writeText(n),m(`Copied!`),setTimeout(()=>m(`Copy`),2e3))},variant:`secondary`,className:`h-7 px-2 text-xs bg-bg-3 dark:bg-bg-4 border border-green-300 dark:border-green-300/50 text-green-700 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-950 hover:border-green-400 transition-all flex-shrink-0`,children:p})]})]}),b===`public`&&o&&(0,W.jsxs)(`div`,{className:`bg-accent/5 border border-accent/20 rounded-md p-3 mb-3`,children:[(0,W.jsxs)(`div`,{className:`text-xs text-accent font-medium mb-1 flex items-center gap-1`,children:[(0,W.jsx)(kt,{className:`w-3 h-3`}),`Shareable Link:`]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsxs)(`code`,{className:`flex-1 text-sm font-mono text-accent bg-accent/5 px-2 py-1 rounded text-ellipsis overflow-hidden`,children:[window.location.origin,`/app/`,o]}),(0,W.jsx)(Za,{onClick:async()=>{let e=`${window.location.origin}/app/${o}`;await navigator.clipboard.writeText(e),g(`Copied!`),setTimeout(()=>g(`Copy Link`),2e3)},variant:`secondary`,className:`h-7 px-2 text-xs bg-accent/10 border border-accent/30 text-accent hover:bg-accent/20 transition-all flex-shrink-0`,children:h})]})]}),(0,W.jsxs)(`div`,{className:c(`grid gap-3`,i?`grid-cols-3`:`grid-cols-2`),children:[(0,W.jsxs)(Za,{onClick:()=>n&&window.open(n,`_blank`),variant:`primary`,className:`h-10 text-sm bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 text-white border-green-600 dark:border-green-700 font-medium shadow-sm hover:shadow-md dark:hover:shadow-green-900/50 transition-all duration-200 hover:scale-[1.02]`,children:[(0,W.jsx)(ct,{className:`w-4 h-4 mr-2`}),`View Live`]}),o&&(0,W.jsx)(Za,{onClick:T,disabled:v,variant:`secondary`,className:c(`h-10 text-sm font-medium transition-all duration-200 shadow-sm`,b===`private`?`bg-accent hover:bg-accent/90 text-white border-accent hover:shadow-md hover:scale-[1.02]`:`bg-bg-3 hover:bg-bg-4 text-text-primary border-border-primary hover:shadow-sm hover:scale-[1.02]`),children:v?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Oe,{className:`w-4 h-4 mr-2 animate-spin`}),`Updating...`]}):b===`private`?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Zt,{className:`w-4 h-4 mr-2`}),`Make Public`]}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(qe,{className:`w-4 h-4 mr-2`}),`Make Private`]})}),i&&(0,W.jsx)(Za,{onClick:w,disabled:t||d,variant:`secondary`,className:c(`h-10 text-sm font-medium transition-all duration-200 shadow-sm`,t?`bg-bg-3 dark:bg-bg-3 text-text-tertiary dark:text-text-tertiary border-muted dark:border-muted cursor-not-allowed`:`bg-blue-500 hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700 text-white border-blue-500 dark:border-blue-600 hover:shadow-md dark:hover:shadow-blue-900/50 hover:scale-[1.02]`),children:t?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Oe,{className:`w-4 h-4 mr-2 animate-spin`}),`Redeploying...`]}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Rt,{className:`w-4 h-4 mr-2`}),`Redeploy`]})})]})]})]})}async function*ao(e){let t=e.body.getReader(),n=new TextDecoder,r=``;for(;;){let{done:e,value:i}=await t.read();if(e)break;r+=n.decode(i,{stream:!0});let a=r.split(`
`);r=a.pop()??``;for(let e of a)e.trim()&&(yield JSON.parse(e))}r.trim()&&(yield JSON.parse(r))}function oo(){let e=``,t=e=>{try{return JSON.parse(e)}catch{}};function n(e){let t=[],n=!1,r=!1;for(let i=0;i<e.length;i++){let a=e[i];if(n){if(r){r=!1,t.push(a);continue}if(a===`\\`){r=!0,t.push(a);continue}if(a===`"`){n=!1,t.push(a);continue}if(a===`,`){let r=i+1;for(;r<e.length&&/\s/.test(e[r]);)r++;let a=e[r]||``;if(a===`"`||a===`}`||a===`]`){t.push(`"`),n=!1,i--;continue}}t.push(a);continue}a===`"`&&(n=!0),t.push(a)}return n&&t.push(`"`),t.join(``)}let r=e=>e.replace(/,\s*([}\]])/g,`$1`);function i(e){let t=!1,n=!1,r=0,i=0;for(let a of e){if(t){n?n=!1:a===`\\`?n=!0:a===`"`&&(t=!1);continue}a===`"`?t=!0:a===`{`?r++:a===`}`?r--:a===`[`?i++:a===`]`&&i--}return e+`]`.repeat(Math.max(0,i))+`}`.repeat(Math.max(0,r))}function a(e){return e=e.replace(/([{,]\s*)"([^"\\]*(?:\\.[^"\\]*)*)"\s*}(?=,?\s*[\]}]|$)/g,(e,t,n)=>`${t}"${n}": ""}`),e=e.replace(/"([^"\\]*(?:\\.[^"\\]*)*)"\s*:\s*(?=[}\],]|$)/g,`"$1": ""`),e=e.replace(/"([^"\\]*(?:\\.[^"\\]*)*)"\s*$/g,`"$1": ""`),e}return{feed(t){e+=t},finalize(){let o=e,s=t(o);if(s||(o=n(o),s=t(o),s)||(o=r(o),s=t(o),s)||(o=i(o),s=t(o),s)||(o=a(o),s=t(o),s))return s;throw Error(`createRepairingJSONParser: unable to repair JSON`)}}}const so=e=>{if(!e||typeof e!=`string`)return`plaintext`;switch(e.split(`.`).pop()){case`ts`:case`tsx`:return`typescript`;case`js`:case`jsx`:return`javascript`;case`css`:return`css`;case`html`:return`html`;case`json`:return`json`;default:return`plaintext`}},X=new class e{static#e=this.levels={debug:0,info:1,warn:2,error:3};constructor(e={}){this.level=e.level??`info`,this.prefix=e.prefix??``,this.enabled=e.enabled??!0}shouldLog(t){return this.enabled&&e.levels[t]>=e.levels[this.level]}formatMessage(e,t){return[this.prefix?`[${this.prefix}]`:``,...t]}debug(...e){this.shouldLog(`debug`)&&console.debug(...this.formatMessage(`debug`,e))}info(...e){this.shouldLog(`info`)&&console.info(...this.formatMessage(`info`,e))}warn(...e){this.shouldLog(`warn`)&&console.warn(...this.formatMessage(`warn`,e))}error(...e){this.shouldLog(`error`)&&console.error(...this.formatMessage(`error`,e))}setLevel(e){this.level=e}enable(){this.enabled=!0}disable(){this.enabled=!1}}({level:`info`});function co(e,t,n){let r=e.findIndex(e=>e.filePath===t);return r>=0?e.map((e,t)=>t===r?{...e,...n}:e):[...e,{filePath:t,fileContents:``,isGenerating:!1,needsFixing:!1,hasErrors:!1,language:so(t),...n}]}function lo(e,t,n,r){let i=[...e];for(let e=i.length-1;e>=0;e--){let a=i[e];if(a.status===`completed`&&n!==`completed`)continue;let o=a.files.find(e=>e.path===t);if(o){o.status=n,r!==void 0&&(o.contents=r),console.log(`File ${n} in phase ${a.name}: ${t}`);break}}return i}function uo(e,t,n){return co(e,t,{filePath:t,fileContents:``,explanation:n||``,isGenerating:!0,needsFixing:!1,hasErrors:!1,language:so(t)})}function fo(e,t,n){return e.find(e=>e.filePath===t)?e.map(e=>e.filePath===t?{...e,fileContents:e.fileContents+n}:e):[...e,{filePath:t,fileContents:n,explanation:``,isGenerating:!0,needsFixing:!1,hasErrors:!1,language:so(t)}]}function po(e,t,n){return co(e,t,{fileContents:n,isGenerating:!1,needsFixing:!1,hasErrors:!1})}function mo(e){return e.map(e=>({...e,isGenerating:!1,needsFixing:!1,hasErrors:!1}))}function ho(){return crypto.randomUUID()}function go(e){return[`main`,`creating-blueprint`,`conversation_response`,`fetching-chat`,`chat-not-found`,`resuming-chat`,`chat-welcome`,`deployment-status`,`code_reviewed`].includes(e)||e.startsWith(`conv-`)}function Z(e,t,n){return{role:`assistant`,conversationId:e,content:t,ui:{isThinking:n}}}function _o(e){return{role:`user`,conversationId:ho(),content:e}}function vo(e,t){let n=e.message;return e.suggestions&&e.suggestions.length>0&&(n+=`\n\n Suggestions:\n${e.suggestions.map(e=>` ${e}`).join(`
`)}`),_.error(n),t?.(`error`,`Rate Limit: ${e.limitType.replace(`_`,` `)} limit exceeded`,`Limit: ${e.limit} per ${Math.floor((e.period||0)/3600)}h\nRetry after: ${(e.period||0)/3600}h\n\nSuggestions:\n${e.suggestions?.join(`
`)||`None`}`,`Rate Limiting`,e.limitType,e),Z(`rate_limit_${Date.now()}`,` ${n}`)}function yo(e,t){if(t.conversationId===`main`){let n=e.findIndex(e=>e.conversationId===`main`&&e.ui?.isThinking);if(n!==-1)return e.map((e,r)=>r===n?{...e,...t}:e)}return[...e,t]}function bo(e,t,n,r){let i=e.findIndex(e=>e.conversationId===t&&e.role===`assistant`);return i!==-1&&!r?e.map((e,t)=>t===i?{...e,content:e.content+n}:e):[...e,Z(t,n,!1)]}function xo(e,t,n){let r=e.findIndex(e=>e.conversationId===t&&e.role===`assistant`),i=Date.now();if(r===-1){let r={role:`assistant`,conversationId:t,content:``,ui:{toolEvents:[{name:n.name,status:n.status,timestamp:i}]}};return[...e,r]}return e.map((e,t)=>{if(t!==r)return e;let a=e.ui?.toolEvents??[];if(n.status===`success`){for(let t=a.length-1;t>=0;t--)if(a[t].name===n.name)return{...e,ui:{...e.ui,toolEvents:a.map((e,n)=>n===t?{...e,status:`success`,timestamp:i}:e)}};return{...e,ui:{...e.ui,toolEvents:[...a,{name:n.name,status:`success`,timestamp:i}]}}}return{...e,ui:{...e.ui,toolEvents:[...a,{name:n.name,status:n.status,timestamp:i}]}}})}const So=[{id:`bootstrap`,title:`Bootstrapping project`,status:`active`},{id:`blueprint`,title:`Generating Blueprint`,status:`pending`},{id:`code`,title:`Generating code`,status:`pending`},{id:`validate`,title:`Reviewing & fixing code`,status:`pending`},{id:`fix`,title:`Fixing issues`,status:`pending`}];function Co(e,t,n){return e.map(e=>e.id===t?{...e,...n}:e)}function wo(e,t){return e.map(e=>t.includes(e.id)?{...e,status:`completed`}:e)}function To(e){return!!e&&e.readyState===1}function Eo(e,t,n){return To(e)?(e.send(JSON.stringify({type:t,...n})),!0):(console.warn(`WebSocket not ready for message type: ${t}`),!1)}function Do(e){let t=e=>e?typeof e==`string`?e:Array.isArray(e)?e.map(e=>e&&`type`in e&&e.type===`text`?e.text:``).join(` `).trim():``:``;return(n,r)=>{let{setFiles:i,setPhaseTimeline:a,setProjectStages:o,setMessages:s,setBlueprint:c,setQuery:l,setPreviewUrl:u,setTotalFiles:d,setIsRedeployReady:f,setIsPreviewDeploying:p,setIsThinking:m,setIsInitialStateRestored:h,setShouldRefreshPreview:g,setIsDeploying:v,setCloudflareDeploymentUrl:y,setDeploymentError:b,setIsGenerationPaused:x,setIsGenerating:S,setIsPhaseProgressActive:C,isInitialStateRestored:w,blueprint:T,query:E,bootstrapFiles:D,files:O,phaseTimeline:k,previewUrl:A,projectStages:j,isGenerating:M,urlChatId:N,updateStage:P,sendMessage:F,loadBootstrapFiles:I,onDebugMessage:L,onTerminalMessage:R}=e;switch(r.type!==`file_chunk_generated`&&r.type!==`cf_agent_state`&&r.type.length<=50&&(X.info(`received message`,r.type,r),L?.(`websocket`,`${r.type}`,JSON.stringify(r,null,2),`WebSocket`,r.type,r)),r.type){case`cf_agent_state`:{let{state:e}=r;X.debug(` Agent state update received:`,e),w||(X.debug(` Performing initial state restoration`),e.blueprint&&!T&&(c(e.blueprint),P(`blueprint`,{status:`completed`})),e.query&&!E&&l(e.query),e.templateDetails?.files&&D.length===0&&I(e.templateDetails.files),e.generatedFilesMap&&O.length===0&&i(Object.values(e.generatedFilesMap).map(e=>({filePath:e.filePath,fileContents:e.fileContents,isGenerating:!1,needsFixing:!1,hasErrors:!1,language:so(e.filePath)}))),e.generatedPhases&&e.generatedPhases.length>0&&k.length===0&&(X.debug(` Restoring phase timeline:`,e.generatedPhases),a(e.generatedPhases.map((t,n)=>({id:`phase-${n}`,name:t.name,description:t.description,status:t.completed?`completed`:`generating`,files:t.files.map(t=>{let n=e.generatedFilesMap?.[t.path];return{path:t.path,purpose:t.purpose,status:n?`completed`:`generating`,contents:n?.fileContents}}),timestamp:Date.now()})))),P(`bootstrap`,{status:`completed`}),e.blueprint&&P(`blueprint`,{status:`completed`}),e.generatedFilesMap&&Object.keys(e.generatedFilesMap).length>0&&(P(`code`,{status:`completed`}),P(`validate`,{status:`completed`})),h(!0),e.generatedFilesMap&&Object.keys(e.generatedFilesMap).length>0&&N!==`new`&&(X.debug(` Requesting preview deployment for existing chat with files`),Eo(n,`preview`))),e.shouldBeGenerating?(X.debug(` shouldBeGenerating=true detected, auto-resuming generation`),P(`code`,{status:`active`}),X.debug(` Sending auto-resume generate_all message`),Eo(n,`generate_all`)):j.find(e=>e.id===`code`)?.status===`active`&&!M&&e.generatedFilesMap&&Object.keys(e.generatedFilesMap).length>0&&(P(`code`,{status:`completed`}),P(`validate`,{status:`completed`}),A||(X.debug(` Generated files exist but no preview URL - auto-deploying preview`),Eo(n,`preview`))),X.debug(` Agent state update processed`);break}case`conversation_state`:{let{state:e}=r,n=e?.runningHistory??[];X.debug(`Received conversation_state with messages:`,n.length);let i=n.reduce((e,n)=>{if(n.role!==`user`&&n.role!==`assistant`)return e;let r=t(n.content);if(!r||r.includes(`<Internal Memo>`))return e;let i=n.conversationId,a=n.role===`assistant`&&i.startsWith(`archive-`);return e.push({role:n.role,conversationId:i,content:a?`previous history was compacted`:r}),e},[]);i.length>0&&(X.debug(`Replacing messages with conversation_state history:`,i.length),s(i));break}case`file_generating`:i(e=>uo(e,r.filePath));break;case`file_chunk_generated`:i(e=>fo(e,r.filePath,r.chunk));break;case`file_generated`:i(e=>po(e,r.file.filePath,r.file.fileContents)),a(e=>lo(e,r.file.filePath,`completed`,r.file.fileContents));break;case`file_regenerated`:f(!0),i(e=>po(e,r.file.filePath,r.file.fileContents)),a(e=>lo(e,r.file.filePath,`completed`,r.file.fileContents));break;case`file_regenerating`:i(e=>uo(e,r.filePath,`File being regenerated...`)),a(e=>lo(e,r.filePath,`generating`));break;case`generation_started`:P(`code`,{status:`active`}),d(r.totalFiles);break;case`generation_complete`:f(!0),i(e=>mo(e)),o(e=>wo(e,[`code`,`validate`,`fix`])),F(Z(`generation-complete`,`Code generation has been completed.`)),C(!1);break;case`deployment_started`:p(!0);break;case`deployment_completed`:p(!1),u(tr(r.previewURL,r.tunnelURL));break;case`deployment_failed`:_.error(`Error: ${r.message}`);break;case`code_reviewed`:{let e=r.review,t=e?.filesToFix?.reduce((e,t)=>e+t.issues.length,0)||0,n=`Code review complete`;n=e?.issuesFound?`Code review complete - ${t} issue${t===1?``:`s`} found across ${e.filesToFix?.length||0} file${e.filesToFix?.length===1?``:`s`}`:`Code review complete - no issues found`,F(Z(`code_reviewed`,n));break}case`runtime_error_found`:X.info(`Runtime error found in sandbox`,r.errors),L?.(`error`,`Runtime Error (${r.count} errors)`,r.errors.map(e=>`${e.message}\nStack: ${e.stack||`N/A`}`).join(`

`),`Runtime Detection`);break;case`code_reviewing`:{let e=(r.staticAnalysis?.lint?.issues?.length||0)+(r.staticAnalysis?.typecheck?.issues?.length||0)+(r.runtimeErrors.length||0);if(P(`validate`,{status:`active`}),e>0){P(`fix`,{status:`active`,metadata:`Fixing ${e} issues`});let t=[`Lint Issues: ${JSON.stringify(r.staticAnalysis?.lint?.issues)}`,`Type Errors: ${JSON.stringify(r.staticAnalysis?.typecheck?.issues)}`,`Runtime Errors: ${JSON.stringify(r.runtimeErrors)}`,`Client Errors: ${JSON.stringify(r.clientErrors)}`].filter(Boolean).join(`
`);L?.(`warning`,`Generation Issues Found (${e} total)`,t,`Code Generation`)}break}case`phase_generating`:P(`validate`,{status:`completed`}),P(`fix`,{status:`completed`}),F(Z(`phase_generating`,r.message)),m(!0),C(!0);break;case`phase_generated`:F(Z(`phase_generated`,r.message)),m(!1),C(!1);break;case`phase_implementing`:F(Z(`phase_implementing`,r.message)),P(`code`,{status:`active`}),r.phase&&a(e=>{if(e.find(e=>e.name===r.phase.name))return X.debug(`Phase already exists in timeline:`,r.phase.name),e;let t={id:`${r.phase.name}-${Date.now()}`,name:r.phase.name,description:r.phase.description,files:r.phase.files?.map(e=>({path:e.path,purpose:e.purpose,status:`generating`}))||[],status:`generating`,timestamp:Date.now()};return X.debug(`Added new phase to timeline:`,r.phase.name),[...e,t]});break;case`phase_validating`:F(Z(`phase_validating`,r.message)),P(`validate`,{status:`active`}),a(e=>{let t=[...e];if(t.length>0){let e=t[t.length-1];e.status=`validating`,X.debug(`Phase validating: ${e.name}`)}return t}),p(!1),C(!1);break;case`phase_validated`:F(Z(`phase_validated`,r.message)),P(`validate`,{status:`completed`});break;case`phase_implemented`:F(Z(`phase_implemented`,r.message)),P(`code`,{status:`completed`}),f(!0),C(!1),r.phase&&a(e=>{let t=[...e];if(t.length>0){let e=t[t.length-1];e.status=`completed`,e.files=e.files.map(e=>({...e,status:`completed`})),X.debug(`Phase completed: ${e.name}`)}return t}),X.debug(` Scheduling preview refresh in 1 second after deployment completion`),setTimeout(()=>{X.debug(` Triggering preview refresh after deployment completion`),g(!0),setTimeout(()=>{g(!1)},100),L?.(`info`,`Preview Auto-Refresh Triggered`,`Preview refreshed 1 second after deployment completion`,`Preview Auto-Refresh`)},1e3);break;case`generation_stopped`:S(!1),x(!0),F(Z(`generation_stopped`,r.message));break;case`generation_resumed`:S(!0),x(!1),F(Z(`generation_resumed`,r.message));break;case`cloudflare_deployment_started`:v(!0),F(Z(`cloudflare_deployment_started`,r.message));break;case`cloudflare_deployment_completed`:v(!1),y(r.deploymentUrl),b(``),f(!1),F(Z(`cloudflare_deployment_completed`,`Your project has been permanently deployed to Cloudflare Workers: ${r.deploymentUrl}`)),L?.(`info`,`Deployment Completed - Redeploy Reset`,`Deployment URL: ${r.deploymentUrl}\nPhase count at deployment: ${k.length}\nRedeploy button disabled until next phase`,`Redeployment Management`);break;case`cloudflare_deployment_error`:v(!1),b(r.error||`Unknown deployment error`),y(``),f(!0),F(Z(`cloudflare_deployment_error`,` Deployment failed: ${r.error}\n\n You can try deploying again.`)),_.error(`Error: ${r.error}`),L?.(`error`,`Deployment Failed - State Reset`,`Error: ${r.error}\nDeployment button reset for retry`,`Deployment Error Recovery`);break;case`github_export_started`:F(Z(`github_export_started`,r.message));break;case`github_export_progress`:F(Z(`github_export_progress`,r.message));break;case`github_export_completed`:F(Z(`github_export_completed`,r.message));break;case`github_export_error`:F(Z(`github_export_error`,` GitHub export failed: ${r.error}`)),_.error(`Error: ${r.error}`);break;case`conversation_response`:{let e=r.conversationId??`conversation_response`;if(r.conversationId){let t=r.conversationId;s(e=>{let n=e.findIndex(e=>e.role===`assistant`&&e.conversationId===`conversation_response`);return n===-1?e:e.map((e,r)=>r===n?{...e,conversationId:t}:e)}),e=t}let t=e.startsWith(`archive-`),n=`previous history was compacted`;if(r.tool){let t=r.tool;s(n=>xo(n,e,{name:t.name,status:t.status}));break}if(r.isStreaming){s(i=>bo(i,e,t?n:r.message,!1));break}s(i=>{let a=i.findIndex(t=>t.role===`assistant`&&t.conversationId===e);return a===-1?[...i,Z(e,t?n:r.message)]:i.map((e,i)=>i===a?{...e,content:t?n:r.message}:e)});break}case`terminal_output`:R&&R({id:`terminal-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,content:r.output,type:r.outputType,timestamp:r.timestamp});break;case`server_log`:R&&R({id:`log-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,content:r.message,type:r.level,timestamp:r.timestamp,source:r.source});break;case`error`:{let e=r;s(t=>[...t,Z(`error_${Date.now()}`,` ${e.error}`)]),L?.(`error`,`WebSocket Error`,e.error,`WebSocket`,`error`,e);break}case`rate_limit_error`:{let e=r.error,t=vo(e.details,L);s(e=>[...e,t]);break}default:X.warn(`Unhandled message:`,r)}}}function Oo({chatId:e,query:t,images:n,agentMode:r=`deterministic`,onDebugMessage:i,onTerminalMessage:a}){let o=(0,H.useRef)(`idle`),s=(0,H.useRef)(0),c=(0,H.useRef)([]),l=(0,H.useRef)(!0),u=(0,H.useRef)(0),[d,f]=(0,H.useState)(),[p,m]=(0,H.useState)([Z(`main`,`Thinking...`,!0)]),[g,v]=(0,H.useState)([]),[y,b]=(0,H.useState)(),[x,S]=(0,H.useState)(),[C,w]=(0,H.useState)(),[T,E]=(0,H.useState)(),[D,O]=(0,H.useState)(!1),[k,A]=(0,H.useState)(!0),[j,M]=(0,H.useState)(So),[N,P]=(0,H.useState)([]),[F,I]=(0,H.useState)([]),[L,R]=(0,H.useState)(),[ee,te]=(0,H.useState)(),[ne,re]=(0,H.useState)(!1),[ie,ae]=(0,H.useState)(``),[oe,se]=(0,H.useState)(),[ce,le]=(0,H.useState)(!1),[ue,de]=(0,H.useState)(!1),[fe,pe]=(0,H.useState)(!1),[z,me]=(0,H.useState)(!1),[he,ge]=(0,H.useState)(!1),[_e,ve]=(0,H.useState)(!1),[B,ye]=(0,H.useState)(!1),[be,xe]=(0,H.useState)(!1),Se=(0,H.useCallback)((e,t)=>{X.debug(`updateStage`,{stageId:e,...t}),M(n=>Co(n,e,t))},[]),Ce=(0,H.useCallback)(()=>{Se(`bootstrap`,{status:`completed`})},[Se]),we=(0,H.useCallback)(()=>{te(void 0)},[]),V=(0,H.useCallback)(e=>{go(e.conversationId)&&m(t=>yo(t,e))},[]),Te=(0,H.useCallback)(e=>{m(t=>[...t,_o(e)])},[]),Ee=e=>{v(t=>[...t,...e.map(e=>({...e,language:so(e.filePath)}))])},De=(0,H.useCallback)(Do({setFiles:I,setPhaseTimeline:P,setProjectStages:M,setMessages:m,setBlueprint:b,setQuery:w,setPreviewUrl:S,setTotalFiles:R,setIsRedeployReady:de,setIsPreviewDeploying:le,setIsThinking:ve,setIsInitialStateRestored:xe,setShouldRefreshPreview:ye,setIsDeploying:re,setCloudflareDeploymentUrl:ae,setDeploymentError:se,setIsGenerationPaused:pe,setIsGenerating:me,setIsPhaseProgressActive:ge,isInitialStateRestored:be,blueprint:y,query:C,bootstrapFiles:g,files:F,phaseTimeline:N,previewUrl:x,projectStages:j,isGenerating:z,urlChatId:e,updateStage:Se,sendMessage:V,loadBootstrapFiles:Ee,onDebugMessage:i,onTerminalMessage:a}),[be,y,C,g,F,N,x,j,z,e,Se,V,Ee,i,a]),Oe=(0,H.useCallback)((t,{disableGenerate:n=!1,isRetry:r=!1}={})=>{if(X.debug(` ${r?`Retrying`:`Attempting`} WebSocket connection (attempt ${s.current+1}/6):`,t),!t){X.error(` WebSocket URL is required`);return}o.current=r?`retrying`:`connecting`;try{X.debug(` Attempting WebSocket connection to:`,t);let i=new h(t);E(i);let a=++u.current,d=setTimeout(()=>{a===u.current&&i.readyState===h.CONNECTING&&(X.warn(` WebSocket connection timeout`),i.close(),ke(t,n,`Connection timeout`))},3e4);return i.addEventListener(`open`,()=>{if(!l.current){i.close();return}a===u.current&&(clearTimeout(d),X.info(` WebSocket connection established successfully!`),o.current=`connected`,s.current=0,c.current.forEach(clearTimeout),c.current=[],r&&V(Z(`websocket_reconnected`,` Connection restored! Continuing with code generation...`)),Eo(i,`get_conversation_state`),!n&&e===`new`&&(X.debug(` Starting code generation for new chat`),Eo(i,`generate_all`)))}),i.addEventListener(`message`,e=>{try{De(i,JSON.parse(e.data))}catch(t){X.error(` Error parsing WebSocket message:`,t,e.data)}}),i.addEventListener(`error`,e=>{clearTimeout(d),a===u.current&&l.current&&(X.error(` WebSocket error:`,e),ke(t,n,`WebSocket error`))}),i.addEventListener(`close`,e=>{clearTimeout(d),X.info(` WebSocket connection closed with code ${e.code}: ${e.reason||`No reason provided`}`,e),a===u.current&&l.current&&ke(t,n,`Connection closed (code: ${e.code})`)}),function(){clearTimeout(d),i.close()}}catch(e){X.error(` Error establishing WebSocket connection:`,e),ke(t,n,`Connection setup failed`)}},[s,5,c]),ke=(0,H.useCallback)((e,t,n)=>{if(o.current=`failed`,s.current>=5){X.error(` WebSocket connection failed permanently after 6 attempts`),V(Z(`websocket_failed`,` Connection failed permanently after 6 attempts.\n\n Reason: ${n}\n\n Please refresh the page to try again.`)),i?.(`error`,`WebSocket Connection Failed Permanently`,`Failed after 6 attempts. Reason: ${n}`,`WebSocket Resilience`);return}s.current++;let r=2**s.current*1e3,a=Math.min(r,3e4);X.warn(` Retrying WebSocket connection in ${a/1e3}s (attempt ${s.current+1}/6)`),V(Z(`websocket_retrying`,` Connection failed. Retrying in ${Math.ceil(a/1e3)} seconds... (attempt ${s.current+1}/6)\n\n Reason: ${n}`,!0));let l=setTimeout(()=>{Oe(e,{disableGenerate:t,isRetry:!0})},a);c.current.push(l),i?.(`warning`,`WebSocket Connection Retry`,`Retry ${s.current}/5 in ${a/1e3}s. Reason: ${n}`,`WebSocket Resilience`)},[5,s,c,i,V]);return(0,H.useEffect)(()=>{async function a(){if(!(!e||o.current!==`idle`))try{if(e===`new`){if(!t){X.error(`Query is required for new code generation`),_.error(`Please enter a description of what you want to build`);return}let e=await U.createAgentSession({query:t,agentMode:r,images:n}),i=oo(),a={websocketUrl:``,agentId:``,template:{files:[]}},o=!1;V(Z(`main`,`Sure, let's get started. Bootstrapping the project first...`,!0));for await(let t of ao(e.stream)){if(X.debug(`Received chunk from server:`,t),t.chunk){o||(V(Z(`main`,`Blueprint is being generated...`,!0)),X.info(`Blueprint stream has started`),A(!1),O(!0),o=!0,Se(`bootstrap`,{status:`completed`}),Se(`blueprint`,{status:`active`})),i.feed(t.chunk);try{b(i.finalize())}catch(e){X.error(`Error parsing JSON:`,e,t.chunk)}}t.agentId&&(a.agentId=t.agentId),t.websocketUrl&&(a.websocketUrl=t.websocketUrl,X.debug(` Received WebSocket URL from server:`,a.websocketUrl)),t.template&&(X.debug(`Received template from server:`,t.template),a.template=t.template,t.template.files&&Ee(t.template.files))}Se(`blueprint`,{status:`completed`}),O(!1),V(Z(`main`,`Blueprint generation complete. Now starting the code generation...`,!0)),X.debug(`connecting to ws with created id`),Oe(a.websocketUrl),f(a.agentId),Hr.emitAppCreated(a.agentId,{title:t||`New App`,description:t})}else if(o.current===`idle`){A(!1),V(Z(`fetching-chat`,`Fetching your previous chat...`));let t=await U.connectToAgent(e);if(!t.success||!t.data)throw X.error(`Failed to fetch existing chat:`,{chatId:e,error:t.error}),Error(t.error?.message||`Failed to connect to agent`);X.debug(`Existing agentId API result`,t.data),f(e),V(Z(`resuming-chat`,`Starting from where you left off...`)),X.debug(`connecting from init for existing chatId`),Oe(t.data.websocketUrl,{disableGenerate:!0})}}catch(e){if(X.error(`Error initializing code generation:`,e),e instanceof RateLimitExceededError){let t=vo(e.details,i);m(e=>[...e,t])}}}a()},[]),(0,H.useEffect)(()=>(l.current=!0,()=>{l.current=!1,c.current.forEach(clearTimeout),c.current=[]}),[]),(0,H.useEffect)(()=>()=>{T?.close()},[T]),(0,H.useEffect)(()=>{if(ee)return()=>{I(e=>e.map(e=>(e.filePath===ee.filePath&&(e.fileContents=e.fileContents.replace(ee.search,ee.replacement)),e)))}},[ee]),{messages:p,edit:ee,bootstrapFiles:g,chatId:d,query:C,files:F,blueprint:y,previewUrl:x,isGeneratingBlueprint:D,isBootstrapping:k,totalFiles:L,websocket:T,sendUserMessage:Te,sendAiMessage:V,clearEdit:we,projectStages:j,phaseTimeline:N,isThinking:_e,onCompleteBootstrap:Ce,isDeploying:ne,cloudflareDeploymentUrl:ie,deploymentError:oe,isRedeployReady:ue,isGenerationPaused:fe,isGenerating:z,handleStopGeneration:(0,H.useCallback)(()=>{Eo(T,`stop_generation`)},[T]),handleResumeGeneration:(0,H.useCallback)(()=>{Eo(T,`resume_generation`)},[T]),handleDeployToCloudflare:(0,H.useCallback)(async e=>{try{if(Eo(T,`deploy`,{instanceId:e}))X.debug(` Deployment WebSocket message sent:`,e),setTimeout(()=>{ne&&(X.warn(` Deployment timeout after 1 minute`),re(!1),ae(``),de(!1),V(Z(`deployment_timeout`,` Deployment timed out after 1 minute.

 Please try deploying again. The server may be busy.`)),i?.(`warning`,`Deployment Timeout`,`Deployment for ${e} timed out after 60 seconds`,`Deployment Timeout Management`))},6e4);else throw Error(`WebSocket connection not available`)}catch(e){X.error(` Error sending deployment WebSocket message:`,e),re(!0),se(``),ae(``),de(!1),V(Z(`deployment_error`,` Failed to initiate deployment: ${e instanceof Error?e.message:`Unknown error`}\n\n You can try again.`))}},[T,V,ne,i]),shouldRefreshPreview:B,isPreviewDeploying:ce,isPhaseProgressActive:he}}var ko=r.create(Se),Ao=r.create(Fe);function jo({text:e}){let[t,n]=(0,H.useState)(!1);return(0,W.jsx)(`button`,{className:`p-1`,onClick:()=>{navigator.clipboard.writeText(e),n(!0),setTimeout(()=>{n(!1)},2500)},children:(0,W.jsx)(l,{children:t?(0,W.jsx)(ko,{initial:{scale:.4},animate:{scale:1},exit:{scale:.4},className:`size-4 text-green-300/70`}):(0,W.jsx)(Ao,{initial:{scale:.4},animate:{scale:1},exit:{scale:.4},className:`size-4 text-text-primary/60`})})})}function Mo(e,t){let[n,r]=(0,H.useState)([]),[i,a]=(0,H.useState)(!1),o=(0,H.useRef)(void 0),s=(0,H.useRef)(0),c=(0,H.useRef)(0);return(0,H.useEffect)(()=>{if(!t.enabled){r(e),a(!0);return}r([]),s.current=0,c.current=0,o.current&&clearTimeout(o.current);let n=()=>{if(s.current>=e.length){a(!0);return}let i=e[s.current],l=i.fileContents,u=Math.max(1,Math.floor(t.tps/10));c.current===0&&r(e=>[...e,{...i,fileContents:``}]);let d=Math.min(l.length,c.current+u),f=l.slice(c.current,d);r(e=>e.map((t,n)=>n===e.length-1?{...t,fileContents:t.fileContents+f}:t)),c.current=d,c.current>=l.length&&(s.current++,c.current=0),o.current=setTimeout(n,100)};return e.length>0&&n(),()=>{o.current&&clearTimeout(o.current)}},[e,t.tps,t.enabled]),{streamedFiles:n,doneStreaming:i}}function No(e){let[t,n]=(0,H.useState)(null),[r,i]=(0,H.useState)(!!e&&e!==`new`),[a,o]=(0,H.useState)(null),s=(0,H.useCallback)(async()=>{if(!e||e===`new`){n(null),o(null),i(!1);return}try{i(!0),n((await U.getAppDetails(e)).data||null),o(null)}catch(e){console.error(`Error fetching app:`,e),o(e instanceof Error?e.message:`Failed to fetch app`),n(null)}finally{i(!1)}},[e]);return(0,H.useEffect)(()=>{s()},[s]),{app:t,loading:r,error:a,refetch:s}}function Po(e,t){let{user:n,isAuthenticated:r}=Un(),[i,a]=(0,H.useState)({isExporting:!1,isModalOpen:!1}),o=(0,H.useCallback)(()=>{a(e=>({...e,isModalOpen:!0,result:void 0}))},[]),s=(0,H.useCallback)(()=>{a(e=>({...e,isModalOpen:!1,isExporting:!1,progress:void 0,result:void 0}))},[]);(0,H.useEffect)(()=>{let e=new URLSearchParams(window.location.search),t=e.get(`github_export`);if(t===`success`){let t=e.get(`repository_url`);a(e=>({...e,isExporting:!1,isModalOpen:!0,result:{success:!0,repositoryUrl:t||void 0}}));let n=new URL(window.location.href);n.searchParams.delete(`github_export`),n.searchParams.delete(`repository_url`),window.history.replaceState({},``,n.toString())}else if(t===`error`){let t=e.get(`reason`)||`Unknown error`;a(e=>({...e,isExporting:!1,isModalOpen:!0,result:{success:!1,error:`GitHub export failed: ${t}`}}));let n=new URL(window.location.href);n.searchParams.delete(`github_export`),n.searchParams.delete(`reason`),window.history.replaceState({},``,n.toString())}},[]);let c=(0,H.useCallback)(async e=>{a(e=>({...e,isExporting:!0,progress:{message:`Initiating GitHub authorization...`,step:`creating_repository`,progress:10},result:void 0}));try{if(!t){a(e=>({...e,isExporting:!1,result:{success:!1,error:`Invalid chat session. Please ensure you are on a valid chat page.`}}));return}let n=await U.initiateGitHubExport({repositoryName:e.repositoryName,description:e.description,isPrivate:e.isPrivate,agentId:t});n.data?.authUrl?(a(e=>({...e,progress:{message:`Redirecting to GitHub...`,step:`creating_repository`,progress:25}})),setTimeout(()=>{window.location.href=n.data?.authUrl||``},500)):a(e=>({...e,isExporting:!1,result:{success:!1,error:`Failed to initiate GitHub authorization`}}))}catch(e){a(t=>({...t,isExporting:!1,result:{success:!1,error:e?.message||`Failed to initiate GitHub export`}}))}},[t]),l=(0,H.useCallback)(()=>{a(e=>({...e,result:void 0,progress:void 0,isExporting:!1}))},[]);return{...i,openModal:o,closeModal:s,startExport:c,isAuthenticated:r,user:n,retry:l}}function Fo({isOpen:e,onClose:t,onExport:n,isExporting:i=!1,exportProgress:a,exportResult:o,onRetry:s}){let[c,u]=(0,H.useState)(``),[d,f]=(0,H.useState)(``),[p,m]=(0,H.useState)(!1),h=(0,H.useCallback)(e=>{e.preventDefault(),c.trim()&&n({repositoryName:c.trim(),isPrivate:p,description:d.trim()||void 0})},[c,d,p,n]),g=(0,H.useCallback)(()=>{i||t()},[i,t]);return H.useEffect(()=>{e&&!c&&u(`generated-app-${new Date().toISOString().slice(0,19).replace(/[-:]/g,``).replace(`T`,`-`)}`)},[e,c]),e?(0,W.jsx)(l,{children:(0,W.jsx)(r.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4`,onClick:g,children:(0,W.jsxs)(r.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:`bg-bg-4 border border-border-primary rounded-xl max-w-md w-full p-6`,onClick:e=>e.stopPropagation(),children:[(0,W.jsxs)(`div`,{className:`flex items-center justify-between mb-6`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,W.jsx)(`div`,{className:`p-2 bg-bg-2 rounded-lg`,children:(0,W.jsx)(Tt,{className:`w-5 h-5 text-text-secondary`})}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h2`,{className:`text-lg font-semibold text-text-secondary`,children:`Export to GitHub`}),(0,W.jsx)(`p`,{className:`text-sm text-text-primary/60`,children:`Create a new repository with your generated code`})]})]}),!i&&(0,W.jsx)(`button`,{onClick:g,className:`p-1 hover:bg-bg-2 rounded-md transition-colors`,children:(0,W.jsx)(Ct,{className:`w-5 h-5 text-text-primary/60`})})]}),o?(0,W.jsx)(`div`,{className:`text-center py-8`,children:o.success?(0,W.jsxs)(`div`,{children:[(0,W.jsx)(yn,{className:`w-12 h-12 text-green-500 mx-auto mb-4`}),(0,W.jsx)(`h3`,{className:`text-lg font-semibold text-text-primary mb-2`,children:`Export Successful!`}),(0,W.jsx)(`p`,{className:`text-sm text-text-primary/60 mb-4`,children:`Your code has been successfully exported to GitHub`}),(0,W.jsxs)(`a`,{href:o.repositoryUrl,target:`_blank`,rel:`noopener noreferrer`,className:`inline-flex items-center gap-2 bg-bg-2 hover:bg-border text-text-primary py-2 px-4 rounded-lg transition-colors`,children:[(0,W.jsx)(Tt,{className:`w-4 h-4`}),`View Repository`]})]}):(0,W.jsxs)(`div`,{children:[(0,W.jsx)(at,{className:`w-12 h-12 text-red-500 mx-auto mb-4`}),(0,W.jsx)(`h3`,{className:`text-lg font-semibold text-text-primary mb-2`,children:`Export Failed`}),(0,W.jsx)(`p`,{className:`text-sm text-text-primary/60 mb-4`,children:o.error||`An error occurred during export`}),(0,W.jsxs)(`div`,{className:`space-x-2`,children:[(0,W.jsx)(`button`,{onClick:s||(()=>window.location.reload()),className:`bg-bg-2 hover:bg-border text-text-primary py-2 px-4 rounded-lg transition-colors`,children:`Try Again`}),(0,W.jsx)(`button`,{onClick:t,className:`bg-transparent hover:bg-bg-2 text-text-primary/60 hover:text-text-primary py-2 px-4 rounded-lg transition-colors`,children:`Close`})]})]})}):i&&a?(0,W.jsxs)(`div`,{className:`py-8`,children:[(0,W.jsxs)(`div`,{className:`text-center mb-6`,children:[(0,W.jsx)(Oe,{className:`w-8 h-8 text-brand mx-auto mb-4 animate-spin`}),(0,W.jsx)(`h3`,{className:`text-lg font-semibold text-text-primary mb-2`,children:`Exporting to GitHub`}),(0,W.jsx)(`p`,{className:`text-sm text-text-primary/60`,children:a.message})]}),(0,W.jsxs)(`div`,{className:`mb-4`,children:[(0,W.jsxs)(`div`,{className:`flex justify-between text-xs text-text-primary/60 mb-2`,children:[(0,W.jsx)(`span`,{children:`Progress`}),(0,W.jsxs)(`span`,{children:[a.progress,`%`]})]}),(0,W.jsx)(`div`,{className:`w-full bg-bg-2 rounded-full h-2`,children:(0,W.jsx)(r.div,{className:`bg-brand h-2 rounded-full`,initial:{width:0},animate:{width:`${a.progress}%`},transition:{duration:.5}})})]}),(0,W.jsxs)(`div`,{className:`flex justify-between text-xs`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-1 ${a.step===`creating_repository`?`text-brand`:a.progress>30?`text-green-500`:`text-text-primary/40`}`,children:[(0,W.jsx)(`div`,{className:`w-2 h-2 rounded-full bg-current`}),`Creating Repository`]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-1 ${a.step===`uploading_files`?`text-brand`:a.progress>70?`text-green-500`:`text-text-primary/40`}`,children:[(0,W.jsx)(`div`,{className:`w-2 h-2 rounded-full bg-current`}),`Uploading Files`]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-1 ${a.step===`finalizing`?`text-brand`:a.progress>90?`text-green-500`:`text-text-primary/40`}`,children:[(0,W.jsx)(`div`,{className:`w-2 h-2 rounded-full bg-current`}),`Finalizing`]})]})]}):(0,W.jsxs)(`form`,{onSubmit:h,className:`space-y-4`,children:[(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`label`,{className:`block text-sm font-medium text-text-primary mb-2`,children:`Repository Name *`}),(0,W.jsx)(`input`,{type:`text`,value:c,onChange:e=>u(e.target.value),placeholder:`my-awesome-app`,className:`w-full px-3 py-2 bg-bg-2 border border-border-primary rounded-lg text-text-primary placeholder:text-text-primary/40 focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand`,required:!0})]}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`label`,{className:`block text-sm font-medium text-text-primary mb-2`,children:`Description (Optional)`}),(0,W.jsx)(`textarea`,{value:d,onChange:e=>f(e.target.value),placeholder:`A brief description of your app...`,rows:3,className:`w-full px-3 py-2 bg-bg-2 border border-border-primary rounded-lg text-text-primary placeholder:text-text-primary/40 focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand resize-none`})]}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`label`,{className:`block text-sm font-medium text-text-primary mb-3`,children:`Repository Privacy`}),(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsxs)(`label`,{className:`flex items-center gap-3 p-3 bg-bg-2 rounded-lg cursor-pointer hover:bg-border transition-colors`,children:[(0,W.jsx)(`input`,{type:`radio`,name:`privacy`,checked:!p,onChange:()=>m(!1),className:`w-4 h-4 text-brand focus:ring-brand/50`}),(0,W.jsx)(Zt,{className:`w-4 h-4 text-text-primary/60`}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`p`,{className:`text-sm font-medium text-text-secondary`,children:`Public`}),(0,W.jsx)(`p`,{className:`text-xs text-text-primary/60`,children:`Anyone can see this repository`})]})]}),(0,W.jsxs)(`label`,{className:`flex items-center gap-3 p-3 bg-bg-2 rounded-lg cursor-pointer hover:bg-border transition-colors`,children:[(0,W.jsx)(`input`,{type:`radio`,name:`privacy`,checked:p,onChange:()=>m(!0),className:`w-4 h-4 text-brand focus:ring-brand/50`}),(0,W.jsx)(qe,{className:`w-4 h-4 text-text-primary/60`}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`p`,{className:`text-sm font-medium text-text-secondary`,children:`Private`}),(0,W.jsx)(`p`,{className:`text-xs text-text-primary/60`,children:`Only you can see this repository`})]})]})]})]}),(0,W.jsxs)(`div`,{className:`flex gap-3 pt-4`,children:[(0,W.jsx)(`button`,{type:`button`,onClick:g,className:`flex-1 bg-bg-2 hover:bg-border text-text-primary py-2 px-4 rounded-lg transition-colors`,children:`Cancel`}),(0,W.jsxs)(`button`,{type:`submit`,disabled:!c.trim(),className:`flex-1 bg-brand hover:bg-brand/90 disabled:bg-brand/50 text-text-on-brand py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2`,children:[(0,W.jsx)(ot,{className:`w-4 h-4`}),`Export to GitHub`]})]})]})]})})}):null}var Io=o(`inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden`,{variants:{variant:{default:`border-transparent bg-text-secondary text-bg-3 [a&]:hover:bg-text-secondary/90`,secondary:`border-transparent bg-bg-2 text-text-secondary [a&]:hover:bg-bg-2/90`,destructive:`border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60`,outline:`text-text-primary [a&]:hover:bg-accent [a&]:hover:text-text-secondary`}},defaultVariants:{variant:`default`}});function Q({className:e,variant:t,asChild:n=!1,...r}){return(0,W.jsx)(n?qt:`span`,{"data-slot":`badge`,className:G(Io({variant:t}),e),...r})}function Lo({className:e,...t}){return(0,W.jsx)(Me,{"data-slot":`tabs`,className:G(`flex flex-col gap-2`,e),...t})}function Ro({className:e,...t}){return(0,W.jsx)(hn,{"data-slot":`tabs-list`,className:G(`bg-bg-3 text-text-tertiary inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]`,e),...t})}function zo({className:e,...t}){return(0,W.jsx)(A,{"data-slot":`tabs-trigger`,className:G(`data-[state=active]:bg-bg-3 dark:data-[state=active]:text-text-primary focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-bg-2 text-text-primary dark:text-text-tertiary inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4`,e),...t})}function Bo({className:e,...t}){return(0,W.jsx)(it,{"data-slot":`tabs-content`,className:G(`flex-1 outline-none`,e),...t})}var Vo={quickstart:{id:`quickstart`,label:`Quick Start`,icon:B,description:`Most commonly used agents`},planning:{id:`planning`,label:`Planning`,icon:B,description:`Project planning and setup`},coding:{id:`coding`,label:`Coding`,icon:B,description:`Development and implementation`},debugging:{id:`debugging`,label:`Debugging`,icon:B,description:`Code fixing and review`},advanced:{id:`advanced`,label:`Advanced`,icon:B,description:`Specialized operations`}},Ho=e=>{let t={templateSelection:`quickstart`,blueprint:`quickstart`,conversationalResponse:`quickstart`,phaseGeneration:`planning`,projectSetup:`planning`,phaseImplementation:`coding`,firstPhaseImplementation:`coding`,fileRegeneration:`coding`,realtimeCodeFixer:`debugging`,fastCodeFixer:`debugging`,codeReview:`debugging`,screenshotAnalysis:`advanced`};if(t[e])return t[e];let n=e.toLowerCase();return n.includes(`template`)||n.includes(`selection`)||n.includes(`blueprint`)||n.includes(`architect`)||n.includes(`conversation`)||n.includes(`chat`)||n.includes(`response`)?`quickstart`:n.includes(`project`)&&n.includes(`setup`)||n.includes(`suggestion`)&&n.includes(`process`)||n.includes(`planning`)||n.includes(`plan`)?`planning`:n.includes(`implementation`)||n.includes(`implement`)||n.includes(`regenerat`)||n.includes(`regen`)||n.includes(`code`)&&n.includes(`gen`)?`coding`:n.includes(`fixer`)||n.includes(`fix`)||n.includes(`debug`)||n.includes(`review`)||n.includes(`lint`)||n.includes(`check`)?`debugging`:(n.includes(`screenshot`)||n.includes(`image`)||n.includes(`vision`)||n.includes(`analysis`)||n.includes(`analyz`),`advanced`)},Uo=e=>e?e.split(`/`).pop()||e:`Default`,Wo=e=>e?e.includes(`cerebras/`)?{name:`Cerebras`,color:`bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400`}:e.includes(`[openrouter]`)?{name:`OpenRouter`,color:`bg-pink-100 text-pink-800 dark:bg-pink-900/20 dark:text-pink-400`}:e.includes(`openai/`)||e.includes(`gpt`)||e.includes(`o3`)||e.includes(`o4`)?{name:`OpenAI`,color:`bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400`}:e.includes(`anthropic/`)||e.includes(`claude`)?{name:`Anthropic`,color:`bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-400`}:e.includes(`google-ai-studio/`)||e.includes(`gemini`)?{name:`Google`,color:`bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400`}:{name:`Custom`,color:`bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400`}:{name:`Default`,color:`bg-bg-3 text-text-tertiary`};function Go({agent:e,userConfig:t,defaultConfig:n}){let r=t?.isUserOverride||!1,i=t?.name||n?.name,a=Uo(i),o=Wo(i),s=t?.temperature??n?.temperature,c=t?.max_tokens??n?.max_tokens,l=t?.reasoning_effort??n?.reasoning_effort;return(0,W.jsxs)(`div`,{className:`p-4 border rounded-lg bg-bg-3/50 space-y-3`,children:[(0,W.jsxs)(`div`,{className:`flex items-start justify-between gap-2`,children:[(0,W.jsxs)(`div`,{className:`flex items-start gap-2 min-w-0 flex-1`,children:[(0,W.jsx)(`div`,{className:`p-1 rounded-sm bg-bg-3`,children:(0,W.jsx)(B,{className:`h-3 w-3`})}),(0,W.jsxs)(`div`,{className:`min-w-0 flex-1`,children:[(0,W.jsx)(`h6`,{className:`font-medium text-sm mb-1 text-text-secondary`,title:e.name,children:e.name}),(0,W.jsx)(`p`,{className:`text-xs text-text-tertiary line-clamp-2`,title:e.description,children:e.description})]})]}),(0,W.jsx)(Q,{variant:r?`default`:`outline`,className:`text-xs shrink-0`,children:r?`Custom`:`Default`})]}),(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,W.jsx)(`span`,{className:`text-sm font-medium text-text-secondary`,title:a,children:a}),(0,W.jsx)(Q,{variant:`secondary`,className:`text-xs shrink-0 ${o.color}`,children:o.name})]}),(0,W.jsxs)(`div`,{className:`flex flex-wrap gap-1`,children:[s!=null&&(0,W.jsxs)(Q,{variant:`outline`,className:`text-xs`,children:[`T: `,s]}),c&&(0,W.jsxs)(Q,{variant:`outline`,className:`text-xs`,children:[Math.round(c/1e3),`K tokens`]}),l&&(0,W.jsxs)(Q,{variant:`outline`,className:`text-xs`,children:[l.charAt(0).toUpperCase(),l.slice(1)]})]})]})]})}function Ko({configs:e,onRequestConfigs:t,loading:n}){let[r,i]=(0,H.useState)(!1),[a,o]=(0,H.useState)(`quickstart`),s=()=>{i(!0),e||t()},c=t=>e?e.agents.filter(e=>Ho(e.key)===t):[],l=t=>c(t).filter(t=>e?.userConfigs[t.key]?.isUserOverride).length;return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(K,{variant:`outline`,size:`sm`,onClick:s,className:`gap-2 text-xs`,title:`View current model configurations`,children:[(0,W.jsx)(rn,{className:`size-3`}),(0,W.jsx)(`span`,{className:`hidden sm:inline`,children:`Model Info`})]}),(0,W.jsx)(Mi,{open:r,onOpenChange:i,children:(0,W.jsxs)(Fi,{className:`max-w-4xl w-[90vw] max-h-[90vh] overflow-y-auto`,children:[(0,W.jsxs)(Ii,{children:[(0,W.jsxs)(Ri,{className:`flex items-center gap-2`,children:[(0,W.jsx)(rn,{className:`h-5 w-5`}),`Current Model Configurations`]}),(0,W.jsx)(zi,{children:`View the AI model settings currently being used for app generation (defaults + your overrides).`})]}),n?(0,W.jsxs)(`div`,{className:`flex items-center gap-3 p-8`,children:[(0,W.jsx)(B,{className:`h-5 w-5 animate-spin text-text-tertiary`}),(0,W.jsx)(`span`,{className:`text-sm text-text-tertiary`,children:`Loading model configurations...`})]}):e?(0,W.jsxs)(Lo,{value:a,onValueChange:o,className:`w-full`,children:[(0,W.jsx)(Ro,{className:`grid w-full grid-cols-5 h-12`,children:Object.values(Vo).map(e=>{let t=l(e.id);return(0,W.jsxs)(zo,{value:e.id,className:`flex flex-col gap-1 py-2 relative justify-center`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(`span`,{className:`hidden sm:inline text-xs`,children:e.label}),(0,W.jsx)(`span`,{className:`sm:hidden text-xs`,children:e.label.split(` `)[0]})]}),t>0&&(0,W.jsx)(Q,{variant:`secondary`,className:`text-xs absolute -top-1 -right-1 h-4 w-4 rounded-full p-0 flex items-center justify-center text-[10px]`,children:t})]},e.id)})}),Object.values(Vo).map(t=>{let n=c(t.id);return(0,W.jsx)(Bo,{value:t.id,className:`mt-6`,children:(0,W.jsxs)(`div`,{className:`space-y-4`,children:[(0,W.jsxs)(`div`,{className:`text-sm text-text-tertiary`,children:[t.description,`  `,n.length,` agent`,n.length===1?``:`s`,l(t.id)>0&&(0,W.jsxs)(`span`,{className:`ml-2 text-text-primary font-medium`,children:[`(`,l(t.id),` customized)`]})]}),n.length===0?(0,W.jsx)(`div`,{className:`text-center py-8 text-text-tertiary`,children:`No agents in this category.`}):(0,W.jsx)(`div`,{className:`grid grid-cols-1 lg:grid-cols-2 gap-4`,children:n.map(t=>(0,W.jsx)(Go,{agent:t,userConfig:e.userConfigs[t.key],defaultConfig:e.defaultConfigs[t.key]},t.key))})]})},t.id)})]}):(0,W.jsxs)(`div`,{className:`text-center py-8 text-text-tertiary`,children:[(0,W.jsx)(`p`,{children:`No configuration data available.`}),(0,W.jsx)(K,{variant:`outline`,size:`sm`,onClick:t,className:`mt-4`,children:`Retry`})]})]})})]})}function qo(e,{enabled:t=!0,behavior:n=`auto`,bottomThreshold:r=128,watch:i}={}){let a=(0,H.useRef)(!0),o=(0,H.useCallback)(()=>{let t=e.current;t&&t.scrollTo({top:t.scrollHeight,behavior:n})},[n,e]);return(0,H.useEffect)(()=>{let n=e.current;if(!n||!t)return;let i=()=>{a.current=n.scrollHeight-n.scrollTop-n.clientHeight<=r};a.current=!0,Promise.resolve().then(o),n.addEventListener(`scroll`,i,{passive:!0});let s=new ResizeObserver(()=>{a.current&&o()});return s.observe(n),()=>{n.removeEventListener(`scroll`,i),s.disconnect()}},[e,t,r,o]),(0,H.useEffect)(()=>{t&&i!==void 0&&a.current&&o()},[t,i,o]),{scrollToBottom:o}}function Jo(){let{chatId:e}=He(),[t]=oe(),n=t.get(`query`),i=t.get(`agentMode`)||`deterministic`,a=(0,H.useMemo)(()=>{let e=t.get(`images`);if(e)try{return JSON.parse(decodeURIComponent(e))}catch(e){console.error(`Failed to parse images from URL:`,e);return}},[t]),{app:o,loading:s}=No(e),c=o?o.originalPrompt||o.title:n||``,u=o?.title,[d,f]=(0,H.useState)(0),p=(0,H.useCallback)((e,t,n,r,i,a)=>{let o={id:`${Date.now()}-${Math.random().toString(36).substring(2,11)}`,timestamp:Date.now(),type:e,message:t,details:n,source:r,messageType:i,rawMessage:a};_e(e=>[...e,o])},[]),m=(0,H.useCallback)(()=>{_e([])},[]),{messages:h,edit:g,bootstrapFiles:_,chatId:v,query:y,files:b,isGeneratingBlueprint:x,isBootstrapping:S,totalFiles:w,websocket:T,sendUserMessage:E,sendAiMessage:D,blueprint:k,previewUrl:A,clearEdit:j,projectStages:M,phaseTimeline:P,isThinking:F,onCompleteBootstrap:I,isDeploying:L,cloudflareDeploymentUrl:R,deploymentError:ee,isRedeployReady:te,isGenerationPaused:ne,isGenerating:re,handleStopGeneration:ie,handleResumeGeneration:ae,handleDeployToCloudflare:se,shouldRefreshPreview:ce,isPreviewDeploying:le}=Oo({chatId:e,query:n,images:a,agentMode:i,onDebugMessage:p}),ue=Po(T,e),de=O(),[fe,pe]=(0,H.useState)(),[z,me]=(0,H.useState)(`editor`),[he,_e]=(0,H.useState)([]),ve=(0,H.useRef)(null),[B,ye]=(0,H.useState)(),[be,xe]=(0,H.useState)(!1),Se=(0,H.useCallback)(()=>{T&&(xe(!0),T.send(JSON.stringify({type:`get_model_configs`})))},[T]);(0,H.useEffect)(()=>{if(!T)return;let e=e=>{try{let t=JSON.parse(e.data);t.type===`model_configs_info`&&(ye(t.configs),xe(!1))}catch(e){X.error(`Error parsing WebSocket message for model configs:`,e)}};return T.addEventListener(`message`,e),()=>{T.removeEventListener(`message`,e)}},[T]);let Ce=(0,H.useRef)(!1),we=(0,H.useRef)(!1),V=(0,H.useRef)(null),Te=(0,H.useRef)(null),Ee=(0,H.useRef)(null),[De,Oe]=(0,H.useState)(``),[ke,Ae]=(0,H.useState)(!1),je=e=>e.trim().split(/\s+/).filter(e=>e.length>0).length,{images:Me,addImages:Ne,removeImage:Pe,clearImages:Fe,isProcessing:Ie}=pa({onError:e=>{console.error(`Chat image upload error:`,e)}}),Le=(0,H.useRef)(null),{streamedFiles:Re,doneStreaming:ze}=Mo(_,{tps:600,enabled:S}),Be=(0,H.useCallback)(e=>{X.debug(`handleFileClick()`,e),j(),pe(e.filePath),me(`editor`),we.current||=!0},[]),Ve=(0,H.useCallback)(e=>{me(e)},[]);(0,H.useMemo)(()=>b.reduce((e,t)=>t.isGenerating?e+1:e,0),[b]);let Ue=(0,H.useMemo)(()=>M.find(e=>e.id===`code`)?.status,[M]),We=(0,H.useMemo)(()=>{if(Ue===`active`){for(let e=b.length-1;e>=0;e--)if(b[e].isGenerating)return b[e]}},[b,Ue]),Ge=(0,H.useMemo)(()=>!we.current&&We?We:!we.current&&S?Re.find(e=>e.filePath===fe):b.find(e=>e.filePath===fe)??Re.find(e=>e.filePath===fe),[fe,We,b,Re,S]),Ke=(0,H.useMemo)(()=>P.length>0&&P[0].status===`completed`,[P]),qe=(0,H.useMemo)(()=>Ke&&!!e,[Ke,e]),Je=(0,H.useMemo)(()=>Re.length>0||!!k||b.length>0,[Re,k,b.length]),[Ye,...Xe]=(0,H.useMemo)(()=>h,[h]),{scrollToBottom:Ze}=qo(Ee,{behavior:`smooth`,watch:[h]}),Qe=(0,H.useRef)(0);(0,H.useEffect)(()=>{h.length>Qe.current&&requestAnimationFrame(()=>Ze()),Qe.current=h.length},[h.length,Ze]),(0,H.useEffect)(()=>{A&&!Ce.current&&Ke&&(me(`preview`),Ae(!0),setTimeout(()=>{Ae(!1)},3e3))},[A,Ke]),(0,H.useEffect)(()=>{v&&de(`/chat/${v}`,{replace:!0})},[v,de]),(0,H.useEffect)(()=>{g&&b.some(e=>e.filePath===g.filePath)&&(pe(g.filePath),me(`editor`))},[g,b]),(0,H.useEffect)(()=>{S&&Re.length>0&&!we.current?pe(Re.at(-1).filePath):z===`editor`&&!Ge&&b.length>0&&!we.current&&pe(b.at(-1).filePath)},[z,Ge,b,S,Re]),(0,H.useEffect)(()=>{z!==`blueprint`&&x?me(`blueprint`):!we.current&&z===`blueprint`&&!x&&me(`editor`)},[x,z]),(0,H.useEffect)(()=>{ze&&!x&&!k&&(I(),D(Z(`creating-blueprint`,`Bootstrapping complete, now creating a blueprint for you...`,!0)))},[ze,x,D,k,I]);let $e=(0,H.useMemo)(()=>S||x,[S,x]),et=(0,H.useMemo)(()=>M.find(e=>e.id===`blueprint`)?.status!==`completed`||!v,[M,v]),tt=(0,H.useRef)(null),{isDragging:nt,dragHandlers:rt}=ma({onFilesDropped:Ne,accept:[...da],disabled:et}),it=(0,H.useCallback)(e=>{e.preventDefault(),!(et||!De.trim())&&(T?.send(JSON.stringify({type:`user_suggestion`,message:De,images:Me.length>0?Me:void 0})),E(De),Oe(``),Me.length>0&&Fe(),requestAnimationFrame(()=>Ze()))},[De,T,E,et,Ze,Me,Fe]),[at,ot]=(0,H.useMemo)(()=>{let e=P.filter(e=>e.status===`completed`).length,t=k?.implementationRoadmap?.length||0;return[e,Math.max(t,P.length,1)]},[P,k?.implementationRoadmap]);return(0,W.jsxs)(`div`,{className:`size-full flex flex-col min-h-0 text-text-primary`,children:[(0,W.jsxs)(`div`,{className:`flex-1 flex min-h-0 overflow-hidden justify-center`,children:[(0,W.jsxs)(r.div,{layout:`position`,className:`flex-1 shrink-0 flex flex-col basis-0 max-w-lg relative z-10 h-full min-h-0`,children:[(0,W.jsx)(`div`,{className:`flex-1 overflow-y-auto min-h-0 chat-messages-scroll`,ref:Ee,children:(0,W.jsxs)(`div`,{className:`pt-5 px-4 pb-4 text-sm flex flex-col gap-5`,children:[s?(0,W.jsxs)(`div`,{className:`flex items-center gap-2 text-text-tertiary`,children:[(0,W.jsx)(C,{className:`size-4 animate-spin`}),`Loading app...`]}):(0,W.jsxs)(W.Fragment,{children:[u&&(0,W.jsx)(`div`,{className:`text-lg font-semibold mb-2`,children:u}),(0,W.jsx)(Sa,{message:y??c}),void 0]}),Ye&&(0,W.jsx)(Ca,{message:Ye.content,isThinking:Ye.ui?.isThinking,toolEvents:Ye.ui?.toolEvents}),(0,W.jsx)(Ua,{projectStages:M,phaseTimeline:P,files:b,view:z,activeFile:Ge,onFileClick:Be,isThinkingNext:F,isPreviewDeploying:le,progress:at,total:ot,parentScrollRef:Ee,onViewChange:e=>{me(e),we.current=!0},chatId:v,isDeploying:L,handleDeployToCloudflare:se}),v&&(0,W.jsx)(r.div,{ref:ve,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},className:`px-4 mb-6`,children:(0,W.jsx)(io,{isPhase1Complete:Ke,isDeploying:L,deploymentUrl:R,instanceId:v||``,isRedeployReady:te,deploymentError:ee,appId:o?.id||v,appVisibility:o?.visibility,isGenerating:re||x,isPaused:ne,onDeploy:se,onStopGeneration:ie,onResumeGeneration:ae,onVisibilityUpdate:e=>{o&&(o.visibility=e)}})}),Xe.map(e=>e.role===`assistant`?(0,W.jsx)(Ca,{message:e.content,isThinking:e.ui?.isThinking,toolEvents:e.ui?.toolEvents},e.conversationId):(0,W.jsx)(Sa,{message:e.content},e.conversationId))]})}),(0,W.jsxs)(`form`,{ref:tt,onSubmit:it,className:`shrink-0 p-4 pb-5 bg-transparent`,...rt,children:[(0,W.jsx)(`input`,{ref:Le,type:`file`,accept:da.join(`,`),multiple:!0,onChange:e=>{let t=Array.from(e.target.files||[]);t.length>0&&Ne(t),e.target.value=``},className:`hidden`,disabled:et}),(0,W.jsxs)(`div`,{className:`relative`,children:[nt&&(0,W.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center bg-accent/10 backdrop-blur-sm rounded-xl z-50 pointer-events-none`,children:(0,W.jsx)(`p`,{className:`text-accent font-medium`,children:`Drop images here`})}),Me.length>0&&(0,W.jsx)(`div`,{className:`mb-2`,children:(0,W.jsx)(ga,{images:Me,onRemove:Pe,compact:!0})}),(0,W.jsx)(`textarea`,{value:De,onChange:e=>{let t=e.target.value;if(je(t)<=4e3){Oe(t);let n=e.currentTarget;n.style.height=`auto`,n.style.height=Math.min(n.scrollHeight,120)+`px`}},onKeyDown:e=>{e.key===`Enter`&&(e.shiftKey||(e.preventDefault(),it(e)))},disabled:et,placeholder:et?`Please wait for blueprint completion...`:$e?`Chat with AI while generating...`:`Ask a follow up...`,rows:1,className:`w-full bg-bg-2 border border-text-primary/10 rounded-xl px-3 pr-20 py-2 text-sm outline-none focus:border-white/20 drop-shadow-2xl text-text-primary placeholder:!text-text-primary/50 disabled:opacity-50 disabled:cursor-not-allowed resize-none overflow-y-auto no-scrollbar min-h-[36px] max-h-[120px]`,style:{height:`auto`,minHeight:`36px`},ref:e=>{e&&(e.style.height=`auto`,e.style.height=Math.min(e.scrollHeight,120)+`px`)}}),(0,W.jsxs)(`div`,{className:`absolute right-1.5 bottom-2.5 flex items-center gap-1`,children:[(0,W.jsx)(`button`,{type:`button`,onClick:()=>Le.current?.click(),disabled:et||Ie,className:`p-1.5 rounded-md hover:bg-bg-3 text-text-secondary hover:text-text-primary transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,"aria-label":`Upload image`,title:`Upload image`,children:(0,W.jsx)(N,{className:`size-4`,strokeWidth:1.5})}),(0,W.jsx)(`button`,{type:`submit`,disabled:!De.trim()||et,className:`p-1.5 rounded-md bg-accent/90 hover:bg-accent/80 disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-transparent text-white disabled:text-text-primary transition-colors`,children:(0,W.jsx)(At,{className:`size-4`})})]})]})]})]}),(0,W.jsx)(l,{children:Je&&(0,W.jsxs)(r.div,{layout:`position`,className:`flex-1 flex shrink-0 basis-0 p-4 pl-0 ml-2 z-30 min-h-0`,initial:{opacity:0,scale:.84},animate:{opacity:1,scale:1},transition:{duration:.3,ease:`easeInOut`},children:[z===`preview`&&A&&(0,W.jsxs)(`div`,{className:`flex-1 flex flex-col bg-bg-3 rounded-xl shadow-md shadow-bg-2 overflow-hidden border border-border-primary`,children:[(0,W.jsxs)(`div`,{className:`grid grid-cols-3 px-2 h-10 border-b bg-bg-2`,children:[(0,W.jsx)(`div`,{className:`flex items-center`,children:(0,W.jsx)(Xa,{view:z,onChange:Ve,previewAvailable:!!A,showTooltip:ke})}),(0,W.jsx)(`div`,{className:`flex items-center justify-center`,children:(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(`span`,{className:`text-sm font-mono text-text-50/70`,children:k?.title??`Preview`}),(0,W.jsx)(jo,{text:A}),(0,W.jsx)(`button`,{className:`p-1 hover:bg-bg-2 rounded transition-colors`,onClick:()=>{f(Date.now())},title:`Refresh preview`,children:(0,W.jsx)(ge,{className:`size-4 text-text-primary/50`})})]})}),(0,W.jsxs)(`div`,{className:`flex items-center justify-end gap-1.5`,children:[(0,W.jsx)(Ko,{configs:B,onRequestConfigs:Se,loading:be}),(0,W.jsxs)(`button`,{className:`flex items-center gap-1.5 px-2 py-1 rounded-md transition-all duration-200 text-xs font-medium shadow-sm ${qe?`bg-gray-800 hover:bg-gray-900 text-white`:`bg-gray-600 text-gray-400 cursor-not-allowed`}`,onClick:qe?ue.openModal:void 0,disabled:!qe,title:qe?`Export to GitHub`:Ke?`Waiting for chat session to initialize...`:`Complete Phase 1 to enable GitHub export`,"aria-label":qe?`Export to GitHub`:Ke?`GitHub export disabled - waiting for chat session`:`GitHub export disabled - complete Phase 1 first`,children:[(0,W.jsx)(Tt,{className:`size-3`}),`GitHub`]}),(0,W.jsx)(`button`,{className:`p-1 hover:bg-bg-2 rounded transition-colors`,onClick:()=>{Te.current?.requestFullscreen()},title:`Fullscreen`,children:(0,W.jsx)(Pt,{className:`size-4 text-text-primary/50`})})]})]}),(0,W.jsx)(Ya,{src:A,ref:Te,className:`flex-1 w-full h-full border-0`,title:`Preview`,shouldRefreshPreview:ce,manualRefreshTrigger:d,webSocket:T})]}),z===`blueprint`&&(0,W.jsxs)(`div`,{className:`flex-1 flex flex-col bg-bg-3 rounded-xl shadow-md shadow-bg-2 overflow-hidden border border-border-primary`,children:[(0,W.jsx)(`div`,{className:`flex items-center justify-center px-2 h-10 bg-bg-2 border-b`,children:(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(`span`,{className:`text-sm text-text-50/70 font-mono`,children:`Blueprint.md`}),A&&(0,W.jsx)(jo,{text:A})]})}),(0,W.jsx)(`div`,{className:`flex-1 overflow-y-auto bg-bg-3`,children:(0,W.jsx)(`div`,{className:`py-12 mx-auto`,children:(0,W.jsx)(Ta,{blueprint:k??{},className:`w-full max-w-2xl mx-auto`})})})]}),z===`editor`&&(0,W.jsxs)(`div`,{className:`flex-1 flex flex-col bg-bg-3 rounded-xl shadow-md shadow-bg-2 overflow-hidden border border-border-primary`,children:[Ge&&(0,W.jsxs)(`div`,{className:`grid grid-cols-3 px-2 h-10 bg-bg-2 border-b`,children:[(0,W.jsx)(`div`,{className:`flex items-center`,children:(0,W.jsx)(Xa,{view:z,onChange:Ve,previewAvailable:!!A,showTooltip:ke})}),(0,W.jsx)(`div`,{className:`flex items-center justify-center`,children:(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(`span`,{className:`text-sm font-mono text-text-50/70`,children:Ge.filePath}),A&&(0,W.jsx)(jo,{text:A})]})}),(0,W.jsxs)(`div`,{className:`flex items-center justify-end gap-1.5`,children:[(0,W.jsx)(Ko,{configs:B,onRequestConfigs:Se,loading:be}),(0,W.jsx)(`button`,{className:`p-1 hover:bg-bg-2 rounded transition-colors`,onClick:()=>{V.current?.requestFullscreen()},title:`Fullscreen`,children:(0,W.jsx)(Pt,{className:`size-4 text-text-primary/50`})})]})]}),(0,W.jsx)(`div`,{className:`flex-1 relative`,children:(0,W.jsxs)(`div`,{className:`absolute inset-0 flex`,ref:V,children:[(0,W.jsx)(Oa,{files:b,bootstrapFiles:Re,currentFile:Ge,onFileClick:Be}),(0,W.jsx)(`div`,{className:`flex-1`,children:(0,W.jsx)(ba,{className:`h-full`,createOptions:{value:Ge?.fileContents||``,language:Ge?.language||`plaintext`,readOnly:!0,minimap:{enabled:!1},lineNumbers:`on`,scrollBeyondLastLine:!1,fontSize:13,theme:`v1-dev`,automaticLayout:!0},find:g&&g.filePath===Ge?.filePath?g.search:void 0,replace:g&&g.filePath===Ge?.filePath?g.replacement:void 0})})]})})]})]})})]}),(0,W.jsx)(ro,{messages:he,onClear:m,chatSessionId:v}),(0,W.jsx)(Fo,{isOpen:ue.isModalOpen,onClose:ue.closeModal,onExport:ue.startExport,isExporting:ue.isExporting,exportProgress:ue.progress,exportResult:ue.result,onRetry:ue.retry})]})}function $({className:e,...t}){return(0,W.jsx)(vn,{"data-slot":`label`,className:G(`flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50`,e),...t})}function Yo({className:e,...t}){return(0,W.jsx)(`textarea`,{"data-slot":`textarea`,className:G(`border-input placeholder:text-text-tertiary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,e),...t})}function Xo(){let{isAuthenticated:e}=Un(),[t,n]=(0,H.useState)(null),[r,i]=(0,H.useState)(!0),[a,o]=(0,H.useState)(null),s=(0,H.useCallback)(async()=>{if(!e){i(!1);return}try{n((await U.getUserStats()).data||null)}catch(e){console.error(`Error fetching stats:`,e),o(e instanceof Error?e.message:`Failed to fetch stats`)}finally{i(!1)}},[e]);return(0,H.useEffect)(()=>{s()},[s]),{stats:t,loading:r,error:a,refetch:s}}function Zo(){let{isAuthenticated:e}=Un(),[t,n]=(0,H.useState)([]),[r,i]=(0,H.useState)(!0),[a,o]=(0,H.useState)(null),s=(0,H.useCallback)(async()=>{if(!e){i(!1);return}try{n((await U.getUserActivity()).data?.activities||[])}catch(e){console.error(`Error fetching activity:`,e),o(e instanceof Error?e.message:`Failed to fetch activity`)}finally{i(!1)}},[e]);return(0,H.useEffect)(()=>{s()},[s]),{activities:t,loading:r,error:a,refetch:s}}function Qo(){let{user:e,refreshUser:t}=Un(),n=O(),[r,i]=H.useState(!1),[a,o]=H.useState({displayName:e?.displayName||``,username:e?.username||``,bio:e?.bio||``,timezone:e?.timezone||`UTC`}),[s,c]=H.useState(!1);H.useEffect(()=>{e&&o({displayName:e.displayName||``,username:e.username||``,bio:e.bio||``,timezone:e.timezone||`UTC`})},[e]);let{stats:l,loading:u}=Xo(),{activities:d=[],loading:p}=Zo(),{apps:m,loading:h}=qr(),g=l?.achievements||[];return(0,W.jsxs)(`div`,{className:`min-h-screen bg-bg-3`,children:[(0,W.jsx)(`div`,{className:`container mx-auto px-4 py-8`,children:(0,W.jsx)(`div`,{className:`pb-8`,children:(0,W.jsxs)(`div`,{className:`flex flex-col md:flex-row items-center gap-6`,children:[(0,W.jsxs)(bi,{className:`h-24 w-24 ring-4 ring-background shadow-xl`,children:[(0,W.jsx)(xi,{src:e?.avatarUrl}),(0,W.jsx)(Si,{className:`text-2xl bg-gradient-to-br from-[#f48120] to-[#faae42] text-white`,children:e?.displayName?.charAt(0).toUpperCase()||e?.email?.charAt(0).toUpperCase()||`?`})]}),(0,W.jsxs)(`div`,{className:`flex-1 text-center md:text-left`,children:[(0,W.jsxs)(`div`,{className:`flex flex-col md:flex-row items-center gap-4 mb-2`,children:[(0,W.jsx)(`h1`,{className:`text-3xl font-bold`,children:e?.displayName}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsxs)(Q,{variant:`secondary`,className:`gap-1`,children:[e?.provider===`github`?(0,W.jsx)(`svg`,{className:`h-3 w-3`,viewBox:`0 0 24 24`,fill:`currentColor`,children:(0,W.jsx)(`path`,{d:`M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z`})}):(0,W.jsx)(Zt,{className:`h-3 w-3`}),nr(e?.provider??``)]}),e?.emailVerified&&(0,W.jsxs)(Q,{variant:`secondary`,className:`gap-1`,children:[(0,W.jsx)(E,{className:`h-3 w-3`}),`Verified`]})]})]}),(0,W.jsx)(`p`,{className:`text-text-tertiary mb-1`,children:e?.email}),e?.bio&&(0,W.jsx)(`p`,{className:`text-sm max-w-2xl`,children:e.bio})]}),(0,W.jsx)(`div`,{className:`flex gap-2`,children:r?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(K,{onClick:async()=>{if(!s)try{c(!0),(await U.updateProfile({displayName:a.displayName,username:a.username,bio:a.bio,timezone:a.timezone})).success&&(_.success(`Profile updated successfully`),await t(),i(!1))}catch(e){console.error(`Profile update error:`,e),_.error(`Failed to update profile`)}finally{c(!1)}},size:`sm`,disabled:s,children:[(0,W.jsx)(Ee,{className:`mr-2 h-4 w-4`}),s?`Saving...`:`Save Changes`]}),(0,W.jsxs)(K,{variant:`outline`,onClick:()=>{o({displayName:e?.displayName||``,username:e?.username||``,bio:e?.bio||``,timezone:e?.timezone||`UTC`}),i(!1)},size:`sm`,children:[(0,W.jsx)(Ct,{className:`mr-2 h-4 w-4`}),`Cancel`]})]}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(K,{variant:`outline`,onClick:()=>i(!0),size:`sm`,children:[(0,W.jsx)(k,{className:`mr-2 h-4 w-4`}),`Edit Profile`]}),(0,W.jsxs)(K,{variant:`outline`,onClick:()=>n(`/settings`),size:`sm`,children:[(0,W.jsx)(B,{className:`mr-2 h-4 w-4`}),`Settings`]})]})})]})})}),(0,W.jsxs)(`div`,{className:`container mx-auto px-4 py-8`,children:[(0,W.jsxs)(`div`,{className:`grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8`,children:[(0,W.jsx)(q,{className:`text-center hover:shadow-lg hover:scale-[1.02] transition-all dark:bg-bg-4/50`,children:(0,W.jsxs)(J,{className:`pt-6 relative overflow-hidden`,children:[(0,W.jsx)(St,{className:`h-32 w-32 text-blue-500 absolute -top-10 -left-6 opacity-10`}),(0,W.jsx)(`p`,{className:`text-6xl font-semibold text-gray-700`,children:u?`-`:l?.appCount}),(0,W.jsx)(`p`,{className:`text-md text-gray-500`,children:`Total Apps`})]})}),(0,W.jsx)(q,{className:`text-center hover:shadow-lg hover:scale-[1.02] transition-all dark:bg-bg-4/50`,children:(0,W.jsxs)(J,{className:`pt-6 relative overflow-hidden`,children:[(0,W.jsx)(Zt,{className:`h-32 w-32 text-green-500 absolute -top-10 -left-6 opacity-20`}),(0,W.jsx)(`p`,{className:`text-6xl font-semibold text-gray-700`,children:u?`-`:l?.publicAppCount}),(0,W.jsx)(`p`,{className:`text-md text-gray-500`,children:`Public Apps`})]})}),(0,W.jsx)(q,{className:`text-center hover:shadow-lg hover:scale-[1.02] transition-all dark:bg-bg-4/50`,children:(0,W.jsxs)(J,{className:`pt-6 relative overflow-hidden`,children:[(0,W.jsx)(be,{className:`h-32 w-32 text-purple-500 absolute -top-10 -left-6 opacity-10`}),(0,W.jsx)(`p`,{className:`text-6xl font-semibold text-gray-700`,children:u?`-`:l?.totalViewsReceived}),(0,W.jsx)(`p`,{className:`text-md text-gray-500`,children:`Total Views`})]})}),(0,W.jsx)(q,{className:`text-center hover:shadow-lg hover:scale-[1.02] transition-all dark:bg-bg-4/50`,children:(0,W.jsxs)(J,{className:`pt-6 relative overflow-hidden`,children:[(0,W.jsx)(R,{className:`h-32 w-32 text-yellow-500 absolute -top-10 -left-6 opacity-20`}),(0,W.jsx)(`p`,{className:`text-6xl font-semibold text-gray-700`,children:u?`-`:l?.totalLikesReceived}),(0,W.jsx)(`p`,{className:`text-md text-gray-500`,children:`Total Likes`})]})})]}),(0,W.jsxs)(Lo,{defaultValue:`about`,className:`space-y-6`,children:[(0,W.jsxs)(Ro,{className:`grid w-full max-w-md grid-cols-4`,children:[(0,W.jsx)(zo,{value:`about`,children:`About`}),(0,W.jsx)(zo,{value:`apps`,children:`Apps`}),(0,W.jsx)(zo,{value:`achievements`,children:`Achievements`}),(0,W.jsx)(zo,{value:`activity`,children:`Activity`})]}),(0,W.jsx)(Bo,{value:`about`,className:`space-y-6`,children:(0,W.jsxs)(q,{className:`dark:bg-bg-4/50 max-w-xl`,children:[(0,W.jsx)(Ki,{className:`border-b`,children:(0,W.jsx)(qi,{children:`Profile Information`})}),(0,W.jsxs)(J,{className:`space-y-6`,children:[(0,W.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-6`,children:[(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)($,{htmlFor:`displayName`,children:`Display Name`}),r?(0,W.jsx)(ir,{id:`displayName`,value:a.displayName,onChange:e=>o({...a,displayName:e.target.value})}):(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:e?.displayName})]}),(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)($,{htmlFor:`username`,children:`Username`}),r?(0,W.jsx)(ir,{id:`username`,value:a.username,onChange:e=>o({...a,username:e.target.value}),placeholder:`@username`}):(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:e?.username||`Not set`})]}),(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)($,{htmlFor:`email`,children:`Email`}),(0,W.jsxs)(`p`,{className:`text-sm text-text-tertiary flex items-center gap-2`,children:[(0,W.jsx)(Yt,{className:`h-4 w-4`}),e?.email]})]}),(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)($,{htmlFor:`joined`,children:`Member Since`}),(0,W.jsxs)(`p`,{className:`text-sm text-text-tertiary flex items-center gap-2`,children:[(0,W.jsx)(P,{className:`h-4 w-4`}),e?.createdAt?f(new Date(e.createdAt),`MMMM d, yyyy`):`Unknown`]})]})]}),(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)($,{htmlFor:`bio`,children:`Bio`}),r?(0,W.jsx)(Yo,{id:`bio`,value:a.bio,onChange:e=>o({...a,bio:e.target.value}),placeholder:`Tell us about yourself...`,rows:4}):(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:e?.bio||`No bio provided`})]})]})]})}),(0,W.jsx)(Bo,{value:`apps`,children:(0,W.jsxs)(q,{className:`dark:bg-bg-4/50 max-w-xl`,children:[(0,W.jsx)(Ki,{className:`border-b`,children:(0,W.jsx)(qi,{children:`Recent Applications`})}),(0,W.jsx)(J,{children:h?(0,W.jsx)(`div`,{className:`flex items-center justify-center py-8`,children:(0,W.jsxs)(`div`,{className:`text-center`,children:[(0,W.jsx)(be,{className:`h-8 w-8 mx-auto mb-2 text-text-tertiary animate-pulse`}),(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:`Loading apps...`})]})}):m&&m.length>0?(0,W.jsx)(`div`,{className:`space-y-4`,children:m.slice(0,5).map(e=>(0,W.jsxs)(`div`,{className:`flex items-center justify-between p-4 rounded-lg border hover:bg-bg-3/50 transition-colors cursor-pointer`,onClick:()=>n(`/app/${e.id}`),children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,W.jsx)(`div`,{className:`h-12 w-12 rounded-lg bg-bg-3 flex items-center justify-center`,children:(0,W.jsx)(St,{className:`h-6 w-6`})}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h4`,{className:`font-medium`,children:e.title}),(0,W.jsxs)(`div`,{className:`flex items-center gap-3 mt-1 text-xs text-text-tertiary`,children:[(0,W.jsx)(Q,{variant:`secondary`,className:`text-xs`,children:e.framework}),(0,W.jsx)(`span`,{className:`text-xs`,children:e.createdAt?f(new Date(e.createdAt),`MMM d, yyyy`):`Recently`})]})]})]}),(0,W.jsx)(Q,{variant:e.visibility===`public`?`default`:`secondary`,children:e.visibility})]},e.id))}):(0,W.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-8`,children:[(0,W.jsx)(St,{className:`h-12 w-12 text-text-tertiary mb-4`}),(0,W.jsx)(`p`,{className:`text-text-tertiary`,children:`No apps created yet`}),(0,W.jsx)(K,{className:`mt-4`,onClick:()=>n(`/chat`),children:`Create Your First App`})]})})]})}),(0,W.jsx)(Bo,{value:`achievements`,children:(0,W.jsxs)(q,{className:`dark:bg-bg-4/50 max-w-xl`,children:[(0,W.jsx)(Ki,{children:(0,W.jsx)(qi,{children:`Achievements`})}),(0,W.jsx)(J,{children:u?(0,W.jsx)(`div`,{className:`flex items-center justify-center py-8`,children:(0,W.jsxs)(`div`,{className:`text-center`,children:[(0,W.jsx)(_n,{className:`h-8 w-8 mx-auto mb-2 text-text-tertiary animate-pulse`}),(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:`Loading achievements...`})]})}):g&&g.length>0?(0,W.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4`,children:g.map((e,t)=>(0,W.jsx)(`div`,{className:`p-4 rounded-lg border hover:shadow-md transition-shadow`,children:(0,W.jsxs)(`div`,{className:`flex items-start gap-4`,children:[(0,W.jsx)(`div`,{className:`p-3 rounded-lg bg-bg-3 text-text-tertiary`,children:(0,W.jsx)(_n,{className:`h-6 w-6`})}),(0,W.jsxs)(`div`,{className:`flex-1`,children:[(0,W.jsx)(`h4`,{className:`font-medium`,children:e}),(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary mt-1`,children:`Achievement unlocked!`})]})]})},t))}):(0,W.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-8`,children:[(0,W.jsx)(_n,{className:`h-12 w-12 text-text-tertiary mb-4`}),(0,W.jsx)(`p`,{className:`text-text-tertiary`,children:`No achievements yet`}),(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary mt-2`,children:`Start creating apps to unlock achievements!`})]})})]})}),(0,W.jsx)(Bo,{value:`activity`,children:(0,W.jsxs)(q,{className:`dark:bg-bg-4/50 max-w-xl`,children:[(0,W.jsx)(Ki,{children:(0,W.jsx)(qi,{children:`Activity Timeline`})}),(0,W.jsx)(J,{children:p?(0,W.jsx)(`div`,{className:`flex items-center justify-center py-8`,children:(0,W.jsxs)(`div`,{className:`text-center`,children:[(0,W.jsx)(be,{className:`h-8 w-8 mx-auto mb-2 text-text-tertiary animate-pulse`}),(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:`Loading activity...`})]})}):d&&d.length>0?(0,W.jsx)(`div`,{className:`space-y-4`,children:d.map((e,t)=>(0,W.jsxs)(`div`,{className:`flex items-start gap-4 pb-4 border-b last:border-0`,children:[(0,W.jsxs)(`div`,{className:G(`p-2 rounded-lg`,e.type===`created`&&`bg-green-500/10 text-green-600`,e.type===`updated`&&`bg-blue-500/10 text-blue-600`,e.type===`favorited`&&`bg-yellow-500/10 text-yellow-600`),children:[e.type===`created`&&(0,W.jsx)(Rt,{className:`h-4 w-4`}),e.type===`updated`&&(0,W.jsx)(k,{className:`h-4 w-4`}),e.type===`favorited`&&(0,W.jsx)(R,{className:`h-4 w-4`})]}),(0,W.jsxs)(`div`,{className:`flex-1`,children:[(0,W.jsxs)(`p`,{className:`text-sm`,children:[(0,W.jsxs)(`span`,{className:`font-medium`,children:[e.type===`created`&&`Created`,e.type===`updated`&&`Updated`,e.type===`favorited`&&`Favorited`]}),` `,(0,W.jsx)(`span`,{className:`text-text-tertiary`,children:e.title})]}),(0,W.jsx)(`p`,{className:`text-xs text-text-tertiary mt-1`,children:e.timestamp?f(new Date(e.timestamp),`MMM d, yyyy h:mm a`):`Recently`})]})]},t))}):(0,W.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-8`,children:[(0,W.jsx)(be,{className:`h-12 w-12 text-text-tertiary mb-4`}),(0,W.jsx)(`p`,{className:`text-text-tertiary`,children:`No recent activity`})]})})]})})]})]})]})}var $o=e=>e?e.split(`/`).pop()||e:`Default`,es=e=>e?e.includes(`cerebras/`)?{name:`Cerebras`,color:`bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400`}:e.includes(`[openrouter]`)?{name:`OpenRouter`,color:`bg-pink-100 text-pink-800 dark:bg-pink-900/20 dark:text-pink-400`}:e.includes(`openai/`)||e.includes(`gpt`)||e.includes(`o3`)||e.includes(`o4`)?{name:`OpenAI`,color:`bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400`}:e.includes(`anthropic/`)||e.includes(`claude`)?{name:`Anthropic`,color:`bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-400`}:e.includes(`google-ai-studio/`)||e.includes(`gemini`)?{name:`Google`,color:`bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400`}:{name:`Custom`,color:`bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400`}:{name:`Default`,color:`bg-bg-3 text-text-tertiary`},ts=e=>e.includes(`Code`)||e.includes(`phase`)||e.includes(`file`)?St:e.includes(`fast`)||e.includes(`template`)?Rt:e.includes(`blueprint`)||e.includes(`suggestion`)||e.includes(`review`)?jt:B,ns=(e,t)=>{if(e==null)return null;switch(t){case`temperature`:return`T: ${e}`;case`maxTokens`:return typeof e==`number`?`${Math.round(e/1e3)}K tokens`:String(e);case`reasoningEffort`:return typeof e==`string`?`${e.charAt(0).toUpperCase()}${e.slice(1)}`:String(e);default:return String(e)}};function rs({agent:e,userConfig:t,defaultConfig:n,onConfigure:r,onTest:i,onReset:a,isTesting:o}){let s=t?.isUserOverride||!1,c=t?.name||n?.name,l=$o(c),u=es(c),d=ts(e.key),f=t?.temperature??n?.temperature,p=t?.max_tokens??n?.max_tokens,m=t?.reasoning_effort??n?.reasoning_effort;return(0,W.jsxs)(q,{className:`h-full min-h-[280px] min-w-[280px] flex flex-col overflow-hidden transition-all dark:!bg-bg-3 !bg-bg-3 hover:shadow-md !border-bg-1/40`,children:[(0,W.jsx)(Ki,{className:`pb- flex-shrink-0`,children:(0,W.jsxs)(`div`,{className:`flex items-start justify-between gap-2`,children:[(0,W.jsxs)(`div`,{className:`flex items-start gap-2 min-w-0 flex-1 overflow-hidden`,children:[(0,W.jsx)(`div`,{className:`p-1.5 rounded-md bg-bg-3 shrink-0`,children:(0,W.jsx)(d,{className:`h-4 w-4`})}),(0,W.jsxs)(`div`,{className:`min-w-0 flex-1 overflow-hidden`,children:[(0,W.jsx)(`h5`,{className:`font-medium text-md leading-tight mb-1 break-words`,title:e.name,children:e.name}),(0,W.jsx)(`p`,{className:`text-xs text-text-tertiary line-clamp-3 leading-tight overflow-hidden break-words`,title:e.description,children:e.description})]})]}),(0,W.jsx)(`div`,{className:`shrink-0`,children:(0,W.jsx)(Q,{variant:s?`default`:`outline`,className:`text-xs px-1.5 py-0.5 whitespace-nowrap dark:!bg-bg-1`,children:s?`Custom`:`Default`})})]})}),(0,W.jsxs)(J,{className:`pt-0 flex-1 flex flex-col justify-between overflow-hidden`,children:[(0,W.jsx)(`div`,{className:`space-y-3 overflow-hidden`,children:(0,W.jsxs)(`div`,{className:`space-y-2 pl-7 mt-2`,children:[(0,W.jsxs)(`div`,{className:`flex items-start justify-between gap-2 min-w-0`,children:[(0,W.jsx)(`span`,{className:`text-sm font-medium flex-1 min-w-0 break-words leading-tight`,title:l,children:l}),(0,W.jsx)(Q,{variant:`secondary`,className:`text-xs shrink-0 px-1.5 py-0.5 mt-0.5 dark:contrast-50 ${u.color}`,children:u.name})]}),(0,W.jsxs)(`div`,{className:`flex flex-wrap gap-1 overflow-hidden`,children:[f==null?null:(0,W.jsx)(mr,{children:(0,W.jsxs)(hr,{children:[(0,W.jsx)(gr,{asChild:!0,children:(0,W.jsx)(Q,{variant:`outline`,className:`text-xs px-1.5 py-0.5 shrink-0 dark:bg-accent/20`,children:ns(f,`temperature`)})}),(0,W.jsx)(_r,{children:(0,W.jsxs)(`p`,{children:[`Temperature: `,f]})})]})}),p?(0,W.jsx)(mr,{children:(0,W.jsxs)(hr,{children:[(0,W.jsx)(gr,{asChild:!0,children:(0,W.jsx)(Q,{variant:`outline`,className:`text-xs px-1.5 py-0.5 shrink-0 dark:bg-accent/20`,children:ns(p,`maxTokens`)})}),(0,W.jsx)(_r,{children:(0,W.jsxs)(`p`,{children:[`Max Tokens: `,p?.toLocaleString()]})})]})}):null,m?(0,W.jsx)(mr,{children:(0,W.jsxs)(hr,{children:[(0,W.jsx)(gr,{asChild:!0,children:(0,W.jsx)(Q,{variant:`outline`,className:`text-xs px-1.5 py-0.5 shrink-0 dark:bg-accent/20`,children:ns(m,`reasoningEffort`)})}),(0,W.jsx)(_r,{children:(0,W.jsxs)(`p`,{children:[`Reasoning Effort: `,m]})})]})}):null]})]})}),(0,W.jsxs)(`div`,{className:`flex gap-2 mt-3 shrink-0`,children:[(0,W.jsxs)(K,{size:`sm`,variant:`outline`,onClick:r,className:`flex-1 h-8 text-xs font-medium min-w-0 dark:bg-bg-2`,children:[(0,W.jsx)(B,{className:`h-3 w-3 mr-1`}),(0,W.jsx)(`span`,{className:`truncate`,children:`Configure`})]}),(0,W.jsx)(mr,{children:(0,W.jsxs)(hr,{children:[(0,W.jsx)(gr,{asChild:!0,children:(0,W.jsx)(K,{size:`sm`,variant:`ghost`,onClick:i,disabled:o,className:`h-8 w-8 p-0 shrink-0`,children:o?(0,W.jsx)(B,{className:`h-3 w-3 animate-spin`}):(0,W.jsx)(Cn,{className:`h-3 w-3`})})}),(0,W.jsx)(_r,{children:(0,W.jsx)(`p`,{children:o?`Testing...`:`Test Config`})})]})}),s&&(0,W.jsx)(mr,{children:(0,W.jsxs)(hr,{children:[(0,W.jsx)(gr,{asChild:!0,children:(0,W.jsx)(K,{size:`sm`,variant:`ghost`,onClick:a,className:`h-8 w-8 p-0 text-text-tertiary shrink-0`,children:(0,W.jsx)(ne,{className:`h-3 w-3`})})}),(0,W.jsx)(_r,{children:(0,W.jsx)(`p`,{children:`Reset to Default`})})]})})]})]})]})}function is({...e}){return(0,W.jsx)(Gt,{"data-slot":`select`,...e})}function as({...e}){return(0,W.jsx)(Qe,{"data-slot":`select-value`,...e})}function os({className:e,size:t=`default`,children:n,...r}){return(0,W.jsxs)(vt,{"data-slot":`select-trigger`,"data-size":t,className:G(`border-input data-[placeholder]:text-text-tertiary [&_svg:not([class*='text-'])]:text-text-tertiary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4`,e),...r,children:[n,(0,W.jsx)(st,{asChild:!0,children:(0,W.jsx)(pn,{className:`size-4 opacity-50`})})]})}function ss({className:e,children:t,position:n=`popper`,...r}){return(0,W.jsx)(ht,{children:(0,W.jsxs)($t,{"data-slot":`select-content`,className:G(`bg-bg-4 text-text-primary data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md`,n===`popper`&&`data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1`,e),position:n,...r,children:[(0,W.jsx)(ls,{}),(0,W.jsx)(ln,{className:G(`p-1`,n===`popper`&&`h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1`),children:t}),(0,W.jsx)(us,{})]})})}function cs({className:e,children:t,...n}){return(0,W.jsxs)(Nt,{"data-slot":`select-item`,className:G(`focus:bg-accent focus:text-text-secondary [&_svg:not([class*='text-'])]:text-text-tertiary relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2`,e),...n,children:[(0,W.jsx)(`span`,{className:`absolute right-2 flex size-3.5 items-center justify-center`,children:(0,W.jsx)(on,{children:(0,W.jsx)(Ie,{className:`size-4`})})}),(0,W.jsx)(ut,{children:t})]})}function ls({className:e,...t}){return(0,W.jsx)(xt,{"data-slot":`select-scroll-up-button`,className:G(`flex cursor-default items-center justify-center py-1`,e),...t,children:(0,W.jsx)(gn,{className:`size-4`})})}function us({className:e,...t}){return(0,W.jsx)(It,{"data-slot":`select-scroll-down-button`,className:G(`flex cursor-default items-center justify-center py-1`,e),...t,children:(0,W.jsx)(pn,{className:`size-4`})})}function ds({...e}){return(0,W.jsx)(tt,{"data-slot":`popover`,...e})}function fs({...e}){return(0,W.jsx)(Ht,{"data-slot":`popover-trigger`,...e})}function ps({className:e,align:t=`center`,sideOffset:n=4,...r}){return(0,W.jsx)(wt,{children:(0,W.jsx)(Xt,{"data-slot":`popover-content`,align:t,sideOffset:n,className:G(`bg-bg-4 text-text-primary data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden`,e),...r})})}var ms=e=>e||``;function hs({value:e,onValueChange:t,availableModels:n,placeholder:r,label:i,systemDefault:a,includeDefaultOption:o=!1,disabled:s=!1,className:c}){let[l,u]=(0,H.useState)(!1),[d,f]=(0,H.useState)(``),p=(0,H.useRef)(null),m=(0,H.useMemo)(()=>d?n.filter(e=>e.label.toLowerCase().includes(d.toLowerCase())):n,[n,d]),h=()=>e===`default`&&o?`Use default`:e&&e!==`default`?n.find(t=>t.value===e)?.label||e:``,g=e=>e.provider&&e.provider!==``?e.hasUserKey?(0,W.jsx)(Q,{variant:`default`,className:`text-xs`,children:`BYOK`}):(0,W.jsx)(Q,{variant:`outline`,className:`text-xs`,children:`Key needed`}):(0,W.jsx)(Q,{variant:`secondary`,className:`text-xs`,children:`Platform`});return(0,W.jsxs)(`div`,{className:G(`space-y-2`,c),children:[(0,W.jsx)($,{className:`text-sm font-medium`,children:i}),(0,W.jsxs)(ds,{open:l,onOpenChange:u,children:[(0,W.jsx)(fs,{asChild:!0,children:(0,W.jsxs)(K,{variant:`outline`,role:`combobox`,"aria-expanded":l,className:`w-full justify-between`,disabled:s,children:[h()||r,(0,W.jsx)(pn,{className:`ml-2 h-4 w-4 shrink-0 opacity-50`})]})}),(0,W.jsxs)(ps,{className:`w-full p-0`,style:{width:`var(--radix-popover-trigger-width)`},children:[(0,W.jsxs)(`div`,{className:`flex items-center border-b border-border-primary px-3 py-2`,children:[(0,W.jsx)(xe,{className:`mr-2 h-4 w-4 shrink-0 text-text-tertiary`}),(0,W.jsx)(ir,{placeholder:`Search models...`,value:d,onChange:e=>f(e.target.value),className:`h-8 border-0 bg-transparent p-0 placeholder:text-text-tertiary focus-visible:outline-none focus-visible:ring-0 focus-visible:ring-offset-0`})]}),(0,W.jsxs)(`div`,{ref:p,className:`max-h-[300px] overflow-y-auto p-1 scroll-smooth`,onWheel:e=>{e.stopPropagation()},children:[m.length===0&&!o&&(0,W.jsx)(`div`,{className:`py-6 text-center text-sm text-text-tertiary`,children:`No models found.`}),o&&(0,W.jsx)(`div`,{onClick:()=>{t(`default`),u(!1),f(``)},className:G(`relative flex cursor-pointer select-none items-center justify-between rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-text-secondary focus:bg-accent focus:text-text-secondary`,e===`default`&&`bg-accent text-text-secondary`),children:(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(Ie,{className:G(`h-4 w-4 text-text-primary`,e===`default`?`opacity-100`:`opacity-0`)}),(0,W.jsx)(`span`,{className:`font-medium`,children:`Use default`})]})},`default`),m.map(n=>(0,W.jsxs)(`div`,{onClick:()=>{t(n.value),u(!1),f(``)},className:G(`relative flex cursor-pointer select-none items-center justify-between rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-text-secondary focus:bg-accent focus:text-text-secondary`,e===n.value&&`bg-accent text-text-secondary`),children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2 min-w-0 flex-1`,children:[(0,W.jsx)(Ie,{className:G(`h-4 w-4 text-text-primary shrink-0`,e===n.value?`opacity-100`:`opacity-0`)}),(0,W.jsx)(`span`,{className:`truncate`,children:n.label})]}),(0,W.jsx)(`div`,{className:`flex items-center gap-1 ml-2 shrink-0`,children:g(n)})]},n.value))]})]})]}),a&&(0,W.jsxs)(`p`,{className:`text-xs text-text-tertiary`,children:[` System default: `,ms(a)]})]})}var gs=o(`relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current`,{variants:{variant:{default:`bg-bg-4 text-text-primary`,destructive:`text-destructive bg-bg-4 [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90`}},defaultVariants:{variant:`default`}});function _s({className:e,variant:t,...n}){return(0,W.jsx)(`div`,{"data-slot":`alert`,role:`alert`,className:G(gs({variant:t}),e),...n})}function vs({className:e,...t}){return(0,W.jsx)(`div`,{"data-slot":`alert-description`,className:G(`text-text-tertiary col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed`,e),...t})}function ys({className:e,...t}){return(0,W.jsx)(nn,{"data-slot":`switch`,className:G(`peer data-[state=checked]:bg-text-secondary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50`,e),...t,children:(0,W.jsx)(zt,{"data-slot":`switch-thumb`,className:G(`bg-bg-3 dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-text-text-secondary pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0`)})})}var bs=e=>(0,W.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,width:256,height:260,preserveAspectRatio:`xMidYMid`,viewBox:`0 0 256 260`,...e,children:(0,W.jsx)(`path`,{d:`M239.184 106.203a64.716 64.716 0 0 0-5.576-53.103C219.452 28.459 191 15.784 163.213 21.74A65.586 65.586 0 0 0 52.096 45.22a64.716 64.716 0 0 0-43.23 31.36c-14.31 24.602-11.061 55.634 8.033 76.74a64.665 64.665 0 0 0 5.525 53.102c14.174 24.65 42.644 37.324 70.446 31.36a64.72 64.72 0 0 0 48.754 21.744c28.481.025 53.714-18.361 62.414-45.481a64.767 64.767 0 0 0 43.229-31.36c14.137-24.558 10.875-55.423-8.083-76.483Zm-97.56 136.338a48.397 48.397 0 0 1-31.105-11.255l1.535-.87 51.67-29.825a8.595 8.595 0 0 0 4.247-7.367v-72.85l21.845 12.636c.218.111.37.32.409.563v60.367c-.056 26.818-21.783 48.545-48.601 48.601Zm-104.466-44.61a48.345 48.345 0 0 1-5.781-32.589l1.534.921 51.722 29.826a8.339 8.339 0 0 0 8.441 0l63.181-36.425v25.221a.87.87 0 0 1-.358.665l-52.335 30.184c-23.257 13.398-52.97 5.431-66.404-17.803ZM23.549 85.38a48.499 48.499 0 0 1 25.58-21.333v61.39a8.288 8.288 0 0 0 4.195 7.316l62.874 36.272-21.845 12.636a.819.819 0 0 1-.767 0L41.353 151.53c-23.211-13.454-31.171-43.144-17.804-66.405v.256Zm179.466 41.695-63.08-36.63L161.73 77.86a.819.819 0 0 1 .768 0l52.233 30.184a48.6 48.6 0 0 1-7.316 87.635v-61.391a8.544 8.544 0 0 0-4.4-7.213Zm21.742-32.69-1.535-.922-51.619-30.081a8.39 8.39 0 0 0-8.492 0L99.98 99.808V74.587a.716.716 0 0 1 .307-.665l52.233-30.133a48.652 48.652 0 0 1 72.236 50.391v.205ZM88.061 139.097l-21.845-12.585a.87.87 0 0 1-.41-.614V65.685a48.652 48.652 0 0 1 79.757-37.346l-1.535.87-51.67 29.825a8.595 8.595 0 0 0-4.246 7.367l-.051 72.697Zm11.868-25.58 28.138-16.217 28.188 16.218v32.434l-28.086 16.218-28.188-16.218-.052-32.434Z`})}),xs=e=>(0,W.jsxs)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,shapeRendering:`geometricPrecision`,textRendering:`geometricPrecision`,imageRendering:`optimizeQuality`,fillRule:`evenodd`,clipRule:`evenodd`,viewBox:`0 0 512 512`,...e,children:[(0,W.jsx)(`rect`,{fill:`#CC9B7A`,width:512,height:512,rx:104.187,ry:105.042}),(0,W.jsx)(`path`,{fill:`#1F1F1E`,fillRule:`nonzero`,d:`M318.663 149.787h-43.368l78.952 212.423 43.368.004-78.952-212.427zm-125.326 0l-78.952 212.427h44.255l15.932-44.608 82.846-.004 16.107 44.612h44.255l-79.126-212.427h-45.317zm-4.251 128.341l26.91-74.701 27.083 74.701h-53.993z`})]}),Ss=e=>(0,W.jsxs)(`svg`,{fill:`none`,xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 16 16`,...e,children:[(0,W.jsx)(`path`,{d:`M16 8.016A8.522 8.522 0 008.016 16h-.032A8.521 8.521 0 000 8.016v-.032A8.521 8.521 0 007.984 0h.032A8.522 8.522 0 0016 7.984v.032z`,fill:`url(#prefix__paint0_radial_980_20147)`}),(0,W.jsx)(`defs`,{children:(0,W.jsxs)(`radialGradient`,{id:`prefix__paint0_radial_980_20147`,cx:0,cy:0,r:1,gradientUnits:`userSpaceOnUse`,gradientTransform:`matrix(16.1326 5.4553 -43.70045 129.2322 1.588 6.503)`,children:[(0,W.jsx)(`stop`,{offset:.067,stopColor:`#9168C0`}),(0,W.jsx)(`stop`,{offset:.343,stopColor:`#5684D1`}),(0,W.jsx)(`stop`,{offset:.672,stopColor:`#1BA1E3`})]})})]}),Cs=e=>(0,W.jsx)(`svg`,{viewBox:`0 0 1124.6 495.25`,xmlns:`http://www.w3.org/2000/svg`,...e,children:(0,W.jsxs)(`g`,{transform:`translate(-2.2762e-5 -.00037576)`,children:[(0,W.jsx)(`path`,{d:`m247.63 479.03c-127.8 0-231.4-103.6-231.4-231.4 0-127.8 103.6-231.4 231.4-231.4m-119.21 374.41c-78.853-66.16-89.133-183.71-22.973-262.56 66.16-78.853 183.71-89.133 262.56-22.973m-187 267.59c-69.027-36.44-95.453-121.95-59.013-190.97 36.44-69.04 121.93-95.453 190.97-59.013m-65.333 221.23c-53.187 0-96.307-43.12-96.307-96.307s43.12-96.307 96.307-96.307`,fill:`none`,stroke:`#f15a29`,strokeMiterlimit:10,strokeWidth:32.453}),(0,W.jsx)(`path`,{d:`m277.37 220.7c-3.76-3.96-7.6933-7.12-11.8-9.4667-4.1067-2.3467-8.3067-3.52-12.6-3.52-5.8933 0-11.173 1.08-15.813 3.24-4.6533 2.1733-8.6267 5.0533-11.933 8.6667-3.32 3.6-5.8133 7.7467-7.52 12.44-1.6933 4.6933-2.5467 9.56-2.5467 14.6 0 5.0533 0.85334 9.9333 2.5467 14.613 1.7067 4.6933 4.2 8.84 7.52 12.44 3.3067 3.6133 7.28 6.4933 11.933 8.6667 4.64 2.16 9.92 3.24 15.813 3.24 5 0 9.6533-1.04 13.947-3.1067 4.2933-2.08 7.9467-5.0933 10.987-9.0667l21.453 23.267c-3.2133 3.24-6.9333 6.04-11.133 8.3867-4.2 2.3467-8.44 4.24-12.733 5.68-4.28 1.44-8.4 2.4667-12.333 3.1067-3.9333 0.62666-7.3333 0.94666-10.187 0.94666-9.6533 0-18.773-1.6267-27.347-4.8667-8.5867-3.2533-16-7.84-22.253-13.8-6.2667-5.9467-11.227-13.12-14.88-21.507-3.6667-8.3867-5.5067-17.707-5.5067-28 0-10.267 1.84-19.6 5.5067-27.987 3.6533-8.3867 8.6133-15.56 14.88-21.507 6.2533-5.9467 13.667-10.547 22.253-13.8 8.5733-3.24 17.693-4.8667 27.347-4.8667 8.2133 0 16.493 1.5867 24.8 4.7333 8.32 3.16 15.6 8.16 21.853 15.013z`}),(0,W.jsx)(`path`,{d:`m394.28 233.68c-0.17333-9.56-3.1333-17.08-8.8533-22.587-5.72-5.4933-13.667-8.2533-23.853-8.2533-9.6533 0-17.307 2.8-22.933 8.3867-5.6267 5.6-9.0667 13.08-10.32 22.453zm-65.96 24.347c1.0667 9.7333 4.8267 17.307 11.267 22.72 6.4267 5.4133 14.2 8.12 23.32 8.12 8.04 0 14.787-1.6667 20.24-5.0133 5.4533-3.3333 10.24-7.52 14.347-12.573l23.067 17.587c-7.5067 9.3733-15.92 16.053-25.213 20.013-9.2933 3.96-19.027 5.9467-29.227 5.9467-9.64 0-18.76-1.6267-27.347-4.8667-8.5733-3.24-16-7.84-22.253-13.8-6.2533-5.9467-11.213-13.107-14.88-21.493-3.6667-8.3867-5.4933-17.72-5.4933-28 0-10.28 1.8267-19.613 5.4933-28 3.6667-8.3867 8.6267-15.56 14.88-21.507 6.2533-5.9467 13.68-10.547 22.253-13.8 8.5867-3.24 17.707-4.8667 27.347-4.8667 8.9467 0 17.12 1.5867 24.533 4.7333 7.4267 3.16 13.773 7.72 19.04 13.667 5.28 5.9467 9.3867 13.293 12.333 22.04 2.96 8.76 4.4267 18.8 4.4267 30.16v8.9333z`}),(0,W.jsx)(`path`,{d:`m440.39 181.74h32.173v20.56h0.53333c3.5733-7.5733 8.68-13.427 15.293-17.587 6.6-4.1467 14.213-6.2133 22.787-6.2133 1.96 0 3.8933 0.17333 5.76 0.53333 1.88 0.36 3.8 0.81334 5.7733 1.36v31.373c-2.68-0.72-5.32-1.3067-7.92-1.76-2.5867-0.45333-5.1333-0.68-7.64-0.68-7.5067 0-13.533 1.4-18.093 4.2s-8.04 6-10.453 9.6c-2.4133 3.6133-4.0267 7.2133-4.8267 10.827-0.81333 3.6-1.2133 6.3067-1.2133 8.1067v69.52h-32.173z`}),(0,W.jsx)(`path`,{d:`m620.85 233.68c-0.18667-9.56-3.1333-17.08-8.8533-22.587-5.72-5.4933-13.667-8.2533-23.853-8.2533-9.6533 0-17.307 2.8-22.933 8.3867-5.6267 5.6-9.0667 13.08-10.32 22.453zm-65.96 24.347c1.0667 9.7333 4.8267 17.307 11.267 22.72 6.4267 5.4133 14.2 8.12 23.32 8.12 8.04 0 14.787-1.6667 20.24-5.0133 5.4533-3.3333 10.24-7.52 14.347-12.573l23.067 17.587c-7.5067 9.3733-15.92 16.053-25.213 20.013-9.2933 3.96-19.027 5.9467-29.227 5.9467-9.6533 0-18.76-1.6267-27.347-4.8667-8.5733-3.24-16-7.84-22.253-13.8-6.2533-5.9467-11.213-13.107-14.88-21.493-3.6667-8.3867-5.4933-17.72-5.4933-28 0-10.28 1.8267-19.613 5.4933-28 3.6667-8.3867 8.6267-15.56 14.88-21.507 6.2533-5.9467 13.68-10.547 22.253-13.8 8.5867-3.24 17.693-4.8667 27.347-4.8667 8.9467 0 17.12 1.5867 24.533 4.7333 7.4267 3.16 13.773 7.72 19.04 13.667 5.2667 5.9467 9.3867 13.293 12.333 22.04 2.96 8.76 4.4267 18.8 4.4267 30.16v8.9333z`}),(0,W.jsx)(`path`,{d:`m768.32 246.66c0-5.04-0.85333-9.92-2.5467-14.6-1.7067-4.6933-4.2-8.84-7.5067-12.453-3.32-3.6-7.2933-6.4933-11.933-8.6533-4.6533-2.16-9.92-3.24-15.827-3.24-5.8933 0-11.16 1.08-15.813 3.24s-8.6267 5.0533-11.933 8.6533c-3.3067 3.6133-5.8133 7.76-7.5067 12.453-1.7067 4.68-2.5467 9.56-2.5467 14.6 0 5.0533 0.84 9.92 2.5467 14.613 1.6933 4.68 4.2 8.84 7.5067 12.44 3.3067 3.6133 7.28 6.4933 11.933 8.6533s9.92 3.2533 15.813 3.2533c5.9067 0 11.173-1.0933 15.827-3.2533 4.64-2.16 8.6133-5.04 11.933-8.6533 3.3067-3.6 5.8-7.76 7.5067-12.44 1.6933-4.6933 2.5467-9.56 2.5467-14.613m-106.72-139.57h32.173v91.147h0.81333c1.6-2.16 3.6533-4.36 6.16-6.6133 2.5067-2.2533 5.5467-4.3733 9.12-6.36 3.5733-1.9867 7.68-3.6133 12.333-4.8667 4.64-1.2667 10.013-1.8933 16.093-1.8933 9.1067 0 17.507 1.7467 25.2 5.2667 7.68 3.52 14.253 8.3467 19.707 14.467 5.4533 6.1333 9.6933 13.36 12.733 21.653s4.56 17.213 4.56 26.773-1.4267 18.493-4.2933 26.787c-2.8533 8.2933-7.0533 15.507-12.6 21.64-5.5333 6.1333-12.24 10.947-20.107 14.467-7.8667 3.52-16.72 5.28-26.547 5.28-9.12 0-17.6-1.8133-25.467-5.4133-7.88-3.6133-14.133-9.3733-18.773-17.32h-0.53333v19.48h-30.573z`}),(0,W.jsx)(`path`,{d:`m814.43 181.74h32.173v20.56h0.53333c3.5733-7.5733 8.68-13.427 15.293-17.587 6.6-4.1467 14.213-6.2133 22.787-6.2133 1.96 0 3.8933 0.17333 5.76 0.53333 1.88 0.36 3.8 0.81334 5.7733 1.36v31.373c-2.68-0.72-5.32-1.3067-7.92-1.76-2.5867-0.45333-5.1333-0.68-7.64-0.68-7.5067 0-13.533 1.4-18.093 4.2s-8.04 6-10.453 9.6c-2.4133 3.6133-4.0267 7.2133-4.8267 10.827-0.81333 3.6-1.2133 6.3067-1.2133 8.1067v69.52h-32.173z`}),(0,W.jsx)(`path`,{d:`m981.21 253.43h-6.7067c-4.4667 0-9.4667 0.18667-15.013 0.54667-5.5467 0.36-10.773 1.2133-15.68 2.56-4.92 1.36-9.08 3.3467-12.467 5.96-3.4 2.6133-5.1067 6.2667-5.1067 10.947 0 3.0667 0.68 5.64 2.0133 7.7067 1.3467 2.08 3.0933 3.84 5.2267 5.28 2.1467 1.44 4.56 2.48 7.24 3.1067 2.6933 0.64 5.3733 0.94667 8.0533 0.94667 11.08 0 19.253-2.6533 24.533-7.9733 5.2667-5.32 7.9067-12.587 7.9067-21.773zm1.88 40.307h-0.81333c-4.64 7.4-10.547 12.76-17.693 16.093-7.1467 3.3333-15.013 5-23.587 5-5.9067 0-11.667-0.81333-17.307-2.4267-5.6267-1.6267-10.627-4.0667-15.013-7.3067-4.3867-3.2533-7.9067-7.3067-10.587-12.173s-4.0267-10.547-4.0267-17.04c0-7.04 1.2533-13.027 3.76-17.987 2.4933-4.96 5.8533-9.1067 10.053-12.453 4.2-3.3333 9.0667-5.9867 14.613-7.9733 5.5333-1.9867 11.307-3.4667 17.293-4.4667 5.9867-0.98667 12.027-1.6267 18.093-1.8933 6.08-0.26666 11.8-0.4 17.173-0.4h8.04v-3.52c0-8.12-2.7733-14.2-8.32-18.253-5.5333-4.0667-12.6-6.0933-21.173-6.0933-6.8 0-13.147 1.2133-19.04 3.6533-5.9067 2.44-11 5.72-15.28 9.88l-16.893-17.053c7.1467-7.3867 15.507-12.707 25.067-15.96 9.56-3.24 19.44-4.8667 29.627-4.8667 9.12 0 16.8 1.04 23.067 3.1067 6.2533 2.08 11.427 4.7467 15.547 7.9867 4.1067 3.24 7.28 6.9867 9.52 11.227 2.2267 4.24 3.84 8.52 4.8267 12.853 0.9733 4.32 1.56 8.52 1.7333 12.573 0.1867 4.0533 0.28 7.6267 0.28 10.68v74.667h-28.96z`}),(0,W.jsx)(`path`,{d:`m1099.2 217.72c-6.2533-8.84-14.667-13.253-25.2-13.253-4.2933 0-8.4933 1.08-12.6 3.24-4.12 2.1733-6.1733 5.68-6.1733 10.547 0 3.9733 1.6933 6.8667 5.0933 8.6667s7.68 3.3333 12.867 4.6c5.1866 1.2533 10.773 2.56 16.76 3.92 5.9866 1.3467 11.573 3.4267 16.76 6.2133 5.1866 2.8 9.48 6.6267 12.867 11.507 3.4 4.8667 5.0934 11.533 5.0934 20.013 0 7.76-1.6534 14.293-4.96 19.613-3.3067 5.32-7.6 9.6-12.867 12.853-5.2667 3.24-11.213 5.5867-17.827 7.0267-6.6133 1.44-13.227 2.16-19.84 2.16-10.013 0-19.227-1.44-27.627-4.32-8.4-2.8933-15.907-8.12-22.52-15.693l21.453-20.293c4.1067 4.6933 8.5333 8.52 13.267 11.507 4.7333 2.9733 10.507 4.4533 17.293 4.4533 2.3333 0 4.7467-0.26666 7.24-0.81333 2.5067-0.53333 4.8267-1.44 6.9733-2.7067 2.1467-1.2533 3.8934-2.8267 5.2267-4.72 1.3467-1.8933 2.0133-4.1067 2.0133-6.64 0-4.4933-1.6933-7.84-5.0933-10-3.4-2.16-7.68-3.92-12.867-5.28-5.1866-1.3467-10.773-2.6133-16.76-3.7867-5.9866-1.1733-11.573-3.0667-16.76-5.68-5.1866-2.6133-9.48-6.2667-12.867-10.947-3.4-4.6933-5.0934-11.187-5.0934-19.48 0-7.2133 1.4667-13.48 4.4134-18.8 2.96-5.32 6.84-9.6933 11.667-13.12 4.8267-3.4267 10.373-5.96 16.627-7.5733 6.2533-1.6267 12.6-2.44 19.04-2.44 8.5733 0 17.067 1.4933 25.467 4.4667 8.4 2.9733 15.2 8.0667 20.387 15.28z`})]})}),ws=e=>(0,W.jsxs)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 32 32`,width:64,height:64,...e,children:[(0,W.jsx)(`path`,{d:`M8.16 23h21.177v-5.86l-4.023-2.307-.694-.3-16.46.113z`,fill:`#fff`}),(0,W.jsx)(`path`,{d:`M22.012 22.222c.197-.675.122-1.294-.206-1.754-.3-.422-.807-.666-1.416-.694l-11.545-.15c-.075 0-.14-.038-.178-.094s-.047-.13-.028-.206c.038-.113.15-.197.272-.206l11.648-.15c1.38-.066 2.88-1.182 3.404-2.55l.666-1.735a.38.38 0 0 0 .02-.225c-.75-3.395-3.78-5.927-7.4-5.927-3.34 0-6.17 2.157-7.184 5.15-.657-.488-1.5-.75-2.392-.666-1.604.16-2.9 1.444-3.048 3.048a3.58 3.58 0 0 0 .084 1.191A4.84 4.84 0 0 0 0 22.1c0 .234.02.47.047.703.02.113.113.197.225.197H21.58a.29.29 0 0 0 .272-.206l.16-.572z`,fill:`#f38020`}),(0,W.jsx)(`path`,{d:`M25.688 14.803l-.32.01c-.075 0-.14.056-.17.13l-.45 1.566c-.197.675-.122 1.294.206 1.754.3.422.807.666 1.416.694l2.457.15c.075 0 .14.038.178.094s.047.14.028.206c-.038.113-.15.197-.272.206l-2.56.15c-1.388.066-2.88 1.182-3.404 2.55l-.188.478c-.038.094.028.188.13.188h8.797a.23.23 0 0 0 .225-.169A6.41 6.41 0 0 0 32 21.106a6.32 6.32 0 0 0-6.312-6.302`,fill:`#faae40`})]}),Ts={openai:bs,anthropic:xs,"google-ai-studio":Ss,cerebras:Cs};function Es(e){let t=Ts[e.provider]||(()=>(0,W.jsx)(`div`,{className:`w-4 h-4 bg-gray-300 rounded`}));return{id:e.id,name:e.displayName.replace(` (BYOK)`,``),provider:e.provider,logo:t,placeholder:e.placeholder,validation:new RegExp(e.validation)}}function Ds({isOpen:e,onClose:t,onKeyAdded:n}){let[r,i]=(0,H.useState)(`add`),[a,o]=(0,H.useState)(null),[s,c]=(0,H.useState)(``),[l,u]=(0,H.useState)(!1),[d,f]=(0,H.useState)([]),[p,m]=(0,H.useState)(!0),[h,g]=(0,H.useState)([]),[v,y]=(0,H.useState)(!1),[b,x]=(0,H.useState)(null),[S,w]=(0,H.useState)(!1),[T,E]=(0,H.useState)(null),[D,O]=(0,H.useState)(!1),k=d.find(e=>e.id===a);(0,H.useEffect)(()=>{e&&(o(null),c(``),u(!1),x(null),w(!1),E(null),O(!1),A(),j())},[e]);let A=async()=>{try{m(!0);let e=await U.getBYOKTemplates();e.success&&e.data?f(e.data.templates.map(Es)):_.error(`Failed to load BYOK providers`)}catch(e){console.error(`Error loading BYOK templates:`,e),_.error(`Failed to load BYOK providers`)}finally{m(!1)}},j=async()=>{try{y(!0);let e=await U.getAllSecrets();e.success&&e.data?g(e.data.secrets.filter(e=>e.secretType.endsWith(`_BYOK`)).map(e=>{let t=Ts[e.provider]||(()=>(0,W.jsx)(`div`,{className:`w-4 h-4 bg-gray-300 rounded`}));return{id:e.id,name:e.name,provider:e.provider,keyPreview:e.keyPreview,isActive:e.isActive??!1,lastUsed:e.lastUsed?e.lastUsed.toString():null,createdAt:e.createdAt?.toString()??``,logo:t}})):_.error(`Failed to load managed secrets`)}catch(e){console.error(`Error loading managed secrets:`,e),_.error(`Failed to load managed secrets`)}finally{y(!1)}},M=e=>{o(e),c(``)},N=k&&s&&k.validation.test(s),P=async()=>{if(!(!k||!s||!N)){u(!0);try{await U.storeSecret({templateId:k.id,value:s.trim(),environment:`production`}),_.success(`${k.name} API key added successfully!`),n?.(),await j(),i(`manage`),o(null),c(``)}catch(e){console.error(`Failed to save API key:`,e),_.error(`Failed to save API key. Please try again.`)}finally{u(!1)}}},F=async e=>{x(e);try{let t=await U.toggleSecret(e);if(t.success&&t.data){let r=t.data.secret;_.success(t.data.message),g(t=>t.map(t=>t.id===e?{...t,isActive:r.isActive??!1}:t)),n?.()}else _.error(`Failed to toggle secret status`)}catch(e){console.error(`Error toggling secret:`,e),_.error(`Failed to toggle secret status`)}finally{x(null)}},I=async()=>{if(T){O(!0);try{await U.deleteSecret(T.id),_.success(`${T.name} API key deleted successfully`),g(e=>e.filter(e=>e.id!==T.id)),n?.(),w(!1),E(null)}catch(e){console.error(`Error deleting secret:`,e),_.error(`Failed to delete API key`)}finally{O(!1)}}},L=e=>{E(e),w(!0)},R=e=>new Date(e).toLocaleDateString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`});return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Mi,{open:e,onOpenChange:t,children:(0,W.jsxs)(Fi,{className:`max-w-2xl max-h-[80vh] overflow-y-auto`,children:[(0,W.jsxs)(Ii,{children:[(0,W.jsxs)(Ri,{className:`flex items-center gap-2`,children:[(0,W.jsx)(pt,{className:`h-5 w-5`}),`Bring Your Own Key`,(0,W.jsxs)(`span`,{className:`flex items-center gap-1 text-xs text-text-tertiary font-normal`,children:[`via `,(0,W.jsx)(ws,{className:`h-3 w-3`}),` AI Gateway`]})]}),(0,W.jsx)(zi,{children:`Add your API keys to use your own provider accounts for billing, or manage existing keys`})]}),(0,W.jsxs)(Lo,{value:r,onValueChange:e=>i(e),className:`space-y-6`,children:[(0,W.jsxs)(Ro,{className:`grid w-full grid-cols-2`,children:[(0,W.jsxs)(zo,{value:`add`,className:`flex items-center gap-2`,children:[(0,W.jsx)(je,{className:`h-4 w-4`}),`Add Keys`]}),(0,W.jsxs)(zo,{value:`manage`,className:`flex items-center gap-2`,children:[(0,W.jsx)(B,{className:`h-4 w-4`}),`Manage Keys`]})]}),(0,W.jsxs)(Bo,{value:`add`,className:`space-y-6`,children:[(0,W.jsxs)(`div`,{className:`space-y-3`,children:[(0,W.jsx)($,{className:`text-sm font-medium`,children:`Select Provider`}),p?(0,W.jsx)(`div`,{className:`space-y-2`,children:[1,2,3,4].map(e=>(0,W.jsxs)(`div`,{className:`w-full flex items-center gap-3 p-3 rounded-lg border-2 border-gray-200`,children:[(0,W.jsx)(`div`,{className:`w-8 h-8 bg-gray-200 rounded-md animate-pulse`}),(0,W.jsx)(`div`,{className:`h-4 bg-gray-200 rounded animate-pulse flex-1`})]},e))}):(0,W.jsx)(`div`,{className:`space-y-2`,children:d.map(e=>{let t=e.logo;return(0,W.jsxs)(`button`,{onClick:()=>M(e.id),className:`w-full flex items-center gap-3 p-3 rounded-lg border-2 transition-all duration-200 text-left ${a===e.id?`border-blue-500 bg-blue-50`:`border-gray-200 hover:border-gray-300 hover:bg-gray-50`}`,children:[(0,W.jsx)(`div`,{className:`flex items-center justify-center w-8 h-8 bg-white rounded-md border shadow-sm`,children:(0,W.jsx)(t,{className:`h-5 w-5`})}),(0,W.jsx)(`span`,{className:`font-medium`,children:e.name})]},e.id)})})]}),a&&k&&(0,W.jsxs)(`div`,{className:`space-y-3 animate-in slide-in-from-top-2 duration-300`,children:[(0,W.jsxs)($,{htmlFor:`apiKey`,className:`text-sm font-medium`,children:[`Enter your `,k.name,` API key`]}),(0,W.jsxs)(`div`,{className:`relative`,children:[(0,W.jsx)(ir,{id:`apiKey`,type:`password`,value:s,onChange:e=>c(e.target.value),placeholder:k.placeholder,className:`pr-10 ${s?N?`border-green-500 focus:border-green-500`:`border-red-500 focus:border-red-500`:``}`}),s&&(0,W.jsx)(`div`,{className:`absolute right-3 top-1/2 -translate-y-1/2`,children:N?(0,W.jsx)(Ie,{className:`h-4 w-4 text-green-500`}):(0,W.jsx)(at,{className:`h-4 w-4 text-red-500`})})]}),s&&!N&&(0,W.jsxs)(`p`,{className:`text-xs text-red-600`,children:[`Invalid format. Expected: `,k.placeholder]})]})]}),(0,W.jsx)(Bo,{value:`manage`,className:`space-y-4`,children:v?(0,W.jsx)(`div`,{className:`space-y-4`,children:[1,2,3].map(e=>(0,W.jsxs)(`div`,{className:`flex items-center gap-4 p-4 rounded-lg border`,children:[(0,W.jsx)(`div`,{className:`w-8 h-8 bg-gray-200 rounded-md animate-pulse`}),(0,W.jsxs)(`div`,{className:`flex-1 space-y-2`,children:[(0,W.jsx)(`div`,{className:`h-4 bg-gray-200 rounded animate-pulse w-1/3`}),(0,W.jsx)(`div`,{className:`h-3 bg-gray-200 rounded animate-pulse w-1/2`})]}),(0,W.jsx)(`div`,{className:`w-12 h-6 bg-gray-200 rounded animate-pulse`})]},e))}):h.length===0?(0,W.jsxs)(`div`,{className:`text-center py-8 text-text-tertiary`,children:[(0,W.jsx)(pt,{className:`h-12 w-12 mx-auto mb-4 opacity-50`}),(0,W.jsx)(`p`,{className:`text-lg font-medium mb-2`,children:`No API keys configured`}),(0,W.jsx)(`p`,{className:`text-sm`,children:`Add your first API key using the "Add Keys" tab`})]}):(0,W.jsxs)(`div`,{className:`space-y-4`,children:[(0,W.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,W.jsx)($,{className:`text-sm font-medium`,children:`Your API Keys`}),(0,W.jsxs)(Q,{variant:`secondary`,children:[h.filter(e=>e.isActive).length,` active, `,h.length,` total`]})]}),(0,W.jsx)(`div`,{className:`space-y-3`,children:h.map(e=>{let t=e.logo,n=b===e.id;return(0,W.jsxs)(`div`,{className:`flex items-center gap-4 p-4 rounded-lg border transition-colors ${e.isActive?`hover:bg-bg-3/50`:`bg-bg-3/20 border-dashed hover:bg-bg-3/30`}`,children:[(0,W.jsx)(`div`,{className:`flex items-center justify-center w-8 h-8 rounded-md border shadow-sm ${e.isActive?`bg-white`:`bg-bg-3 border-dashed opacity-60`}`,children:(0,W.jsx)(t,{className:`h-5 w-5 ${e.isActive?``:`opacity-60`}`})}),(0,W.jsxs)(`div`,{className:`flex-1 space-y-1`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(`span`,{className:`font-medium capitalize ${e.isActive?``:`opacity-60`}`,children:e.name.replace(` (BYOK)`,``)}),(0,W.jsx)(Q,{variant:e.isActive?`default`:`outline`,className:`text-xs ${e.isActive?``:`opacity-60`}`,children:e.isActive?`Active`:`Inactive`})]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-3 text-xs text-text-tertiary`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,W.jsx)(Ut,{className:`h-3 w-3`}),(0,W.jsx)(`span`,{children:e.keyPreview})]}),(0,W.jsx)(ar,{orientation:`vertical`,className:`h-3`}),(0,W.jsxs)(`span`,{children:[`Added `,R(e.createdAt)]}),e.lastUsed&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(ar,{orientation:`vertical`,className:`h-3`}),(0,W.jsxs)(`span`,{children:[`Last used `,R(e.lastUsed)]})]})]})]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(ys,{checked:e.isActive,onCheckedChange:()=>F(e.id),disabled:n}),n&&(0,W.jsx)(C,{className:`h-4 w-4 animate-spin text-text-tertiary`})]}),(0,W.jsx)(K,{variant:`ghost`,size:`sm`,onClick:()=>L(e),className:`text-red-600 hover:text-red-700 hover:bg-red-50`,children:(0,W.jsx)(mn,{className:`h-4 w-4`})})]})]},e.id)})})]})})]}),(0,W.jsxs)(Li,{children:[(0,W.jsx)(K,{variant:`outline`,onClick:t,children:`Close`}),r===`add`&&a&&(0,W.jsx)(K,{onClick:P,disabled:!s||!N||l,className:`gap-2`,children:l?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(C,{className:`h-4 w-4 animate-spin`}),`Adding...`]}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(je,{className:`h-4 w-4`}),`Add Key`]})})]})]})}),(0,W.jsx)(ai,{open:S,onOpenChange:w,children:(0,W.jsxs)(li,{children:[(0,W.jsxs)(ui,{children:[(0,W.jsx)(fi,{children:`Delete API Key`}),(0,W.jsxs)(pi,{children:[`Are you sure you want to delete the `,T?.name,` API key? This action cannot be undone.`]})]}),(0,W.jsxs)(di,{children:[(0,W.jsx)(hi,{children:`Cancel`}),(0,W.jsx)(mi,{onClick:I,disabled:D,className:`bg-red-600 hover:bg-red-700`,children:D?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(C,{className:`h-4 w-4 animate-spin mr-2`}),`Deleting...`]}):`Delete Key`})]})]})})]})}var Os=e=>!e||e===`default`?``:e.split(`/`)[0]||``,ks=(e,t)=>{let n=Os(e);return n?t.some(e=>e.provider===n&&e.hasValidKey):!1},As=e=>e,js=e=>({templateSelection:` Recommended: Fast models for quick template selection`,blueprint:` Recommended: Creative models for architecture design`,projectSetup:` Recommended: Reliable models for precise setup`,phaseGeneration:` Recommended: Large context models for comprehensive planning`,firstPhaseImplementation:` Recommended: High-capability models for foundation development`,phaseImplementation:` Recommended: Strong coding models for implementation`,realtimeCodeFixer:` Recommended: Fast debugging models`,fastCodeFixer:` Recommended: Ultra-fast models for quick fixes`,conversationalResponse:` Recommended: Balanced models for natural conversation`,codeReview:` Recommended: Analytical models with large context`,fileRegeneration:` Recommended: Pure coding models`,screenshotAnalysis:` Recommended: Vision-capable models for image analysis`})[e]||``;function Ms({isOpen:e,onClose:t,agentConfig:n,userConfig:r,defaultConfig:i,onSave:a,onTest:o,onReset:s,isTesting:c}){let[l,u]=(0,H.useState)({modelName:r?.name||`default`,maxTokens:r?.max_tokens?.toString()||``,temperature:r?.temperature?.toString()||``,reasoningEffort:r?.reasoning_effort||`default`,fallbackModel:r?.fallbackModel||`default`}),[d,f]=(0,H.useState)(!1),[p,m]=(0,H.useState)(!1),[h,g]=(0,H.useState)(!1),[_,v]=(0,H.useState)(null),[y,b]=(0,H.useState)(!1),x=async()=>{try{b(!0);let e=await U.getByokProviders();e.success&&e.data&&v(e.data)}catch(e){console.error(`Failed to load BYOK data:`,e)}finally{b(!1)}};(0,H.useEffect)(()=>{e&&!h?(u({modelName:r?.name||`default`,maxTokens:r?.max_tokens?.toString()||``,temperature:r?.temperature?.toString()||``,reasoningEffort:r?.reasoning_effort||`default`,fallbackModel:r?.fallbackModel||`default`}),f(!1),m(!1),g(!0),x()):!e&&h&&g(!1)},[e,h,r]),(0,H.useEffect)(()=>{},[_,h,r?.name]),(0,H.useEffect)(()=>{let e={modelName:r?.name||`default`,maxTokens:r?.max_tokens?.toString()||``,temperature:r?.temperature?.toString()||``,reasoningEffort:r?.reasoning_effort||`default`,fallbackModel:r?.fallbackModel||`default`};f(JSON.stringify(l)!==JSON.stringify(e))},[l,r]);let S=(0,H.useMemo)(()=>{if(!_)return[];let e=[],t=new Set;return Object.values(_.modelsByProvider).forEach(n=>{n.forEach(n=>{let r=n;if(!t.has(r)){let n=Os(r),i=ks(r,_.providers);e.push({value:r,label:As(r),provider:n,hasUserKey:i,byokAvailable:!0}),t.add(r)}})}),_.platformModels.forEach(n=>{let r=n;t.has(r)||(e.push({value:r,label:As(r),provider:``,hasUserKey:!1,byokAvailable:!1}),t.add(r))}),e.sort((e,t)=>e.label.localeCompare(t.label))},[_]),C=(0,H.useMemo)(()=>{let e=l.modelName&&l.modelName!==`default`?l.modelName:``;if(!e||!_)return{hasUserKey:!1,provider:``,requiresBYOK:!1,isPlatformModel:!0};let t=Object.values(_.modelsByProvider).some(t=>t.some(t=>t===e)),n=Os(e),r=ks(e,_.providers);return{hasUserKey:r,provider:n,requiresBYOK:t&&!r,isPlatformModel:!t}},[l.modelName,_]),w=()=>({...l.modelName!==`default`&&{modelName:l.modelName},...l.maxTokens&&{maxTokens:parseInt(l.maxTokens)},...l.temperature&&{temperature:parseFloat(l.temperature)},...l.reasoningEffort!==`default`&&{reasoningEffort:l.reasoningEffort},...l.fallbackModel!==`default`&&{fallbackModel:l.fallbackModel},isUserOverride:!0}),T=async()=>{await a(w())},E=async()=>{await o(w())},D=async()=>{await s(),t()},O=()=>{m(!0)},k=()=>{x()},A=r?.isUserOverride||!1;return(0,W.jsxs)(Mi,{open:e,onOpenChange:t,children:[(0,W.jsxs)(Fi,{className:`overflow-y-auto max-w-3xl w-[90vw] max-h-[90vh] sm:max-w-4xl`,children:[(0,W.jsxs)(Ii,{children:[(0,W.jsxs)(Ri,{className:`flex items-center gap-2`,children:[(0,W.jsx)(B,{className:`h-5 w-5`}),`Configure `,n.name]}),(0,W.jsxs)(zi,{className:`space-y-2`,children:[(0,W.jsx)(`p`,{children:n.description}),js(n.key)&&(0,W.jsxs)(_s,{children:[(0,W.jsx)(rn,{className:`h-4 w-4`}),(0,W.jsx)(vs,{className:`text-sm`,children:js(n.key)})]})]})]}),(0,W.jsxs)(`div`,{className:`space-y-6`,children:[(0,W.jsxs)(`div`,{className:`flex items-center justify-between p-3 bg-bg-3/50 rounded-lg`,children:[(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`p`,{className:`font-medium text-sm`,children:`Configuration Status`}),(0,W.jsx)(`p`,{className:`text-xs text-text-tertiary`,children:A?`Using custom configuration`:`Using system defaults`})]}),(0,W.jsx)(Q,{variant:A?`default`:`outline`,children:A?`Custom`:`Default`})]}),(0,W.jsxs)(`div`,{className:`space-y-4`,children:[(0,W.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,W.jsxs)(`div`,{children:[(0,W.jsx)($,{className:`text-sm font-medium`,children:`Model Configuration`}),(0,W.jsx)(`p`,{className:`text-xs text-text-tertiary mt-1`,children:`Select primary and fallback models - we'll use your API keys if available`})]}),(0,W.jsxs)(K,{variant:`outline`,size:`sm`,onClick:O,disabled:!0,className:`gap-2`,children:[(0,W.jsx)(pt,{className:`h-4 w-4`}),`Coming Soon`]})]}),(0,W.jsxs)(`div`,{className:`grid grid-cols-1 lg:grid-cols-2 gap-6`,children:[(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)(hs,{value:l.modelName,onValueChange:e=>u({...l,modelName:e}),availableModels:S,placeholder:`Select model...`,label:`AI Model`,systemDefault:i?.name,disabled:y}),C.requiresBYOK&&(0,W.jsxs)(`div`,{className:`flex items-center gap-2 text-sm text-amber-600 bg-amber-50 dark:bg-amber-950/20 px-3 py-2 rounded-md border border-amber-200 dark:border-amber-800`,children:[(0,W.jsx)(pt,{className:`h-4 w-4`}),(0,W.jsxs)(`span`,{children:[`API key needed for `,C.provider]}),(0,W.jsx)(K,{variant:`link`,size:`sm`,onClick:O,className:`p-0 h-auto text-amber-600 hover:text-amber-700`,children:`Setup now`})]}),C.isPlatformModel&&l.modelName&&l.modelName!==`default`&&(0,W.jsxs)(`div`,{className:`flex items-center gap-2 text-sm text-blue-600 bg-blue-50 dark:bg-blue-950/20 px-3 py-2 rounded-md border border-blue-200 dark:border-blue-800`,children:[(0,W.jsx)(`svg`,{className:`h-4 w-4`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`,children:(0,W.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z`})}),(0,W.jsx)(`span`,{children:`Platform model with usage limits. Consider BYOK for higher usage.`})]}),l.modelName&&l.modelName!==`default`&&C.hasUserKey&&(0,W.jsxs)(`div`,{className:`flex items-center gap-2 text-sm text-green-600 bg-green-50 dark:bg-green-950/20 px-3 py-2 rounded-md border border-green-200 dark:border-green-800`,children:[(0,W.jsx)(Ie,{className:`h-4 w-4`}),(0,W.jsxs)(`span`,{children:[`Using your `,C.provider,` API key`]})]})]}),(0,W.jsx)(`div`,{className:`space-y-2`,children:(0,W.jsx)(hs,{value:l.fallbackModel,onValueChange:e=>u({...l,fallbackModel:e}),availableModels:S,placeholder:`Select fallback model...`,label:`Fallback Model`,systemDefault:i?.fallbackModel,includeDefaultOption:!0,disabled:y})})]})]}),(0,W.jsx)(ar,{}),(0,W.jsx)(`div`,{className:`space-y-3`,children:(0,W.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-4`,children:[(0,W.jsxs)(`div`,{className:`p-4 rounded-lg border bg-blue-50/50 border-blue-200`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2 mb-2`,children:[(0,W.jsx)(`div`,{className:`h-2 w-2 rounded-full bg-blue-500`}),(0,W.jsx)(`h4`,{className:`font-medium text-sm text-blue-900`,children:`Platform Models`})]}),(0,W.jsx)(`p`,{className:`text-xs text-blue-700`,children:`Models served through our platform with limited quota. No API keys required.`})]}),(0,W.jsxs)(`div`,{className:`p-4 rounded-lg border bg-green-50/50 border-green-200`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2 mb-2`,children:[(0,W.jsx)(`div`,{className:`h-2 w-2 rounded-full bg-green-500`}),(0,W.jsx)(`h4`,{className:`font-medium text-sm text-green-900`,children:`BYOK (Your Keys)`})]}),(0,W.jsx)(`p`,{className:`text-xs text-green-700`,children:`Your API keys are used for direct billing with providers. Unlimited usage based on your provider account.`})]})]})}),(0,W.jsx)(ar,{}),(0,W.jsxs)(`div`,{className:`space-y-4`,children:[(0,W.jsx)(`h4`,{className:`font-medium text-sm`,children:`Parameters`}),(0,W.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-3 gap-4`,children:[(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)($,{className:`text-sm font-medium`,children:`Temperature`}),(0,W.jsx)(ir,{type:`number`,min:`0`,max:`2`,step:`0.1`,value:l.temperature,placeholder:i?.temperature?`${i.temperature}`:`0.7`,onChange:e=>u({...l,temperature:e.target.value}),className:`h-10`}),i?.temperature&&(0,W.jsxs)(`p`,{className:`text-xs text-text-tertiary`,children:[` Default: `,i.temperature]})]}),(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)($,{className:`text-sm font-medium`,children:`Max Tokens`}),(0,W.jsx)(ir,{type:`number`,min:`1`,max:`200000`,value:l.maxTokens,placeholder:i?.max_tokens?`${i.max_tokens}`:`4000`,onChange:e=>u({...l,maxTokens:e.target.value}),className:`h-10`}),i?.max_tokens&&(0,W.jsxs)(`p`,{className:`text-xs text-text-tertiary`,children:[` Default: `,i.max_tokens?.toLocaleString()]})]}),(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)($,{className:`text-sm font-medium`,children:`Reasoning Effort`}),(0,W.jsxs)(is,{value:l.reasoningEffort,onValueChange:e=>u({...l,reasoningEffort:e}),children:[(0,W.jsx)(os,{className:`h-10`,children:(0,W.jsx)(as,{placeholder:`Select effort...`})}),(0,W.jsxs)(ss,{children:[(0,W.jsx)(cs,{value:`default`,children:`Use default`}),(0,W.jsx)(cs,{value:`low`,children:`Low (Fast)`}),(0,W.jsx)(cs,{value:`medium`,children:`Medium (Balanced)`}),(0,W.jsx)(cs,{value:`high`,children:`High (Deep)`})]})]}),i?.reasoning_effort&&(0,W.jsxs)(`p`,{className:`text-xs text-text-tertiary`,children:[` Default: `,i.reasoning_effort]})]})]})]})]}),(0,W.jsxs)(Li,{className:`gap-3 flex-col sm:flex-row sm:justify-between`,children:[(0,W.jsxs)(`div`,{className:`flex gap-2 flex-wrap`,children:[(0,W.jsx)(K,{variant:`outline`,size:`sm`,onClick:E,disabled:c,className:`gap-2`,children:c?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(B,{className:`h-4 w-4 animate-spin`}),`Testing...`]}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Cn,{className:`h-4 w-4`}),`Test Config`]})}),A&&(0,W.jsxs)(K,{variant:`ghost`,size:`sm`,onClick:D,className:`gap-2 text-text-tertiary`,children:[(0,W.jsx)(ne,{className:`h-4 w-4`}),`Reset to Default`]})]}),(0,W.jsxs)(`div`,{className:`flex gap-2 flex-wrap sm:justify-end`,children:[(0,W.jsx)(K,{variant:`outline`,onClick:t,children:`Cancel`}),(0,W.jsx)(K,{onClick:T,disabled:!d,children:`Save Changes`})]})]})]}),(0,W.jsx)(Ds,{isOpen:p,onClose:()=>m(!1),onKeyAdded:k})]})}const Ns={quickstart:{id:`quickstart`,label:`Quick Start`,icon:ue,description:`Most commonly customized settings`,patterns:[`template`,`blueprint`,`conversational`]},planning:{id:`planning`,label:`Planning`,icon:jt,description:`Project planning and setup`,patterns:[`phase`,`project`,`suggestion`,`generation`]},coding:{id:`coding`,label:`Coding`,icon:Lt,description:`Development and implementation`,patterns:[`implementation`,`file`,`regeneration`]},debugging:{id:`debugging`,label:`Debugging`,icon:Ce,description:`Code fixing and review`,patterns:[`fixer`,`fix`,`review`,`debug`]},advanced:{id:`advanced`,label:`Advanced`,icon:bt,description:`Specialized operations`,patterns:[`screenshot`,`analysis`,`image`,`vision`]}};var Ps=e=>{let t={templateSelection:`quickstart`,blueprint:`quickstart`,conversationalResponse:`quickstart`,phaseGeneration:`planning`,projectSetup:`planning`,phaseImplementation:`coding`,firstPhaseImplementation:`coding`,fileRegeneration:`coding`,realtimeCodeFixer:`debugging`,fastCodeFixer:`debugging`,codeReview:`debugging`,screenshotAnalysis:`advanced`};if(t[e])return t[e];let n=e.toLowerCase();return n.includes(`template`)||n.includes(`selection`)||n.includes(`blueprint`)||n.includes(`architect`)||n.includes(`conversation`)||n.includes(`chat`)||n.includes(`response`)?`quickstart`:n.includes(`project`)&&n.includes(`setup`)||n.includes(`suggestion`)&&n.includes(`process`)||n.includes(`planning`)||n.includes(`plan`)?`planning`:n.includes(`implementation`)||n.includes(`implement`)||n.includes(`regenerat`)||n.includes(`regen`)||n.includes(`code`)&&n.includes(`gen`)?`coding`:n.includes(`fixer`)||n.includes(`fix`)||n.includes(`debug`)||n.includes(`review`)||n.includes(`lint`)||n.includes(`check`)?`debugging`:(n.includes(`screenshot`)||n.includes(`image`)||n.includes(`vision`)||n.includes(`analysis`)||n.includes(`analyz`),`advanced`)};function Fs({agentConfigs:e,modelConfigs:t,defaultConfigs:n,loadingConfigs:r,onSaveConfig:i,onTestConfig:a,onResetConfig:o,onResetAllConfigs:s,testingConfig:c,savingConfigs:l}){let[u,d]=(0,H.useState)(`quickstart`),[f,p]=(0,H.useState)(``),[m,h]=(0,H.useState)(null),[g,v]=(0,H.useState)(!1),y=e.filter(e=>e.name.toLowerCase().includes(f.toLowerCase())||e.description.toLowerCase().includes(f.toLowerCase())),b=(0,H.useCallback)(e=>y.filter(t=>Ps(t.key)===e),[y]),x=(0,H.useCallback)(e=>b(e).filter(e=>t[e.key]?.isUserOverride).length,[b,t]),S=e=>{h(e),v(!0)};return r?(0,W.jsxs)(`div`,{className:`flex items-center gap-3 p-8`,children:[(0,W.jsx)(B,{className:`h-5 w-5 animate-spin text-text-tertiary`}),(0,W.jsx)(`span`,{className:`text-sm text-text-tertiary`,children:`Loading model configurations...`})]}):(0,W.jsxs)(`div`,{className:`space-y-6`,children:[(0,W.jsxs)(`div`,{className:`flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center`,children:[(0,W.jsxs)(`div`,{className:`flex-1`,children:[(0,W.jsx)(`h4`,{className:`font-medium`,children:`Model Configuration Overrides`}),(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:`Customize AI model settings for different operations. Organized by workflow stage.`})]}),(0,W.jsxs)(`div`,{className:`flex flex-col sm:flex-row gap-2 w-full sm:w-auto`,children:[(0,W.jsxs)(`div`,{className:`relative`,children:[(0,W.jsx)(xe,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-tertiary`}),(0,W.jsx)(ir,{placeholder:`Search configurations...`,value:f,onChange:e=>p(e.target.value),className:`pl-9 w-full sm:w-64 dark:bg-bg-1 bg-bg-4`})]}),(0,W.jsxs)(`div`,{className:`flex gap-2`,children:[(0,W.jsxs)(K,{variant:`outline`,size:`sm`,onClick:async()=>{let n=e.filter(e=>t[e.key]?.isUserOverride);if(n.length===0){_.info(`No customized configurations to test`);return}let r=0,i=0;for(let e of n)try{await a(e.key),r++}catch{i++}_.success(`Tested ${n.length} configs: ${r} passed, ${i} failed`)},className:`gap-2`,children:[(0,W.jsx)(Cn,{className:`h-4 w-4`}),`Test All`]}),(0,W.jsxs)(K,{variant:`outline`,size:`sm`,onClick:s,disabled:l,className:`gap-2`,children:[(0,W.jsx)(ne,{className:`h-4 w-4`}),l?`Resetting...`:`Reset All`]})]})]})]}),(0,W.jsxs)(Lo,{value:u,onValueChange:d,className:`w-full`,children:[(0,W.jsx)(Ro,{className:`grid w-full grid-cols-5 h-12 items-center border-2 border-bg-2 dark:border-bg-4`,children:Object.values(Ns).map(e=>{let t=e.icon,n=x(e.id);return(0,W.jsxs)(zo,{value:e.id,className:`flex flex-col gap-1 py-1 relative h-[calc(100%-4px)] min-h-[calc(100%-4px)] justify-center`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(t,{className:`h-4 w-4`}),(0,W.jsx)(`span`,{className:`hidden sm:inline`,children:e.label})]}),n>0&&(0,W.jsx)(Q,{variant:`secondary`,className:`text-xs absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 flex items-center justify-center`,children:n})]},e.id)})}),Object.values(Ns).map(e=>{let r=b(e.id);return(0,W.jsx)(Bo,{value:e.id,className:`mt-6`,children:(0,W.jsxs)(`div`,{className:`space-y-4`,children:[(0,W.jsxs)(`div`,{className:`text-sm text-text-tertiary`,children:[e.description,`  `,r.length,` agent`,r.length===1?``:`s`,x(e.id)>0&&(0,W.jsxs)(`span`,{className:`ml-2 text-text-primary font-medium`,children:[`(`,x(e.id),` customized)`]})]}),r.length===0?(0,W.jsx)(`div`,{className:`text-center py-8 text-text-tertiary`,children:f?`No configurations match your search.`:`No configurations in this category.`}):(0,W.jsx)(`div`,{className:`grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-8 auto-rows-fr`,children:r.map(e=>(0,W.jsx)(rs,{agent:e,userConfig:t[e.key],defaultConfig:n[e.key],onConfigure:()=>S(e.key),onTest:()=>a(e.key),onReset:()=>o(e.key),isTesting:c===e.key},e.key))})]})},e.id)})]}),m&&(0,W.jsx)(Ms,{isOpen:g,onClose:()=>{h(null),v(!1)},agentConfig:e.find(e=>e.key===m),userConfig:t[m],defaultConfig:n[m],onSave:e=>i(m,e),onTest:e=>a(m,e),onReset:()=>o(m),isTesting:c===m})]})}function Is(){let{user:e}=Un(),[t,n]=(0,H.useState)({sessions:[],loading:!0}),[r,i]=(0,H.useState)({secrets:[],loading:!0}),[a,o]=(0,H.useState)([]),[s,c]=(0,H.useState)(!1),[l,u]=(0,H.useState)(null),[d,f]=(0,H.useState)(!1),[p,m]=(0,H.useState)({templateId:``,name:``,envVarName:``,value:``,environment:`production`,description:``}),[h,g]=(0,H.useState)(!1),[v,y]=(0,H.useState)(!1),[b,x]=(0,H.useState)([]),[S,C]=(0,H.useState)({}),[w,T]=(0,H.useState)({}),[E,D]=(0,H.useState)(!0),[O,k]=(0,H.useState)(!1),[A,j]=(0,H.useState)(null),[M,N]=(0,H.useState)(!1),P=()=>{oe(),L()},F=H.useCallback(e=>e.replace(/([A-Z])/g,` $1`).replace(/^./,e=>e.toUpperCase()).trim(),[]),I=H.useCallback(e=>({templateSelection:`Quick template selection - Needs to be extremely fast with low latency. Intelligence level is less important than speed for rapid project bootstrapping.`,blueprint:`Project architecture & UI design - Requires strong design thinking, UI/UX understanding, and architectural planning skills. Speed is important but coding ability is not critical.`,projectSetup:`Technical scaffolding setup - Must excel at following technical instructions precisely and setting up proper project structure. Reliability and instruction-following are key.`,phaseGeneration:`Development phase planning - Needs rapid planning abilities with large context windows for understanding project scope. Quick thinking is essential, coding skills are not required.`,firstPhaseImplementation:`Initial development phase - Requires large context windows and excellent coding skills for implementing the foundation. Deep thinking is less critical than execution.`,phaseImplementation:`Subsequent development phases - Needs large context windows and superior coding abilities for complex feature implementation. Focus is on execution rather than reasoning.`,realtimeCodeFixer:`Real-time bug detection - Must be extremely fast at identifying and fixing code issues with strong debugging skills. Large context windows are not needed, speed is crucial.`,fastCodeFixer:`Ultra-fast code fixes - Optimized for maximum speed with decent coding ability. No deep thinking or large context required, pure speed and basic bug fixing.`,conversationalResponse:`User chat interactions - Handles natural conversation flow and user communication. Balanced capabilities for engaging dialogue and helpful responses.`,userSuggestionProcessor:`User feedback processing - Analyzes and implements user suggestions and feedback. Requires understanding user intent and translating to actionable changes.`,codeReview:`Code quality analysis - Needs large context windows, strong analytical thinking, and good speed for thorough code review. Must identify issues and suggest improvements.`,fileRegeneration:`File recreation - Focused on pure coding ability to regenerate or rewrite files. No context window or deep thinking required, just excellent code generation.`,screenshotAnalysis:`UI/design analysis - Analyzes visual designs and screenshots to understand UI requirements. Requires visual understanding and design interpretation skills.`})[e]||`AI model configuration for ${F(e)}`,[F]),L=async()=>{try{D(!0);let e=await U.getModelConfigs();if(e.success&&e.data)C(e.data.configs||{}),T(e.data.defaults||{});else throw Error(e.error?.message||`Failed to load model configurations`)}catch(e){console.error(`Error loading model configurations:`,e),_.error(`Failed to load model configurations`)}finally{D(!1)}},R=async(e,t)=>{try{(await U.updateModelConfig(e,t)).success&&(_.success(`Configuration saved successfully`),await L())}catch(e){console.error(`Error saving model configuration:`,e),_.error(`Failed to save configuration`)}},ee=async(e,t)=>{try{j(e);let n=await U.testModelConfig(e,t);if(n.success&&n.data){let e=n.data.testResult;e.success?_.success(`Test successful! Model: ${e.modelUsed}, Response time: ${e.latencyMs}ms`):_.error(`Test failed: ${e.error}`)}}catch(e){console.error(`Error testing configuration:`,e),_.error(`Failed to test configuration`)}finally{j(null)}},te=async e=>{try{await U.resetModelConfig(e),_.success(`Configuration reset to default`),await L()}catch(e){console.error(`Error resetting configuration:`,e),_.error(`Failed to reset configuration`)}},ne=async()=>{try{k(!0);let e=await U.resetAllModelConfigs();_.success(`${e.data?.resetCount} configurations reset to defaults`),await L()}catch(e){console.error(`Error resetting all configurations:`,e),_.error(`Failed to reset all configurations`)}finally{k(!1)}},re=async()=>{_.error(`Account deletion is not yet implemented`)},ie=async()=>{try{n({sessions:(await U.getActiveSessions()).data?.sessions||[{id:`current`,userAgent:navigator.userAgent,ipAddress:`Current location`,lastActivity:new Date,createdAt:new Date,isCurrent:!0}],loading:!1})}catch(e){console.error(`Error loading active sessions:`,e),n({sessions:[{id:`current`,userAgent:navigator.userAgent,ipAddress:`Current location`,lastActivity:new Date,createdAt:new Date,isCurrent:!0}],loading:!1})}},ae=async e=>{try{await U.revokeSession(e),_.success(`Session revoked successfully`),ie()}catch(e){console.error(`Error revoking session:`,e),_.error(`Failed to revoke session`)}},oe=async()=>{try{i({secrets:(await U.getAllSecrets()).data?.secrets||[],loading:!1})}catch(e){console.error(`Error loading user secrets:`,e),i({secrets:[],loading:!1})}},se=async()=>{try{o((await U.getSecretTemplates()).data?.templates||[])}catch(e){console.error(`Error loading secret templates:`,e)}},ce=async()=>{if(!v)try{y(!0);let e=d?{name:p.name,envVarName:p.envVarName,value:p.value,environment:p.environment,description:p.description}:{templateId:l||void 0,value:p.value,environment:p.environment};await U.storeSecret(e),_.success(`Secret saved successfully`),le(),oe()}catch(e){console.error(`Error saving secret:`,e),_.error(`Failed to save secret`)}finally{y(!1)}},le=()=>{c(!1),u(null),f(!1),m({templateId:``,name:``,envVarName:``,value:``,environment:`production`,description:``}),g(!1)},ue=async e=>{try{await U.deleteSecret(e),_.success(`Secret deleted successfully`),oe(),L()}catch(e){console.error(`Error deleting secret:`,e),_.error(`Failed to delete secret`)}},de={openai:bs,anthropic:xs,"google-ai-studio":Ss,google:Ss,cerebras:Cs,cloudflare:ws},fe=(e,t=`h-5 w-5`)=>{let n=de[e];return n?(0,W.jsx)(n,{className:t}):(0,W.jsx)(`span`,{className:`text-lg`,children:{stripe:``,github:``,vercel:``,supabase:``,custom:``}[e]||``})};return H.useEffect(()=>{U.getModelDefaults().then(e=>{e.success&&e.data?.defaults&&x(Object.keys(e.data.defaults).map(e=>({key:e,name:F(e),description:I(e)})))}).catch(e=>{console.error(`Failed to load agent configurations:`,e)})},[F,I]),H.useEffect(()=>{e&&(ie(),L(),se())},[e]),(0,W.jsxs)(`div`,{className:`min-h-screen bg-bg-3 relative`,children:[(0,W.jsx)(`main`,{className:`container mx-auto px-4 py-8 max-w-4xl`,children:(0,W.jsxs)(`div`,{className:`space-y-8`,children:[(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h1`,{className:`text-4xl font-bold font-[departureMono] text-red-500`,children:`SETTINGS`}),(0,W.jsx)(`p`,{className:`text-text-tertiary mt-2`,children:`Manage your account settings and preferences`})]}),(0,W.jsxs)(q,{id:`model-configs`,children:[(0,W.jsx)(Ki,{variant:`minimal`,children:(0,W.jsxs)(`div`,{className:`flex items-center gap-3 border-b w-full py-3 text-text-primary`,children:[` `,(0,W.jsx)(B,{className:`h-5 w-5`}),(0,W.jsx)(`div`,{children:(0,W.jsx)(qi,{children:`AI Model Configurations`})})]})}),(0,W.jsxs)(J,{className:`space-y-6 px-6`,children:[(0,W.jsxs)(`div`,{className:`space-y-2 mt-6`,children:[(0,W.jsx)(`h4`,{className:`font-medium`,children:`Provider API Keys`}),(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:`AI provider API keys are managed in the "API Keys & Secrets" section below. Configure your OpenAI, Anthropic, Google AI, and OpenRouter keys there.`}),(0,W.jsxs)(K,{variant:`outline`,size:`sm`,onClick:()=>{let e=document.getElementById(`secrets`);e&&e.scrollIntoView({behavior:`smooth`,block:`start`})},className:`gap-2 shrink-0`,children:[(0,W.jsx)(pt,{className:`h-4 w-4`}),`Manage Keys`]})]}),(0,W.jsx)(ar,{}),(0,W.jsx)(Fs,{agentConfigs:b,modelConfigs:S,defaultConfigs:w,loadingConfigs:E,onSaveConfig:R,onTestConfig:ee,onResetConfig:te,onResetAllConfigs:ne,testingConfig:A,savingConfigs:O})]})]}),(0,W.jsxs)(q,{id:`secrets`,children:[(0,W.jsx)(Ki,{variant:`minimal`,children:(0,W.jsxs)(`div`,{className:`flex items-center gap-3 border-b w-full py-3 text-text-primary`,children:[(0,W.jsx)(pt,{className:`h-5 w-5`}),(0,W.jsx)(`div`,{children:(0,W.jsx)(qi,{children:`API Keys & Secrets`})})]})}),(0,W.jsxs)(J,{className:`space-y-3 mt-4 px-6`,children:[(0,W.jsxs)(`div`,{className:`space-y-4`,children:[(0,W.jsxs)(`div`,{className:`flex justify-between items-center`,children:[(0,W.jsx)(`h4`,{className:`font-medium`,children:`BYOK Provider Keys`}),(0,W.jsxs)(K,{size:`sm`,variant:`outline`,onClick:()=>N(!0),disabled:!0,className:`gap-2`,children:[(0,W.jsx)(pt,{className:`h-4 w-4`}),`Coming Soon`]})]}),(()=>{let e=r.secrets.filter(e=>e.secretType.endsWith(`_BYOK`));return e.length===0?(0,W.jsxs)(`div`,{className:`text-center py-6 border-2 border-dashed dark:border-bg-4 border-muted rounded-lg`,children:[(0,W.jsx)(pt,{className:`h-8 w-8 text-text-tertiary mx-auto mb-2`}),(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:`Coming Soon: You would be able to add your own LLM keys to bypass rate limits from here.`})]}):(0,W.jsxs)(`div`,{className:`rounded-lg bg-bg-3/50 p-4`,children:[(0,W.jsx)(`div`,{className:`flex items-center justify-between mb-3`,children:(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(`div`,{className:`w-2 h-2 bg-green-500 rounded-full`}),(0,W.jsxs)(`span`,{className:`text-sm font-medium`,children:[e.length,` `,`provider`,e.length===1?``:`s`,` `,`configured`]})]})}),(0,W.jsx)(`div`,{className:`space-y-3`,children:e.map(e=>{let t=e.secretType.replace(`_API_KEY_BYOK`,``).replace(`_`,` `).toLowerCase().replace(/\b\w/g,e=>e.toUpperCase());return(0,W.jsxs)(`div`,{className:`flex items-center justify-between p-3 border rounded-lg transition-colors ${e.isActive?`bg-white/50 dark:bg-gray-800/50`:`bg-bg-3/20 border-dashed opacity-70`}`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,W.jsx)(`div`,{className:`flex items-center justify-center w-8 h-8 rounded-md border shadow-sm ${e.isActive?`bg-white`:`bg-bg-3 border-dashed opacity-60`}`,children:fe(e.provider,`h-5 w-5 ${e.isActive?``:`opacity-60`}`)}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`span`,{className:`font-medium text-sm ${e.isActive?``:`opacity-60`}`,children:t}),(0,W.jsx)(`div`,{className:`text-xs text-text-tertiary ${e.isActive?``:`opacity-60`}`,children:e.keyPreview})]})]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(Q,{variant:e.isActive?`default`:`outline`,className:`text-xs ${e.isActive?``:`opacity-60`}`,children:e.isActive?`Active`:`Inactive`}),(0,W.jsxs)(ai,{children:[(0,W.jsx)(oi,{asChild:!0,children:(0,W.jsx)(K,{variant:`outline`,size:`sm`,className:`text-destructive hover:text-destructive h-8 w-8 p-0`,children:(0,W.jsx)(mn,{className:`h-4 w-4`})})}),(0,W.jsxs)(li,{children:[(0,W.jsxs)(ui,{children:[(0,W.jsxs)(fi,{children:[`Remove`,` `,t,` `,`Key`]}),(0,W.jsxs)(pi,{children:[`Are you sure you want to remove your`,` `,t,` `,`API key? You'll need to add it again to use BYOK mode with this provider.`]})]}),(0,W.jsxs)(di,{children:[(0,W.jsx)(hi,{children:`Cancel`}),(0,W.jsx)(mi,{onClick:()=>ue(e.id),className:`bg-destructive text-destructive-foreground hover:bg-destructive/90`,children:`Remove Key`})]})]})]})]})]},e.id)})}),(0,W.jsxs)(`p`,{className:`text-xs text-text-tertiary mt-3`,children:[`These keys are used automatically when you select BYOK mode in model configurations.`,(0,W.jsx)(K,{variant:`link`,size:`sm`,className:`text-xs p-0 h-auto ml-1`,onClick:()=>{let e=document.getElementById(`model-configs`);e&&e.scrollIntoView({behavior:`smooth`,block:`start`})},children:`Configure models `})]})]})})()]}),(0,W.jsx)(Mi,{open:s,onOpenChange:le,children:(0,W.jsxs)(Fi,{className:`max-w-lg`,children:[(0,W.jsxs)(Ii,{children:[(0,W.jsx)(Ri,{children:`Add API Key or Secret`}),(0,W.jsx)(zi,{children:`Choose a predefined template or add a custom environment variable`})]}),(0,W.jsxs)(`div`,{className:`space-y-6`,children:[!l&&!d&&(0,W.jsxs)(`div`,{className:`space-y-4`,children:[(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h4`,{className:`font-medium mb-3`,children:`Quick Setup (Recommended)`}),(0,W.jsx)(`div`,{className:`grid grid-cols-1 gap-2 max-h-60 overflow-y-auto`,children:a.sort((e,t)=>(t.required?1:0)-(e.required?1:0)).map(e=>(0,W.jsx)(K,{variant:`outline`,className:`justify-start h-auto p-3 text-left`,onClick:()=>{u(e.id),m(t=>({...t,templateId:e.id,environment:`production`}))},children:(0,W.jsxs)(`div`,{className:`flex items-start`,children:[(0,W.jsx)(`span`,{className:`text-lg`,children:e.icon}),(0,W.jsxs)(`div`,{className:`flex items-start`,children:[(0,W.jsx)(Tt,{className:`w-5 h-5 text-yellow-400 dark:text-yellow-200 mr-2`}),(0,W.jsxs)(`ul`,{className:`space-y-1`,children:[(0,W.jsxs)(`li`,{children:[``,` `,(0,W.jsx)(`strong`,{children:`More secure:`}),` `,`Uses short-lived tokens (1 hour expiry)`]}),(0,W.jsxs)(`li`,{children:[``,` `,(0,W.jsx)(`strong`,{children:`Fine-grained permissions:`}),` `,`Only accesses repositories you choose`]}),(0,W.jsxs)(`li`,{children:[``,` `,(0,W.jsx)(`strong`,{children:`One-time setup:`}),` `,`Install once, export anytime`]}),(0,W.jsxs)(`li`,{children:[``,` `,(0,W.jsx)(`strong`,{children:`GitHub recommended:`}),` `,`Apps are the preferred integration method`]})]})]})]})},e.id))})]}),(0,W.jsxs)(`div`,{className:`relative`,children:[(0,W.jsx)(`div`,{className:`absolute inset-0 flex items-center`,children:(0,W.jsx)(`span`,{className:`w-full border-t`})}),(0,W.jsx)(`div`,{className:`relative flex justify-center text-xs uppercase`,children:(0,W.jsx)(`span`,{className:`bg-bg-3 px-2 text-text-tertiary`,children:`Or`})})]}),(0,W.jsx)(K,{variant:`outline`,className:`w-full justify-start h-auto p-3`,onClick:()=>f(!0),children:(0,W.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,W.jsx)(`span`,{className:`text-lg`,children:``}),(0,W.jsxs)(`div`,{className:`text-left`,children:[(0,W.jsx)(`div`,{className:`font-medium`,children:`Custom Environment Variable`}),(0,W.jsx)(`p`,{className:`text-xs text-text-tertiary`,children:`Add any custom API key or secret with your own variable name`})]})]})})]}),l&&(0,W.jsx)(`div`,{className:`space-y-4`,children:(()=>{let e=a.find(e=>e.id===l);return e?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-3 p-3 bg-bg-3/50 rounded-lg`,children:[(0,W.jsx)(`span`,{className:`text-xl`,children:e.icon}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`h4`,{className:`font-medium`,children:e.displayName}),(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:e.description})]}),(0,W.jsx)(K,{variant:`ghost`,size:`sm`,onClick:()=>{u(null),m(e=>({...e,templateId:``,value:``}))},children:`Change`})]}),(0,W.jsxs)(`div`,{className:`space-y-3`,children:[(0,W.jsxs)(`div`,{children:[(0,W.jsx)($,{children:`Environment Variable Name`}),(0,W.jsx)(ir,{value:e.envVarName,disabled:!0,className:`bg-bg-3`}),(0,W.jsxs)(`p`,{className:`text-xs text-text-tertiary mt-1`,children:[`This will be available as`,` `,(0,W.jsx)(`code`,{className:`bg-bg-3 px-1 rounded text-xs`,children:e.envVarName}),` `,`in your generated apps`]})]}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)($,{htmlFor:`templateValue`,children:`Value`}),(0,W.jsxs)(`div`,{className:`relative`,children:[(0,W.jsx)(ir,{id:`templateValue`,type:h?`text`:`password`,placeholder:e.placeholder,value:p.value,onChange:e=>m(t=>({...t,value:e.target.value})),className:`pr-10`}),(0,W.jsx)(K,{type:`button`,variant:`ghost`,size:`sm`,className:`absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0`,onClick:()=>g(!h),children:h?(0,W.jsx)(en,{className:`h-4 w-4`}):(0,W.jsx)(Ut,{className:`h-4 w-4`})})]})]}),(0,W.jsxs)(`div`,{className:`rounded-lg bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 p-3`,children:[(0,W.jsx)(`h5`,{className:`font-medium text-blue-900 dark:text-blue-100 text-sm mb-1`,children:`How to get this:`}),(0,W.jsx)(`p`,{className:`text-xs text-blue-700 dark:text-blue-300`,children:e.instructions})]})]})]}):null})()}),d&&(0,W.jsxs)(`div`,{className:`space-y-4`,children:[(0,W.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,W.jsx)(`h4`,{className:`font-medium`,children:`Custom Environment Variable`}),(0,W.jsx)(K,{variant:`ghost`,size:`sm`,onClick:()=>{f(!1),m(e=>({...e,name:``,envVarName:``,value:``}))},children:`Back`})]}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)($,{htmlFor:`customName`,children:`Display Name`}),(0,W.jsx)(ir,{id:`customName`,placeholder:`e.g., My Custom API Key`,value:p.name,onChange:e=>m(t=>({...t,name:e.target.value}))})]}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)($,{htmlFor:`customEnvVar`,children:`Environment Variable Name`}),(0,W.jsx)(ir,{id:`customEnvVar`,placeholder:`e.g., MY_API_KEY`,value:p.envVarName,onChange:e=>m(t=>({...t,envVarName:e.target.value.toUpperCase()}))}),(0,W.jsx)(`p`,{className:`text-xs text-text-tertiary mt-1`,children:`Must be uppercase letters, numbers, and underscores only`})]}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)($,{htmlFor:`customValue`,children:`Value`}),(0,W.jsxs)(`div`,{className:`relative`,children:[(0,W.jsx)(ir,{id:`customValue`,type:h?`text`:`password`,placeholder:`Enter your API key or secret`,value:p.value,onChange:e=>m(t=>({...t,value:e.target.value})),className:`pr-10`}),(0,W.jsx)(K,{type:`button`,variant:`ghost`,size:`sm`,className:`absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0`,onClick:()=>g(!h),children:h?(0,W.jsx)(en,{className:`h-4 w-4`}):(0,W.jsx)(Ut,{className:`h-4 w-4`})})]})]}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)($,{htmlFor:`customDescription`,children:`Description (Optional)`}),(0,W.jsx)(Yo,{id:`customDescription`,placeholder:`Brief description of this secret`,value:p.description,onChange:e=>m(t=>({...t,description:e.target.value})),rows:2})]})]}),(l||d)&&(0,W.jsxs)(`div`,{children:[(0,W.jsx)($,{htmlFor:`environment`,children:`Environment`}),(0,W.jsxs)(is,{value:p.environment,onValueChange:e=>m(t=>({...t,environment:e})),children:[(0,W.jsx)(os,{children:(0,W.jsx)(as,{})}),(0,W.jsxs)(ss,{children:[(0,W.jsx)(cs,{value:`production`,children:`Production`}),(0,W.jsx)(cs,{value:`sandbox`,children:`Sandbox`}),(0,W.jsx)(cs,{value:`test`,children:`Test`})]})]})]})]}),(0,W.jsxs)(Li,{children:[(0,W.jsx)(K,{variant:`outline`,onClick:le,children:`Cancel`}),(l||d)&&(0,W.jsx)(K,{onClick:ce,disabled:!p.value||d&&(!p.name||!p.envVarName)||v,children:v?`Saving...`:`Save Secret`})]})]})})]})]}),(0,W.jsxs)(q,{id:`security`,children:[(0,W.jsx)(Ki,{variant:`minimal`,children:(0,W.jsxs)(`div`,{className:`flex items-center gap-3 border-b w-full py-3 text-text-primary`,children:[(0,W.jsx)(qe,{className:`h-5 w-5`}),(0,W.jsx)(`div`,{children:(0,W.jsx)(qi,{className:`text-lg`,children:`Security`})})]})}),(0,W.jsxs)(J,{className:`space-y-3 mt-2 px-6`,children:[(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)(`h4`,{className:`font-medium`,children:`Connected Accounts`}),(0,W.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,W.jsx)(`div`,{className:`h-5 w-5 rounded-full bg-bg-3 flex items-center justify-center`,children:e?.provider===`google`?``:``}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`p`,{className:`text-sm font-medium capitalize`,children:e?.provider}),(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:e?.email})]})]}),(0,W.jsx)(Q,{variant:`secondary`,children:`Connected`})]})]}),(0,W.jsx)(ar,{}),(0,W.jsxs)(`div`,{className:`space-y-2`,children:[(0,W.jsx)(`h4`,{className:`font-medium`,children:`Active Sessions`}),t.loading?(0,W.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,W.jsx)(B,{className:`h-5 w-5 animate-spin text-text-tertiary`}),(0,W.jsx)(`span`,{className:`text-sm text-text-tertiary`,children:`Loading active sessions...`})]}):t.sessions.map(e=>(0,W.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,W.jsx)(we,{className:`h-5 w-5 text-text-tertiary`}),(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`p`,{className:`font-medium text-sm`,children:e.isCurrent?`Current Session`:`Other Session`}),(0,W.jsxs)(`p`,{className:`text-sm text-text-tertiary`,children:[e.ipAddress,` `,` `,new Date(e.lastActivity).toLocaleDateString()]})]})]}),(0,W.jsx)(`div`,{className:`flex items-center gap-2`,children:e.isCurrent?(0,W.jsx)(`div`,{className:`bg-green-400 size-3 rounded-full ring-green-200 ring-2 animate-pulse`}):(0,W.jsx)(K,{variant:`outline`,size:`sm`,onClick:()=>ae(e.id),className:`text-destructive hover:text-destructive`,children:`Revoke`})})]},e.id))]})]})]}),(0,W.jsxs)(`div`,{className:`space-y-4 p-3`,children:[(0,W.jsx)(`h4`,{className:`font-medium text-destructive`,children:`Danger Zone`}),(0,W.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`p`,{className:`font-medium text-text-primary`,children:`Delete Account`}),(0,W.jsx)(`p`,{className:`text-sm text-text-tertiary`,children:`Permanently delete your account and all data`})]}),(0,W.jsxs)(ai,{children:[(0,W.jsx)(oi,{asChild:!0,children:(0,W.jsxs)(K,{variant:`destructive`,className:`gap-2`,children:[(0,W.jsx)(mn,{className:`h-4 w-4`}),`Delete Account`]})}),(0,W.jsxs)(li,{children:[(0,W.jsxs)(ui,{children:[(0,W.jsx)(fi,{children:`Are you absolutely sure?`}),(0,W.jsx)(pi,{children:`This action cannot be undone. This will permanently delete your account and remove all your data from our servers.`})]}),(0,W.jsxs)(di,{children:[(0,W.jsx)(hi,{children:`Cancel`}),(0,W.jsx)(mi,{onClick:re,className:`bg-destructive text-destructive-foreground hover:bg-destructive/90`,children:`Delete Account`})]})]})]})]})]})]})}),(0,W.jsx)(Ds,{isOpen:M,onClose:()=>N(!1),onKeyAdded:P})]})}function Ls({threshold:e=400,enabled:t=!0,onLoadMore:n}={}){let r=(0,H.useRef)(null),i=(0,H.useRef)(!1);return(0,H.useEffect)(()=>{if(!r.current||!t||!n)return;let a=new IntersectionObserver(e=>{let[t]=e;t.isIntersecting&&!i.current&&(i.current=!0,n(),setTimeout(()=>{i.current=!1},300))},{rootMargin:`${e}px`,threshold:0});return a.observe(r.current),()=>a.disconnect()},[e,t,n]),(0,H.useEffect)(()=>{t||(i.current=!1)},[t]),{triggerRef:r}}var Rs={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},zs=(e,t)=>{if(t===0)return{title:`No apps yet`,description:`Start building your first app with AI assistance.`};switch(e){case`popular`:return{title:`No popular apps yet`,description:`Apps will appear here once they start getting views, stars, or forks.`};case`starred`:return{title:`No bookmarked apps yet`,description:`Apps you bookmark will appear here. Click the bookmark icon on any app to add it.`};case`trending`:return{title:`No trending apps yet`,description:`Apps will appear here based on recent activity and engagement.`};case`recent`:default:return{title:`No apps match your filters`,description:`Try adjusting your search or filters to find what you're looking for.`}}};const Bs=({apps:e,loading:t,loadingMore:n,error:i,hasMore:a,totalCount:o,sortBy:s,onAppClick:c,onToggleFavorite:u,onLoadMore:d,onRetry:f,showUser:p=!1,showStats:m=!0,showActions:h=!1,infiniteScroll:g=!0,emptyState:_,className:v=``})=>{let y=zs(s,o),{triggerRef:b}=Ls({threshold:200,enabled:g&&a&&!n,onLoadMore:d});if(t)return(0,W.jsx)(`div`,{className:`flex items-center py-20`,children:(0,W.jsxs)(`div`,{className:`text-center`,children:[(0,W.jsx)(C,{className:`h-8 w-8 animate-spin mx-auto mb-4 text-text-tertiary`}),(0,W.jsx)(`p`,{className:`text-neutral-50`,children:`Loading apps...`})]})});if(i)return(0,W.jsxs)(`div`,{className:`text-center py-20`,children:[(0,W.jsx)(`div`,{className:`rounded-full bg-destructive/10 p-3 mb-4 inline-flex`,children:(0,W.jsx)(Ct,{className:`h-6 w-6 text-destructive`})}),(0,W.jsx)(`h3`,{className:`text-xl text-text-secondary font-semibold mb-2`,children:`Failed to load apps`}),(0,W.jsx)(`p`,{className:`text-text-tertiary mb-6`,children:i}),(0,W.jsxs)(K,{onClick:f,variant:`outline`,children:[(0,W.jsx)(ge,{className:`h-4 w-4 mr-2`}),`Retry`]})]});if(e.length===0){let e=_||y;return(0,W.jsxs)(`div`,{className:`text-center py-20`,children:[(0,W.jsx)(St,{className:`h-16 w-16 mx-auto mb-4 text-text-tertiary`}),(0,W.jsx)(`h3`,{className:`text-xl font-semibold mb-2 text-text-secondary`,children:e.title}),(0,W.jsx)(`p`,{className:`text-text-tertiary mb-6`,children:e.description}),`action`in e&&e.action]})}return(0,W.jsxs)(`div`,{className:v,children:[(0,W.jsx)(r.div,{variants:Rs,initial:`hidden`,animate:`visible`,className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6`,children:(0,W.jsx)(l,{mode:`popLayout`,children:e.map(e=>(0,W.jsx)(ua,{app:e,onClick:c,onToggleFavorite:u,showStats:m,showUser:p,showActions:h},e.id))})}),g&&a&&(0,W.jsx)(`div`,{ref:b,className:`relative mt-8`,style:{height:n?`auto`:`80px`},children:n&&(0,W.jsxs)(r.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:`space-y-4`,children:[(0,W.jsx)(`div`,{className:`flex items-center justify-center py-4`,children:(0,W.jsxs)(`div`,{className:`flex items-center gap-3 px-4 py-2 rounded-full bg-surface-elevated/60 backdrop-blur-sm border border-border/30`,children:[(0,W.jsx)(C,{className:`h-4 w-4 animate-spin text-accent`}),(0,W.jsx)(`span`,{className:`text-sm text-text-tertiary`,children:`Loading more amazing apps...`})]})}),(0,W.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6`,children:[...[,,,,]].map((e,t)=>(0,W.jsx)(`div`,{className:`animate-pulse`,children:(0,W.jsxs)(`div`,{className:`bg-surface-elevated/30 rounded-2xl p-6 h-[200px]`,children:[(0,W.jsx)(`div`,{className:`h-4 bg-surface-elevated/50 rounded w-3/4 mb-3`}),(0,W.jsx)(`div`,{className:`h-3 bg-surface-elevated/40 rounded w-full mb-2`}),(0,W.jsx)(`div`,{className:`h-3 bg-surface-elevated/40 rounded w-5/6`})]})},`skeleton-${t}`))})]})}),!g&&n&&(0,W.jsx)(`div`,{className:`flex justify-center mt-8`,children:(0,W.jsxs)(`div`,{className:`flex items-center gap-2 text-text-tertiary`,children:[(0,W.jsx)(C,{className:`h-4 w-4 animate-spin`}),(0,W.jsx)(`span`,{className:`text-sm`,children:`Loading more apps...`})]})}),!g&&a&&(0,W.jsx)(`div`,{className:`flex justify-center mt-8`,children:(0,W.jsx)(K,{onClick:d,disabled:n,variant:`outline`,className:`gap-2`,children:n?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(C,{className:`h-4 w-4 animate-spin`}),`Loading more...`]}):(0,W.jsx)(W.Fragment,{children:`Load more apps`})})}),o>0&&(0,W.jsxs)(`div`,{className:`text-center mt-6 text-sm text-text-tertiary`,children:[`Showing `,e.length,` of `,o,` apps`]})]})},Vs=({searchQuery:e,onSearchChange:t,onSearchSubmit:n,searchPlaceholder:r=`Search apps...`,showSearchButton:i=!1,className:a=``})=>(0,W.jsx)(`div`,{className:`max-w-4xl mb-8 ${a}`,children:(0,W.jsxs)(`form`,{onSubmit:n,className:`flex gap-2 mb-4`,children:[(0,W.jsxs)(`div`,{className:`relative`,children:[(0,W.jsx)(xe,{className:`absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-tertiary`}),(0,W.jsx)(ir,{type:`text`,placeholder:r,value:e,onChange:e=>t(e.target.value),className:`pl-10 bg-bg-4 w-90`})]}),i&&(0,W.jsx)(K,{type:`submit`,children:`Search`})]})});var Hs={recent:{value:`recent`,label:`Recent`,icon:un},popular:{value:`popular`,label:`Popular`,icon:M},trending:{value:`trending`,label:`Trending`,icon:M},starred:{value:`starred`,label:`Starred`,icon:R}};const Us=({value:e,onValueChange:t,availableSorts:n=[`recent`,`popular`,`trending`]})=>(0,W.jsxs)(`div`,{className:`grid grid-cols-1`,children:[(0,W.jsx)(`select`,{id:`location`,name:`location`,value:e,onChange:e=>t(e.target.value),className:`col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pl-3 pr-8 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 focus-visible:outline focus-visible:-outline-offset-2 focus-visible:outline-indigo-600 sm:text-sm/6 dark:bg-white/5 dark:text-white dark:outline-white/10 dark:*:bg-gray-800 dark:focus-visible:outline-indigo-500`,children:n.map(e=>Hs[e]).map(e=>(0,W.jsx)(`option`,{value:e.value,children:e.label},e.value))}),(0,W.jsx)(pn,{"aria-hidden":`true`,className:`pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4 dark:text-gray-400`})]});var Ws=[{value:`all`,label:`All`,icon:F,color:`from-violet-500/20 to-purple-500/20`,activeColor:`from-violet-500/10 to-purple-500/10`},{value:`public`,label:`Public`,icon:Zt,color:`from-green-500/20 to-emerald-500/20`,activeColor:`from-green-500/10 to-emerald-500/10`},{value:`private`,label:`Private`,icon:qe,color:`from-orange-500/20 to-red-500/20`,activeColor:`from-orange-500/10 to-red-500/10`}];const Gs=({value:e,onChange:t,className:n})=>(0,W.jsx)(`div`,{className:G(`inline-flex items-center rounded-lg bg-bg-4 p-0.5`,n),children:Ws.map(n=>{let i=n.icon,a=e===n.value;return(0,W.jsxs)(r.button,{onClick:()=>t(n.value),className:G(`relative inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-xs font-medium transition-all duration-200`,`outline-none focus-visible:ring-1 focus-visible:ring-accent/30`,a?`text-text-primary`:`text-text-tertiary hover:text-text-secondary`,!a&&`hover:bg-bg-3/30`),whileHover:{scale:a?1:1.01},whileTap:{scale:.99},children:[a&&(0,W.jsx)(r.div,{className:G(`absolute inset-0 rounded-md bg-bg-1 shadow-sm`),layoutId:`activeBackground`,transition:{type:`spring`,stiffness:500,damping:35}}),(0,W.jsxs)(`span`,{className:`relative flex items-center gap-1.5`,children:[(0,W.jsx)(i,{className:G(`h-3 w-3 transition-colors duration-200`,a&&`text-accent`)}),(0,W.jsx)(`span`,{children:n.label})]})]},n.value)})});function Ks(){let e=O(),[t,n]=oe(),i=[`recent`,`popular`,`trending`,`starred`],a=t.get(`sort`),o=typeof localStorage<`u`?localStorage.getItem(`apps.sort`):null,{searchQuery:s,setSearchQuery:c,filterFramework:l,filterVisibility:u,sortBy:d,period:f,apps:p,loading:m,loadingMore:h,error:g,totalCount:_,hasMore:v,handleSearchSubmit:y,handleSortChange:b,handlePeriodChange:x,handleFrameworkChange:S,handleVisibilityChange:C,refetch:w,loadMore:T}=Gi({type:`user`,defaultSort:a&&i.includes(a)?a:o&&i.includes(o)?o:`recent`,includeVisibility:!0,limit:20});return(0,W.jsx)(`div`,{className:`min-h-screen bg-bg-3`,children:(0,W.jsx)(`div`,{className:`container mx-auto px-4 py-8`,children:(0,W.jsxs)(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,W.jsxs)(`div`,{className:`mb-8`,children:[(0,W.jsx)(`h1`,{className:`text-6xl font-bold mb-3 font-[departureMono] text-accent`,children:`MY APPS`}),(0,W.jsx)(`p`,{className:`text-text-tertiary text-lg`,children:m?`Loading...`:`${_} app${_===1?``:`s`} in your workspace`})]}),(0,W.jsxs)(`div`,{className:`flex flex-col gap-4`,children:[(0,W.jsx)(`div`,{className:`flex items-center gap-4`,children:(0,W.jsx)(Gs,{value:u,onChange:C})}),(0,W.jsxs)(`div`,{className:`flex items-start gap-4 justify-between`,children:[(0,W.jsx)(Vs,{searchQuery:s,onSearchChange:c,onSearchSubmit:y,searchPlaceholder:`Search your apps...`,filterFramework:l,onFrameworkChange:S,filterVisibility:u,onVisibilityChange:C,showVisibility:!1,period:f,onPeriodChange:x,sortBy:d}),(0,W.jsx)(Us,{value:d,onValueChange:e=>{b(e);try{localStorage.setItem(`apps.sort`,e)}catch{}let r=new URLSearchParams(t);r.set(`sort`,e),n(r,{replace:!0})},availableSorts:[`recent`,`popular`,`trending`,`starred`]})]})]}),(0,W.jsx)(Bs,{apps:p,loading:m,loadingMore:h,error:g,hasMore:v,totalCount:_,sortBy:d,onAppClick:t=>e(`/app/${t}`),onToggleFavorite:async e=>{try{await Xr(e),w()}catch(e){console.error(`Failed to toggle favorite:`,e)}},onLoadMore:T,onRetry:w,showUser:!1,showStats:!0,showActions:!0,infiniteScroll:!0,emptyState:!s&&l===`all`&&u===`all`&&d===`recent`&&_===0?{title:`No apps yet`,description:`Start building your first app with AI assistance.`,action:(0,W.jsx)(`div`,{})}:void 0})]})})})}var qs=[`favorite`,`bookmark`,`star`,`fork`,`remix`],Js={favorite:`favorite`,bookmark:`favorite`,star:`star`,fork:`fork`,remix:`fork`};function Ys(){let{id:e}=He(),t=O(),[n,r]=oe(),{user:i}=Un(),{requireAuth:a}=Vr(),[o,s]=(0,H.useState)(null),[c,l]=(0,H.useState)(!0),[u,f]=(0,H.useState)(null),[m,h]=(0,H.useState)(!1),[g,v]=(0,H.useState)(!1),[y,b]=(0,H.useState)(!1),[x,S]=(0,H.useState)(`preview`),[w,E]=(0,H.useState)(!1),[D,k]=(0,H.useState)(``),[A,M]=(0,H.useState)(!1),[N,F]=(0,H.useState)(!1),[I,L]=(0,H.useState)(!1),[ee,te]=(0,H.useState)(),ne=(0,H.useRef)(null),re=(0,H.useCallback)(async()=>{if(e)try{l(!0),f(null);let t=await U.getAppDetails(e);if(t.success&&t.data){let e=t.data;s(e),h(e.userFavorited||!1),v(e.userStarred||!1)}else throw Error(t.error?.message||`Failed to fetch app details`)}catch(e){console.error(`Error fetching app:`,e),e instanceof Rn?e.status===404?f(`App not found`):f(`Failed to load app: ${e.message}`):f(e instanceof Error?e.message:`Failed to load app`)}finally{l(!1)}},[e]);(0,H.useEffect)(()=>{re()},[e,re]);let ae=(0,H.useMemo)(()=>o?.agentSummary?.generatedCode?o.agentSummary.generatedCode.filter(e=>e&&e.filePath&&typeof e.filePath==`string`).map(e=>({filePath:e.filePath,fileContents:e.fileContents||``,explanation:e.filePurpose,language:so(e.filePath),isGenerating:!1,needsFixing:!1,hasErrors:!1})):[],[o?.agentSummary?.generatedCode]),se=(0,H.useMemo)(()=>ae.find(e=>e.filePath===ee),[ae,ee]);(0,H.useEffect)(()=>{ae.length>0&&!ee&&te(ae[0].filePath)},[ae,ee]);let ce=(0,H.useCallback)(e=>{te(e.filePath)},[]),le=(0,H.useMemo)(()=>({favorite:{action:`favorite`,context:`to bookmark apps`,handler:async()=>{if(!o)return;let e=await Xr(o.id);h(e),_.success(e?`Added to bookmarks`:`Removed from bookmarks`)},errorMessage:`Failed to update bookmarks`},star:{action:`star`,context:`to star apps`,handler:async()=>{if(!o)return;let e=await U.toggleAppStar(o.id);if(e.success&&e.data)v(e.data.isStarred),s(t=>t?{...t,starCount:e.data?.starCount||0}:null),_.success(e.data.isStarred?`Starred!`:`Unstarred`);else throw Error(e.error?.message||`Failed to star app`)},errorMessage:`Failed to update star`}}),[o]),ue=(0,H.useCallback)(e=>async()=>{if(!o)return;let t=le[e];if(!t)return;let n=`/app/${o.id}?action=${t.action}`;if(a({requireFullAuth:!0,actionContext:t.context,intendedUrl:n}))try{await t.handler()}catch(e){console.error(`${t.action} error:`,e),_.error(e instanceof Rn?e.message:t.errorMessage)}},[le,o,a]),de=(0,H.useMemo)(()=>ue(`favorite`),[ue]),fe=(0,H.useMemo)(()=>ue(`star`),[ue]),pe=(0,H.useCallback)(async e=>{if(!o)return;let t=Js[e];if(!t){console.warn(`Unknown pending action:`,e);return}let n=le[t];if(!n){console.warn(`No config found for action:`,e);return}try{await n.handler()}catch(t){console.error(`Failed to execute pending action:`,e,t),_.error(t instanceof Rn?t.message:n.errorMessage)}},[le,o]);(0,H.useEffect)(()=>{if(!i||!o||c)return;let e=n.get(`action`);if(!e)return;let t=qs.find(t=>t===e);if(!t){console.warn(`Unsupported action parameter:`,e);return}let a=new URLSearchParams(n);a.delete(`action`),r(a,{replace:!0}),pe(t)},[i,o,c,n,r,pe]);let z=()=>{B&&(navigator.clipboard.writeText(B),b(!0),setTimeout(()=>b(!1),2e3))},me=()=>o?.cloudflareUrl||o?.previewUrl||``,he=async()=>{if(!(!o||w))try{E(!0),k(`Connecting to agent...`);let e=await U.deployPreview(o.id);if(e.success&&e.data){let t=e.data;if(t.previewURL||t.tunnelURL){let e=tr(t.previewURL,t.tunnelURL);s(t=>t?{...t,cloudflareUrl:e,previewUrl:e}:null),k(`Deployment complete!`)}}E(!1)}catch(e){console.error(`Error starting deployment:`,e),k(`Failed to start deployment`),E(!1),_.error(`Failed to start deployment`)}},ge=async()=>{if(!o||!i||!ve){_.error(`You can only change visibility of your own apps`);return}try{M(!0);let e=o.visibility===`private`?`public`:`private`,t=await U.updateAppVisibility(o.id,e);if(t.success&&t.data)s(t=>t?{...t,visibility:e}:null),_.success(t.data.message||`App is now ${e===`private`?`private`:`public`}`);else throw Error(t.error?.message||`Failed to update visibility`)}catch(e){console.error(`Error updating app visibility:`,e),_.error(e instanceof Rn?e.message:`Failed to update visibility`)}finally{M(!1)}},_e=async()=>{if(o)try{L(!0),(await U.deleteApp(o.id)).success&&(_.success(`App deleted successfully`),F(!1),Hr.emitAppDeleted(o.id),window.history.length>1?window.history.back():t(`/apps`))}catch(e){console.error(`Error deleting app:`,e),_.error(`An unexpected error occurred while deleting the app`)}finally{L(!1)}};if(c)return(0,W.jsx)(`div`,{className:`min-h-screen bg-bg-3 flex items-center justify-center`,children:(0,W.jsxs)(`div`,{className:`text-center`,children:[(0,W.jsx)(C,{className:`h-8 w-8 animate-spin mx-auto mb-4 text-text-tertiary`}),(0,W.jsx)(`p`,{className:`text-text-tertiary`,children:`Loading app...`})]})});if(u||!o)return(0,W.jsx)(`div`,{className:`min-h-screen bg-bg-3 flex items-center justify-center`,children:(0,W.jsx)(q,{className:`max-w-md`,children:(0,W.jsx)(J,{className:`pt-6`,children:(0,W.jsxs)(`div`,{className:`text-center`,children:[(0,W.jsx)(`h2`,{className:`text-xl font-semibold mb-2`,children:`App not found`}),(0,W.jsx)(`p`,{className:`text-text-tertiary mb-4`,children:u||`The app you're looking for doesn't exist.`}),(0,W.jsxs)(K,{onClick:()=>t(`/apps`),children:[(0,W.jsx)(j,{className:`mr-2 h-4 w-4`}),`Back to Apps`]})]})})})});let ve=o.userId===i?.id,B=me(),ye=o.createdAt?new Date(o.createdAt):new Date;return(0,W.jsxs)(`div`,{className:`min-h-screen bg-bg-3 flex flex-col`,children:[(0,W.jsxs)(`div`,{className:`container mx-auto px-4 pb-6 space-y-6 flex flex-col flex-1`,children:[(0,W.jsxs)(`button`,{onClick:()=>history.back(),className:`gap-2 flex items-center text-text-primary/80`,children:[(0,W.jsx)(j,{className:`h-4 w-4`}),`Back`]}),(0,W.jsx)(`div`,{className:`flex flex-col items-start justify-between gap-4 text-bg-4 w-fit rounded-lg p-5`,children:(0,W.jsxs)(`div`,{className:`flex-1`,children:[(0,W.jsxs)(`div`,{className:`flex rounded w-fit pb-3 pt-2 flex-col mb-6`,children:[(0,W.jsxs)(`div`,{className:`flex items-center gap-3 mb-2`,children:[(0,W.jsx)(`h1`,{className:`text-4xl font-semibold tracking-tight text-text-primary`,children:o.title}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2 border rounded-xl`,children:[(0,W.jsxs)(Q,{variant:`default`,children:[(0,W.jsx)(Zt,{}),nr(o.visibility)]}),ve&&(0,W.jsx)(K,{variant:`ghost`,size:`sm`,onClick:ge,disabled:A,className:`h-6 w-6 p-0 hover:bg-bg-3/50 -ml-1.5 !mr-1.5`,title:`Make ${o.visibility===`private`?`public`:`private`}`,children:A?(0,W.jsx)(C,{className:`h-3 w-3 animate-spin text-text-primary`}):o.visibility===`private`?(0,W.jsx)(Ze,{className:`h-3 w-3 text-text-primary`}):(0,W.jsx)(qe,{className:`h-3 w-3 text-text-primary`})})]})]}),(0,W.jsxs)(`div`,{className:`flex flex-wrap gap-2`,children:[(0,W.jsxs)(K,{variant:`outline`,size:`sm`,onClick:de,className:G(`gap-2 text-text-primary`),children:[(0,W.jsx)(T,{className:G(`h-4 w-4`,m&&`fill-current`)}),m?`Bookmarked`:`Bookmark`]}),(0,W.jsxs)(K,{variant:`outline`,size:`sm`,onClick:fe,className:G(`gap-2 text-text-primary`),children:[(0,W.jsx)(R,{className:G(`h-4 w-4`,g&&`fill-current`)}),g?`Starred`:`Star`]}),o.githubRepositoryUrl&&(0,W.jsxs)(K,{variant:`outline`,size:`sm`,onClick:()=>{o.githubRepositoryUrl&&window.open(o.githubRepositoryUrl,`_blank`,`noopener,noreferrer`)},className:G(`gap-2 text-text-primary`),title:`View on GitHub (${o.githubRepositoryVisibility||`public`})`,children:[(0,W.jsx)(Tt,{className:`h-4 w-4`}),`View on GitHub`,o.githubRepositoryVisibility===`private`&&(0,W.jsx)(qe,{className:`h-3 w-3 opacity-70`})]}),ve?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(K,{size:`sm`,onClick:()=>t(`/chat/${o.id}`),className:`gap-2 bg-text-primary text-bg-4 border-bg-4 border`,children:[(0,W.jsx)(St,{className:`h-4 w-4`}),`Continue Editing`]}),(0,W.jsxs)(K,{variant:`outline`,size:`sm`,onClick:()=>F(!0),className:`gap-2 text-text-on-brand !border-0 bg-destructive hover:opacity-90 transition-colors`,children:[(0,W.jsx)(mn,{className:`h-4 w-4`}),`Delete App`]})]}):(0,W.jsx)(W.Fragment,{})]})]}),o.description&&(0,W.jsx)(`p`,{className:`text-text-primary my-3 max-w-4xl`,children:o.description}),(0,W.jsxs)(`div`,{className:`flex flex-wrap items-center gap-4 text-sm text-text-secondary`,children:[o.user&&(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(bn,{className:`h-4 w-4`}),(0,W.jsx)(`span`,{children:o.user.displayName})]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(P,{className:`h-4 w-4`}),(0,W.jsx)(`span`,{children:d(ye)?p(ye,{addSuffix:!0}):`recently`})]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(Ut,{className:`h-4 w-4`}),(0,W.jsx)(`span`,{children:o.viewCount||0})]}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,W.jsx)(R,{className:`h-4 w-4`}),(0,W.jsx)(`span`,{children:o.starCount||0})]})]})]})}),(0,W.jsxs)(Lo,{value:x,onValueChange:S,className:`flex flex-col flex-1 gap-2`,children:[(0,W.jsxs)(Ro,{className:`inline-flex h-auto w-fit items-center gap-0.5 bg-bg-2 dark:bg-bg-1 rounded-md p-0.5 border border-border-primary/30 ml-0`,children:[(0,W.jsxs)(zo,{value:`preview`,className:`px-3 py-1.5 rounded text-xs font-medium data-[state=active]:bg-bg-4 dark:data-[state=active]:bg-bg-3 data-[state=active]:text-text-primary data-[state=active]:shadow-sm`,children:[(0,W.jsx)(Ut,{className:G(`h-3.5 w-3.5 mr-1.5`,x===`preview`?`text-accent`:`text-accent/60`)}),`Preview`]}),(0,W.jsxs)(zo,{value:`code`,className:`px-3 py-1.5 rounded text-xs font-medium data-[state=active]:bg-bg-4 dark:data-[state=active]:bg-bg-3 data-[state=active]:text-text-primary data-[state=active]:shadow-sm`,children:[(0,W.jsx)(St,{className:G(`h-3.5 w-3.5 mr-1.5`,x===`code`?`text-accent`:`text-accent/60`)}),`Code`]}),(0,W.jsxs)(zo,{value:`prompt`,className:`px-3 py-1.5 rounded text-xs font-medium data-[state=active]:bg-bg-4 dark:data-[state=active]:bg-bg-3 data-[state=active]:text-text-primary data-[state=active]:shadow-sm`,children:[(0,W.jsx)(ie,{className:G(`h-3.5 w-3.5 mr-1.5`,x===`prompt`?`text-accent`:`text-accent/60`)}),`Prompt`]})]}),(0,W.jsx)(Bo,{value:`preview`,className:`flex-1`,children:(0,W.jsxs)(q,{className:`px-2`,children:[(0,W.jsx)(Ki,{className:`overflow-hidden rounded-t`,children:(0,W.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,W.jsx)(qi,{className:`text-base`,children:`Live Preview`}),(0,W.jsx)(`div`,{className:`flex items-center gap-0`,children:B&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(K,{variant:`ghost`,size:`sm`,onClick:z,className:`gap-2`,children:y?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Ie,{className:`h-3 w-3`}),`Copied!`]}):(0,W.jsx)(W.Fragment,{children:(0,W.jsx)(gt,{className:`h-3 w-3`})})}),(0,W.jsx)(K,{variant:`ghost`,size:`sm`,onClick:()=>window.open(B,`_blank`),className:`gap-2`,children:(0,W.jsx)(ct,{className:`h-3 w-3`})})]})})]})}),(0,W.jsx)(J,{className:`p-0`,children:(0,W.jsx)(`div`,{className:`border-t relative`,children:B?(0,W.jsx)(Ya,{ref:ne,src:B,className:`w-full h-[600px] lg:h-[800px]`,title:`${o.title} Preview`}):(0,W.jsxs)(`div`,{className:`relative w-full h-[400px] bg-gray-50 flex items-center justify-center`,children:[(0,W.jsx)(`div`,{className:`absolute inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center z-10`,children:(0,W.jsxs)(`div`,{className:`text-center p-8`,children:[(0,W.jsx)(`h3`,{className:`text-xl font-semibold mb-2 text-gray-700`,children:`Run App`}),(0,W.jsx)(`p`,{className:`text-gray-500 mb-6 max-w-md`,children:`Run the app to see a live preview.`}),D&&(0,W.jsx)(`p`,{className:`text-sm text-gray-800 mb-4`,children:D}),(0,W.jsx)(`div`,{className:`flex gap-3 justify-center`,children:(0,W.jsx)(K,{onClick:he,disabled:w,className:`gap-2`,children:w?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(C,{className:`h-4 w-4 animate-spin`}),`Deploying...`]}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Cn,{className:`h-4 w-4`}),`Deploy for Preview`]})})})]})}),(0,W.jsx)(`div`,{className:`absolute inset-0 opacity-10`,children:(0,W.jsx)(`div`,{className:`w-full h-full`,style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23000' fill-opacity='0.1'%3E%3Cpath d='M20 20c0 11.046-8.954 20-20 20V0c11.046 0 20 8.954 20 20z'/%3E%3C/g%3E%3C/svg%3E")`,backgroundSize:`40px 40px`}})})]})})})]})}),(0,W.jsx)(Bo,{value:`code`,className:`flex-1`,children:(0,W.jsxs)(q,{className:`flex flex-col`,style:{maxHeight:`600px`},children:[(0,W.jsx)(Ki,{children:(0,W.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,W.jsxs)(`div`,{children:[(0,W.jsx)(qi,{children:`Generated Code`}),o?.agentSummary&&(0,W.jsxs)(`p`,{className:`text-sm text-muted-foreground`,children:[ae.length,` files generated`]})]}),se&&(0,W.jsxs)(K,{variant:`ghost`,size:`sm`,onClick:()=>{navigator.clipboard.writeText(se.fileContents),_.success(`Code copied to clipboard`)},className:`gap-2`,children:[(0,W.jsx)(gt,{className:`h-3 w-3`}),`Copy File`]})]})}),(0,W.jsx)(J,{className:`p-0 flex-1 flex flex-col overflow-hidden`,children:ae.length>0?(0,W.jsx)(`div`,{className:`h-[450px] relative bg-bg-3 overflow-hidden`,children:(0,W.jsxs)(`div`,{className:`h-full flex`,children:[(0,W.jsxs)(`div`,{className:`w-full max-w-[250px] bg-bg-3 border-r border-text/10 h-full overflow-y-auto`,children:[(0,W.jsxs)(`div`,{className:`p-2 px-3 text-sm flex items-center gap-1 text-text-primary/50 font-medium border-b bg-bg-3`,children:[(0,W.jsx)(St,{className:`size-4`}),`Files`]}),(0,W.jsx)(`div`,{className:`flex flex-col`,children:ae.map(e=>(0,W.jsxs)(`button`,{onClick:()=>ce(e),className:G(`flex items-center w-full gap-2 py-2 px-3 text-left text-sm transition-colors`,se?.filePath===e.filePath?`bg-blue-100 text-blue-900 border-r-2 border-blue-500`:`hover:bg-bg-3 text-text-tertiary hover:text-text-primary`),children:[(0,W.jsx)(St,{className:`h-4 w-4 flex-shrink-0`}),(0,W.jsx)(`span`,{className:`truncate font-mono text-xs`,children:e.filePath})]},e.filePath))})]}),(0,W.jsx)(`div`,{className:`flex-1 flex flex-col`,children:se?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(`div`,{className:`flex items-center justify-between p-3 border-b bg-bg-3`,children:(0,W.jsxs)(`div`,{className:`flex items-center gap-2 flex-1`,children:[(0,W.jsx)(St,{className:`h-4 w-4`}),(0,W.jsx)(`span`,{className:`text-sm font-mono`,children:se.filePath}),se.explanation&&(0,W.jsx)(`span`,{className:`text-xs text-text-tertiary ml-3`,children:se.explanation})]})}),(0,W.jsx)(`div`,{className:`flex-1 min-h-0`,children:(0,W.jsx)(ba,{className:`h-full`,createOptions:{value:se.fileContents,language:se.language||`plaintext`,readOnly:!0,minimap:{enabled:!1},lineNumbers:`on`,scrollBeyondLastLine:!1,fontSize:13,theme:`v1-dev`,automaticLayout:!0}})})]}):(0,W.jsx)(`div`,{className:`flex-1 flex items-center justify-center`,children:(0,W.jsx)(`p`,{className:`text-text-tertiary`,children:`Select a file to view`})})})]})}):(0,W.jsx)(`div`,{className:`flex items-center justify-center h-[400px]`,children:(0,W.jsx)(`p`,{className:`text-muted-foreground`,children:o?.agentSummary===null?`Loading code...`:`No code has been generated yet.`})})})]})}),(0,W.jsx)(Bo,{value:`prompt`,className:`flex-1`,children:(0,W.jsxs)(q,{children:[(0,W.jsxs)(Ki,{children:[(0,W.jsx)(qi,{children:`Original Prompt`}),(0,W.jsx)(Ji,{children:`The initial prompt used to create this app`})]}),(0,W.jsx)(J,{children:o?.agentSummary?.query||o?.originalPrompt?(0,W.jsxs)(`div`,{className:`bg-bg-2 rounded-lg p-6 border border-border-primary`,children:[(0,W.jsxs)(`div`,{className:`flex items-start gap-3`,children:[(0,W.jsx)(`div`,{className:`flex-shrink-0 mt-1`,children:(0,W.jsx)(`div`,{className:`rounded-full bg-accent/10 p-2`,children:(0,W.jsx)(ie,{className:`h-4 w-4 text-accent`})})}),(0,W.jsxs)(`div`,{className:`flex-1`,children:[(0,W.jsx)(`p`,{className:`text-sm text-text-secondary mb-2 font-medium`,children:`Prompt`}),(0,W.jsx)(`p`,{className:`text-text-primary whitespace-pre-wrap`,children:o?.agentSummary?.query||o?.originalPrompt})]})]}),(0,W.jsx)(`div`,{className:`mt-4 flex justify-end`,children:(0,W.jsxs)(K,{variant:`outline`,size:`sm`,onClick:()=>{let e=o?.agentSummary?.query||o?.originalPrompt;e&&(navigator.clipboard.writeText(e),_.success(`Prompt copied to clipboard`))},className:`gap-2`,children:[(0,W.jsx)(gt,{className:`h-3 w-3`}),`Copy Prompt`]})})]}):(0,W.jsxs)(`div`,{className:`flex items-center justify-center py-12 text-text-tertiary`,children:[(0,W.jsx)(ie,{className:`h-8 w-8 mr-3`}),(0,W.jsx)(`p`,{children:o?.agentSummary===null?`Loading prompt...`:`No prompt available`})]})})]})})]})]}),(0,W.jsx)(gi,{open:N,onOpenChange:F,onConfirm:_e,isLoading:I,appTitle:o?.title})]})}function Xs(){let e=O(),[t,n]=oe(),i=[`recent`,`popular`,`trending`,`starred`],a=t.get(`sort`),o=typeof localStorage<`u`?localStorage.getItem(`discover.sort`):null,{searchQuery:s,setSearchQuery:c,filterFramework:l,sortBy:u,period:d,apps:f,loading:p,loadingMore:m,error:h,totalCount:g,hasMore:_,handleSearchSubmit:v,handlePeriodChange:y,handleFrameworkChange:b,handleSortChange:x,refetch:S,loadMore:C}=Gi({type:`public`,defaultSort:a&&i.includes(a)?a:o&&i.includes(o)?o:`popular`,defaultPeriod:`week`,limit:20});return(0,W.jsx)(`div`,{className:`min-h-screen`,children:(0,W.jsx)(`div`,{className:`container mx-auto px-4 py-8`,children:(0,W.jsxs)(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,W.jsxs)(`div`,{className:`mb-8`,children:[(0,W.jsx)(`h1`,{className:`text-6xl font-bold mb-3 font-[departureMono] text-accent`,children:`DISCOVER`}),(0,W.jsx)(`p`,{className:`text-text-tertiary text-lg`,children:`Explore apps built by the community`})]}),(0,W.jsxs)(`div`,{className:`flex items-start gap-4 justify-between`,children:[(0,W.jsx)(Vs,{searchQuery:s,onSearchChange:c,onSearchSubmit:v,searchPlaceholder:`Search apps...`,showSearchButton:!0,filterFramework:l,period:d,onFrameworkChange:b,onPeriodChange:y,sortBy:u}),(0,W.jsx)(Us,{value:u,onValueChange:e=>{x(e);try{localStorage.setItem(`discover.sort`,e)}catch{}let r=new URLSearchParams(t);r.set(`sort`,e),n(r,{replace:!0})},availableSorts:[`recent`,`popular`,`trending`,`starred`]})]}),(0,W.jsx)(Bs,{apps:f,loading:p,loadingMore:m,error:h,hasMore:_,totalCount:g,sortBy:u,onAppClick:t=>e(`/app/${t}`),onLoadMore:C,onRetry:S,showUser:!0,showStats:!0,infiniteScroll:!0})]})})})}function Zs({children:e}){let{isAuthenticated:t,isLoading:n}=Un();return n?(0,W.jsx)(`div`,{className:`min-h-screen flex items-center justify-center`,children:(0,W.jsxs)(`div`,{className:`space-y-4`,children:[(0,W.jsx)(pr,{className:`h-12 w-48`}),(0,W.jsx)(pr,{className:`h-4 w-32 mx-auto`})]})}):t?(0,W.jsx)(W.Fragment,{children:e}):(0,W.jsx)(le,{to:`/`,replace:!0})}var Qs=[{path:`/`,Component:Wi,children:[{index:!0,Component:_a},{path:`chat/:chatId`,Component:Jo},{path:`profile`,element:H.createElement(Zs,{children:H.createElement(Qo)})},{path:`settings`,element:H.createElement(Zs,{children:H.createElement(Is)})},{path:`apps`,element:H.createElement(Zs,{children:H.createElement(Ks)})},{path:`app/:id`,Component:Ys},{path:`discover`,Component:Xs}]}];Nn();var $s=Ae(Qs,{hydrationData:window.__staticRouterHydrationData});(0,Mn.createRoot)(document.getElementById(`root`)).render((0,W.jsx)(te,{router:$s}));
//# sourceMappingURL=index-C2o18Evc.js.map